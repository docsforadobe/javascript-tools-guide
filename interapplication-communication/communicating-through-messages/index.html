
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://extendscript.docsforadobe.dev/interapplication-communication/communicating-through-messages/">
      
      
        <link rel="prev" href="../cross-dom-functions/">
      
      
        <link rel="next" href="../messaging-framework-api-reference/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Communicating through messages - Adobe Extendscript Scripting Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../_static/extra.css">
    
      <link rel="stylesheet" href="../../docs/_global/css/global.css">
    
      <link rel="stylesheet" href="../../docs/_global/css/global-syntax-highlight.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#communicating-through-messages" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
  Welcome to the new docsforadobe guide!

  This is a work in progress.

  Please provide all feedback via
  <a ref="me" href="https://github.com/orgs/docsforadobe/discussions">
    <span class="twemoji">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.75 1h8.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 10.25 10H7.061l-2.574 2.573A1.458 1.458 0 0 1 2 11.543V10h-.25A1.75 1.75 0 0 1 0 8.25v-5.5C0 1.784.784 1 1.75 1M1.5 2.75v5.5c0 .138.112.25.25.25h1a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.75.75 0 0 1 .53-.22h3.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25m13 2a.25.25 0 0 0-.25-.25h-.5a.75.75 0 0 1 0-1.5h.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 14.25 12H14v1.543a1.458 1.458 0 0 1-2.487 1.03L9.22 12.28a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l2.22 2.22v-2.19a.75.75 0 0 1 .75-.75h1a.25.25 0 0 0 .25-.25Z"/></svg>
    </span>
    <strong>the org's discussion forum</strong>
  </a>.

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://docsforadobe.dev" title="Adobe Extendscript Scripting Guide" class="md-header__button md-logo" aria-label="Adobe Extendscript Scripting Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Adobe Extendscript Scripting Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Communicating through messages
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/docsforadobe/javascript-tools-guide/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    javascript-tools-guide
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docsforadobe.dev" title="Adobe Extendscript Scripting Guide" class="md-nav__button md-logo" aria-label="Adobe Extendscript Scripting Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Adobe Extendscript Scripting Guide
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/docsforadobe/javascript-tools-guide/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    javascript-tools-guide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/extendscript-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExtendScript overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/scripting-for-specific-applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scripting for specific applications
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    The VS Code ExtendScript Debugger
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            The VS Code ExtendScript Debugger
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vscode-debugger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The VS Code Debugger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vscode-debugger/getting-started-with-vscode-debugger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with the VS Code Debugger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vscode-debugger/vscode-extension-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VS Code Extension Features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    The ExtendScript Toolkit
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            The ExtendScript Toolkit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-toolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The ExtendScript Toolkit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-toolkit/configuring-the-toolkit-window/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring the Toolkit window
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-toolkit/selecting-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Selecting Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-toolkit/the-script-editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Script Editor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-toolkit/debugging-in-the-toolkit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging in the Toolkit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-toolkit/code-profiling-for-optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code profiling for optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-toolkit/inspecting-object-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inspecting object models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    File System Access
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            File System Access
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../file-system-access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File System Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../file-system-access/using-file-and-folder-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using File and Folder objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../file-system-access/file-access-error-messages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File access error messages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../file-system-access/file-and-folder-supported-encoding-names/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File- and Folder-supported encoding names
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../file-system-access/file-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../file-system-access/folder-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folder object
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User-Interface Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            User-Interface Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User-Interface Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/code-examples-for-scriptui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code examples for ScriptUI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/scriptui-programming-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScriptUI programming model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/types-of-controls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types of controls
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/size-and-location-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Size and location objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/drawing-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/resource-specifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource specifications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/defining-behavior-with-event-callbacks-and-listeners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining behavior with event callbacks and listeners
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/communicating-with-the-flash-application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Communicating with the Flash application
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/automatic-layout/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automatic layout
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/managing-control-titles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Managing control titles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/localization-in-scriptui-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Localization in ScriptUI objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/scriptui-object-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScriptUI object reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/scriptui-class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScriptUI class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/common-properties/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/window-class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Window class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/window-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Window object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/control-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/event-handling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Event handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/graphic-customization-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphic customization objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-interface-tools/layoutmanager-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LayoutManager object
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interapplication Communication with Scripts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Interapplication Communication with Scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interapplication Communication with Scripts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../communications-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Communications overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cross-dom-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross-DOM functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Communicating through messages
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Communicating through messages
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page Contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
	<a href="#sending-messages" class="md-nav__link">
		<span class="md-ellipsis">
			Sending messages
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Sending messages">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#step-1-check-that-the-target-application-is-installed" class="md-nav__link">
		<span class="md-ellipsis">
			Step 1: Check that the target application is installed
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#step-2-construct-a-message-object" class="md-nav__link">
		<span class="md-ellipsis">
			Step 2: Construct a message object
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#step-3-specify-how-to-handle-a-response" class="md-nav__link">
		<span class="md-ellipsis">
			Step 3: Specify how to handle a response
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#receiving-messages" class="md-nav__link">
		<span class="md-ellipsis">
			Receiving messages
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#handling-unsolicited-messages" class="md-nav__link">
		<span class="md-ellipsis">
			Handling unsolicited messages
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Handling unsolicited messages">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#message-handling-examples" class="md-nav__link">
		<span class="md-ellipsis">
			Message-handling examples
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#handling-responses-from-the-message-target" class="md-nav__link">
		<span class="md-ellipsis">
			Handling responses from the message target
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Handling responses from the message target">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#example-receiving-a-simple-response" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Receiving a simple response
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#example-handling-any-error" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Handling any error
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#example-handling-expected-errors-and-responses" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Handling expected errors and responses
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#example-setting-up-a-target-to-send-multiple-responses" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Setting up a target to send multiple responses
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#example-setting-up-a-sender-to-receive-multiple-responses" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Setting up a sender to receive multiple responses
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#passing-values-between-applications" class="md-nav__link">
		<span class="md-ellipsis">
			Passing values between applications
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Passing values between applications">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#passing-simple-types" class="md-nav__link">
		<span class="md-ellipsis">
			Passing simple types
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#passing-complex-types" class="md-nav__link">
		<span class="md-ellipsis">
			Passing complex types
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../messaging-framework-api-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Messaging framework API reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bridgetalk-class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BridgeTalk class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bridgetalk-message-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BridgeTalk message object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../messaging-error-codes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Messaging error codes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../application-and-namespace-specifiers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application and namespace specifiers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    External Communication Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            External Communication Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external-communication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Communication Tools
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external-communication/socket-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Socket object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../external-communication/socket-object-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Socket object reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integrating External Libraries
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Integrating External Libraries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrating-external-libraries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrating External Libraries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrating-external-libraries/loading-and-using-shared-libraries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loading and using shared libraries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrating-external-libraries/externalobject-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExternalObject object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrating-external-libraries/defining-entry-points-for-direct-access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining entry points for direct access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrating-external-libraries/defining-entry-points-for-indirect-access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining entry points for indirect access
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ExtendScript Tools and Features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            ExtendScript Tools and Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-tools-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExtendScript Tools and Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-tools-features/dollar-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dollar ($) object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-tools-features/extendscript-reflection-interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExtendScript reflection interface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-tools-features/localizing-extendscript-strings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Localizing ExtendScript strings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-tools-features/user-notification-dialogs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User notification dialogs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-tools-features/specifying-measurement-values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Specifying measurement values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-tools-features/preprocessor-directives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocessor directives
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../extendscript-tools-features/operator-overloading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operator overloading
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integrating XML into JavaScript
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Integrating XML into JavaScript
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrating-xml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integrating XML into JavaScript
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrating-xml/the-xml-object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The XML Object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrating-xml/xml-object-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XML Object Reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Scripting Access to XMP Metadata
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Scripting Access to XMP Metadata
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripting-xmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scripting Access to XMP Metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripting-xmp/accessing-the-xmp-scripting-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing the XMP scripting API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripting-xmp/xmpscript-object-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XMPScript object reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page Contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
	<a href="#sending-messages" class="md-nav__link">
		<span class="md-ellipsis">
			Sending messages
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Sending messages">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#step-1-check-that-the-target-application-is-installed" class="md-nav__link">
		<span class="md-ellipsis">
			Step 1: Check that the target application is installed
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#step-2-construct-a-message-object" class="md-nav__link">
		<span class="md-ellipsis">
			Step 2: Construct a message object
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#step-3-specify-how-to-handle-a-response" class="md-nav__link">
		<span class="md-ellipsis">
			Step 3: Specify how to handle a response
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#receiving-messages" class="md-nav__link">
		<span class="md-ellipsis">
			Receiving messages
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
      
        <li class="md-nav__item">
	<a href="#handling-unsolicited-messages" class="md-nav__link">
		<span class="md-ellipsis">
			Handling unsolicited messages
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Handling unsolicited messages">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#message-handling-examples" class="md-nav__link">
		<span class="md-ellipsis">
			Message-handling examples
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#handling-responses-from-the-message-target" class="md-nav__link">
		<span class="md-ellipsis">
			Handling responses from the message target
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Handling responses from the message target">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#example-receiving-a-simple-response" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Receiving a simple response
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#example-handling-any-error" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Handling any error
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#example-handling-expected-errors-and-responses" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Handling expected errors and responses
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#example-setting-up-a-target-to-send-multiple-responses" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Setting up a target to send multiple responses
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#example-setting-up-a-sender-to-receive-multiple-responses" class="md-nav__link">
		<span class="md-ellipsis">
			Example: Setting up a sender to receive multiple responses
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
        <li class="md-nav__item">
	<a href="#passing-values-between-applications" class="md-nav__link">
		<span class="md-ellipsis">
			Passing values between applications
		</span>
	</a>

	<!-- Table of contents list -->
	
		<nav class="md-nav" aria-label="Passing values between applications">
			<ul class="md-nav__list">
				
				
					<li class="md-nav__item">
	<a href="#passing-simple-types" class="md-nav__link">
		<span class="md-ellipsis">
			Passing simple types
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
				
					<li class="md-nav__item">
	<a href="#passing-complex-types" class="md-nav__link">
		<span class="md-ellipsis">
			Passing complex types
		</span>
	</a>

	<!-- Table of contents list -->
	
</li>
				
				
			</ul>
		</nav>
	
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/docsforadobe/javascript-tools-guide/edit/master/docs/interapplication-communication/communicating-through-messages.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/docsforadobe/javascript-tools-guide/raw/master/docs/interapplication-communication/communicating-through-messages.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="communicating-through-messages">Communicating through messages<a class="headerlink" href="#communicating-through-messages" title="Permanent link">&para;</a></h1>
<p>Adobe Bridge provides an application programming interface (API) that defines a communication protocol between Adobe ExtendScript- and message-enabled applications. This provides the most general mechanism for communication between applications. A messaging-enabled application can launch another messaging-enabled application, and send or receive scripts to effect certain actions. For example, from within Adobe Bridge, a script can launch Photoshop, and then send a script to Photoshop that requests a photomerge operation.</p>
<p>While the exported functions allow specific access to certain capabilities of the application, the script in an interapplication message allows full access to the target application's document object model (DOM), in addition to all cross-DOM and application exported functions.</p>
<p>The messaging API defines the BridgeTalk class, whose globally available static properties and functions provide access to environmental information relevant for communication between applications. You can instantiate this class to create a BridgeTalk message object, which encapsulates a message and allows you to send it to another application. For details of these objects, see <a href="../messaging-framework-api-reference/">Messaging framework API reference</a>.</p>
<h2 id="sending-messages">Sending messages<a class="headerlink" href="#sending-messages" title="Permanent link">&para;</a></h2>
<p>To send a script or other data to another application, you must create and configure a <a href="../bridgetalk-message-object/">BridgeTalk message object</a>.</p>
<p>This object contains the data to be sent (generally a script to be executed in the target application), and also specifies how to handle the response.</p>
<p>This simple example walks through the steps of sending a script from Adobe Bridge CS5 to Photoshop CS5, and receiving a response.</p>
<h3 id="step-1-check-that-the-target-application-is-installed">Step 1: Check that the target application is installed<a class="headerlink" href="#step-1-check-that-the-target-application-is-installed" title="Permanent link">&para;</a></h3>
<p>Before you can actually send a message, you must check that the required version of the target application is installed. The function <a href="../bridgetalk-class/#bridgetalkgetspecifier">getSpecifier()</a>, available in the global namespace through the <a href="../bridgetalk-class/">BridgeTalk class</a>, provides this information.</p>
<p>For example, this code, which will send a message to Adobe Bridge CS5 as part of a script being executed by Photoshop CS5, checks that the required version of Adobe Bridge is installed:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-0-1"><span class="kd">var</span><span class="w"> </span><span class="nx">targetApp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">.</span><span class="nx">getSpecifier</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;bridge-3.0&quot;</span><span class="p">);</span>
</span><span id="__span-0-2"><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nx">targetApp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-3"><span class="w">    </span><span class="c1">// construct and send message</span>
</span><span id="__span-0-4"><span class="p">}</span>
</span></code></pre></div>
<p>When you send the message, the messaging framework automatically launches the target application, if it is not already running.</p>
<h3 id="step-2-construct-a-message-object">Step 2: Construct a message object<a class="headerlink" href="#step-2-construct-a-message-object" title="Permanent link">&para;</a></h3>
<p>The next step is to construct a message to send to the application. You do this by creating a BridgeTalk message object, and assigning values to its properties. You must specify the target application and the message body, which is usually a script packaged into a string.</p>
<p>Scripts sent in messages can be very complex, and can use the full DOM of the target application. This example defines a message script that accesses the Adobe Bridge DOM to request the number of files or folders found in a specific folder:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-1-1"><span class="c1">// create a new BridgeTalk message object</span>
</span><span id="__span-1-2"><span class="kd">var</span><span class="w"> </span><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-1-3">
</span><span id="__span-1-4"><span class="c1">// send this msg to the Adobe Bridge CS4 application</span>
</span><span id="__span-1-5"><span class="kd">var</span><span class="w"> </span><span class="nx">targetApp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">.</span><span class="nx">getSpecifier</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;bridge-3.0&quot;</span><span class="p">);</span>
</span><span id="__span-1-6"><span class="nx">bt</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">targetApp</span><span class="p">;</span>
</span><span id="__span-1-7">
</span><span id="__span-1-8"><span class="c1">// the script to evaluate is contained in a string in the &quot;body&quot; property</span>
</span><span id="__span-1-9"><span class="nx">bt</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;new Document(&#39;C:\\BridgeScripts&#39;);app.document.target.children.length;&quot;</span>
</span></code></pre></div>
<h3 id="step-3-specify-how-to-handle-a-response">Step 3: Specify how to handle a response<a class="headerlink" href="#step-3-specify-how-to-handle-a-response" title="Permanent link">&para;</a></h3>
<p>If you want to handle a response for this message, or use the data that is returned from the script's evaluation, you must set up the response-handling mechanism before you send the message. You do this by defining the <a href="../bridgetalk-message-object/#onresult">onResult()</a> callback in the message object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The message callbacks are optional, and are not implemented by all message-enabled applications. The response to a message is, by default, the result of evaluation of the script contained in that message's body property. The target application might define some different kind of response; see <a href="#receiving-messages">Receiving messages</a>.</p>
</div>
<p>When the target has finished processing this message, it looks for an onResult callback in the message object it received. If it is found, the target automatically invokes it, passing it the response. The response is packaged into a string, which is in turn packaged into the body property of a new message object. That message object is the argument to your onResult callback function.</p>
<p>This handler, for example, processes the returned result using a script-defined processResult function:</p>
<p><code>``javascript</code>
bt.onResult = function(returnBtObj) {
    processResult(returnBtObj.body);
}
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1">If you want to handle errors that might arise during script processing, you can define an [onError()](bridgetalk-message-object.md#onerror) callback in the message object. Similarly, you can define a [timeout](bridgetalk-message-object.md#timeout) value and [onTimeout()](bridgetalk-message-object.md#ontimeout) callback to handle the case where the target cannot process the message within a given time. For more information, see [Handling responses from the message target](#handling-responses-from-the-message-target).
</span><span id="__span-2-2">
</span><span id="__span-2-3">!!! note
</span><span id="__span-2-4">    If you define callbacks to handle a response, you must store the message in a variable that still exists when the response is received. Otherwise, JavaScript might garbage-collect the message object, and the response would be lost.
</span><span id="__span-2-5">
</span><span id="__span-2-6">### Step 4: Send the message
</span><span id="__span-2-7">
</span><span id="__span-2-8">To send the message, call the message object&#39;s `send` method. You do not need to specify where to send the message to, since the target application is set in the message itself:
</span><span id="__span-2-9">
</span><span id="__span-2-10">```javascript
</span><span id="__span-2-11">bt.send();
</span></code></pre></div></p>
<p>You can optionally specify a timeout value, which makes the call synchronous; when you do this, the method waits for a response from the target application, or for the timeout value to expire, before returning. When a timeout is not specified, as in this example, the call is asynchronous and the <code>send()</code> method returns immediately.</p>
<p>A second optional parameter allows you to specify launch parameters, in case the target application is not currently running, and the messaging framework needs to launch it.</p>
<p>The complete script looks like this:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-3-1"><span class="c1">// script to be executed in Photoshop CS4</span>
</span><span id="__span-3-2"><span class="n">#target</span><span class="w"> </span><span class="s2">&quot;photoshop-11.0&quot;</span>
</span><span id="__span-3-3">
</span><span id="__span-3-4"><span class="c1">// check that the target app is installed</span>
</span><span id="__span-3-5"><span class="kd">var</span><span class="w"> </span><span class="nx">targetApp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">.</span><span class="nx">getSpecifier</span><span class="p">(</span><span class="w"> </span><span class="s2">&quot;bridge-3.0&quot;</span><span class="p">);</span>
</span><span id="__span-3-6">
</span><span id="__span-3-7"><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nx">targetApp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-8"><span class="w">    </span><span class="c1">// construct a message object</span>
</span><span id="__span-3-9"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-3-10">
</span><span id="__span-3-11"><span class="w">    </span><span class="c1">// the message is intended for Adobe Bridge CS4</span>
</span><span id="__span-3-12"><span class="w">    </span><span class="nx">bt</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">targetApp</span><span class="p">;</span>
</span><span id="__span-3-13">
</span><span id="__span-3-14"><span class="w">    </span><span class="c1">// the script to evaluate is contained in a string in the &quot;body&quot; property</span>
</span><span id="__span-3-15"><span class="w">    </span><span class="nx">bt</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;new Document(&#39;C:\\BridgeScripts&#39;);app.document.target.children.length;&quot;</span>
</span><span id="__span-3-16">
</span><span id="__span-3-17"><span class="w">    </span><span class="c1">// define result handler callback</span>
</span><span id="__span-3-18"><span class="w">    </span><span class="nx">bt</span><span class="p">.</span><span class="nx">onResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">returnBtObj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-19"><span class="w">    </span><span class="nx">processResult</span><span class="p">(</span><span class="nx">returnBtObj</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="c1">//fn defined elsewhere</span>
</span><span id="__span-3-20">
</span><span id="__span-3-21"><span class="w">    </span><span class="c1">// send the message asynchronously</span>
</span><span id="__span-3-22"><span class="w">    </span><span class="nx">bt</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span><span id="__span-3-23"><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="receiving-messages">Receiving messages<a class="headerlink" href="#receiving-messages" title="Permanent link">&para;</a></h2>
<p>An application can be the target of a message; that is, it receives an unsolicited message from another application. An unsolicited message is handled by the static <a href="../bridgetalk-class/#bridgetalkonreceive">BridgeTalk.onReceive</a> callback function in the target application. See <a href="#handling-unsolicited-messages">Handling unsolicited messages</a>.</p>
<p>An application that sends a message can receive response messages; that is, messages that come as the result of requesting a response when a message was sent. These can be:</p>
<ul>
<li>The result of an error in processing the message</li>
<li>The result of a timeout when attempting to process the message</li>
<li>A notification of receipt of the message</li>
<li>Intermediate responses</li>
<li>The final result of processing the message.</li>
</ul>
<p>All of these response messages are sent automatically by the target application, and are handled by callbacks defined in the sending message object. For details, see <a href="#handling-responses-from-the-message-target">Handling responses from the message target</a>.</p>
<hr />
<h2 id="handling-unsolicited-messages">Handling unsolicited messages<a class="headerlink" href="#handling-unsolicited-messages" title="Permanent link">&para;</a></h2>
<p>To specify how the application should handle unsolicited incoming messages, define a callback handler function in the static <a href="../bridgetalk-class/#bridgetalkonreceive">onReceive</a> property of the <code>BridgeTalk</code> class. This function takes a single argument, a <a href="../bridgetalk-message-object/">BridgeTalk message object</a>.</p>
<p>The default behavior of the <code>onReceive</code> handler is to evaluate the body of the received message with JavaScript, and return the result of that evaluation. (The result of evaluating a script is the result of the last line of the script.) To return the result, it creates a new message object, encapsulates the result in a string in the body property of that object, and passes that object to the <a href="../bridgetalk-message-object/#onresult">onResult()</a> callback defined in the original message.</p>
<p>If an error occurs on evaluation, the default <code>onReceive</code> handler returns the error information using a similar mechanism. It creates a new message object, encapsulates the error information in a string in the body property of that object, and passes that object to the <a href="../bridgetalk-message-object/#onerror">onError()</a> callback defined in the original message.</p>
<p>To change the default behavior set the <code>BridgeTalk.onReceive</code> property to a function definition in the following form:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-4-1"><span class="nx">BridgeTalk</span><span class="p">.</span><span class="nx">onReceive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="w"> </span><span class="nx">bridgeTalkObject</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-2"><span class="w">    </span><span class="c1">// callback definition here</span>
</span><span id="__span-4-3"><span class="p">};</span>
</span></code></pre></div>
<p>The <code>body</code> property of the received message object contains the received data.</p>
<p>The function can return any type.</p>
<p>The function that you define does not need to explicitly create and return a <code>BridgeTalk</code> message object.</p>
<p>The messaging framework creates a new <code>BridgeTal``k message object, and packages the return value of the ``onReceive</code> handler as a string in the body property of that object.</p>
<p>Return values are flattened into a string using the Unicode Transformation Format-8 (UTF-8) encoding. If the function does not specify a return value, the resulting string is the empty string.</p>
<p>The result object is transmitted back to the sender if the sender has implemented an <code>onResult</code> callback for the original message.</p>
<h3 id="message-handling-examples">Message-handling examples<a class="headerlink" href="#message-handling-examples" title="Permanent link">&para;</a></h3>
<p>This example shows the default mechanism for handling unsolicited messages received from other applications. This simple handler executes the message's data as a script and returns the results of that execution:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-5-1"><span class="nx">BridgeTalk</span><span class="p">.</span><span class="nx">onReceive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-2"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="w"> </span><span class="nx">message</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="p">);</span>
</span><span id="__span-5-3"><span class="p">}</span>
</span></code></pre></div>
<p>This example shows how you might extend the receive handler to process a new type of message:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-6-1"><span class="nx">BridgeTalk</span><span class="p">.</span><span class="nx">onReceive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-2"><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-3"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;Data&quot;</span><span class="o">:</span>
</span><span id="__span-6-4"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nx">processData</span><span class="p">(</span><span class="w"> </span><span class="nx">message</span><span class="w"> </span><span class="p">);</span>
</span><span id="__span-6-5"><span class="w">            </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-6-6"><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="c1">//&quot;ExtendScript&quot;</span>
</span><span id="__span-6-7"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="w"> </span><span class="nx">mesage</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="p">);</span>
</span><span id="__span-6-8"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-9"><span class="p">}</span>
</span></code></pre></div>
<hr />
<h2 id="handling-responses-from-the-message-target">Handling responses from the message target<a class="headerlink" href="#handling-responses-from-the-message-target" title="Permanent link">&para;</a></h2>
<p>To handle responses to a message you have sent, you define callback handler functions in the message object itself. The target application cannot send a response message back to the sender unless the message object it received has the appropriate callback defined.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The message callbacks are optional, and are not implemented by all message-enabled applications.</p>
</div>
<p>When your message is received by its target, the target application's static BridgeTalk object's onReceive method processes that message, and can invoke one of the message object's callbacks to return a response. In each case, the messaging framework packages the response in a new message object, whose target application is the sender. Your callback functions receive this response message object as an argument.</p>
<p>A response message can be:</p>
<ul>
<li>The result of an error in processing the message. This is handled by the <a href="../bridgetalk-message-object/#onerror">onError()</a> callback.<ul>
<li>If an error occurs in processing the message body (as the result of a JavaScript syntax error, for instance), the target application invokes the <a href="../bridgetalk-message-object/#onerror">onError()</a> callback, passing a response message that contains the error code and error message. If you do not have an <a href="../bridgetalk-message-object/#onerror">onError()</a> callback defined, the error is completely transparent. It can appear that the message has not been processed, since no result is ever returned to the <a href="../bridgetalk-message-object/#onresult">onResult()</a> callback.</li>
</ul>
</li>
<li>A notification of receipt of the message. This is handled by the <a href="../bridgetalk-message-object/#onreceived">onReceived()</a> callback.<ul>
<li>Message sending is asynchronous. Getting a <code>true</code> result from the send method does not guarantee that your message was actually received by the target application. If you want to be notified of the receipt of your message, define the <a href="../bridgetalk-message-object/#onreceived">onReceived()</a> callback in the message object. The target sends back the original message object to this callback, first replacing the body value with an empty string.</li>
</ul>
</li>
<li>The result of a time-out. This is handled by the <a href="../bridgetalk-message-object/#ontimeout">onTimeout()</a> callback.<ul>
<li>You can specify a number of seconds in a message object's <a href="../bridgetalk-message-object/#timeout">timeout</a> property. If the message is not removed from the input queue for processing before the time elapses, it is discarded. If the sender has defined an <a href="../bridgetalk-message-object/#ontimeout">onTimeout()</a> callback for the message, the target application sends a time-out message back to the sender.</li>
</ul>
</li>
<li>Intermediate responses. These are handled by the <a href="../bridgetalk-message-object/#onresult">onResult()</a> callback.<ul>
<li>The script that you send can send back intermediate responses by invoking the original message object's <a href="../bridgetalk-message-object/#sendresult">sendResult()</a> method. It can send data of any type, but that data is packaged into a body string in a new message object, which is passed to your callback. See <a href="#passing-values-between-applications">Passing values between applications</a>.</li>
</ul>
</li>
<li>The final result of processing the message. This is handled by the <a href="../bridgetalk-message-object/#onresult">onResult()</a> callback.<ul>
<li>When it finishes processing your message, the target application can send back a result of any type. If you have sent a script, and the target application is using the default BridgeTalk <a href="../bridgetalk-class/#bridgetalkonreceive">onReceive</a> callback to process messages, the return value is the final result of evaluating that script. In any case, the return value is packaged into a body string in a new message object, which is passed to your callback. See <a href="#passing-values-between-applications">Passing values between applications</a>.</li>
</ul>
</li>
</ul>
<p>The following examples demonstrate how to handle simple responses and multiple responses, and how to integrate error handling with response handling.</p>
<h3 id="example-receiving-a-simple-response">Example: Receiving a simple response<a class="headerlink" href="#example-receiving-a-simple-response" title="Permanent link">&para;</a></h3>
<p>In this example, an application script asks Adobe Bridge to find out how many files and folders are in a certain folder, which the evaluation of the script returns. (The default BridgeTalk.onReceive method processes this correctly.)</p>
<p>The <code>onResult</code> method saves that number in <code>fileCountResult</code>, a script-defined property of the message, for later use:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-7-1"><span class="kd">var</span><span class="w"> </span><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-7-2"><span class="nx">bt</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bridge-3.0&quot;</span><span class="p">;</span>
</span><span id="__span-7-3"><span class="nx">bt</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;new Document(&#39;C:\\BridgeScripts&#39;);app.document.target.children.length;&quot;</span>
</span><span id="__span-7-4"><span class="nx">bt</span><span class="p">.</span><span class="nx">onResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="w"> </span><span class="nx">retObj</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-5"><span class="w">    </span><span class="nx">processFileCount</span><span class="p">(</span><span class="nx">retObj</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span id="__span-7-6"><span class="p">}</span>
</span><span id="__span-7-7">
</span><span id="__span-7-8"><span class="nx">bt</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="example-handling-any-error">Example: Handling any error<a class="headerlink" href="#example-handling-any-error" title="Permanent link">&para;</a></h3>
<p>In this example, the onError handler re-throws the error message within the sending application:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-8-1"><span class="kd">var</span><span class="w"> </span><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-8-2"><span class="nx">bt</span><span class="p">.</span><span class="nx">onError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">btObj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-3"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">errorCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="w"> </span><span class="p">(</span><span class="nx">btObj</span><span class="p">.</span><span class="nx">headers</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Error-Code&quot;</span><span class="p">]);</span>
</span><span id="__span-8-4"><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="p">(</span><span class="nx">errorCode</span><span class="p">,</span><span class="w"> </span><span class="nx">btObj</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span id="__span-8-5"><span class="p">}</span>
</span></code></pre></div>
<h3 id="example-handling-expected-errors-and-responses">Example: Handling expected errors and responses<a class="headerlink" href="#example-handling-expected-errors-and-responses" title="Permanent link">&para;</a></h3>
<p>This example creates a message that asks Adobe Bridge to return XMP metadata for a specific file. The <code>onResult</code> method processes the data using a script-defined processFileSize function. Any errors are handled by the <code>onError</code> method. For example, if the file requested is not an existing file, the resulting error is returned to the onError method:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-9-1"><span class="kd">var</span><span class="w"> </span><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-9-2"><span class="nx">bt</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bridge-3.0&quot;</span><span class="p">;</span>
</span><span id="__span-9-3"><span class="nx">bt</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;var tn = new Thumbnail(&#39;C/MyPhotos/temp.gif&#39;); tn.core.immediate.size;&quot;</span>
</span><span id="__span-9-4"><span class="nx">bt</span><span class="p">.</span><span class="nx">onResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="w"> </span><span class="nx">resultMsg</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-5"><span class="w">    </span><span class="nx">processFileSize</span><span class="p">(</span><span class="nx">resultMsg</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span id="__span-9-6"><span class="p">}</span>
</span><span id="__span-9-7">
</span><span id="__span-9-8"><span class="nx">bt</span><span class="p">.</span><span class="nx">onError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="w"> </span><span class="nx">errorMsg</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-9"><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">errCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="w"> </span><span class="p">(</span><span class="nx">errorMsg</span><span class="p">.</span><span class="nx">headers</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Error-Code&quot;</span><span class="p">]);</span>
</span><span id="__span-9-10"><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="p">(</span><span class="nx">errCode</span><span class="p">,</span><span class="w"> </span><span class="nx">errorMsg</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span id="__span-9-11"><span class="p">}</span>
</span><span id="__span-9-12">
</span><span id="__span-9-13"><span class="nx">bt</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span></code></pre></div>
<h3 id="example-setting-up-a-target-to-send-multiple-responses">Example: Setting up a target to send multiple responses<a class="headerlink" href="#example-setting-up-a-target-to-send-multiple-responses" title="Permanent link">&para;</a></h3>
<p>This example integrates the sending of multiple responses with the evaluation of a message body. It sets up a handler for a message such as the one sent in the following example.</p>
<p>The target application (Adobe Bridge) defines a static onReceive method to allow for a new type of message, which it calls an iterator. An iterator type of message expects the message.body to use the iteration variable i within the script, so that different results are produced for each pass through the while loop. Each result is sent back to the sending application with the sendResult() method. When the message.body has finished processing its task, it sets a flag to end the while loop:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-10-1"><span class="c1">// Code for processing the message and sending intermediate responses</span>
</span><span id="__span-10-2"><span class="c1">// in the target application (Adobe Bridge)</span>
</span><span id="__span-10-3"><span class="nx">BridgeTalk</span><span class="p">.</span><span class="nx">onReceive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">message</span><span class="p">){</span>
</span><span id="__span-10-4"><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-5"><span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;iterator&quot;</span><span class="o">:</span>
</span><span id="__span-10-6"><span class="w">            </span><span class="nx">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-10-7"><span class="w">            </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-10-8"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">done</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-9"><span class="w">                </span><span class="c1">// the message.body uses &quot;i&quot; to produce different results</span>
</span><span id="__span-10-10"><span class="w">                </span><span class="c1">// for each execution of the message.</span>
</span><span id="__span-10-11"><span class="w">                </span><span class="c1">// when done, the message.body sets &quot;done&quot; to `true`</span>
</span><span id="__span-10-12"><span class="w">                </span><span class="c1">// so this onReceive method breaks out of the loop.</span>
</span><span id="__span-10-13"><span class="w">                </span><span class="nx">message</span><span class="p">.</span><span class="nx">sendResult</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">body</span><span class="p">));</span>
</span><span id="__span-10-14"><span class="w">                </span><span class="nx">i</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-10-15"><span class="w">            </span><span class="p">}</span>
</span><span id="__span-10-16"><span class="w">            </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-10-17"><span class="w">        </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="c1">//&quot;ExtendScript&quot;</span>
</span><span id="__span-10-18"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="w"> </span><span class="nx">message</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="p">);</span>
</span><span id="__span-10-19"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-20"><span class="p">}</span>
</span></code></pre></div>
<h3 id="example-setting-up-a-sender-to-receive-multiple-responses">Example: Setting up a sender to receive multiple responses<a class="headerlink" href="#example-setting-up-a-sender-to-receive-multiple-responses" title="Permanent link">&para;</a></h3>
<p>This example sends a message of the type iterator, to be handled by the onReceive handler in the previous example, and processes the responses received from that target.</p>
<p>The sending application creates a message whose script (contained in the body string) iterates through all files in a specific folder (represented by an Adobe Bridge Thumbnail object), using the iterator variable i.</p>
<p>For each file in the folder, it returns file size data. For each contained folder, it returns -1. The last executed line in the script is the final result value for the message.</p>
<p>The <code>onResult</code> method of the message object receives each intermediate result, stores it into an array, <code>resArr</code>, and processes it immediately using a script-defined function processInterResult:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-11-1"><span class="c1">// Code for send message and handling response</span>
</span><span id="__span-11-2"><span class="c1">// in the sending application (any message-enabled application)</span>
</span><span id="__span-11-3"><span class="kd">var</span><span class="w"> </span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-11-4"><span class="kd">var</span><span class="w"> </span><span class="nx">resArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Array</span><span class="p">;</span>
</span><span id="__span-11-5"><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-11-6"><span class="nx">bt</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bridge&quot;</span><span class="p">;</span>
</span><span id="__span-11-7"><span class="nx">bt</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;iterator&quot;</span><span class="p">;</span>
</span><span id="__span-11-8"><span class="nx">bt</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span>
</span><span id="__span-11-9"><span class="s2">var fld = new Thumbnail(Folder(&#39;C/Junk&#39;));</span>
</span><span id="__span-11-10"><span class="s2">if (i == (fld.children.length - 1))</span>
</span><span id="__span-11-11"><span class="s2">done = true; //no more files, end loop</span>
</span><span id="__span-11-12"><span class="s2">tn = fld.children[i];</span>
</span><span id="__span-11-13"><span class="s2">if (tn.spec.constructor.name == &#39;File&#39;)</span>
</span><span id="__span-11-14"><span class="s2">md = tn.core.immediate.size;</span>
</span><span id="__span-11-15"><span class="s2">else md = -1;</span>
</span><span id="__span-11-16"><span class="s2">&quot;</span><span class="p">;</span>
</span><span id="__span-11-17">
</span><span id="__span-11-18"><span class="c1">// store intermediate results</span>
</span><span id="__span-11-19"><span class="nx">bt</span><span class="p">.</span><span class="nx">onResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">rObj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-20"><span class="w">    </span><span class="nx">resArr</span><span class="p">[</span><span class="nx">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">rObj</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
</span><span id="__span-11-21"><span class="w">    </span><span class="nx">processInterResult</span><span class="p">(</span><span class="nx">resArr</span><span class="p">[</span><span class="nx">idx</span><span class="p">]);</span>
</span><span id="__span-11-22"><span class="w">    </span><span class="nx">idx</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-11-23"><span class="p">};</span>
</span><span id="__span-11-24">
</span><span id="__span-11-25"><span class="nx">bt</span><span class="p">.</span><span class="nx">onError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">eObj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-26"><span class="w">    </span><span class="nx">bt</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">eObj</span><span class="p">.</span><span class="nx">body</span>
</span><span id="__span-11-27"><span class="p">};</span>
</span><span id="__span-11-28">
</span><span id="__span-11-29"><span class="nx">bt</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span></code></pre></div>
<hr />
<h2 id="passing-values-between-applications">Passing values between applications<a class="headerlink" href="#passing-values-between-applications" title="Permanent link">&para;</a></h2>
<p>The BridgeTalk.onReceive static callback function can return values of any type. The messaging framework, however, packages the response into a response message, and passes any returned values in the message body, first converting the result to a UTF-8-encoded string.</p>
<h3 id="passing-simple-types">Passing simple types<a class="headerlink" href="#passing-simple-types" title="Permanent link">&para;</a></h3>
<p>When your message object's onResult callback receives a response, it must interpret the string it finds in the body of the response message to obtain a result of the correct type. Results of various types can be identified and processed as follows:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Number</td>
<td>JavaScript allows you to access a string that contains a number directly as a number, without doing any type conversion. However, be careful when using the plus operator (+), which works with either strings or numbers. If one of the operands is a string, both operands are converted to strings and concatenated.</td>
</tr>
<tr>
<td>String</td>
<td>No conversion is required.</td>
</tr>
<tr>
<td>Boolean</td>
<td>The result string is either "true" or "false." You can convert it to a true boolean by evaluating it with the <code>eval</code> method.</td>
</tr>
<tr>
<td>Date</td>
<td>The result string contains the date in the form: <code>"dow mmm dd yyyy hh:mm:ss GMT-nnnn".</code> For example "Wed Jun 23 2004 00:00:00 GMT-0700".</td>
</tr>
<tr>
<td>Array</td>
<td>The result string contains a comma delimited list of the elements of the array. For example, If the result array is <code>[12, "test", 432]</code>, the messaging framework flattens this into the string <code>"12,test,432"</code>. As an alternative to simply returning the array, the message target can use the <code>toSource</code> method to return the code used to create the array. In this case, the sender must reconstitute the array by using the <code>eval</code> method on the result string in the response body. See discussion below.</td>
</tr>
</tbody>
</table>
<h3 id="passing-complex-types">Passing complex types<a class="headerlink" href="#passing-complex-types" title="Permanent link">&para;</a></h3>
<p>When returning complex types (arrays and objects), the script that you send must construct a result string, using the toSource method to serialize the array or object. In this case, the sender must reconstitute the array or object by using the eval method on the result string in the response body.</p>
<h4 id="passing-an-array-with-tosource-and-eval">Passing an array with toSource and eval<a class="headerlink" href="#passing-an-array-with-tosource-and-eval" title="Permanent link">&para;</a></h4>
<p>For example, the following code sends a script that returns an array in this way. The onResult callback that receives the response uses eval to reconstruct the array:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-12-1"><span class="c1">// Code for send message and handling response</span>
</span><span id="__span-12-2"><span class="c1">// in the sending application (any message-enabled application)</span>
</span><span id="__span-12-3"><span class="kd">var</span><span class="w"> </span><span class="nx">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
</span><span id="__span-12-4"><span class="kd">var</span><span class="w"> </span><span class="nx">resArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Array</span><span class="p">;</span>
</span><span id="__span-12-5"><span class="kd">var</span><span class="w"> </span><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-12-6"><span class="nx">bt</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bridge-3.0&quot;</span><span class="p">;</span>
</span><span id="__span-12-7">
</span><span id="__span-12-8"><span class="c1">// the script passed to the target application</span>
</span><span id="__span-12-9"><span class="c1">// needs to return the array using &quot;toSource&quot;</span>
</span><span id="__span-12-10"><span class="nx">bt</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;var arr = [10, this string, 324]; arr.toSource()&quot;</span><span class="p">;</span>
</span><span id="__span-12-11">
</span><span id="__span-12-12"><span class="nx">bt</span><span class="p">.</span><span class="nx">onResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">resObj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-13"><span class="w">    </span><span class="c1">// use eval to reconstruct the array</span>
</span><span id="__span-12-14"><span class="w">    </span><span class="nx">arr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="nx">resObj</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span id="__span-12-15">
</span><span id="__span-12-16"><span class="w">    </span><span class="c1">// now you can access the returned array</span>
</span><span id="__span-12-17"><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="w"> </span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span><span class="p">();</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span>
</span><span id="__span-12-18"><span class="w">        </span><span class="nx">doSomething</span><span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span><span id="__span-12-19"><span class="p">}</span>
</span><span id="__span-12-20">
</span><span id="__span-12-21"><span class="c1">// send the message</span>
</span><span id="__span-12-22"><span class="nx">bt</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span></code></pre></div>
<h4 id="passing-an-object-with-tosource-and-eval">Passing an object with toSource and eval<a class="headerlink" href="#passing-an-object-with-tosource-and-eval" title="Permanent link">&para;</a></h4>
<p>This technique is the only way to pass objects between applications. For example, this code sends a script that returns an object containing some of the metadata for a specific file and defines an onResult callback that receives the object:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-13-1"><span class="kd">var</span><span class="w"> </span><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-13-2"><span class="nx">bt</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bridge-3.0&quot;</span><span class="p">;</span>
</span><span id="__span-13-3">
</span><span id="__span-13-4"><span class="c1">//the script passed to the target application</span>
</span><span id="__span-13-5"><span class="c1">// returns the object using &quot;toSource&quot;</span>
</span><span id="__span-13-6"><span class="nx">bt</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;var tn = new Thumbnail(File(&#39;C:\\Myphotos\\photo1.jpg&#39;));</span>
</span><span id="__span-13-7"><span class="s2">var md = {fname:tn.core.immediate.name,</span>
</span><span id="__span-13-8"><span class="s2">fsize:tn.core.immediate.size};</span>
</span><span id="__span-13-9"><span class="s2">md.toSource();&quot;</span>
</span><span id="__span-13-10">
</span><span id="__span-13-11"><span class="c1">//For the result, use eval to reconstruct the object</span>
</span><span id="__span-13-12"><span class="nx">bt</span><span class="p">.</span><span class="nx">onResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">resObj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-13"><span class="w">    </span><span class="nx">md</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">bt</span><span class="p">.</span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="nx">resObj</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span id="__span-13-14"><span class="w">    </span><span class="c1">// now you can access fname and fsize properties</span>
</span><span id="__span-13-15"><span class="w">    </span><span class="nx">doSomething</span><span class="w"> </span><span class="p">(</span><span class="nx">md</span><span class="p">.</span><span class="nx">fname</span><span class="p">,</span><span class="w"> </span><span class="nx">md</span><span class="p">.</span><span class="nx">fsize</span><span class="p">);</span>
</span><span id="__span-13-16"><span class="p">}</span>
</span><span id="__span-13-17">
</span><span id="__span-13-18"><span class="c1">// send the message</span>
</span><span id="__span-13-19"><span class="nx">bt</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span></code></pre></div>
<h4 id="passing-a-dom-object">Passing a DOM object<a class="headerlink" href="#passing-a-dom-object" title="Permanent link">&para;</a></h4>
<p>You can send a script that returns a DOM object, but the resulting object contains only those properties that were accessed within the script. For example, the following script requests the return of the Adobe Bridge DOM Thumbnail object. Only the properties path and uri are accessed by the script, and only those properties are returned:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-14-1"><span class="kd">var</span><span class="w"> </span><span class="nx">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">BridgeTalk</span><span class="p">;</span>
</span><span id="__span-14-2"><span class="nx">bt</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bridge&quot;</span><span class="p">;</span>
</span><span id="__span-14-3">
</span><span id="__span-14-4"><span class="c1">//set up the script passed to the target application</span>
</span><span id="__span-14-5"><span class="c1">// to return the array using &quot;toSource&quot;</span>
</span><span id="__span-14-6"><span class="nx">bt</span><span class="p">.</span><span class="nx">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;var tn = new Thumbnail(File(&#39;C:\\Myphotos\\photo1.jpg&#39;));</span>
</span><span id="__span-14-7"><span class="s2">var p = tn.path; var u = tn.uri;</span>
</span><span id="__span-14-8"><span class="s2">tn.toSource();&quot;</span>
</span><span id="__span-14-9">
</span><span id="__span-14-10"><span class="c1">//For the result, use eval to reconstruct the object</span>
</span><span id="__span-14-11"><span class="nx">bt</span><span class="p">.</span><span class="nx">onResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">resObj</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-12"><span class="w">    </span><span class="c1">// use eval to reconstruct the object</span>
</span><span id="__span-14-13"><span class="w">    </span><span class="nx">tn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="nx">resObj</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span id="__span-14-14"><span class="w">    </span><span class="c1">// now the script can access tn.path and tn.uri,</span>
</span><span id="__span-14-15"><span class="w">    </span><span class="c1">// but no other properties of the Adobe Bridge DOM Thumbnail object</span>
</span><span id="__span-14-16"><span class="w">    </span><span class="nx">doSomething</span><span class="w"> </span><span class="p">(</span><span class="nx">tn</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span><span class="w"> </span><span class="nx">tn</span><span class="p">.</span><span class="nx">uri</span><span class="p">);</span>
</span><span id="__span-14-17"><span class="p">}</span>
</span><span id="__span-14-18">
</span><span id="__span-14-19"><span class="c1">// send the message</span>
</span><span id="__span-14-20"><span class="nx">bt</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span></code></pre></div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 4, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      All content is copyright Adobe Systems Incorporated.
    </div>
  
  
    Made with
    <a
      href="https://squidfunk.github.io/mkdocs-material/"
      target="_blank" rel="noopener"
    >
      Material for MkDocs
    </a>
  
</div>

<!-- Print button -->
<div class="md-copyright">
  
  <a href="../../print_page/" title="Print Site" class="md-content__button md-icon">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 3H6v4h12m1 5a1 1 0 0 1-1-1 1 1 0 0 1 1-1 1 1 0 0 1 1 1 1 1 0 0 1-1 1m-3 7H8v-5h8m3-6H5a3 3 0 0 0-3 3v6h4v4h12v-4h4v-6a3 3 0 0 0-3-3"/></svg>
  </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.copy", "search.highlight", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
        <script src="../../_static/extra.js"></script>
      
        <script src="../../docs/_global/js/global.js"></script>
      
    
  </body>
</html>