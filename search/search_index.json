{"config":{"lang":["en"],"separator":"[\\s\\-,\\.:!=\\[\\]()\"/]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Introduction","text":"<p>JavaScript is a platform-independent scripting language that you can use to control many features and automate many tasks in Adobe\u00ae applications. Scripting is easier to learn and use than many other kinds of programming, and provides a convenient way of automating repetitive tasks or extending applications to provide additional tools for other users.</p> <ul> <li>If you are new to scripting, see Adobe Creative Suite: Introduction to Scripting, which introduces basic scripting concepts and describes different scripting languages that are available, including JavaScript. JavaScript and other scripting languages are object-oriented, and this book also describes the basic concepts of object-oriented programming and document object models.</li> <li>Each application that supports JavaScript also provides an application-specific Scripting Guide that introduces the object model for that application, and reference material for the objects. This document provides information about the JavaScript features, tools, and objects that are common to all Adobe applications that support JavaScript.</li> <li>This document does not teach JavaScript. If you are familiar with scripting or programming in general, but unfamiliar with JavaScript, see publicly available Web resources and documents, such as:<ul> <li>The public JavaScript standards organization web site: www.ecma-international.org</li> <li>JavaScript: The Definitive Guide, David Flanagan, O'Reily Media Inc, 2002. ISBN 0-596-00048-0</li> <li>JavaScript Bible, Danny Goodman, Hungry Minds Inc, 2001. ISBN 0-7645-4718-6</li> <li>Adobe Scripting, Chandler McWilliams, Wiley Publishing, Inc., 2003. ISBN 0-7645-2455-0</li> </ul> </li> </ul>"},{"location":"_global/readme/","title":"docsforadobe.dev MkDocs Config","text":"<p>This repo holds the common components shared between this org's hosted MkDocs documentation projects.</p> <p>The idea is that this repo will be kept up-to-date with global config, and each child repo will use the provided script to download the latest commit from this repo, and have its \"local\" MkDocs config point to the downloaded files from this repo.</p> <p>In all cases, each child repo will be able to override config items here as needed.</p>"},{"location":"_global/readme/#updating-this-repo","title":"Updating This Repo","text":"<p>See Modifying Common Components in the org contribution guide for info on how this repo works, and best practices for modifying it.</p>"},{"location":"extendscript-toolkit/","title":"The ExtendScript Toolkit","text":"<p>Warning</p> <p>The Extendscript Toolkit has been deprecated in favour of The VS Code Debugger!</p> <p>This information is preserved here for legacy reference, but the Extendscript Toolkit is no longer being actively maintained or supported, and will no longer work on 64-bit-only versions of MacOS.</p> <p>The ExtendScript Toolkit provides an interactive development and testing environment for ExtendScript in all JavaScript-enabled Adobe applications.</p> <p>It includes a full-featured, syntax-highlighting text editor with Unicode capabilities and multiple undo/redo support. The Toolkit is the default editor for ExtendScript files, which use the extension .jsx.</p> <p>The Toolkit includes a JavaScript debugger that allows you to:</p> <ul> <li>Single-step through JavaScript scripts (JS or JSX files) inside an application.</li> <li>Inspect all data for a running script.</li> <li>Set and execute breakpoints.</li> </ul> <p>When you double click a JSX file in the platform's windowing environment, the script runs in the Toolkit, unless it specifies a particular target application using the #target directive.</p> <p>For more information, see Selecting a debugging target and Preprocessor directives.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/","title":"Code profiling for optimization","text":"<p>The Profiling tool helps you to optimize program execution.</p> <p>When you turn profiling on, the JavaScript engine collects information about a program while it is running. It counts how often the program executed a line or function, or how long it took to execute a line or function. You can choose exactly which profiling data to display.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#profiling-options","title":"Profiling Options","text":"<p>Because profiling significantly slows execution time, the Profile menu offers these profiling options.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#off","title":"Off","text":"<p>Profiling turned off.</p> <p>This is the default.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#functions","title":"Functions","text":"<p>The profiler counts each function call.</p> <p>At the end of execution, displays the total to the left of the line number where the function header is defined.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#lines","title":"Lines","text":"<p>The profiler counts each time each line is executed.</p> <p>At the end of execution, displays the total to the left of the line number. Consumes more execution time, but delivers more detailed information.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#add-timing-info","title":"Add Timing Info","text":"<p>Instead of counting the functions or lines, records the time taken to execute each function or line.</p> <p>At the end of execution, displays the total number of microseconds spent in the function or line, to the left of the line number. This is the most time-consuming form of profiling.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#no-profiler-data","title":"No Profiler Data","text":"<p>When selected, do not display profiler data.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#show-hit-count","title":"Show Hit Count","text":"<p>When selected, display hit counts.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#show-timing","title":"Show Timing","text":"<p>When selected, display timing data.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#erase-profiler-data","title":"Erase Profiler Data","text":"<p>Clear all profiling data.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#save-data-as","title":"Save Data As","text":"<p>Save profiling data as comma-separated values in a CSV file that can be loaded into a spreadsheet program such as Excel.</p>"},{"location":"extendscript-toolkit/code-profiling-for-optimization/#viewing-profiling-info","title":"Viewing Profiling Info","text":"<p>When execution halts (at termination, at a breakpoint, or due to a runtime error), the Toolkit displays this information in the Document Window, line by line. The profiling data is color coded:</p> <ul> <li>Green indicates the lowest number of hits, or the fastest execution time.</li> <li>Orange or yellow indicates a trouble spot, such as a line that has been executed many times, or which line took the most time to execute.</li> </ul> <p>This example shows number-of-hits information:</p> <p></p> <p>This example displays timing information for the program, in microseconds. The timing might not be accurate down to the microsecond; it depends on the resolution and accuracy of the hardware timers built into your computer.</p> <p></p>"},{"location":"extendscript-toolkit/configuring-the-toolkit-window/","title":"Configuring the Toolkit window","text":"<p>The ExtendScript Toolkit initially appears with a default workspace arrangement, containing a default configuration of tabbed panels and Script Editor document windows contained in a parent frame. The arrangement is highly configurable, through the Window menu, the context menus of individual panels and panel groups, or directly using drag and drop.</p> <p></p> <p>You can, for example, adjust the relative sizes of the panels by dragging the separators up or down, or right or left, and can rearrange the groupings. To move a tabbed panel, drag the tab into another pane.</p> <p>If you drag a tab so that the entire destination group is highlighted, it becomes another stacked panel in that group. If you drag a tab to the top or bottom of a group (so that only the top or bottom bar of the destination group is highlighted), that group splits to show the panels in a tiled format.</p> <ul> <li>You can dock the entire panel group to different edges of the Toolkit window.</li> <li>You can collapse the entire panel group, then expose individual panels.</li> <li>You can open and close, or collapse and expand individual panels, regardless of the dock state.</li> <li>You can undock individual tabs or the entire control panel, making them floating panels. Floating panels can be docked to each other, or can be independent.</li> </ul> <p>There are predefined configurations, called workspaces, suitable for various uses, and you can save your favorite configurations as workspaces. See Workspaces.</p>"},{"location":"extendscript-toolkit/configuring-the-toolkit-window/#panel-menus","title":"Panel menus","text":"<p>Panel groups have a context menu, which you invoke with a right click in the tab or on the background of the title bar. These menus have panel-control commands, including Close Panel and Close Group to hide the individual panel or entire group.</p> <p></p> <ul> <li>You can also show or hide specific panels by toggling them on or off in the Window menu. Use the Window menu to show a hidden panel, or to bring a floating panel to the front.</li> <li>Use Window &gt; Hide panels to close all of the panels.</li> </ul> <p>Some panels also have a flyout menu, specific to that panel, which you access through the menu icon in the upper right corner. The JavaScript Console has a right-click menu that allows you to copy and paste text.</p> <p>The individual panels are discussed in detail in the following sections.</p>"},{"location":"extendscript-toolkit/configuring-the-toolkit-window/#document-windows","title":"Document windows","text":"<p>When you open scripts or text files, each file appears in its own Script Editor document window. By default, the document windows are docked; that is, shown as tabbed panes in the main window. However, like the panels, you can drag any document window out of the frame to make it an independent floating window.</p> <p>If you are displaying more than one document, and you have undocked one or more of them, you can choose to show the document windows in tiled or cascade style-that is, side by side in the main window, or overlapping in the main window. To do this, choose Window &gt; Tile Documents or Window &gt; Cascade.</p> <p>You can edit or run scripts in multiple document windows simultaneously. The current document window is highlighted and has the input focus. You can select another document window by clicking in it, or you can switch between them with the commands Window &gt; Next document and Window &gt; Previous document. The default keyboard shortcuts for these commands are F6 and SHIFT-F6; you can change these using the Keyboard Shortcuts page in the Preferences dialog (Edit &gt; Preferences).</p> <p>Note</p> <p>Because you can run scripts in the same application simultaneously, you should be careful not to interrupt the processing of one script with another.</p> <p>For example, if one script opens a modal dialog in Photoshop, and you run another script that targets Photoshop while the dialog is still open, the second script is likely to generate an error.</p> <p></p> <p>A button in the upper right corner of the document window allows you to split that window.</p> <p>When the window is split, the second window is another view of exactly the same source. Any changes you make in the text, breakpoints that you add, and so on, appear simultaneously in both windows. The copy is, by default, positioned to the right of the original, docked window, as shown. However, if you use CTRL-click to split the window, the second appears below the original.</p> <p>For more information about the document windows and the Script Editor, see The Script Editor.</p>"},{"location":"extendscript-toolkit/configuring-the-toolkit-window/#workspaces","title":"Workspaces","text":"<p>The Toolkit saves the current layout when you exit, and restores it at the next startup. It saves and restores the open documents, the current positions within the documents, any breakpoints that have been set, and other preferences that have been set in the Preferences dialog.</p> <ul> <li>The Startup page in the Preferences dialog (Edit &gt; Preferences) offers a choice of whether to open a blank document window, no document window, or display a previously opened document on startup.</li> <li>The Tookit defines a number of workspace configurations that are suitable for specific usage types. To choose a predefined or user-defined workspace, use the workspace menu that drops down from the upper right corner of the Toolkit.<ul> <li>When you choose a workspace, its name appears here. You can also add and remove workspaces from this menu. </li> </ul> </li> <li>You can save any configuration as a named workspace, using the Create new Workspace menu command, or the Add button on the Workspaces page in the Preferences dialog (Edit &gt; Preferences).</li> <li>You can remove workspaces you have defined, either individually using the menu or the Workspaces page in the Preferences dialog, or all at once using the Default button at the bottom of the Workspace page.</li> <li>The Keyboard Shortcuts page in the Preferences dialog (Edit &gt; Preferences) allows you to set or modify keyboard shortcuts for all menu commands. There is a warning if you assign a key combination that is already in use. If you assign the combination to a new command, it is removed from the previous command.</li> <li>You can restore all preferences to their default values by holding the SHIFT key down while the Toolkit loads.</li> </ul>"},{"location":"extendscript-toolkit/configuring-the-toolkit-window/#dialogs","title":"Dialogs","text":"<p>Some dialog windows offer the option \"Don't show again\". If you select this option, the Toolkit remembers the choices made in this dialog, and next time it would appear, makes the same choices without showing the dialog.</p> <p>To make these dialogs display again, click Reset Dialogs on the User Interface page in the Preferences dialog (Edit &gt; Preferences).</p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/","title":"Debugging in the Toolkit","text":"<p>You can debug the code in the currently active document window. Select one of the debugging commands to either run or to single-step through the program.</p> <p>When you run code from the document window, it runs in the current target application's selected JavaScript engine. The Toolkit itself runs an independent JavaScript engine, so you can quickly edit and run a script without connecting to a target application.</p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#selecting-a-debugging-target","title":"Selecting a debugging target","text":"<p>The Toolkit can debug multiple applications at one time. If you have more than one Adobe application installed, use the drop-down list at the upper left of a document window to select the target application for that window. All installed applications that support JavaScript are shown in this list. If you try to run a script in an application that is not running, the Toolkit prompts for permission to run it.</p> <p>Some applications use multiple JavaScript engines; all available engines in the selected target application are shown in a drop-down list to the right of the application list, with an icon that shows the current debugging status of that engine. A target application can have more than one JavaScript engine, and more than one engine can be active, although only one is current. An active engine is one that is currently executing code, is halted at a breakpoint, or, having executed all scripts, is waiting to receive events.</p> <p>An icon by each engine name indicates whether it is running, halted, or waiting for input:</p> Icon Status running halted waiting <p>The current engine is the one whose data and state is displayed in the Toolkit's panes. If an application has only one engine, its engine becomes current when you select the application as the target. If there is more than one engine available in the target application, you can select an engine in the list to make it current.</p> <p>When you open the Toolkit, the Toolkit itself is the default target application. When you select another target, if the target application that you select is not running, the Toolkit prompts for permission and launches the application. Similarly, if you run a script that specifies a target application that is not running (using the #target directive), the Toolkit prompts for permission to launch it. If the application is running but not selected as the current target, the Toolkit prompts you to switch to it.</p> <p>If you select an application that cannot be debugged in the Toolkit, an error dialog reports that the Toolkit cannot connect to the selected application.</p> <p>The ExtendScript Toolkit is the default editor for JSX files. If you double-click a JSX file in a file browser, the Toolkit looks for a #target directive in the file and launches that application to run the script; however, it first checks for syntax errors in the script.</p> <p>If any are found, the Toolkit displays the error in a message box and quits silently, rather than launching the target application. For example:</p> <p></p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#the-javascript-console","title":"The JavaScript console","text":"<p>The JavaScript console is a command shell and output window for the currently selected JavaScript engine. It connects you to the global namespace of that engine.</p> <p></p> <p>The console is a JavaScript listener, that expects input text to be JavaScript code.</p> <p>You can use the console to evaluate expressions or call functions. Enter any JavaScript statement and execute it by pressing ENTER. The statement executes within the stack scope of the line highlighted in the Call Stack panel, and the result appears in the next line.</p> <ul> <li>You can use the up- and down-arrow keys to scroll through previous entries, or place the cursor with the mouse. Pressing ENTER executes the line that contains the cursor, or all selected lines.</li> <li>The right-click context menu provides the same editing commands as that of the document window.</li> <li>You can copy, cut, and paste text, and undo and redo previous actions.</li> <li>You can select text with the mouse, and use the normal copy and paste shortcuts.</li> <li>The flyout menu allows you to clear the current content.</li> <li>Commands entered in the console execute with a timeout of one second. If a command takes longer than one second to execute, the Toolkit generates a timeout error and terminates the attempt.</li> <li>The console is the standard output location for JavaScript execution. If any script generates a syntax error, the error is displayed here along with the file name and the line number. The Toolkit displays errors here during its own startup phase.</li> </ul>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#controlling-code-execution","title":"Controlling code execution","text":"<p>The debugging commands are available from the Debug menu, from the document window's right-click context menu, through keyboard shortcuts, and from the toolbar buttons. Use these menu commands and buttons to control the execution of code when the JavaScript Debugger is active.</p> <p>Icon</p> <p>Action</p> <p>Hotkey</p> <p>Description</p> <p></p> <p>Run/Continue</p> <p>F5 (Windows)</p> <p>Ctrl R (Mac OS)</p> <p>Starts or resumes execution of a script.</p> <p>Disabled when script is executing.</p> <p></p> <p>Break</p> <p>Ctrl F5 (Windows)</p> <p>Cmd . (Mac OS)</p> <p>Halts the currently executing script temporarily and reactivates the JavaScript Debugger.</p> <p>Enabled when a script is executing.</p> <p></p> <p>Stop</p> <p>Shift F5 (Windows)</p> <p>Ctrl K (Mac OS)</p> <p>Stops execution of the script and generates a runtime error.</p> <p>Enabled when a script is executing.</p> <p></p> <p>Step Over</p> <p>F10 (Windows)</p> <p>Ctrl S (Mac OS)</p> <p>Halts after executing a single JavaScript line in the script. If the statement calls a JavaScript function, executes the function in its entirety before stopping (do not step into the function).</p> <p></p> <p>Step Into</p> <p>F11 (Windows)</p> <p>Ctrl T (Mac OS)</p> <p>Halts after executing a single JavaScript line statement in the script or after executing a single statement in any JavaScript function that the script calls.</p> <p></p> <p>Step Out</p> <p>Shift F11 (Windows)</p> <p>Ctrl U (Mac OS)</p> <p>When paused within the body of a JavaScript function, resumes script execution until the function returns.</p> <p>When paused outside the body of a function, resumes script execution until the script terminates.</p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#visual-indication-of-execution-states","title":"Visual indication of execution states","text":"<p>When the execution of a script halts because the script reached a breakpoint, or when the script reaches the next line when stepping line by line, the document window displays the current script with the current line highlighted in yellow.</p> <p></p> <p>If the script encounters a runtime error, the Toolkit halts the execution of the script, displays the current script with the current line highlighted in orange, and displays the error message in the status line. Use the Data Browser to get further details of the current data assignments.</p> <p></p> <p>Scripts often use a try/catch clause to execute code that may cause a runtime error, in order to catch the error programmatically rather than have the script terminate. You can choose to allow regular processing of such errors using the catch clause, rather than breaking into the debugger. To set this behavior, choose Debug &gt; Don't Break On Guarded Exceptions. Some runtime errors, such as Out Of Memory, always cause the termination of the script, regardless of this setting.</p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#setting-breakpoints","title":"Setting breakpoints","text":"<p>When debugging a script, it is often helpful to make it stop at certain lines so that you can inspect the state of the environment, whether function calls are nested properly, or whether all variables contain the expected data.</p> <ul> <li>To stop execution of a script at a given line, click to the left of the line number to set a breakpoint. A red dot indicates the breakpoint.</li> <li>Click a second time to temporarily disable the breakpoint; the icon changes color.</li> <li>Click a third time to delete the breakpoint. The icon is removed.</li> </ul> <p>Some breakpoints need to be conditional. For example, if you set a breakpoint in a loop that is executed several thousand times, you would not want to have the program stop each time through the loop, but only on each 1000th iteration.</p> <p>You can attach a condition to a breakpoint, in the form of a JavaScript expression. Every time execution reaches the breakpoint, it runs the JavaScript expression. If the expression evaluates to a nonzero number or <code>true</code>, execution stops.</p> <p>To set a conditional breakpoint in a loop, for example, the conditional expression could be <code>\"i &gt;= 1000\"</code>, which means that the program execution halts if the value of the iteration variable i is equal to or greater than 1000.</p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#the-breakpoints-panel","title":"The Breakpoints panel","text":"<p>The Breakpoints panel displays all breakpoints set in the current document window. You can use the panel's flyout menu to add, change, or remove a breakpoint.</p> <p></p> <p>You can edit a breakpoint by double-clicking it, or by selecting it and choosing Add or Modify from the panel menu. A dialog allows you to change the line number, the breakpoint's enabled state, and the condition statement. You can also specify a hit count, which allows you to skip the breakpoint some number of times before entering the debugger. The default is 1, which breaks at the first execution.</p> <p></p> <p>When execution reaches this breakpoint after the specified number of hits, the debugger evaluates this condition. If it does not evaluate to <code>true</code>, the breakpoint is ignored and execution continues. This allows you to break only when certain conditions are met, such as a variable having a particular value.</p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#breakpoint-icons","title":"Breakpoint icons","text":"<p>Each breakpoint is indicated by an icon to the left of the line number in the document window, and an icon and line number in the Breakpoints panel. Different icons are used in the document window and in the Breakpoints panel.</p> Document window Breakpoints panel Description Unconditional breakpoint. Execution stops here. Unconditional breakpoint, disabled. Execution does not stop. Conditional breakpoint. Execution stops if the attached JavaScript expression evaluates to <code>true</code>. Conditional breakpoint, disabled. Execution does not stop."},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#evaluation-in-help-tips","title":"Evaluation in help tips","text":"<p>If you let your mouse pointer rest over a variable or function in a document window, the result of evaluating that variable or function is displayed as a help tip. When you are not debugging the program, this is helpful only if the variables and functions are already known to the JavaScript engine. During debugging, however, this is an extremely useful way to display the current value of a variable, along with its current data type.</p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#tracking-data","title":"Tracking data","text":"<p>The Data Browser panel is your window into the JavaScript engine. It displays all live data defined in the current context, as a list of variables with their current values. If execution has stopped at a breakpoint, it shows variables that have been defined using var in the current function, and the function arguments. To show variables defined in the global or calling scope, use the Call Stack to change the context (see The call stack).</p> <p>You can use the Data Browser to examine and set variable values. - Click a variable name to show its current value in the edit field at the top of the panel. - To change the value, enter a new value and press ENTER. If a variable is Read only, the edit field is disabled.</p> <p></p> <p>The flyout menu for this panel lets you control the amount of data displayed:</p> <ul> <li>Undefined Variables toggles the display of variables whose value is undefined (as opposed to null).</li> <li>Functions toggles the display of all functions that are attached to objects. Most often, the interesting data in an object are its callable methods.</li> <li>Core JavaScript Elements toggles the display of all data that is part of the JavaScript language standard, such as the Array constructor or the Math object.</li> <li>Prototype Elements toggles the display of the JavaScript object prototype chain.</li> </ul> <p>Each variable has a small icon that indicates the data type. An invalid object (that is, a reference to an object that has been deleted) shows the object icon crossed out in red. An undefined value has no icon.</p> Icon Status Boolean Number String Object Method null <p>You can inspect the contents of an object by clicking its icon. The list expands to show the object's properties (and methods, if Functions display is enabled), and the triangle points down to indicate that the object is open.</p>"},{"location":"extendscript-toolkit/debugging-in-the-toolkit/#the-call-stack","title":"The call stack","text":"<p>The Call Stack panel is active while debugging a program. When an executing program stops because of a breakpoint or runtime error, the panel displays the sequence of function calls that led to the current execution point. The Call Stack panel shows the names of the active functions, along with the actual arguments passed in to that function.</p> <p>For example, this panel shows a break occurring at a breakpoint in a function RGBColorPicker():</p> <p></p> <p>The function containing the breakpoint is highlighted in the Call Stack panel. The line containing the breakpoint is highlighted in the Document Window.</p> <p>You can click any function in the call hierarchy to inspect it. In the document window, the line containing the function call that led to that point of execution is marked with a green background. In the example, when you select the run() function in the call stack, the Document Window highlights the line in that function where the RGBColorPicker() function was called.</p> <p></p> <p>Switching between the functions in the call hierarchy allows you to trace how the current function was called. The Console and Data Browser panels coordinate with the Call Stack panel. When you select a function in the Call Stack:</p> <ul> <li>The Console panel switches its scope to the execution context of that function, so you can inspect and modify its local variables. These would otherwise be inaccessible to the running JavaScript program from within a called function.</li> <li>The Data Browser panel displays all data defined in the selected context.</li> </ul>"},{"location":"extendscript-toolkit/inspecting-object-models/","title":"Inspecting object models","text":"<p>The ExtendScript Toolkit offers the ability to inspect the object model of any loaded dictionary, using the Object Model Viewer that you invoke from the Help menu.</p> <p></p> <p>The Object Model Viewer (OMV) comes up as a separate, floating window. The OMV allows you to browse through the object hierarchy and inspect the type and description of each property, and the description and parameters for each method.</p> <p></p> <p>The drop-down menu in the Browser section at the top left allows you to choose from any loaded dictionary of objects. A dictionary provides access to the object model for one application or subsystem.</p> <ul> <li>The Core JavaScript Classes dictionary includes Adobe tools and utilities such as File and Folder.</li> <li>The ScriptUI Classes dictionary shows the interface elements defined in the ScriptUI JavaScript module.</li> <li>Each Adobe application defines a dictionary for that application's Document Object Model (DOM). The dictionary for a particular application may not be available until you launch that application, or until you select it as a target in the Toolkit.</li> </ul> <p></p> <p>To inspect an object model, select the appropriate dictionary from the Browser menu. The classes defined in that model appear in the Classes panel. Select a class to populate the Types panel with the available element types (Constructor, Class, Instance, Event). Select the type to populate the Properties and Methods panel with elements of that type.</p> <p>Each time you select a class or element, its description appears on the right; descriptions are stacked, remaining in view until you close them. You can close each description individually, using the mouse-over menu that appears in the lower right of the description itself, or you can close all open descriptions using the Close All button at the top left of the OMV window.</p> <p></p> <p>The mouse-over menu also allows you to bookmark an element for easy access, or copy text from the description. Live links in the descriptions take you to related objects and elements, and you can search for text in names or descriptions.</p>"},{"location":"extendscript-toolkit/selecting-scripts/","title":"Selecting Scripts","text":"<p>You can open multiple scripts (or text files, including programs in other languages). You can find and open scripts in a number of ways:</p> <ul> <li>Use File &gt; Open to bring up the platform-specific file browser.</li> <li>Choose from recently opened files using File &gt; Recent files.</li> <li>Create a new script using File &gt; New JavaScript.</li> <li>Drop files from the Explorer or the Finder onto the Toolkit to open them in a document window.</li> <li>For JavaScript scripts in trusted locations (the user-script folders of installed Adobe applications), a double-click on the file runs it in the target application or in the Toolkit. For script files in other locations, you must confirm that you want to run the script.</li> <li>Search for scripts containing particular text using Edit &gt; Find and Replace. You can search in a particular document window, among all scripts open in document windows, or among scripts associated with an application, or kept in favorite locations. See Searching in text.</li> <li>Use the Scripts panel to display and open scripts made available by loaded Adobe applications, or those kept in favorite locations.</li> </ul>"},{"location":"extendscript-toolkit/selecting-scripts/#the-scripts-panel-and-favorite-script-locations","title":"The Scripts panel and favorite script locations","text":"<p>The Scripts panel offers a list of debuggable scripts, which can be JS or JSX files or (for some applications) HTML files that contain embedded scripts.</p> <p>You can display a list of scripts made available by a particular target application. Select the target application in the leftmost drop-down list; the available JavaScript engines for that application become available in the right-hand list.</p> <p>When you select a target application, the Toolkit offers to open that application if it is not running, then displays the scripts which that application makes public. Select a script in this panel to load it and display its contents in a new document window, where you can modify it, save it, or run it within the target application.</p> <p>When you choose the target Favorites, the right-hand list shows the default favorite script location, and any other favorite locations that have been defined. You can create your own list of favorite script locations using the flyout menu.</p> <p></p> <p>The favorite script locations that you define are also available to the Find and Replace dialog; see Searching in text.</p> <p>You can also examine and set favorite locations using the Favorites page of the Preferences dialog (Edit &gt; Preferences). Use the Add, Modify, and Remove buttons to edit the list of folders.</p> <p></p>"},{"location":"extendscript-toolkit/selecting-scripts/#adobe-scripts-folder","title":"Adobe Scripts folder","text":"<p>On first launch, the Toolkit creates a folder named Adobe Scripts in the user's Documents folder. The Default favorite in the Scripts panel displays the contents of this folder.</p> <p>When double-clicking a JSX file, the Toolkit normally acts as an invisible security filter. Before actually launching the file, a security dialog asks if it is OK to execute the script. The Toolkit treats the user's Documents/Adobe Scripts folder, however, as a trusted location; when you double-click a JSX file in that folder, the Toolkit does not display the security alert.</p>"},{"location":"extendscript-toolkit/the-script-editor/","title":"The Script Editor","text":"<p>The Script Editor is a full-featured source code editor for JavaScript. You can open any number of Script Editor document windows; each displays one Unicode source code document.</p> <p>The Script Editor offers many useful and powerful text editing and navigation features. Some are intended specifically for use with JavaScript, while others are useful for all kinds of text editing. Features include:</p> <ul> <li>Navigation aids and options applicable to any kind of text, and specific code navigation for JavaScript; see Navigation aids.</li> <li>General editing and coding support such as undo-redo, and specific JavaScript coding support such as syntax checking; see Coding aids.</li> <li>A full-featured text search tool that can search in multiple files; see Searching in text.</li> <li>Syntax marking (color and font styles for specific syntactic structures) for JavaScript and for many other computer languages. The marking styles are configurable; see Syntax marking.</li> </ul>"},{"location":"extendscript-toolkit/the-script-editor/#navigation-aids","title":"Navigation aids","text":"<p>You can configure the Script Editor to display text with various features that help you track the structure of your code, or that help you move around in the file. It also offers mouse and keyboard shortcuts for specific types of cursor movement and text selection.</p>"},{"location":"extendscript-toolkit/the-script-editor/#view-options","title":"View options","text":"<p>The Script Editor offers a number of viewing options that aid in code navigation, including the following:</p> <ul> <li>Automatic line numbering. View &gt; Line Numbers toggles numbering on and off.</li> <li>A collapsible tree view of code, where you can open or close logical units of the structure, such as comments or function definitions. View &gt; Code Collapse toggles the tree view on and off.</li> <li>A line-wrapping mode, where there is no horizontal scroll bar, and lines are wrapped at word breaks. View &gt; Word Wrap toggles line-wrapping on and off.</li> <li>Syntax marking, which uses color and font styles to highlight specific syntactic structures. View &gt;</li> <li>Syntax Highlighting allows you to turn syntax marking off, or set it to mark a particular language, JavaScript or many other computer languages. The marking styles are configurable; see Syntax marking.</li> </ul> <p>You can set the default values for any of these states using the Documents page of the Preferences dialog (Edit &gt; Preferences).</p>"},{"location":"extendscript-toolkit/the-script-editor/#function-finders","title":"Function finders","text":"<p>The Functions panel, and the flyout menu at the top right of the document window, both offer lists of functions defined in the current document. When you select a function in either list, the document jumps directly to that function definition in the code.</p> <p></p>"},{"location":"extendscript-toolkit/the-script-editor/#bookmarks","title":"Bookmarks","text":"<p>The Edit &gt; Bookmarks menu allows you to set and clear navigation points in your text. The F2 function key is the default shortcut key for the bookmark commands:</p> <ul> <li>Toggle the bookmark for the current line using CTRL-F2.</li> <li>Move the cursor to the next bookmark with F2, or to the previous one with SHIFT-F2. The bookmarks wrap, so that the first follows the last.</li> <li>Use SHIFT-CTRL-F2 to clear all bookmarks in the current text.</li> </ul> <p>When you navigate to a bookmark in a collapsed section of code, that section automatically opens.</p> <p>Bookmarks are marked with a blue, right-pointing arrow at the left of the line (to the right of the line number if it is shown). This is the same place where a breakpoint is marked with a dot (see Setting breakpoints). If you have both a breakpoint and a bookmark set in the same line, the blue arrow is superimposed on the breakpoint dot.</p> <p></p>"},{"location":"extendscript-toolkit/the-script-editor/#mouse-navigation-and-selection","title":"Mouse navigation and selection","text":"<p>You can use the mouse or special keyboard shortcuts to move the insertion point or to select text in the document window. Click the left mouse button in the document window to move the position caret.</p> <p>To select text with the mouse, click in unselected text, then drag over the text to be selected. If you drag above or below the currently displayed text, the text scrolls, continuing to select while scrolling. You can also double-click to select a word, or triple-click to select a line.</p> <p>To initiate a drag-and-drop of selected text, click in the block of selected text, then drag to the destination. You can drag text from one document window to another. You can also drag text out of the Toolkit into another application that accepts dragged text, and drag text from another application into a Toolkit document window.</p> <p>You can drop files from the Explorer or the Finder onto the Toolkit to open them in a document window.</p>"},{"location":"extendscript-toolkit/the-script-editor/#keyboard-navigation-and-selection","title":"Keyboard navigation and selection","text":"<p>The Keyboard Shortcuts page in the Preferences dialog (Edit &gt; Preferences) allows you to set or modify keyboard shortcuts for all menu commands.</p> <p>In addition to the keyboard shortcuts specified for menu commands, and the usual keyboard input, the document window accepts these special movement keys. You can also select text by using a movement key while pressing <code>SHIFT</code>.</p> Shortcut Behaviour <code>ENTER</code> Insert a Line Feed character <code>Backspace</code> Delete character to the left <code>DELETE</code> Delete character to the right <code>Left arrow</code> Move insertion point left one character <code>Right arrow</code> Move insertion point right one character <code>Up arrow</code> Move insertion point up one line; stay in column if possible <code>Down arrow</code> Move insertion point down one line; stay in column if possible <code>Page up</code> Move insertion point one page up <code>Page down</code> Move insertion point one page down <code>CTRL + Up arrow</code> Scroll up one line without moving the insertion point <code>CTRL + Down arrow</code> Scroll down one line without moving the insertion point <code>CTRL + Page up</code> Scroll one page up without moving the insertion point <code>CTRL + page down</code> Scroll one page down without moving the insertion point <code>CTRL + Left arrow</code> Move insertion point one word to the left <code>CTRL + right arrow</code> Move insertion point one word to the right <code>HOME</code> Move insertion point to start of line <code>END</code> Move insertion point to end of line <code>CTRL + HOME</code> Move insertion point to start of text <p>The Script Editor supports extended keyboard input via IME (Windows) or TMS (Mac OS). This is especially important for Far Eastern characters.</p>"},{"location":"extendscript-toolkit/the-script-editor/#coding-aids","title":"Coding aids","text":"<p>The Script Editor offers a number of visual and editing features that help you navigate in and maintain the syntactic structure of your JavaScript code, including the following.</p>"},{"location":"extendscript-toolkit/the-script-editor/#code-completion","title":"Code completion","text":"<p>When you position the cursor in a document and begin typing, the Toolkit offers completion choices from among keywords, global functions, functions that are defined in the current document, and functions defined in the object-model dictionary that is currently selected from the flyout menu.</p> <p></p> <p>You can use the flyout menu at the upper right corner of the document window to choose an object-model dictionary to use for completion. Available dictionaries depend on which applications are loaded. See Inspecting object models.</p> <p></p>"},{"location":"extendscript-toolkit/the-script-editor/#brace-matching","title":"Brace matching","text":"<p>The Edit menu offers two kinds of brace-matching selection, that operate when the cursor is placed immediate after an opening brace character, or immediately before a closing brace:</p> <ul> <li>Edit &gt; Select to Brace: Moves the cursor to the matching bracing, but does not select any text. The default keyboard shortcut is <code>CTRL 0</code> (zero).</li> <li>Edit &gt; Select Including Brace: Selects all text between the braces. The default keyboard shortcut is <code>SHIFT CTRL 0</code> (zero).</li> </ul> <p>Brace characters include parentheses, curly braces, and square brackets.</p>"},{"location":"extendscript-toolkit/the-script-editor/#block-indentation","title":"Block indentation","text":"<p>When Word Wrap is off, you can automatically indent or outdent entire blocks of text. To indent a block of text, select some or all of the text on the line or lines, and press TAB. (Be careful; if Word Wrap is on, this deletes the selected text.) To outdent, press <code>SHIFT TAB</code>.</p>"},{"location":"extendscript-toolkit/the-script-editor/#comment-and-uncomment-commands","title":"Comment and uncomment commands","text":"<p>Use Edit &gt; Comment or Uncomment Selection to temporarily remove parts of a JavaScript program from the path of execution. This command is a toggle. When you first issue the command, it places the special comment sequence //~ at the front of any line that is wholly or partially selected. When you next issue the command with such a line selected, it removes that comment marker.</p> <p>The command affects only the comment markers it places in the text; it ignores any comment markers that were already in the selected lines. This allows you to temporarily remove and replace blocks of text that include both code and comments.</p>"},{"location":"extendscript-toolkit/the-script-editor/#version-comments","title":"Version comments","text":"<p>A special comment format is reserved for a code versioning statement, which is used internally by Adobe scripts, but is available to all scripters. Use Edit &gt; Insert Version Tag to insert a comment containing the file name and current date-time, in this format:</p> <pre><code>/**\n * @@@BUILDINFO@@@ SnpCreateDialog.jsx !Version! Tue Dec 05 2006 08:03:38 GMT-0800\n */\n</code></pre> <p>You are responsible for manually updating the !Version! portion with your own version information.</p>"},{"location":"extendscript-toolkit/the-script-editor/#undo-and-redo","title":"Undo and redo","text":"<p>Choose Undo or Redo from the Edit menu or from the document window's right-click context menu to revoke and reinstate multiple editing changes sequentially. The change history is kept from when a file is created or loaded, and maintained through file-save operations.</p>"},{"location":"extendscript-toolkit/the-script-editor/#syntax-checking","title":"Syntax checking","text":"<p>Before running the new script or saving the text as a script file, use Edit &gt; Check Syntax to check whether the text contains JavaScript syntax errors. The default keyboard shortcut is <code>F7</code>.</p> <ul> <li>If the script is syntactically correct, the status line shows \"No syntax errors.\"</li> <li>If the Toolkit finds a syntax error, such as a missing quote, it highlights the affected text, plays a sound, and shows the error message in the status line so you can fix the error.</li> </ul>"},{"location":"extendscript-toolkit/the-script-editor/#multiline-statements","title":"Multiline statements","text":"<p>The Script Editor supports triple-quote syntax to allow strings to span several source code lines. When entering a very long string, you can:</p> <ul> <li>Enter it all on one line:     <pre><code>var myString = \"This very long string might wrap onto a second line visually, but you typed no CR character when entering it.\"\n</code></pre></li> <li>Enter on multiple lines, using a backslash () continuation character at the end of each line:     <pre><code>var myString = \"This string spans \\\ntwo lines.\"\n</code></pre></li> <li>Use triple quotes around the entire string on multiple lines:     <pre><code>var myString = \"\"\"This \"quoted\" word is inside the\nmultiline string enclosed by triple quotes.\"\"\"\n</code></pre></li> </ul> <p>The triple-quote option allows the string to contain embedded quotes.</p>"},{"location":"extendscript-toolkit/the-script-editor/#searching-in-text","title":"Searching in text","text":"<p>The Toolkit offers a search utility through the Edit &gt; Find and Replace command. This command brings up the Find and Replace panel. If the panel is not docked, you can hide it by pressing ESC.</p> <p>The Find and Replace panel allows you to search through multiple documents for text that matches a specific search string or regular expression. You can choose to search in:</p> <ul> <li>The current document, or the current selection in the current document</li> <li>All open documents</li> <li>All scripts made public by the current target application</li> <li>Folders that you have defined as favorite locations; see The Scripts panel and favorite script locations.</li> </ul> <p></p> <p>The results of a search are listed in the Find Results tab; by default, this is stacked with the Find and Replace panel, but you can drag it to another stack, or display it as an independent floating panel.</p> <p></p> <p>Double-click a result line in the Find Results panel to jump directly to the document and line where the text was found.</p>"},{"location":"extendscript-toolkit/the-script-editor/#using-regular-expression-syntax","title":"Using regular-expression syntax","text":"<p>The Toolkit supports a limited set of Regular Expression syntax for the Find and Replace dialog:</p> RegEx Token Behaviour <code>.</code> Matches any character <code>(</code> Marks the start of a region for capturing a match. <code>)</code> Marks the end of a capturing region. <code>\\&lt;</code> Matches the start of a word using the editor's current definition of words. <code>\\&gt;</code> Matches the end of a word using the editor's current definition of words. <code>\\x</code> Escapes a character x that would otherwise have a special meaning. For example, <code>[</code> is interpreted as a left bracket, rather than the start of a character set. <code>[...]</code> A set of characters; for example, [abc] means any of the characters a, b or c. You can also use ranges, for example [a-z] for any lower case character. <code>[^...]</code> The complement of the characters in a set. For example, [^A-Za-z] means any character except an alphabetic character. <code>^</code> Matches the start of a line (unless used inside a set). <code>$</code> Matches the end of a line. <code>*</code> Matches 0 or more times. For example, Sa*m matches Sm, Sam, Saam, Saaam etc. <p>In a replace operation, you can use the captured regions of a match in the replacement expression by using the placeholders <code>\\1</code> through <code>\\9</code>, where <code>\\1</code> refers to the first captured region, <code>\\2</code> to the second, and so on.</p> <p>For example, if the search string is <code>Fred\\([1-9]\\)XXX</code> and the replace string is <code>Sam\\1YYY</code>, when applied to <code>Fred2XXX</code> the search generates <code>Sam2YYY</code>.</p>"},{"location":"extendscript-toolkit/the-script-editor/#syntax-marking","title":"Syntax marking","text":"<p>The Script Editor offers language-based syntax highlighting to aid in editing code. Although the debugging features (including syntax checking) are only available for JavaScript, you can choose to edit other kinds of code, and the syntax is highlighted according to the language. The style of syntax marking is automatically set to match the file extension, or you can choose the language from the View &gt; Syntax Highlighting menu.</p> <p>The style of highlighting is configurable, using the Fonts and Colors page of the Preferences dialog.</p> <p></p>"},{"location":"extendscript-tools-features/","title":"ExtendScript Tools and Features","text":"<p>In addition to the specific functional modules and development tools, ExtendScript provides these tools and features:</p> <ul> <li>Global objects that support debugging and object inspection; these include the Dollar ($) object and the ExtendScript reflection interface.</li> <li>A localization utility for providing user-interface string values in different languages. See Localizing ExtendScript strings.</li> <li>Global functions for displaying short messages in dialog boxes. See User notification dialogs.</li> <li>An object type for specifying measurement values together with their units. See Specifying measurement values.</li> <li>Preprocessor directives that allow you to include scripts in one another and specify an execution target application.</li> <li>Support for extending or overriding math and logical operator behavior on a class-by-class basis. See Operator overloading.</li> </ul> <p>ExtendScript also provides a common scripting environment for all Adobe JavaScript-enabled applications, and allows interapplication communication through scripts.</p> <p>For information on these features, see Interapplication Communication with Scripts.</p>"},{"location":"extendscript-tools-features/dollar-object/","title":"Dollar ($) object","text":"<p>This global ExtendScript object provides a number of debugging facilities and informational methods. The properties of the $ object allow you to get global information such as the most recent run-time error, and set flags that control debugging and localization behavior. The methods allow you to output text to the JavaScript Console during script execution, control execution and other ExtendScript behavior programmatically, and gather statistics on object use.</p>"},{"location":"extendscript-tools-features/dollar-object/#attributes","title":"Attributes","text":""},{"location":"extendscript-tools-features/dollar-object/#appencoding","title":"$.appEncoding","text":"<p><code>$.appEncoding</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description","title":"Description","text":"<p>The Internet name of the application's default character encoding, such as \"CP1252\" or \"X-SHIFT-JIS\". Valid values are implementation- and OS-dependent.</p> <p>Set to change the default encoding for the application. The returned value can differ from the value set. In Windows, for example, if set to \"x-latin1\", the returned value is the synonymous \"ISO-8859-1\".</p>"},{"location":"extendscript-tools-features/dollar-object/#type","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/dollar-object/#build","title":"$.build","text":"<p><code>$.build</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_1","title":"Description","text":""},{"location":"extendscript-tools-features/dollar-object/#type_1","title":"Type","text":"<p>String</p> <p>The version information for the current ExtendScript build.</p> <p>Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#builddate","title":"$.buildDate","text":"<p><code>$.buildDate</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_2","title":"Description","text":""},{"location":"extendscript-tools-features/dollar-object/#type_2","title":"Type","text":"<p><code>Date</code></p> <p>The date the current JavaScript engine was built.</p> <p>Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#decimalpoint","title":"$.decimalPoint","text":"<p><code>$.decimalPoint</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_3","title":"Description","text":""},{"location":"extendscript-tools-features/dollar-object/#type_3","title":"Type","text":"<p>String</p> <p>The character used in formatted numeric output for a decimal point, for the current locale.</p> <p>Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#enginename","title":"$.engineName","text":"<p><code>$.engineName</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_4","title":"Description","text":""},{"location":"extendscript-tools-features/dollar-object/#type_4","title":"Type","text":"<p>String</p> <p>The name of the current JavaScript engine, if set.</p> <p>Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#error","title":"$.error","text":"<p><code>$.error</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_5","title":"Description","text":""},{"location":"extendscript-tools-features/dollar-object/#type_5","title":"Type","text":"<p><code>Error</code></p> <p>String</p> <p>The most recent run-time error information, contained in a JavaScript Error object.</p> <p>Assigning error text to this property generates a run-time error; however, the preferred way to generate a run-time error is to throw an Error object.</p>"},{"location":"extendscript-tools-features/dollar-object/#filename","title":"$.fileName","text":"<p><code>$.fileName</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_6","title":"Description","text":""},{"location":"extendscript-tools-features/dollar-object/#type_6","title":"Type","text":"<p>String</p> <p>The file name of the current script.</p> <p>Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#flags","title":"$.flags","text":"<p><code>$.flags</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_7","title":"Description","text":""},{"location":"extendscript-tools-features/dollar-object/#type_7","title":"Type","text":"<p>Number</p> <p>Gets or sets low-level debug output flags. A logical AND of the following bit flag values:</p> <ul> <li><code>0x0002</code> (2): Displays each line with its line number as it is executed.</li> <li><code>0x0040</code> (64): Enables excessive garbage collection. Usually, garbage collection starts when the number of objects has increased by a certain amount since the last garbage collection. This flag causes ExtendScript to garbage collect after almost every statement. This impairs performance severely, but is useful when you suspect that an object gets released too soon.</li> <li><code>0x0080</code> (128): Displays all calls with their arguments and the return value.</li> <li><code>0x0100</code> (256): Enables extended error handling (see strict).</li> <li><code>0x0200</code> (512): Enables the localization feature of the toString method. Equivalent to the localize property.</li> </ul> <p>Note</p> <p>Other bit values are not public and should not be used.</p>"},{"location":"extendscript-tools-features/dollar-object/#global","title":"$.global","text":"<p><code>$.global</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_8","title":"Description","text":"<p>Provides access to the Global object, which contains the JavaScript global namespace.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_8","title":"Type","text":"<p>Global</p>"},{"location":"extendscript-tools-features/dollar-object/#hirestimer","title":"$.hiresTimer","text":"<p><code>$.hiresTimer</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_9","title":"Description","text":"<p>A high-resolution timer that measures the number of microseconds since this property was last accessed. Value is initialized as early as possible, so the first access returns the startup time for ExtendScript. The property is thread-local; that is, the first access on a thread returns the time needed to create and initialize that thread.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_9","title":"Type","text":"<p>Number. Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#includepath","title":"$.includePath","text":"<p><code>$.includePath</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_10","title":"Description","text":"<p>The path for include files for the current script.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_10","title":"Type","text":"<p>String. Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#level","title":"$.level","text":"<p><code>$.level</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_11","title":"Description","text":"<p>The current debugging level, which enables or disables the JavaScript debugger.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_11","title":"Type","text":"<p>Number. Read only. One of:</p> <ul> <li><code>0</code>: No debugging</li> <li><code>1</code>: Break on runtime errors</li> <li><code>2</code>: Full debug mode</li> </ul>"},{"location":"extendscript-tools-features/dollar-object/#line","title":"$.line","text":"<p><code>$.line</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_12","title":"Description","text":"<p>The current line of the currently executing script; the first line is number 1.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_12","title":"Type","text":"<p>Number. Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#locale","title":"$.locale","text":"<p><code>$.locale</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_13","title":"Description","text":"<p>Gets or sets the current locale. The string contains five characters in the form LL_RR, where LL is an ISO 639 language specifier, and RR is an ISO 3166 region specifier.</p> <p>Initially, this is the value that the application or the platform returns for the current user. You can set it to temporarily change the locale for testing. To return to the application or platform setting, set to Nothing, <code>null</code>, or the empty string.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_13","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/dollar-object/#localize","title":"$.localize","text":"<p><code>$.localize</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_14","title":"Description","text":"<p>Enable or disable the extended localization features of the built-in <code>toString()</code> method.</p> <p>See Localizing ExtendScript strings.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_14","title":"Type","text":"<p>Boolean</p>"},{"location":"extendscript-tools-features/dollar-object/#memcache","title":"$.memCache","text":"<p><code>$.memCache</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_15","title":"Description","text":"<p>Gets or sets the ExtendScript memory cache size in bytes.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_15","title":"Type","text":"<p>Number</p>"},{"location":"extendscript-tools-features/dollar-object/#os","title":"$.os","text":"<p><code>$.os</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_16","title":"Description","text":"<p>The current operating system version information.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_16","title":"Type","text":"<p>String. Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#screens","title":"$.screens","text":"<p><code>$.screens</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_17","title":"Description","text":"<p>An array of objects containing information about the display screens attached to your computer.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_17","title":"Type","text":"<p>Array of objects</p>"},{"location":"extendscript-tools-features/dollar-object/#properties","title":"Properties","text":"Property Type Description <code>left</code> Coordinate The left corner of the drawable area <code>top</code> Coordinate The top corner of the drawable area <code>right</code> Coordinate The right corner of the drawable area <code>bottom</code> Coordinate The bottom corner of the drawable area <code>primary</code> Boolean <code>true</code> if the object describes the primary display"},{"location":"extendscript-tools-features/dollar-object/#stack","title":"$.stack","text":"<p><code>$.stack</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_18","title":"Description","text":"<p>The current stack trace.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_18","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/dollar-object/#strict","title":"$.strict","text":"<p><code>$.strict</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_19","title":"Description","text":"<p>When <code>true</code>, any attempt to write to a read-only property causes a runtime error.</p> <p>Some objects do not permit the creation of new properties when <code>true</code>.</p>"},{"location":"extendscript-tools-features/dollar-object/#type_19","title":"Type","text":"<p>Boolean</p>"},{"location":"extendscript-tools-features/dollar-object/#version","title":"$.version","text":"<p><code>$.version</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_20","title":"Description","text":"<p>The version number of the JavaScript engine as a three-part number and description; for example: \"3.92.95 (debug)\"</p>"},{"location":"extendscript-tools-features/dollar-object/#type_20","title":"Type","text":"<p>String. Read only.</p>"},{"location":"extendscript-tools-features/dollar-object/#methods","title":"Methods","text":""},{"location":"extendscript-tools-features/dollar-object/#about","title":"$.about()","text":"<p><code>$.about()</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_21","title":"Description","text":"<p>Displays the About box for the ExtendScript component, and returns the text of the About box as a string.</p>"},{"location":"extendscript-tools-features/dollar-object/#returns","title":"Returns","text":"<p>String</p>"},{"location":"extendscript-tools-features/dollar-object/#bp","title":"$.bp()","text":"<p><code>$.bp([condition])</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_22","title":"Description","text":"<p>Executes a breakpoint at the current position.</p> <p>If no condition is needed, it is recommended that you use the JavaScript <code>debugger;</code> statement in the script, rather than this method.</p>"},{"location":"extendscript-tools-features/dollar-object/#parameters","title":"Parameters","text":"Parameter Type Description <code>condition</code> String Optional. The JavaScript statement to be used as a condition. If the statement evaluates to <code>true</code> or nonzero when this point is reached, execution stops."},{"location":"extendscript-tools-features/dollar-object/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"extendscript-tools-features/dollar-object/#colorpicker","title":"$.colorPicker()","text":"<p><code>$.colorPicker(name)</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_23","title":"Description","text":"<p>Invokes the platform-specific color selection dialog</p>"},{"location":"extendscript-tools-features/dollar-object/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>name</code> Hexadecimal RGB value (<code>0xRRGGBB</code>) The color to be preselected in the dialog, or <code>-1</code> for the platform default."},{"location":"extendscript-tools-features/dollar-object/#returns_2","title":"Returns","text":"<p>Hexadecimal RGB value, e.g. <code>0xRRGGBB</code>.</p>"},{"location":"extendscript-tools-features/dollar-object/#evalfile","title":"$.evalFile()","text":"<p><code>$.evalFile(path[, timeout=10000])</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_24","title":"Description","text":"<p>Loads a JavaScript script file from disk, evaluates it, and returns the result of evaluation.</p>"},{"location":"extendscript-tools-features/dollar-object/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>path</code> String The name and location of the file. <code>timeout</code> Number Optional. A number of milliseconds to wait before returning undefined, if the script cannot be evaluated. Defaults to <code>10000</code>."},{"location":"extendscript-tools-features/dollar-object/#returns_3","title":"Returns","text":"<p>Any type</p>"},{"location":"extendscript-tools-features/dollar-object/#gc","title":"$.gc()","text":"<p><code>$.gc()</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_25","title":"Description","text":"<p>Initiates garbage collection in the JavaScript engine.</p>"},{"location":"extendscript-tools-features/dollar-object/#returns_4","title":"Returns","text":"<p>Nothing</p>"},{"location":"extendscript-tools-features/dollar-object/#getenv","title":"$.getenv()","text":"<p><code>$.getenv(envname)</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_26","title":"Description","text":"<p>Retrieves the value of the specified environment variable, or null if no such variable is defined.</p> <p>Note</p> <p>On MacOS the only env vars that will be accessible are:</p> <ul> <li>System default environment variable</li> <li>Custom environment variables created by the <code>$.setenv()</code> metho</li> <li>Custom environment variables created with <code>launchctl setenv CUSTOM_VAR \"custom_value\"</code></li> </ul> <p>Any env vars set in .bash_profile, .bashrc, .profile, .zshenv, or .zshrc will be ignored.</p>"},{"location":"extendscript-tools-features/dollar-object/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>envname</code> String The name of the environment variable."},{"location":"extendscript-tools-features/dollar-object/#returns_5","title":"Returns","text":"<p>String</p>"},{"location":"extendscript-tools-features/dollar-object/#setenv","title":"$.setenv()","text":"<p><code>$.setenv(envname, value)</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_27","title":"Description","text":"<p>Sets the value of the specified environment variable, if no such variable is defined.</p>"},{"location":"extendscript-tools-features/dollar-object/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>envname</code> String The name of the environment variable. <code>value</code> String The new value, a string."},{"location":"extendscript-tools-features/dollar-object/#returns_6","title":"Returns","text":"<p>Nothing</p>"},{"location":"extendscript-tools-features/dollar-object/#sleep","title":"$.sleep()","text":"<p><code>$.sleep(milliseconds)</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_28","title":"Description","text":"<p>Suspends the calling thread for the given number of milliseconds.</p> <p>During a sleep period, checks at <code>100</code> millisecond intervals to see whether the sleep should be terminated. This can happen if there is a break request, or if the script timeout has expired.</p>"},{"location":"extendscript-tools-features/dollar-object/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>milliseconds</code> Number The number of milliseconds to wait."},{"location":"extendscript-tools-features/dollar-object/#returns_7","title":"Returns","text":"<p>Nothing</p>"},{"location":"extendscript-tools-features/dollar-object/#write","title":"$.write()","text":"<p><code>$.write(text[, text...]...)</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_29","title":"Description","text":"<p>Writes the specified text to the JavaScript Console.</p>"},{"location":"extendscript-tools-features/dollar-object/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>text</code> String One or more strings to write, which are concatenated to form a single string."},{"location":"extendscript-tools-features/dollar-object/#returns_8","title":"Returns","text":"<p>Nothing</p>"},{"location":"extendscript-tools-features/dollar-object/#writeln","title":"$.writeln()","text":"<p><code>$.writeln (text[, text...]...)</code></p>"},{"location":"extendscript-tools-features/dollar-object/#description_30","title":"Description","text":"<p>Writes the specified text to the JavaScript Console and appends a linefeed sequence.</p>"},{"location":"extendscript-tools-features/dollar-object/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>text</code> String One or more strings to write, which are concatenated to form a single string."},{"location":"extendscript-tools-features/dollar-object/#returns_9","title":"Returns","text":"<p>Nothing</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/","title":"ExtendScript Reflection Interface","text":"<p>ExtendScript provides a reflection interface that allows you to find out everything about an object, including its name, a description, the expected data type for properties, the arguments and return value for methods, and any default values or limitations to the input values.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#reflectionobject","title":"ReflectionObject","text":"<p>Every object has a reflect property that returns a Reflection Object that reports the contents of the object. You can, for example, show the values of all the properties of an object with code like this:</p> <pre><code>var f = new File (\"myfile\");\nvar props = f.reflect.properties;\nfor (var i = 0; i &lt; props.length; i++) {\n    $.writeln('this property ' + props[i].name + ' is ' + f[props[i].name]);\n}\n</code></pre>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#reflectionobject-attributes","title":"ReflectionObject Attributes","text":"<p>Info</p> <p>All properties are read only.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description","title":"description","text":"<p><code>reflect.description</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_1","title":"Description","text":"<p>Short text describing the reflected object, or undefined if no description is available.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#help","title":"help","text":"<p><code>reflect.help</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_2","title":"Description","text":"<p>Longer text describing the reflected object more completely, or <code>undefined</code> if no description is available.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_1","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#methods","title":"methods","text":"<p><code>reflect.methods</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_3","title":"Description","text":"<p>An Array of ReflectionInfo object containing all methods of the reflected object, defined in the class or in the specific instance.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_2","title":"Type","text":"<p>Array of ReflectionInfo objects</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#name","title":"name","text":"<p><code>reflect.name</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_4","title":"Description","text":"<p>The class name of the reflected object.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_3","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#properties","title":"properties","text":"<p><code>reflect.properties</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_5","title":"Description","text":"<p>An Array of ReflectionInfo object containing all properties of the reflected object, defined in the class or in the specific instance. For objects with dynamic properties (defined at runtime) the list contains only those dynamic properties that have already been accessed by the script.</p> <p>For example, in an object wrapping an HTML tag, the names of the HTML attributes are determined at run time.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_4","title":"Type","text":"<p>Array of ReflectionInfo objects</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#reflectionobject-methods","title":"ReflectionObject Methods","text":""},{"location":"extendscript-tools-features/extendscript-reflection-interface/#find","title":"find()","text":"<p><code>reflectionObj.find(name)</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_6","title":"Description","text":"<p>Returns the ReflectionInfo object for the named property of the reflected object, or null if no such property exists.</p> <p>Use this method to get information about dynamic properties that have not yet been accessed, but that are known to exist.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#parameters","title":"Parameters","text":"Parameter Type Description name String The property for which to retrieve information."},{"location":"extendscript-tools-features/extendscript-reflection-interface/#examples","title":"Examples","text":"<p>This code determines the class name of an object:</p> <pre><code>obj = new String (\"hi\");\nobj.reflect.name; // =&gt; String\n</code></pre> <p>This code gets a list of all methods:</p> <pre><code>obj = new String (\"hi\");\nobj.reflect.methods; //=&gt; indexOf,slice,...\nobj.reflect.find (\"indexOf\"); // =&gt; the method info\n</code></pre> <p>This code gets a list of properties:</p> <pre><code>Math.reflect.properties; //=&gt; PI,LOG10,...\n</code></pre> <p>This code gets the data type of a property:</p> <pre><code>Math.reflect.find (\"PI\").type; // =&gt; number\n</code></pre>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#reflectioninfo-object","title":"ReflectionInfo Object","text":"<p>This object contains information about a property, a method, or a method argument.</p> <p>You can access ReflectionInfo objects in a Reflection object's properties and methods arrays, by name or index:</p> <pre><code>obj = new String (\"hi\");\nobj.reflect.methods[0];\nobj.reflect.methods[\"indexOf\"];\n</code></pre> <p>You can access the ReflectionInfo objects for the arguments of a method in the arguments array of the ReflectionInfo object for the method, by index:</p> <pre><code>obj.reflect.methods[\"indexOf\"].arguments[0];\nobj.reflect.methods.indexOf.arguments[0];\n</code></pre>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#reflectioninfo-attributes","title":"ReflectionInfo Attributes","text":""},{"location":"extendscript-tools-features/extendscript-reflection-interface/#arguments","title":"arguments","text":"<p><code>obj.reflect.methods[0].arguments</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_7","title":"Description","text":"<p>For a reflected method, an array of ReflectionInfo objects describing each method argument.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_5","title":"Type","text":"<p>Array of ReflectionInfo objects</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#datatype","title":"dataType","text":"<p><code>obj.reflect.methods[0].dataType</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_8","title":"Description","text":"<p>The data type of the reflected element.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_6","title":"Type","text":"<p>String. One of:</p> <ul> <li><code>\"boolean\"</code></li> <li><code>\"number\"</code></li> <li><code>\"string\"</code></li> <li><code>\"Classname\"</code>: The class name of an object.     !!! note         Class names start with a capital letter. Thus, the value <code>String</code> stands for a JavaScript string, while String is a JavaScript String wrapper object.</li> <li><code>*</code>: Any type. This is the default.</li> <li><code>null</code></li> <li><code>undefined</code>: Return data type for a function that does not return any value.</li> <li><code>unknown</code></li> </ul>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#defaultvalue","title":"defaultValue","text":"<p><code>obj.reflect.methods[0].defaultValue</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_9","title":"Description","text":"<p>The default value for a reflected property or method argument, or <code>undefined</code> if there is no default value, if the property is undefined, or if the element is a method.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_7","title":"Type","text":"<p>Any</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_10","title":"description","text":"<p><code>obj.reflect.methods[0].description</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_11","title":"Description","text":"<p>Short text describing the reflected object, or <code>undefined</code> if no description is available.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_8","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#help_1","title":"help","text":"<p><code>obj.reflect.methods[0].help</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_12","title":"Description","text":"<p>Longer text describing the reflected object more completely, or <code>undefined</code> if no description is available.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_9","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#iscollection","title":"isCollection","text":"<p><code>obj.reflect.methods[0].isCollection</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_13","title":"Description","text":"<p>When <code>true</code>, the reflected property or method returns a collection; otherwise, <code>false</code>.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_10","title":"Type","text":"<p>Boolean</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#max","title":"max","text":"<p><code>obj.reflect.methods[0].max</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_14","title":"Description","text":"<p>The maximum numeric value for the reflected element, or <code>undefined</code> if there is no maximum or if the element is a method.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_11","title":"Type","text":"<p>Number</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#min","title":"min","text":"<p><code>obj.reflect.methods[0].min</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_15","title":"Description","text":"<p>The minimum numeric value for the reflected element, or <code>undefined</code> if there is no minimum or if the element is a method.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_12","title":"Type","text":"<p>Number</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#name_1","title":"name","text":"<p><code>obj.reflect.methods[0].name</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_16","title":"Description","text":"<p>The name of the reflected element. A string, or a number for an array index.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_13","title":"Type","text":"<p>String or Number</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_14","title":"type","text":"<p><code>obj.reflect.methods[0].type</code></p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#description_17","title":"Description","text":"<p>The type of the reflected element.</p>"},{"location":"extendscript-tools-features/extendscript-reflection-interface/#type_15","title":"Type","text":"<p>String. One of:</p> <ul> <li><code>readonly</code>: A Read only property.</li> <li><code>readwrite</code>: A read-write property.</li> <li><code>createonly</code>: A property that is valid only during creation of an object.</li> <li><code>method</code>: A method.</li> </ul>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/","title":"Localizing ExtendScript strings","text":"<p>Localization is the process of translating and otherwise manipulating an interface so it looks as if it were originally designed for a particular language. ExtendScript enables you to localize the strings in your script's user interface. The language is chosen by the application at startup, according to the current locale provided by the operating system.</p> <p>For parts of your user interface that are displayed on the screen, you may want to localize the displayed text. You can localize any string explicitly, using the Global localize function function, which takes as its argument a localization object containing the localized versions of a string.</p> <p>A localization object is a JavaScript object literal whose property names are locale names and whose property values are the localized text strings. The locale name is a standard language code with an optional region identifier. For syntax details, see Locale names.</p> <p>In this example, a msg object contains localized text strings for two locales. This object supplies the text for an alert dialog:</p> <pre><code>msg = { en: \"Hello, world\", de: \"Hallo Welt\" };\nalert (msg);\n</code></pre> <p>ExtendScript matches the current locale and platform to one of the object's properties and uses the associated string. On a German system, for example, the property <code>de: \"Hallo Welt\"</code> is converted to the string <code>\"Hallo Welt\"</code>.</p>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/#variable-values-in-localized-strings","title":"Variable values in localized strings","text":"<p>Some localization strings need to contain additional data whose position and order may change according to the language used.</p> <p>You can include variables in the string values of the localization object, in the form <code>%n</code>. The variables are replaced in the returned string with the results of JavaScript expressions, supplied as additional arguments to the <code>localize</code> function. The variable %1 corresponds to the first additional argument, <code>%2</code> to the second, and so on.</p> <p>Because the replacement occurs after the localized string is chosen, the variable values are inserted in the correct position. For example:</p> <pre><code>today = {\n    en: \"Today is %1/%2.\",\n    de: \"Heute ist der %2.%1.\"\n};\nd = new Date();\nalert (localize (today, d.getMonth()+1, d.getDate()));\n</code></pre>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/#enabling-automatic-localization","title":"Enabling automatic localization","text":"<p>ExtendScript offers an automatic localization feature. When it is enabled, you can specify a localization object directly as the value of any property that takes a localizable string, without using the <code>localize</code> function. For example:</p> <pre><code>msg = { en: \"Yes\", de: \"Ja\", fr: \"Oui\" };\nalert (msg);\n</code></pre> <p>To use automatic translation of localization objects, you must enable localization in your script with this statement:</p> <pre><code>$.localize = true;\n</code></pre> <p>The localize function always performs its translation, regardless of the setting of the <code>$.localize</code> variable; for example:</p> <pre><code>msg = { en: \"Yes\", de: \"Ja\", fr: \"Oui\" };\n//Only works if the $.localize=true\nalert (msg);\n//Always works, regardless of $.localize value\nalert ( localize (msg));\n</code></pre> <p>If you need to include variables in the localized strings, use the localize function.</p>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/#locale-names","title":"Locale names","text":"<p>A locale name is an identifier string in that contains an ISO 639 language specifier, and optionally an ISO 3166 region specifier, separated from the language specifier by an underscore. The ISO 639 standard defines a set of two-letter language abbreviations, such as <code>en</code> for English and <code>de</code> for German.</p> <p>The ISO 3166 standard defines a region code, another two-letter identifier, which you can optionally append to the language identifier with an underscore. For example, <code>en_US</code> identifies U.S. English, while <code>en_GB</code> identifies British English.</p> <p>This object defines one message for British English, another for all other flavors of English, and another for all flavors of German:</p> <pre><code>message = {\n    en_GB: \"Please select a colour.\"\n    en: \"Please select a colour.\"\n    de: \"Bitte w\u00e4hlen Sie eine Farbe.\"\n};\n</code></pre> <p>If you need to specify different messages for different platforms, you can append another underline character and the name of the platform, one of <code>Win</code>, <code>Mac</code>, or <code>Unix</code>. For example, this objects defines one message in British English to be displayed on Mac OS, one for all other flavors of English on Mac OS, and one for all other flavors of English on all other platforms:</p> <pre><code>pressMsg = {\n    en_GB_Mac: \"Press Cmd-S to select a colour.\",\n    en_Mac: \"Press Cmd-S to select a color.\",\n    en: \"Press Ctrl-S to select a color.\"\n};\n</code></pre> <p>All these identifiers are case sensitive; for example, <code>EN_US</code> is not valid.</p>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/#how-locale-names-are-resolved","title":"How locale names are resolved","text":"<ol> <li>ExtendScript gets the hosting application's locale; for example, <code>en_US</code>.</li> <li>It appends the platform identifier; for example, <code>en_US_Win</code>.</li> <li>It looks for a matching property, and if found, returns the value string.</li> <li>If not found, it removes the platform identifier (for example, <code>en_US</code>) and retries.</li> <li>If not found, it removes the region identifier (for example, <code>en</code>) and retries.</li> <li>If not found, it tries the identifier <code>en</code> (that is, the default language is English).</li> <li>If not found, it returns the entire localizer object.</li> </ol>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/#testing-localization","title":"Testing localization","text":"<p>ExtendScript stores the current locale in the variable <code>$.locale</code>. This variable is updated whenever the locale of the hosting application changes.</p> <p>To test your localized strings, you can temporarily reset the locale. To restore the original behavior, set the variable to <code>null</code>, <code>false</code>, <code>0</code>, or the empty string. An example:</p> <pre><code>$.locale = \"ru\"; // try your Russian messages\n$.locale = null; // restore to the locale of the app\n</code></pre>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/#global-localize-function","title":"Global localize function","text":""},{"location":"extendscript-tools-features/localizing-extendscript-strings/#localize","title":"localize()","text":"<p><code>localize (localization_obj[, args])</code></p> <p><code>localize (ZString)</code></p>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/#description","title":"Description","text":"<p>The globally available <code>localize</code> function can be used to provide localized strings anywhere a displayed text value is specified.</p> <p>The function takes a specially formatted set of localized versions of a display string, and returns the version appropriate to the current locale.</p>"},{"location":"extendscript-tools-features/localizing-extendscript-strings/#parameters","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p>localization_obj</p> <p>Object</p> <p>A JavaScript object literal whose property names are locale names, and whose property values are the localized text strings. The locale name is an identifier as specified in the ISO 3166 standard, a set of two-letter language abbreviations, such as <code>\"en\"</code> for English and <code>\"de\"</code> for German.</p> <p>For example: <code>btnText = { en: \"Yes\", de: \"Ja\", fr: \"Oui\" }; b1 = w.add (\"button\", undefined, localize (btnText));</code></p> <p>The string value of each property can contain variables in the form %1, %2, and so on, corresponding to additional arguments. The variable is replaced with the result of evaluating the corresponding argument in the returned string.</p> <p>args</p> <p>Any</p> <p>Optional. Additional JavaScript expressions matching variables in the string values supplied in the localization object. The first argument corresponds to the variable <code>%1</code>, the second to <code>%2</code>, and so on.</p> <p>Each expression is evaluated and the result inserted in the variable's positionin the returned string.</p> <p>ZString</p> <p>ZString</p> <p>Internal use only. A ZString is an internal Adobe format for localized strings, which you might see in Adobe scripts. It is a string that begins with <code>$$$</code> and contains a path to the localized string in an installed ZString dictionary.</p> <p>For example: <code>w = new Window (\"dialog\", localize (\"$$$/UI/title1=Sample\"));</code></p> <p>For example:</p> <pre><code>today = {\n    en: \"Today is %1/%2\",\n    de: \"Heute ist der %2.%1.\"\n};\nd = new Date();\nalert (localize (today, d.getMonth()+1, d.getDate()));\n</code></pre>"},{"location":"extendscript-tools-features/operator-overloading/","title":"Operator overloading","text":"<p>ExtendScript allows you to extend or override the behavior of a math or a Boolean operator for a specific class by defining a method in that class with same name as the operator. For example, this code defines the addition (+) operator for the class <code>MyClass</code>. In this case, the addition operator simply adds the operand to the property value:</p> <pre><code>// define the constructor method\nfunction MyClass (initialValue) {\n    this.value = initialValue;\n}\n\n// define the addition operator\nMyClass.prototype [\"+\"] = function (operand) {\n    return this.value + operand;\n}\n</code></pre> <p>This allows you to perform the \"+\" operation with any object of this class:</p> <pre><code>var obj = new MyClass (5);\nResult: [object Object]\nobj + 10;\nResult: 15\n</code></pre> <p>You can override the following operators:</p> <p>Category</p> <p>Operators</p> <p>Unary</p> <p><code>+, ~</code></p> <p>Binary</p> <ul> <li><code>+, *, /, %, ^</code></li> <li><code>&lt;, &lt;=, ==</code></li> <li><code>&lt;&lt;, &gt;&gt;, &gt;&gt;&gt;</code></li> <li><code>&amp;, \\|, ===</code></li> </ul> <ul> <li>The operators <code>&gt;</code> and <code>&gt;=</code> are implemented by executing NOT operator <code>&lt;=</code> and NOT operator <code>&lt;</code>.</li> <li>Combined assignment operators such as <code>*=</code> are not supported.</li> </ul> <p>All operator overload implementations must return the result of the operation. To perform the default operation, return <code>undefined</code>.</p> <p>Unary operator functions work on the <code>this</code> object, while binary operators work on the <code>this</code> object and the first argument. The + and - operators have both unary and binary implementations. If the first argument is undefined, the operator is unary; if it is supplied, the operator is binary.</p> <p>For binary operators, a second argument indicates the order of operands. For noncommutative operators, either implement both order variants in your function or return <code>undefined</code> for combinations that you do not support. For example:</p> <pre><code>this [\"/\"] = function (operand, rev) {\n    if (rev) {\n        // do not resolve operand / this\n        return;\n    } else {\n        // resolve this / operand\n        return this.value / operand;\n}\n</code></pre>"},{"location":"extendscript-tools-features/preprocessor-directives/","title":"Preprocessor directives","text":"<p>ExtendScript provides preprocessor directives for including external scripts, naming scripts, specifying a JavaScript engine, and setting certain flags.</p> <p>Specify these with either a C-style statement starting with the # character, or a comment followed by @:</p> <pre><code>#include \"file.jsxinc\"\n//@include \"file.jsxinc\"\n</code></pre> <p>When a directive takes one or more arguments, and an argument contains any nonalphanumeric characters, the argument must be enclosed in single or double quotes. This is generally the case with paths and file names, for example, which contain dots and slashes.</p>"},{"location":"extendscript-tools-features/preprocessor-directives/#include-file","title":"#include file","text":"<p>Includes a JavaScript source file from another location. Inserts the contents of the named file into this file at the location of this statement. The <code>file</code> argument is an Adobe portable file specification. See Specifying paths.</p> <p>As a convention, use the file extension .jsxinc for JavaScript include files. For example:</p> <pre><code>#include \"../include/lib.jsxinc\"\n//@include \"../include/file.jsxinc\"\n</code></pre> <p>To set one or more paths for the #include statement to scan, use the <code>#includepath</code> preprocessor directive.</p> <p>If the file to be included cannot be found, ExtendScript throws a run-time error. Included source code is not shown in the debugger, so you cannot set breakpoints in it.</p>"},{"location":"extendscript-tools-features/preprocessor-directives/#includepath-path","title":"#includepath path","text":"<p>One or more paths that the <code>#include</code> statement should use to locate the files to be included. The semicolon (;) separates path names.</p> <p>If a <code>#include</code> file name starts with a slash (/), it is an absolute path name, and the include paths are ignored. Otherwise, ExtendScript attempts to find the file by prefixing the file with each path set by the <code>#includepath</code> statement.</p> <p>For example:</p> <pre><code>#includepath \"include;../include\"\n#include \"file.jsxinc\"\n//@includepath \"include;../include\"\n//@include \"file.jsxinc\"\n</code></pre> <p>Multiple <code>#includepath</code> statements are allowed; the list of paths changes each time an <code>#includepath</code> statement is executed.</p> <p>As a fallback, ExtendScript also uses the contents of the environment variable <code>JSINCLUDE</code> as a list of include paths.</p> <p>Some engines can have a predefined set of include paths. If so, the path provided by <code>#includepath</code> is tried before the predefined paths. If, for example, the engine has a predefined path set to <code>predef;predef/include</code>, the preceding example causes the following lookup sequence:</p> <ul> <li><code>file.jsxinc</code>: literal lookup</li> <li><code>include/file.jsxinc</code>: first #includepath path</li> <li><code>../include/file.jsxinc</code>: second #includepath path</li> <li><code>predef/file.jsxinc</code>: first predefined engine path</li> <li><code>predef/include/file.jsxinc</code>: second predefined engine path</li> </ul>"},{"location":"extendscript-tools-features/preprocessor-directives/#script-name","title":"#script name","text":"<p>Names a script. Enclosing quotes are optional, but required for names that include spaces or special characters. For example:</p> <pre><code>#script SetupPalette\n#script \"Load image file\"\n</code></pre> <p>The <code>name</code> value is displayed in the Toolkit Editor tab. An unnamed script is assigned a unique name generated from a number.</p>"},{"location":"extendscript-tools-features/preprocessor-directives/#strict-on","title":"#strict on","text":"<p>Turns on strict error checking. See the Dollar ($) object's strict property.</p>"},{"location":"extendscript-tools-features/preprocessor-directives/#target-name","title":"#target name","text":"<p>Defines the target application for this JSX file. The name value is an application specifier; see Application and namespace specifiers. Enclosing quotes are optional.</p> <p>If the Toolkit is registered as the handler for files with the <code>.jsx</code> extension (as it is by default), opening the file opens the target application to run the script.</p> <p>If this directive is not present, the Toolkit loads and displays the script. A user can open a file by double-clicking it in a file browser, and a script can open a file using a <code>File</code> object's <code>execute</code> method.</p>"},{"location":"extendscript-tools-features/preprocessor-directives/#targetengine-enginename","title":"#targetengine enginename","text":"<p>Defines the target JavaScript engine for this JSX file, within the designated target application.</p> <p>Supported by Adobe Illustrator CS5 and Adobe InDesign CS5; other applications ignore the directive.</p> <ul> <li>For Adobe Illustrator CS5 and Adobe InDesign CS5, if the named engine does not exist, and if the script originates within the application (rather than being executed in the ExtendScript Toolkit or received in an interapplication message), the application creates a new JavaScript engine with this name, which persists for the lifetime of the application session.</li> <li>If the script originates outside the application, and the named engine does not exist, the directive is ignored.</li> </ul>"},{"location":"extendscript-tools-features/specifying-measurement-values/","title":"Specifying measurement values","text":"<p>ExtendScript provides the UnitValue object to represent measurement values. The properties and methods of the UnitValue object make it easy to change the value, the unit, or both, or to perform conversions from one unit to another.</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#unitvalue-object","title":"UnitValue object","text":"<p>Represents measurement values that contain both the numeric magnitude and the unit of measurement.</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#unitvalue-object-constructor","title":"UnitValue object constructor","text":"<p>The UnitValue constructor creates a new UnitValue object. The keyword new is optional:</p> <pre><code>myVal = new UnitValue (value, unit);\nmyVal = new UnitValue (\"value unit\");\nmyVal = new UnitValue (value, \"unit\");\n</code></pre> <p>The value is a number, and the unit is specified with a string in abbreviated, singular, or plural form, as shown in the following table.</p> Abbreviation Singular Plural Comments <code>\"in\"</code> <code>\"inch\"</code> <code>\"inches\"</code> 2.54 cm <code>\"ft\"</code> <code>\"foot\"</code> <code>\"feet\"</code> 30.48 cm <code>\"yd\"</code> <code>\"yard\"</code> <code>\"yards\"</code> 91.44 cm <code>\"mi\"</code> <code>\"mile\"</code> <code>\"miles\"</code> 1609.344 m <code>\"mm\"</code> <code>\"millimeter\"</code> <code>\"millimeters\"</code> <code>\"cm\"</code> <code>\"centintimeter\"</code> <code>\"centimeters\"</code> <code>\"m\"</code> <code>\"meter\"</code> <code>\"meters\"</code> <code>\"km\"</code> <code>\"kilometer\"</code> <code>\"kilometers\"</code> <code>\"pt\"</code> <code>\"point\"</code> <code>\"points\"</code> inches / 72 <code>\"pc\"</code> <code>\"pica\"</code> <code>\"picas\"</code> points * 12 <code>\"tpt\"</code> <code>\"traditional point\"</code> <code>\"traditional points\"</code> inches / 72.27 <code>\"tpc\"</code> <code>\"traditional pica\"</code> <code>\"traditional picas\"</code> 12 tpt <code>\"ci\"</code> <code>\"cicero\"</code> <code>\"ciceros\"</code> 12.7872 pt <code>\"px\"</code> <code>\"pixel\"</code> <code>\"pixels\"</code> baseless (see below) <code>\"%\"</code> <code>\"percent\"</code> <code>\"percent\"</code> baseless (see below) <p>If an unknown unit type is supplied, the type is set to <code>\"?\"</code>, and the <code>UnitValue</code> object prints as \"UnitValue 0.00000\".</p> <p>For example, all the following formats are equivalent:</p> <pre><code>myVal = new UnitValue (12, \"cm\");\nmyVal = new UnitValue (\"12 cm\");\nmyVal = UnitValue (\"12 centimeters\");\n</code></pre>"},{"location":"extendscript-tools-features/specifying-measurement-values/#attributes","title":"Attributes","text":""},{"location":"extendscript-tools-features/specifying-measurement-values/#unitvaluebaseunit","title":"UnitValue.baseUnit","text":"<p><code>unitValueObj.baseUnit</code></p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#description","title":"Description","text":"<p>A UnitValue object that defines the size of one pixel, or a total size to use as a base for percentage values.</p> <p>This is used as the base conversion unit for pixels and percentages; see Converting pixel and percentage values.</p> <p>Default is 0.013889 inches (1/72 in), which is the base conversion unit for pixels at 72 dpi. Set to null to restore the default.</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#type","title":"Type","text":"<p>UnitValue</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#unitvaluetype","title":"UnitValue.type","text":"<p><code>unitValueObj.type</code></p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#description_1","title":"Description","text":"<p>The unit type in abbreviated form; for example, \"cm\" or \"in\".</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#type_1","title":"Type","text":"<p>String</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#unitvaluevalue","title":"UnitValue.value","text":"<p><code>unitValueObj.value</code></p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#description_2","title":"Description","text":"<p>The numeric measurement value.</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#type_2","title":"Type","text":"<p>Number</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#methods","title":"Methods","text":""},{"location":"extendscript-tools-features/specifying-measurement-values/#unitvalueas","title":"UnitValue.as()","text":"<p><code>unitValueObj.as(unit)</code></p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#description_3","title":"Description","text":"<p>Returns the numeric value of this object in the given unit. If the unit is unknown or cannot be computed, generates a run-time error.</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#parameter","title":"Parameter","text":"Parameter Type Description <code>unit</code> String The unit type in abbreviated form; for example, <code>\"cm\"</code> or <code>\"in\"</code>."},{"location":"extendscript-tools-features/specifying-measurement-values/#returns","title":"Returns","text":"<p>Number</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#unitvalueconvert","title":"UnitValue.convert()","text":"<p><code>unitValueObj.convert(unit)</code></p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#description_4","title":"Description","text":"<p>Converts this object to the given unit, resetting the type and value accordingly.</p> <p>Returns <code>true</code> if the conversion is successful. If the unit is unknown or the object cannot be converted, generates a run-time error and returns <code>false</code>.</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#parameter_1","title":"Parameter","text":"Parameter Type Description <code>unit</code> String The unit type in abbreviated form; for example, <code>\"cm\"</code> or <code>\"in\"</code>."},{"location":"extendscript-tools-features/specifying-measurement-values/#returns_1","title":"Returns","text":"<p>Boolean</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#converting-pixel-and-percentage-values","title":"Converting pixel and percentage values","text":"<p>Converting measurements among different units requires a common base unit. For example, for length, the meter is the base unit. All length units can be converted into meters, which makes it possible to convert any length unit into any other length unit.</p> <p>Pixels and percentages do not have a standard common base unit. Pixel measurements are relative to display resolution, and percentages are relative to an absolute total size.</p> <ul> <li>To convert pixels into length units, you must know the size of a single pixel. The size of a pixel depends on the display resolution. A common resolution measurement is 72 dpi, which means that there are 72 pixels to the inch. The conversion base for pixels at 72 dpi is 0.013889 inches (1/72 inch).</li> <li>Percentage values are relative to a total measurement. For example, 10% of 100 inches is 10 inches, while 10% of 1 meter is 0.1 meters. The conversion base of a percentage is the unit value corresponding to 100%.</li> </ul> <p>The default <code>baseUnit</code> of a <code>unitValue</code> object is 0.013889 inches, the base for pixels at 72 dpi. If the <code>unitValue</code> is for pixels at any other dpi, or for a percentage value, you must set the <code>baseUnit</code> value accordingly. The <code>baseUnit</code> value is itself a <code>unitValue</code> object, containing both a magnitude and a unit.</p> <p>For a system using a different DPI, you can change the <code>baseUnit</code> value in the <code>UnitValue</code> class, thus changing the default for all new <code>unitValue</code> objects. For example, to double the resolution of pixels:</p> <pre><code>UnitValue.baseUnit = UnitValue (1/144, \"in\"); //144 dpi\n</code></pre> <p>To restore the default, assign null to the class property:</p> <pre><code>UnitValue.baseUnit = null; //restore default\n</code></pre> <p>You can override the default value for any particular unitValue object by setting the property in that object. For example, to create a unitValue object for pixels with 96 dpi:</p> <pre><code>pixels = UnitValue (10, \"px\");\nmyPixBase = UnitValue (1/96, \"in\");\npixels.baseUnit = myPixBase;\n</code></pre> <p>For percentage measurements, set the baseUnit property to the measurement value for 100%. For example, to create a unitValue object for 40% of 10 feet:</p> <pre><code>myPctVal = UnitValue (40, \"%\");\nmyBase = UnitValue (10, \"ft\")\nmyPctVal.baseUnit = myBase;\n</code></pre> <p>Use the as() method to get to a percentage value as a unit value:</p> <pre><code>myFootVal = myPctVal.as (\"ft\"); // =&gt; 4\nmyInchVal = myPctVal.as (\"in\"); // =&gt; 36\n</code></pre> <p>You can convert a unitValue from an absolute measurement to pixels or percents in the same way:</p> <pre><code>myMeterVal = UnitValue (10, \"m\"); // 10 meters\nmyBase = UnitValue (1, \"km\");\nmyMeterVal.baseUnit = myBase; //as a percentage of 1 kilometer\npctOfKm = myMeterVal.as ('%'); // =&gt; 1\nmyVal = UnitValue (\"1 in\"); // Define measurement in inches\n// convert to pixels using default base\nmyVal.convert (\"px\"); // =&gt; value=72 type=px\n</code></pre>"},{"location":"extendscript-tools-features/specifying-measurement-values/#computing-with-unit-values","title":"Computing with unit values","text":"<p>UnitValue objects can be used in computational JavaScript expressions. The way the value is used depends on the type of operator.</p>"},{"location":"extendscript-tools-features/specifying-measurement-values/#unary-operators-","title":"Unary operators <code>(~, !, +, -)</code>","text":"Operator Behaviour <code>~unitValue</code> Result is a new UnitValue with the same type, but value converted to a 32-bit integer and inverted bitwise. <code>!unitValue</code> Result is <code>true</code> if the numeric value is nonzero, <code>false</code> if it is not. <code>+unitValue</code> Result is a new UnitValue with the same type and value as the original. <code>-unitValue</code> Result is a new UnitValue with the same type and negated value from the original"},{"location":"extendscript-tools-features/specifying-measurement-values/#binary-operators-","title":"Binary operators <code>(+, -, *, /, %)</code>","text":"<p>If one operand is unitValue object and the other is a number, the operation is applied to the number and the numeric value of the object. The expression returns a new unitValue object with the result as its value.</p> <p>For example:</p> <pre><code>val = new UnitValue (\"10 cm\");\nres = val * 20;\n// res is a UnitValue (200, \"cm\");\n</code></pre> <p>If both operands are unitValue objects, JavaScript converts the right operand to the same unit as the left operand and applies the operation to the resulting values. The expression returns a new unitValue object with the unit of the left operand, and the result value.</p> <p>For example:</p> <pre><code>a = new UnitValue (\"1 m\");\nb = new UnitValue (\"10 cm\");\na + b;\n// res is a UnitValue (1.1, \"m\");\nb + a;\n// res is a UnitValue (110, \"cm\");\n</code></pre>"},{"location":"extendscript-tools-features/specifying-measurement-values/#comparisons","title":"Comparisons (=, ==, &lt;, &gt;, &lt;=, &gt;=)","text":"<p>If one operand is a unitValue object and the other is a number, JavaScript compares the number with the unitValue's numeric value.</p> <p>If both operands are unitValue objects, JavaScript converts both objects to the same unit, and compares the converted numeric values.</p> <p>For example:</p> <pre><code>a = new UnitValue (\"98 cm\");\nb = new UnitValue (\"1 m\");\na &lt; b;   // =&gt; true\na &lt; 1;   // =&gt; false\na == 98; // =&gt; true\n</code></pre>"},{"location":"extendscript-tools-features/user-notification-dialogs/","title":"User notification dialogs","text":"<p>ExtendScript provides a set of globally available functions that allow you to display short messages to the user in platform-standard dialog boxes. There are three types of message dialogs:</p> <ul> <li>Alert - Displays a dialog containing a short message and an OK button.</li> <li>Confirm - Displays a dialog containing a short message and two buttons, Yes and No, allowing the user to accept or reject an action.</li> <li>Prompt - Displays a dialog containing a short message, a text entry field, and OK and Cancel buttons, allowing the user to supply a value to the script.</li> </ul> <p>These dialogs are customizable to a small degree. The appearance is platform specific.</p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#global-methods","title":"Global Methods","text":""},{"location":"extendscript-tools-features/user-notification-dialogs/#alert","title":"alert()","text":"<p><code>alert(message[, title=\"Script Alert\", errorIcon=false]);</code></p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#description","title":"Description","text":"<p>Displays a platform-standard dialog containing a short message and an OK button.</p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#parameters","title":"Parameters","text":"Parameter Type Description message String The string for the displayed message. title String Optional. A string to appear as the title of the dialog, if the platform supports a title. Mac OS does not support titles for alert dialogs. The default title string is <code>\"Script Alert\"</code>. errorIcon Boolean Optional. When <code>true</code>, the platform-standard alert icon is replaced by the platform-standard error icon in the dialog. Default is <code>false</code>."},{"location":"extendscript-tools-features/user-notification-dialogs/#returns","title":"Returns","text":"<p>Returns nothing</p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#examples","title":"Examples","text":"<p>This figure shows simple alert dialogs in Windows and in Mac OS.</p> <p> </p> <p>This figure shows alert dialogs with error icons.</p> <p> </p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#confirm","title":"confirm()","text":"<p><code>confirm(message[,noAsDflt=false, title=\"Script Alert\"]);</code></p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#description_1","title":"Description","text":"<p>Displays a platform-standard dialog containing a short message and two buttons labeled Yes and No.</p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#parameters_1","title":"Parameters","text":"Parameter Type Description message String The string for the displayed message. noAsDflt Boolean Optional. When <code>true</code>, the No button is the default choice, selected when the user types <code>ENTER</code>. Default is <code>false</code>, meaning that Yes is the default choice. title String Optional. A string to appear as the title of the dialog, if the platform supports a title. Mac OS does not support titles for confirmation dialogs. The default title string is <code>\"Script Alert\"</code>."},{"location":"extendscript-tools-features/user-notification-dialogs/#returns_1","title":"Returns","text":"<p>Returns <code>true</code> if the user clicked Yes, <code>false</code> if the user clicked No.</p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#examples_1","title":"Examples","text":"<p>This figure shows simple confirmation dialogs on Windows and Mac OS.</p> <p> </p> <p>This figure shows confirmation dialogs with No as the default button.</p> <p> </p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#prompt","title":"prompt()","text":"<p><code>prompt(message, preset[, title=\"Script Alert\"]);</code></p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#description_2","title":"Description","text":"<p>Displays a platform-standard dialog containing a short message, a text edit field, and two buttons labeled OK and Cancel.</p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#parameters_2","title":"Parameters","text":"Parameter Type Description message String The string for the displayed message. preset String The initial value to be displayed in the text edit field. title String Optional. A string to appear as the title of the dialog, if the platform supports a title. Mac OS does not support titles for confirmation dialogs. The default title string is <code>\"Script Alert\"</code>."},{"location":"extendscript-tools-features/user-notification-dialogs/#returns_2","title":"Returns","text":"<p>Returns the value of the text edit field if the user clicked OK, <code>null</code> if the user clicked Cancel.</p>"},{"location":"extendscript-tools-features/user-notification-dialogs/#examples_2","title":"Examples","text":"<p>This figure shows simple prompt dialogs on Windows and Mac OS.</p> <p> </p> <p>This figure shows confirmation dialogs with a title value specified.</p> <p> </p>"},{"location":"external-communication/","title":"External Communication Tools","text":"<p>ExtendScript offers tools for communicating with other computers or the Internet using standard protocols.</p> <p>The Socket object supports low-level TCP connections. It is available in the following applications:</p> <ul> <li>Adobe Bridge CS5</li> <li>Adobe InDesign CS5</li> <li>Adobe InCopy\u00ae CS5</li> <li>Adobe After Effects\u00ae CS5</li> <li>Adobe Photoshop CS5</li> </ul>"},{"location":"external-communication/socket-object-reference/","title":"Socket Object Reference","text":"<p>This section provides details of the object's properties and methods.</p> <p>Socket object constructor:</p> <pre><code>[new] Socket();\n</code></pre> <p>Creates and returns a new Socket object.</p>"},{"location":"external-communication/socket-object-reference/#attributes","title":"Attributes","text":""},{"location":"external-communication/socket-object-reference/#socketconnected","title":"Socket.connected","text":"<p><code>socketObj.connected</code></p>"},{"location":"external-communication/socket-object-reference/#description","title":"Description","text":"<p>When <code>true</code>, the connection is active.</p>"},{"location":"external-communication/socket-object-reference/#type","title":"Type","text":"<p>Boolean. Read only.</p>"},{"location":"external-communication/socket-object-reference/#socketencoding","title":"Socket.encoding","text":"<p><code>socketObj.encoding</code></p>"},{"location":"external-communication/socket-object-reference/#description_1","title":"Description","text":"<p>Sets or retrieves the name of the encoding used to transmit data.</p> <p>Typical values are <code>\"ASCII\"</code>, <code>\"BINARY\"</code>, or <code>\"UTF-8\"</code>.</p>"},{"location":"external-communication/socket-object-reference/#type_1","title":"Type","text":"<p>String</p>"},{"location":"external-communication/socket-object-reference/#socketeof","title":"Socket.eof","text":"<p><code>socketObj.eof</code></p>"},{"location":"external-communication/socket-object-reference/#description_2","title":"Description","text":"<p>When <code>true</code>, the receive buffer is empty.</p>"},{"location":"external-communication/socket-object-reference/#type_2","title":"Type","text":"<p>Boolean. Read only.</p>"},{"location":"external-communication/socket-object-reference/#socketerror","title":"Socket.error","text":"<p><code>socketObj.error</code></p>"},{"location":"external-communication/socket-object-reference/#description_3","title":"Description","text":"<p>A message describing the most recent error. Setting this value clears any error message.</p>"},{"location":"external-communication/socket-object-reference/#type_3","title":"Type","text":"<p>String</p>"},{"location":"external-communication/socket-object-reference/#sockethost","title":"Socket.host","text":"<p><code>socketObj.host</code></p>"},{"location":"external-communication/socket-object-reference/#description_4","title":"Description","text":"<p>The name of the remote computer when a connection is established.</p> <p>If the connection is shut down or does not exist, the property contains the empty string.</p>"},{"location":"external-communication/socket-object-reference/#type_4","title":"Type","text":"<p>String. Read only.</p>"},{"location":"external-communication/socket-object-reference/#sockettimeout","title":"Socket.timeout","text":"<p><code>socketObj.timeout</code></p>"},{"location":"external-communication/socket-object-reference/#description_5","title":"Description","text":"<p>The timeout in seconds to be applied to read or write operations. Default is <code>10</code>.</p>"},{"location":"external-communication/socket-object-reference/#type_5","title":"Type","text":"<p>Number</p>"},{"location":"external-communication/socket-object-reference/#methods","title":"Methods","text":""},{"location":"external-communication/socket-object-reference/#socketclose","title":"Socket.close()","text":"<p><code>socketObj.close();</code></p>"},{"location":"external-communication/socket-object-reference/#description_6","title":"Description","text":"<p>Terminates the open connection. Deleting the object also closes the connection, but not until JavaScript garbage-collects the object.</p> <p>The connection might stay open longer than you wish if you do not close it explicitly.</p>"},{"location":"external-communication/socket-object-reference/#returns","title":"Returns","text":"<p>Boolean. <code>true</code> if the connection was closed, <code>false</code> on I/O errors.</p>"},{"location":"external-communication/socket-object-reference/#socketlisten","title":"Socket.listen()","text":"<p><code>socketObj.listen(port[, encoding=\"ASCII\"]);</code></p>"},{"location":"external-communication/socket-object-reference/#description_7","title":"Description","text":"<p>Instructs the object to start listening for an incoming connection.</p> <p>The call to <code>open()</code> and the call to <code>listen()</code> are mutually exclusive. Call one function or the other, not both.</p>"},{"location":"external-communication/socket-object-reference/#parameters","title":"Parameters","text":"Parameter Type Description <code>port</code> Number. The TCP/IP port number to listen on. Valid port numbers are <code>[1..65535]</code>. Typical values are 80 for a Web server, 23 for a Telnet server and so on. <code>encoding</code> String Optional. The encoding to be used for the connection. Typical values are <code>\"ASCII\"</code>, <code>\"binary\"</code>, or <code>\"UTF-8\"</code>. Default is <code>\"ASCII\"</code>"},{"location":"external-communication/socket-object-reference/#returns_1","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"external-communication/socket-object-reference/#socketopen","title":"Socket.open()","text":"<p><code>socketObj.open(host[, encoding=\"ASCII\"]);</code></p>"},{"location":"external-communication/socket-object-reference/#description_8","title":"Description","text":"<p>Opens the connection for subsequent read/write operations.</p> <p>The call to open() and the call to listen() are mutually exclusive. Call one function or the other, not both.</p>"},{"location":"external-communication/socket-object-reference/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>host</code> String The name or IP address of the remote computer, followed by a colon and the port number to connect to. The port number is required. Valid computer names are, for example, <code>\"www.adobe.com:80\"</code> or <code>\"192.150.14.12:80\"</code>. <code>encoding</code> String Optional. The encoding to be used for the connection. Typical values are <code>\"ASCII\"</code>, <code>\"binary\"</code>, or <code>\"UTF-8\"</code>. Default is <code>\"ASCII\"</code>"},{"location":"external-communication/socket-object-reference/#returns_2","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"external-communication/socket-object-reference/#socketpoll","title":"Socket.poll()","text":"<p><code>socketObj.poll();</code></p>"},{"location":"external-communication/socket-object-reference/#description_9","title":"Description","text":"<p>Checks a listening object for a new incoming connection. If a connection request was detected, the method returns a new Socket object that wraps the new connection. Use this connection object to communicate with the remote computer.</p> <p>After use, close the connection and delete the JavaScript object. If no new connection request was detected, the method returns null.</p>"},{"location":"external-communication/socket-object-reference/#parameters_2","title":"Parameters","text":""},{"location":"external-communication/socket-object-reference/#returns_3","title":"Returns","text":"<p>Socket object or <code>null</code>.</p>"},{"location":"external-communication/socket-object-reference/#socketread","title":"Socket.read()","text":"<p><code>socketObj.read([count=0]);</code></p>"},{"location":"external-communication/socket-object-reference/#description_10","title":"Description","text":"<p>Reads up to the specified number of characters from the connection, waiting if necessary.</p> <p>Ignores CR characters unless encoding is set to <code>BINARY</code>.</p>"},{"location":"external-communication/socket-object-reference/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>count</code> Number Optional. The number of characters to read. If negative, the call is equivalent to <code>readln()</code>. Default is <code>0</code>."},{"location":"external-communication/socket-object-reference/#returns_4","title":"Returns","text":"<p>String that contains up to the number of characters that were supposed to be read, or the number of characters read before the connection closed or timed out.</p>"},{"location":"external-communication/socket-object-reference/#socketreadln","title":"Socket.readln()","text":"<p><code>socketObj.readln();</code></p>"},{"location":"external-communication/socket-object-reference/#description_11","title":"Description","text":""},{"location":"external-communication/socket-object-reference/#parameters_4","title":"Parameters","text":"<p>Reads one line of text up to the next line feed. Line feeds are recognized as LF or CRLF pairs.</p> <p>CR characters are ignored.</p>"},{"location":"external-communication/socket-object-reference/#returns_5","title":"Returns","text":"<p>String</p>"},{"location":"external-communication/socket-object-reference/#socketwrite","title":"Socket.write()","text":"<p><code>socketObj.write(text[, text...]);</code></p>"},{"location":"external-communication/socket-object-reference/#description_12","title":"Description","text":"<p>Concatenates all arguments into a single string and writes that string to the connection.</p> <p>CRLF sequences are converted to LFs unless encoding is set to <code>BINARY.</code></p>"},{"location":"external-communication/socket-object-reference/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>text</code> String. Any number of string values. All arguments are concatenated to form the string to be written."},{"location":"external-communication/socket-object-reference/#returns_6","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"external-communication/socket-object-reference/#socketwriteln","title":"Socket.writeln()","text":"<p><code>socketObj.writeln(text[, text...]);</code></p>"},{"location":"external-communication/socket-object-reference/#description_13","title":"Description","text":"<p>Concatenates all arguments into a single string, appends a Line Feed character, and writes that string to the connection.</p>"},{"location":"external-communication/socket-object-reference/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>text</code> String. Any number of string values. All arguments are concatenated to form the string to be written."},{"location":"external-communication/socket-object-reference/#returns_7","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"external-communication/socket-object/","title":"Socket Object","text":"<p>TCP connections are the basic transport layer of the Internet. Every time your Web browser connects to a server and requests a new page, it opens a TCP connection to handle the request as well as the server's reply. The JavaScript Socket object lets you connect to any server on the Internet and to exchange data with this server.</p> <p>The Socket object provides basic functionality to connect to a remote computer over a TCP/IP network or the Internet. It provides calls like <code>open()</code> and <code>close()</code> to establish or to terminate a connection, and <code>read()</code> or <code>write()</code> to transfer data. The <code>listen()</code> method establishes a simple Internet server; the server uses the method <code>poll()</code> to check for incoming connections.</p> <p>Many of these connections are based on simple data exchange of ASCII data, while other protocols, like the FTP protocol, are more complex and involve binary data. One of the simplest protocols is the HTTP protocol.</p> <p>The following sample TCP/IP client connects to a WWW server (which listens on port 80); it then sends a very simple HTTP GET request to obtain the home page of the WWW server, and then it reads the reply, which is the home page together with a HTTP response header:</p> <pre><code>var reply = \"\";\nvar conn = new Socket;\n\n// access Adobe's home page\nif (conn.open (\"www.adobe.com:80\")) {\n\n    // send a HTTP GET request\n    conn.write (\"GET /index.html HTTP/1.0\\n\\n\");\n\n    // and read the server's reply\n    reply = conn.read(999999);\n\n    conn.close();\n}\n</code></pre> <p>After executing this code, the variable <code>reply</code> contains the contents of the Adobe home page together with an HTTP response header.</p> <p>Establishing an Internet server is a bit more complicated. A typical server program sits and waits for incoming connections, which it then processes. Usually, you would not want your application to run in an endless loop, waiting for any incoming connection request. Therefore, you can ask a Socket object for an incoming connection by calling the <code>poll()</code> method of a Socket object.</p> <p>This call would just check the incoming connections and then return immediately. If there is a connection request, the call to <code>poll()</code> would return another Socket object containing the brand new connection. Use this connection object to talk to the calling client; when finished, close the connection and discard the connection object.</p> <p>Before a Socket object is able to check for an incoming connection, it must be told to listen on a specific port, like port 80 for HTTP requests. Do this by calling the <code>listen()</code> method instead of the <code>open()</code> method.</p> <p>The following example is a very simple Web server. It listens on port 80, waiting until it detects an incoming request. The HTTP header is discarded, and a dummy HTML page is transmitted to the caller:</p> <pre><code>conn = new Socket;\n// listen on port 80\nif (conn.listen (80)) {\n    // wait forever for a connection\n    var incoming;\n    do incoming = conn.poll();\n    while (incoming == null);\n\n    // discard the request\n    conn.read();\n\n    // Reply with a HTTP header\n    incoming.writeln (\"HTTP/1.0 200 OK\");\n    incoming.writeln (\"Content-Type: text/html\");\n    incoming.writeln();\n\n    // Transmit a dummy homepage\n    incoming.writeln (\"&lt;html&gt;&lt;body&gt;&lt;h1&gt;Homepage&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\");\n\n    // done!\n    incoming.close();\n    delete incoming;\n}\n</code></pre> <p>Often, the remote endpoint terminates the connection after transmitting data. Therefore, there is a connected property that contains <code>true</code> as long as the connection still exists. If the connected property returns <code>false</code>, the connection is closed automatically.</p> <p>On errors, the <code>error</code> property of the Socket object contains a short message describing the type of the error.</p> <p>The Socket object lets you easily implement software that talks to each other via the Internet. You could, for example, let two Adobe applications exchange documents and data simply by writing and executing JavaScript programs.</p>"},{"location":"external-communication/socket-object/#chat-server-sample","title":"Chat server sample","text":"<p>The following sample code implements a very simple chat server. A chat client may connect to the chat server, who is listening on port number 1234. The server responds with a welcome message and waits for one line of input from the client. The client types some text and transmits it to the server who displays the text and lets the user at the server computer type a line of text, which the client computer again displays. This goes back and forth until either the server or the client computer types the word \"bye\":</p> <pre><code>// A simple Chat server on port 1234\nfunction chatServer() {\n    var tcp = new Socket;\n\n    // listen on port 1234\n    writeln (\"Chat server listening on port 1234\");\n    if (tcp.listen (1234)) {\n        for (;;) {\n            // poll for a new connection\n            var connection = tcp.poll();\n            if (connection != null) {\n                writeln (\"Connection from \" + connection.host);\n\n                // we have a new connection, so welcome and chat\n                // until client terminates the session\n                connection.writeln (\"Welcome to a little chat!\");\n                chat (connection);\n                connection.writeln ( \"*** Goodbye ***\");\n                connection.close();\n                delete connection;\n                writeln (\"Connection closed\");\n            }\n        }\n    }\n}\n\nfunction chatClient() {\n    var connection = new Socket;\n\n    // connect to sample server\n    if (connection.open (\"remote-pc.corp.adobe.com:1234\")) {\n        // then chat with server\n        chat (connection);\n        connection.close();\n        delete connection;\n    }\n}\n\nfunction chat (c) {\n    // select a long timeout\n    c.timeout=1000;\n\n    while (true) {\n        // get one line and echo it\n        writeln (c.read());\n\n        // stop if the connection is broken\n        if (!c.connected)\n            break;\n\n        // read a line of text\n        write (\"chat: \");\n        var text = readln();\n\n        if (text == \"bye\")\n            // stop conversation if the user entered \"bye\"\n            break;\n        else\n            // otherwise transmit to server\n            c.writeln (text);\n    }\n}\n</code></pre>"},{"location":"file-system-access/","title":"File System Access","text":"<p>Adobe ExtendScript defines classes that simplify cross-platform file-system access. These classes are available to all applications that support a JavaScript interface.</p> <ul> <li>The first part of this chapter, Using File and Folder objects, describes how to use these classes and provides details of pathname syntax.</li> <li>File object and Folder object provide reference details of the objects, properties, methods, and creation parameters. You can also choose the Core JavaScript Classes dictionary from the Help menu in the ExtendScript Toolkit to inspect the objects in the Object Model Viewer.</li> </ul>"},{"location":"file-system-access/file-access-error-messages/","title":"File access error messages","text":"<p>The following messages can be returned in the error property.</p> Message Explanation File or folder does not exist The file or folder does not exist, but the parent folder exists. File or folder already exists The file or folder already exists. I/O device is not open An I/O operation was attempted on a file that was closed. Read past EOF Attempt to read beyond the end of a file. Conversion error The content of the file cannot be converted to Unicode. Partial multibyte character found The character encoding of the file data has errors. Permission denied The OS did not allow the attempted operation. Cannot change directory Cannot change the current folder. Cannot create Cannot create a folder. Cannot rename Cannot rename a file or folder. Cannot delete Cannot delete a file or folder. I/O error Unspecified I/O error. Cannot set size Setting the file size failed. Cannot open Opening of a file failed. Cannot close Closing a file failed. Read error Reading from a file failed. Write error Writing to a file failed. Cannot seek Seek failure. Cannot execute Unable to execute the specified file."},{"location":"file-system-access/file-and-folder-supported-encoding-names/","title":"File- and Folder-supported encoding names","text":"<p>The following list of names is a basic set of encoding names supported by the File object. Some of the character encoders are built in, while the operating system is queried for most of the other encoders.</p> <p>Depending on the language packs installed, some of the encodings may not be available. Names that refer to the same encoding are listed in one line. Underlines are replaced with dashes before matching an encoding name.</p> <p>The File object processes an extended Unicode character with a value greater that 65535 as a Unicode surrogate pair (two characters in the range between 0xD700-0xDFFF).</p> <p>Built-in encodings are:</p> <pre><code>US-ASCII, ASCII, ISO646-US, ISO-646.IRV:1991, ISO-IR-6,\nANSI-X3.4-1968, CP367, IBM367, US, ISO646.1991-IRV\nUCS-2, UCS2, ISO-10646-UCS-2\nUCS2LE, UCS-2LE, ISO-10646-UCS-2LE\nUCS2BE, UCS-2BE, ISO-10646-UCS-2BE\nUCS-4, UCS4, ISO-10646-UCS-4\nUCS4LE, UCS-4LE, ISO-10646-UCS-4LE\nUCS4BE, UCS-4BE, ISO-10646-UCS-4BE\nUTF-8, UTF8, UNICODE-1-1-UTF-8, UNICODE-2-0-UTF-8, X-UNICODE-2-0-UTF-8\nUTF16, UTF-16, ISO-10646-UTF-16\nUTF16LE, UTF-16LE, ISO-10646-UTF-16LE\nUTF16BE, UTF-16BE, ISO-10646-UTF-16BE\nCP1252, WINDOWS-1252, MS-ANSI\nISO-8859-1, ISO-8859-1, ISO-8859-1:1987, ISO-IR-100, LATIN1\nMACINTOSH, X-MAC-ROMAN\nBINARY\n</code></pre> <p>The ASCII encoder raises errors for characters greater than 127, and the BINARY encoder simply converts between bytes and Unicode characters by using the lower 8 bits. The latter encoder is convenient for reading and writing binary data.</p>"},{"location":"file-system-access/file-and-folder-supported-encoding-names/#additional-encodings","title":"Additional encodings","text":"<p>In Windows, all encodings use code pages, which are assigned numeric values. The usual Western character set that Windows uses, for example, is the code page 1252. You can select Windows code pages by prepending the number of the code page with \"CP\" or \"WINDOWS\": for example, \"CP1252\" for the code page 1252. The File object has many other built-in encoding names that match predefined code page numbers. If a code page is not present, the encoding cannot be selected.</p> <p>In Mac OS, you can select encoders by name rather than by code page number. The File object queries Mac OS directly for an encoder. As far as Mac OS character sets are identical with Windows code pages, Mac OS also knows the Windows code page numbers.</p> <p>In UNIX, the number of available encoders depends on the installation of the <code>iconv</code> library.</p>"},{"location":"file-system-access/file-and-folder-supported-encoding-names/#common-encoding-names","title":"Common encoding names","text":"<p>The following encoding names are implemented both in Windows and in Mac OS:</p> <pre><code>UTF-7, UTF7, UNICODE-1-1-UTF-7, X-UNICODE-2-0-UTF-7\nISO-8859-2, ISO-8859-2, ISO-8859-2:1987, ISO-IR-101, LATIN2\nISO-8859-3, ISO-8859-3, ISO-8859-3:1988, ISO-IR-109, LATIN3\nISO-8859-4, ISO-8859-4, ISO-8859-4:1988, ISO-IR-110, LATIN4, BALTIC\nISO-8859-5, ISO-8859-5, ISO-8859-5:1988, ISO-IR-144, CYRILLIC\nISO-8859-6, ISO-8859-6, ISO-8859-6:1987, ISO-IR-127, ECMA-114, ASMO-708, ARABIC\nISO-8859-7, ISO-8859-7, ISO-8859-7:1987, ISO-IR-126, ECMA-118, ELOT-928, GREEK8, GREEK\nISO-8859-8, ISO-8859-8, ISO-8859-8:1988, ISO-IR-138, HEBREW\nISO-8859-9, ISO-8859-9, ISO-8859-9:1989, ISO-IR-148, LATIN5, TURKISH\nISO-8859-10, ISO-8859-10, ISO-8859-10:1992, ISO-IR-157, LATIN6\nISO-8859-13, ISO-8859-13, ISO-IR-179, LATIN7\nISO-8859-14, ISO-8859-14, ISO-8859-14, ISO-8859-14:1998, ISO-IR-199, LATIN8\nISO-8859-15, ISO-8859-15, ISO-8859-15:1998, ISO-IR-203\nISO-8859-16, ISO-885, ISO-885, MS-EE\nCP850, WINDOWS-850, IBM850\nCP866, WINDOWS-866, IBM866\nCP932, WINDOWS-932, SJIS, SHIFT-JIS, X-SJIS, X-MS-SJIS, MS-SJIS, MS-KANJI\nCP936, WINDOWS-936, GBK, WINDOWS-936, GB2312, GB-2312-80, ISO-IR-58, CHINESE\nCP949, WINDOWS-949, UHC, KSC-5601, KS-C-5601-1987, KS-C-5601-1989, ISO-IR-149, KOREAN\nCP950, WINDOWS-950, BIG5, BIG-5, BIG-FIVE, BIGFIVE, CN-BIG5, X-X-BIG5\nCP1251, WINDOWS-1251, MS-CYRL\nCP1252, WINDOWS-1252, MS-ANSI\nCP1253, WINDOWS-1253, MS-GREEK\nCP1254, WINDOWS-1254, MS-TURK\nCP1255, WINDOWS-1255, MS-HEBR\nCP1256, WINDOWS-1256, MS-ARAB\nCP1257, WINDOWS-1257, WINBALTRIM\nCP1258, WINDOWS-1258\nCP1361, WINDOWS-1361, JOHAB\nEUC-JP, EUCJP, X-EUC-JP\nEUC-KR, EUCKR, X-EUC-KR\nHZ, HZ-GB-2312\nX-MAC-JAPANESE\nX-MAC-GREEK\nX-MAC-CYRILLIC\nX-MAC-LATIN\nX-MAC-ICELANDIC\nX-MAC-TURKISH\n</code></pre>"},{"location":"file-system-access/file-and-folder-supported-encoding-names/#additional-windows-encoding-names","title":"Additional Windows encoding names:","text":"<pre><code>CP437, IBM850, WINDOWS-437\nCP709, WINDOWS-709, ASMO-449, BCONV4\nEBCDIC\nKOI-8R\nKOI-8U\nISO-2022-JP\nISO-2022-KR\n</code></pre>"},{"location":"file-system-access/file-and-folder-supported-encoding-names/#additional-mac-os-encoding-names","title":"Additional Mac OS encoding names","text":"<p>These names are alias names for encodings that Mac OS might know:</p> <pre><code>TIS-620, TIS620, TIS620-0, TIS620.2529-1, TIS620.2533-0, TIS620.2533-1, ISO-IR-166\nCP874, WINDOWS-874\nJP, JIS-C6220-1969-RO, ISO646-JP, ISO-IR-14\nJIS-X0201, JISX0201-1976, X0201\nJIS-X0208, JIS-X0208-1983, JIS-X0208-1990, JIS0208, X0208, ISO-IR-87\nJIS-X0212, JIS-X0212.1990-0, JIS-X0212-1990, X0212, ISO-IR-159\nCN, GB-1988-80, ISO646-CN, ISO-IR-57\nISO-IR-16, CN-GB-ISOIR165\nKSC-5601, KS-C-5601-1987, KS-C-5601-1989, ISO-IR-149\nEUC-CN, EUCCN, GB2312, CN-GB\nEUC-TW, EUCTW, X-EUC-TW\n</code></pre>"},{"location":"file-system-access/file-and-folder-supported-encoding-names/#unix-encodings","title":"UNIX encodings","text":"<p>In UNIX, the <code>File</code> object looks for the presence of the <code>iconv</code> library, and uses whatever encoding it finds there. If you need a special encoding in UNIX, make sure that there is an <code>iconv</code> encoding module installed that converts between UTF-16 (the internal format that the <code>File</code> object uses) and the desired encoding.</p>"},{"location":"file-system-access/file-object/","title":"File Object","text":"<p>Represents a file in the local file system in a platform-independent manner. All properties and methods resolve file system aliases automatically and act on the original file unless otherwise noted.</p>"},{"location":"file-system-access/file-object/#file-object-constructors","title":"File Object Constructors","text":"<pre><code>File ( [ path ] );    // Can return a Folder object\nnew File ([ path ] ); // Always returns a File object\n</code></pre> <p>To create a File object, use the File function or the new operator. The constructor accepts full or partial path names, and returns the new object.</p> <p>The CRLF sequence for the file is preset to the system default, and the encoding is preset to the default system encoding.</p> <p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>path</code></p> <p>String</p> <p>Optional. The absolute or relative path to the file associated with this object, specified in platform-specific or URI format; see Specifying paths. The value stored in the object is the absolute path.</p> <p>The path need not refer to an existing file. If not supplied, a temporary name is generated.</p> <p>If the path refers to an existing folder:</p> <ul> <li>The File function returns a Folder object instead of a File object.</li> <li>The new operator returns a File object for a nonexisting file with the same name.</li> </ul> <p>Warning</p> <p>In After Effects on MacOS, if <code>path.length</code> is more than 1002, After Effects crashes.</p> <p>This has been reported on MacOS 10.11.6 and After Effects 13.8 and 14.0.</p>"},{"location":"file-system-access/file-object/#file-class-attributes","title":"File Class Attributes","text":"<p>This property is available as a static property of the File class. It is not necessary to create an instance to access it.</p>"},{"location":"file-system-access/file-object/#filefs","title":"File.fs","text":"<p><code>File.fs</code></p>"},{"location":"file-system-access/file-object/#description","title":"Description","text":"<p>The name of the file system.</p> <p>One of:</p> <ul> <li><code>Windows</code></li> <li><code>Macintosh</code></li> <li><code>Unix</code></li> </ul>"},{"location":"file-system-access/file-object/#type","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#file-class-methods","title":"File Class Methods","text":"<p>These functions are available as static methods of the File class. It is not necessary to create an instance to call them.</p>"},{"location":"file-system-access/file-object/#filedecode","title":"File.decode()","text":"<p><code>File.decode(uri)</code></p>"},{"location":"file-system-access/file-object/#description_1","title":"Description","text":"<p>Decodes the specified string as required by RFC 2396.</p> <p>All special characters must be encoded in UTF-8 and stored as escaped characters starting with the percent sign followed by two hexadecimal digits. Special characters are those with a numeric value greater than 127, except the following:</p> <pre><code>/ - _ . ! ~ * ' ( )\n</code></pre> <p>For example, the string <code>\"my%20file\"</code> is decoded as <code>\"my&lt;br/&gt;file\"</code>.</p>"},{"location":"file-system-access/file-object/#parameters","title":"Parameters","text":"Parameter Type Description <code>uri</code> String The encoded string to decode."},{"location":"file-system-access/file-object/#returns","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/file-object/#fileencode","title":"File.encode()","text":"<p><code>File.encode(name)</code></p>"},{"location":"file-system-access/file-object/#description_2","title":"Description","text":"<p>Encodes the specified string as required by RFC 2396.</p> <p>All special characters are encoded in UTF-8 and stored as escaped characters starting with the percent sign followed by two hexadecimal digits. For example, the string \"my file\" is encoded as \"my%20file\". Special characters are those with a numeric value greater than 127, except the following:</p> <pre><code>/ - _ . ! ~ * ' ( )\n</code></pre>"},{"location":"file-system-access/file-object/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>name</code> String The string to encode."},{"location":"file-system-access/file-object/#returns_1","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/file-object/#fileisencodingavailable","title":"File.isEncodingAvailable()","text":"<p><code>File.isEncodingAvailable( name)</code></p>"},{"location":"file-system-access/file-object/#description_3","title":"Description","text":"<p>Checks whether a given encoding is available.</p>"},{"location":"file-system-access/file-object/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>name</code> String The encoding name. Typical values are <code>\"ASCII\"</code>, <code>\"binary\"</code>, or <code>\"UTF-8\"</code>. See File- and Folder-supported encoding names. <p>Boolean. <code>true</code> if your system supports the specified encoding, <code>false</code> otherwise.</p>"},{"location":"file-system-access/file-object/#fileopendialog","title":"File.openDialog()","text":"<p><code>File.openDialog([prompt=\"\", filter=\"\", multiSelect=false])</code></p>"},{"location":"file-system-access/file-object/#description_4","title":"Description","text":"<p>Opens the built-in platform-specific file-browsing dialog in which a user can select an existing file or multiple files, and creates new File objects to represent the selected files.</p>"},{"location":"file-system-access/file-object/#parameters_3","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>prompt</code></p> <p>String</p> <p>Optional. The prompt text, if the dialog allows a prompt.</p> <p><code>filter</code></p> <p>String or Function</p> <p>Optional. A filter that limits the types of files displayed in the dialog.</p> <p>In Windows, a filter expression, such as <code>\"JavaScript:*.jsx;All files:*.*\"</code></p> <p>Tip</p> <ul> <li>Separate expression with a semicolon (<code>;</code>) to filter by all these types at once; (show <code>jsx</code> AND <code>all</code>)</li> <li>Separate with a comma (<code>,</code>) to populate the filter dropdown, to select one type at a time (show <code>jsx</code> OR <code>all</code>)</li> </ul> <p>In Mac OS, a filter function that takes a File instance and returns <code>true</code> if the file should be included in the display, <code>false</code> if it should not.</p> <p><code>multiSelect</code></p> <p>Boolean</p> <p>Optional. When <code>true</code>, the user can select multiple files and the return value is an array. Default is <code>false</code>.</p>"},{"location":"file-system-access/file-object/#returns_2","title":"Returns","text":"<p>The File for the selected file, or an array of File Objects if multiple files are selected.</p> <p>If the user cancels, returns <code>null</code>.</p>"},{"location":"file-system-access/file-object/#filesavedialog","title":"File.saveDialog()","text":"<p><code>File.saveDialog(prompt[, preset=\"\"])</code></p>"},{"location":"file-system-access/file-object/#description_5","title":"Description","text":"<p>Opens the built-in platform-specific file-browsing dialog in which a user can select an existing file location to which to save information, and creates a new File object to represent the selected file location.</p>"},{"location":"file-system-access/file-object/#parameters_4","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>prompt</code></p> <p>String</p> <p>A string containing the prompt text, if the dialog allows a prompt.</p> <p><code>filter</code></p> <p>String or Function</p> <p>Optional. Windows only. A filter that limits the types of files displayed in the dialog.</p> <p>A filter expression, such as <code>\"JavaScript:*.jsx;All files:*.*\"</code></p> <p>Tip</p> <ul> <li>Separate expression with a semicolon (<code>;</code>) to filter by all these types at once; (show <code>jsx</code> AND <code>all</code>)</li> <li>Separate with a comma (<code>,</code>) to populate the filter dropdown, to select one type at a time (show <code>jsx</code> OR <code>all</code>)</li> </ul>"},{"location":"file-system-access/file-object/#returns_3","title":"Returns","text":"<p>A File for the the selected file location.</p> <p>If the user cancels, returns <code>null</code>.</p>"},{"location":"file-system-access/file-object/#file-object-attributes","title":"File Object Attributes","text":"<p>These properties are available for <code>File</code> objects.</p>"},{"location":"file-system-access/file-object/#fileabsoluteuri","title":"File.absoluteURI","text":"<p><code>fileObj.absoluteURI</code></p>"},{"location":"file-system-access/file-object/#description_6","title":"Description","text":"<p>The full path name for the referenced file in URI notation.</p>"},{"location":"file-system-access/file-object/#type_1","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#filealias","title":"File.alias","text":"<p><code>fileObj.alias</code></p>"},{"location":"file-system-access/file-object/#description_7","title":"Description","text":"<p>When <code>true</code>, the object refers to a file system alias or shortcut.</p>"},{"location":"file-system-access/file-object/#type_2","title":"Type","text":"<p>Boolean. Read only.</p>"},{"location":"file-system-access/file-object/#filecreated","title":"File.created","text":"<p><code>fileObj.created</code></p>"},{"location":"file-system-access/file-object/#description_8","title":"Description","text":"<p>The creation date of the referenced file, or <code>null</code> if the object does not refer to a file on disk.</p>"},{"location":"file-system-access/file-object/#type_3","title":"Type","text":"<p>Date. Read only.</p>"},{"location":"file-system-access/file-object/#filecreator","title":"File.creator","text":"<p><code>fileObj.creator</code></p>"},{"location":"file-system-access/file-object/#description_9","title":"Description","text":"<p>In Mac OS, the file creator as a four-character string. In Windows or UNIX, value is <code>\"????\"</code>.</p>"},{"location":"file-system-access/file-object/#type_4","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#filedisplayname","title":"File.displayName","text":"<p><code>fileObj.displayName</code></p>"},{"location":"file-system-access/file-object/#description_10","title":"Description","text":"<p>The localized name of the referenced file, without the path.</p>"},{"location":"file-system-access/file-object/#type_5","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#fileencoding","title":"File.encoding","text":"<p><code>fileObj.encoding</code></p>"},{"location":"file-system-access/file-object/#description_11","title":"Description","text":"<p>Gets or sets the encoding for subsequent read/write operations. One of the encoding constants listed in File- and Folder-supported encoding names.</p> <p>If the value is not recognized, uses the system default encoding.</p> <p>A special encoder, <code>\"BINARY\"</code>, is used to read binary files. It stores each byte of the file as one Unicode character regardless of any encoding. When writing, the lower byte of each Unicode character is treated as a single byte to write.</p>"},{"location":"file-system-access/file-object/#type_6","title":"Type","text":"<p>String</p>"},{"location":"file-system-access/file-object/#fileeof","title":"File.eof","text":"<p><code>fileObj.eof</code></p>"},{"location":"file-system-access/file-object/#description_12","title":"Description","text":"<p>When <code>true</code>, a read attempt caused the current position to be at the end of the file, or the file is not open.</p>"},{"location":"file-system-access/file-object/#type_7","title":"Type","text":"<p>Boolean. Read only.</p>"},{"location":"file-system-access/file-object/#fileerror","title":"File.error","text":"<p><code>fileObj.error</code></p>"},{"location":"file-system-access/file-object/#description_13","title":"Description","text":"<p>A message describing the last file system error; see File access error messages.</p> <p>Typically set by the file system, but a script can set it. Setting this value clears any error message and resets the error bit for opened files.</p> <p>Contains the empty string if there is no error.</p>"},{"location":"file-system-access/file-object/#type_8","title":"Type","text":"<p>String</p>"},{"location":"file-system-access/file-object/#fileexists","title":"File.exists","text":"<p><code>fileObj.exists</code></p>"},{"location":"file-system-access/file-object/#description_14","title":"Description","text":"<p>When <code>true</code>, this object refers to a file or file-system alias that actually exists in the file system.</p>"},{"location":"file-system-access/file-object/#type_9","title":"Type","text":"<p>Boolean. Read only.</p>"},{"location":"file-system-access/file-object/#filefsname","title":"File.fsName","text":"<p><code>fileObj.fsName</code></p>"},{"location":"file-system-access/file-object/#description_15","title":"Description","text":"<p>The platform-specific full path name for the referenced file.</p>"},{"location":"file-system-access/file-object/#type_10","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#filefullname","title":"File.fullName","text":"<p><code>fileObj.fullName</code></p>"},{"location":"file-system-access/file-object/#description_16","title":"Description","text":"<p>The full path name for the referenced file in URI notation.</p>"},{"location":"file-system-access/file-object/#type_11","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#filehidden","title":"File.hidden","text":"<p><code>fileObj.hidden</code></p>"},{"location":"file-system-access/file-object/#description_17","title":"Description","text":"<p>When <code>true</code>, the file is not shown in the platform-specific file browser. Read/write. If the object references a file-system alias or shortcut, the flag is altered on the alias, not on the original file.</p>"},{"location":"file-system-access/file-object/#type_12","title":"Type","text":"<p>Boolea</p>"},{"location":"file-system-access/file-object/#filelength","title":"File.length","text":"<p><code>fileObj.length</code></p>"},{"location":"file-system-access/file-object/#description_18","title":"Description","text":"<p>The size of the file in bytes. Can be set only for a file that is not open, in which case it truncates or pads the file with 0-bytes to the new length.</p>"},{"location":"file-system-access/file-object/#type_13","title":"Type","text":"<p>Number</p>"},{"location":"file-system-access/file-object/#filelinefeed","title":"File.lineFeed","text":"<p><code>fileObj.lineFeed</code></p>"},{"location":"file-system-access/file-object/#description_19","title":"Description","text":"<p>How line feed characters are written in the file system.</p> <p>One of:</p> <ul> <li><code>Windows</code> - Windows style</li> <li><code>Macintosh</code> - Mac OS style</li> <li><code>Unix</code> - UNIX style</li> </ul>"},{"location":"file-system-access/file-object/#type_14","title":"Type","text":"<p>String</p>"},{"location":"file-system-access/file-object/#filelocalizedname","title":"File.localizedName","text":"<p><code>fileObj.localizedName</code></p>"},{"location":"file-system-access/file-object/#description_20","title":"Description","text":"<p>A localized version of the file name portion of the absolute URI for the referenced file, without the path specification.</p>"},{"location":"file-system-access/file-object/#type_15","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#filemodified","title":"File.modified","text":"<p><code>fileObj.modified</code></p>"},{"location":"file-system-access/file-object/#description_21","title":"Description","text":"<p>The date of the referenced file's last modification, or null if the object does not refer to a file on disk.</p>"},{"location":"file-system-access/file-object/#type_16","title":"Type","text":"<p>Date. Read only.</p>"},{"location":"file-system-access/file-object/#filename","title":"File.name","text":"<p><code>fileObj.name</code></p>"},{"location":"file-system-access/file-object/#description_22","title":"Description","text":"<p>The file name portion of the absolute URI for the referenced file, without the path specification.</p>"},{"location":"file-system-access/file-object/#type_17","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#fileparent","title":"File.parent","text":"<p><code>fileObj.parent</code></p>"},{"location":"file-system-access/file-object/#description_23","title":"Description","text":"<p>The Folder object for the folder that contains this file.</p>"},{"location":"file-system-access/file-object/#type_18","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/file-object/#filepath","title":"File.path","text":"<p><code>fileObj.path</code></p>"},{"location":"file-system-access/file-object/#description_24","title":"Description","text":"<p>The path portion of the absolute URI for the referenced file, without the file name.</p>"},{"location":"file-system-access/file-object/#type_19","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#filereadonly","title":"File.readonly","text":"<p><code>fileObj.readonly</code></p>"},{"location":"file-system-access/file-object/#description_25","title":"Description","text":"<p>When <code>true</code>, prevents the file from being altered or deleted. If the referenced file is a file-system alias or shortcut, the flag is altered on the alias, not on the original file.</p>"},{"location":"file-system-access/file-object/#type_20","title":"Type","text":"<p>Boolean</p>"},{"location":"file-system-access/file-object/#filerelativeuri","title":"File.relativeURI","text":"<p><code>fileObj.relativeURI</code></p>"},{"location":"file-system-access/file-object/#description_26","title":"Description","text":"<p>The path name for the referenced file in URI notation, relative to the current folder.</p>"},{"location":"file-system-access/file-object/#type_21","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#filetype","title":"File.type","text":"<p><code>fileObj.type</code></p>"},{"location":"file-system-access/file-object/#description_27","title":"Description","text":"<p>The file type as a four-character string.</p> <ul> <li>In Mac OS, the Mac OS file type.</li> <li> <ul> <li>In Windows, <code>\"appl\"</code> for <code>.EXE</code> files, <code>\"shlb\"</code> for <code>.DLL</code> files and <code>\"TEXT\"</code> for any other file.</li> </ul> </li> </ul> <p>If the file does not exist, the value is <code>\"????\"</code>.</p>"},{"location":"file-system-access/file-object/#type_22","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/file-object/#file-object-methods","title":"File Object Methods","text":"<p>These functions are available for File objects.</p>"},{"location":"file-system-access/file-object/#filechangepath","title":"File.changePath()","text":"<p><code>fileObj.changePath(path)</code></p>"},{"location":"file-system-access/file-object/#description_28","title":"Description","text":"<p>Changes the path specification of the referenced file.</p>"},{"location":"file-system-access/file-object/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>path</code> String The new path, absolute or relative to the current folder."},{"location":"file-system-access/file-object/#returns_4","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"file-system-access/file-object/#fileclose","title":"File.close()","text":"<p><code>fileObj.close()</code></p>"},{"location":"file-system-access/file-object/#description_29","title":"Description","text":"<p>Closes this open file.</p>"},{"location":"file-system-access/file-object/#returns_5","title":"Returns","text":"<p>Boolean. <code>true</code> on success, <code>false</code> if there are I/O errors.</p>"},{"location":"file-system-access/file-object/#filecopy","title":"File.copy()","text":"<p><code>fileObj.copy(target)</code></p>"},{"location":"file-system-access/file-object/#description_30","title":"Description","text":"<p>Copies this object's referenced file to the specified target location.</p> <p>Resolves any aliases to find the source file. If a file exists at the target location, it is overwritten.</p>"},{"location":"file-system-access/file-object/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>target</code> String or File object The URI path to the target location, or a File that references the target location."},{"location":"file-system-access/file-object/#returns_6","title":"Returns","text":"<p>Boolean. <code>true</code> if the copy was successful, <code>false</code> otherwise.</p>"},{"location":"file-system-access/file-object/#filecreatealias","title":"File.createAlias()","text":"<p><code>fileObj.createAlias( [path])</code></p>"},{"location":"file-system-access/file-object/#description_31","title":"Description","text":"<p>Makes this file a file-system alias or shortcut to the specified file. The referenced file for this object must not yet exist on disk.</p>"},{"location":"file-system-access/file-object/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>path</code> String The path of the target file."},{"location":"file-system-access/file-object/#returns_7","title":"Returns","text":"<p>Boolean. <code>true</code> if the operation was successful, <code>false</code> otherwise.</p>"},{"location":"file-system-access/file-object/#fileexecute","title":"File.execute()","text":"<p><code>fileObj.execute()</code></p>"},{"location":"file-system-access/file-object/#description_32","title":"Description","text":"<p>Opens this file using the appropriate application, as if it had been double-clicked in a file browser.</p> <p>You can use this method to run scripts, launch applications, and so on.</p>"},{"location":"file-system-access/file-object/#returns_8","title":"Returns","text":"<p>Boolean. <code>true</code> immediately if the application launch was successful.</p>"},{"location":"file-system-access/file-object/#filegetrelativeuri","title":"File.getRelativeURI()","text":"<p><code>fileObj.getRelativeURI([basePath])</code></p>"},{"location":"file-system-access/file-object/#description_33","title":"Description","text":"<p>Retrieves the URI for this file, relative to the specified base path, in URI notation. If no base path is supplied, the URI is relative to the path of the current folder.</p>"},{"location":"file-system-access/file-object/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>basePath</code> String Optional. A string containing the base path for the relative URI. Default is the current folder."},{"location":"file-system-access/file-object/#returns_9","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/file-object/#fileopen","title":"File.open()","text":"<p><code>fileObj.open(mode[, type][, creator])</code></p>"},{"location":"file-system-access/file-object/#description_34","title":"Description","text":"<p>Opens the referenced file for subsequent read/write operations. The method resolves any aliases to find the file.</p> <p>The method attempts to detect the encoding of the open file. It reads a few bytes at the current location and tries to detect the Byte Order Mark character 0xFFFE. If found, the current position is advanced behind the detected character and the encoding property is set to one of the strings UCS-2BE, UCS-2LE, UCS4-BE, UCS-4LE, or UTF-8. If the marker character is not found, it checks for zero bytes at the current location and makes an assumption about one of the above formats (except UTF-8). If everything fails, the encoding property is set to the system encoding.</p> <p>Warning</p> <p>Be careful about opening a file more than once. The operating system usually permits you to do so, but if you start writing to the file using two different File objects, you can destroy your data.</p>"},{"location":"file-system-access/file-object/#parameters_9","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>mode</code></p> <p>String</p> <p>A string indicating the read/write mode. One of:</p> <ul> <li><code>r</code>: (read) Opens for reading. If the file does not exist or cannot be found, the call fails.</li> <li><code>w</code>: (write) Opens a file for writing. If the file exists, its contents are destroyed. If the file does not exist, creates a new, empty file.</li> <li><code>e</code>: (edit) Opens an existing file for reading and writing.</li> <li><code>a</code>: (append) Opens the file in Append mode, and moves the current position to the end of the file.</li> </ul> <p><code>type</code></p> <p>String</p> <p>Optional. In Mac OS, the type of a newly created file, a 4-character string. Ignored in Windows and UNIX.</p> <p><code>creator</code></p> <p>String</p> <p>Optional. In Mac OS, the creator of a newly created file, a 4-character string. Ignored in Windows and UNIX.</p>"},{"location":"file-system-access/file-object/#returns_10","title":"Returns","text":"<p>Boolean. <code>true</code> if the file has been opened successfully, <code>false</code> otherwise.</p>"},{"location":"file-system-access/file-object/#fileopendlg","title":"File.openDlg()","text":"<p><code>fileObj.openDlg([prompt=\"\"][, filter=\"\"][, multiSelect=false])</code></p>"},{"location":"file-system-access/file-object/#description_35","title":"Description","text":"<p>Opens the built-in platform-specific file-browsing dialog, in which the user can select an existing file or files, and creates new File objects to represent the selected files. Differs from the class method openDialog() in that it presets the current folder to this File object's parent folder and the current file to this object's associated file.</p>"},{"location":"file-system-access/file-object/#parameters_10","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>prompt</code></p> <p>String</p> <p>Optional. The prompt text, if the dialog allows a prompt.</p> <p><code>filter</code></p> <p>String or Function</p> <p>Optional. A filter that limits the types of files displayed in the dialog.</p> <p>In Windows, a filter expression, such as <code>\"JavaScript:*.jsx;All files:*.*\"</code></p> <p>Tip</p> <ul> <li>Separate expression with a semicolon (<code>;</code>) to filter by all these types at once; (show <code>jsx</code> AND <code>all</code>)</li> <li>Separate with a comma (<code>,</code>) to populate the filter dropdown, to select one type at a time (show <code>jsx</code> OR <code>all</code>)</li> </ul> <p>In Mac OS, a filter function that takes a File instance and returns <code>true</code> if the file should be included in the display, <code>false</code> if it should not.</p> <p><code>multiSelect</code></p> <p>Boolean.</p> <p>Optional. When <code>true</code>, the user can select multiple files and the return value is an array. Default is <code>false</code>.</p>"},{"location":"file-system-access/file-object/#returns_11","title":"Returns","text":"<p>If the user clicks OK, returns a File or Folder object for the selected file or folder, or an array of objects.</p> <p>If the user cancels, returns <code>null</code>.</p>"},{"location":"file-system-access/file-object/#fileread","title":"File.read()","text":"<p><code>fileObj.read([chars])</code></p>"},{"location":"file-system-access/file-object/#description_36","title":"Description","text":"<p>Reads the contents of the file starting at the current position.</p> <p>Returns a string that contains up to the specified number of characters.</p>"},{"location":"file-system-access/file-object/#parameters_11","title":"Parameters","text":"Parameter Type Description <code>chars</code> Number Optional. An integer specifying the number of characters to read. By default, reads from the current position to the end of the file. If the file is encoded, multiple bytes might be read to create single Unicode characters."},{"location":"file-system-access/file-object/#returns_12","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/file-object/#filereadch","title":"File.readch()","text":"<p><code>fileObj.readch()</code></p>"},{"location":"file-system-access/file-object/#description_37","title":"Description","text":"<p>Reads a single text character from the file at the current position. Line feeds are recognized as CR, LF, CRLF, or LFCR pairs. If the file is encoded, multiple bytes might be read to create single Unicode characters.</p> <p>Returns a string that contains the character.</p>"},{"location":"file-system-access/file-object/#returns_13","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/file-object/#filereadln","title":"File.readln()","text":"<p><code>fileObj.readln()</code></p>"},{"location":"file-system-access/file-object/#description_38","title":"Description","text":"<p>Reads a single line of text from the file at the current position, and returns it in a string. Line feeds are recognized as CR, LF, CRLF, or LFCR pairs. If the file is encoded, multiple bytes might be read to create single Unicode characters.</p> <p>Returns a string that contains the text.</p>"},{"location":"file-system-access/file-object/#returns_14","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/file-object/#fileremove","title":"File.remove()","text":"<p><code>fileObj.remove()</code></p>"},{"location":"file-system-access/file-object/#description_39","title":"Description","text":"<p>Deletes the file associated with this object from disk, immediately, without moving it to the system trash.</p> <p>Does not resolve aliases; instead, deletes the referenced alias or shortcut file itself.</p> <p>Warning</p> <p>Cannot be undone. It is recommended that you prompt the user for permission before deleting.</p>"},{"location":"file-system-access/file-object/#returns_15","title":"Returns","text":"<p>Boolean. <code>true</code> if the file is deleted successfully.</p>"},{"location":"file-system-access/file-object/#filerename","title":"File.rename()","text":"<p><code>fileObj.rename(newName)</code></p>"},{"location":"file-system-access/file-object/#description_40","title":"Description","text":"<p>Renames the associated file.</p> <p>Does not resolve aliases, but renames the referenced alias or shortcut file itself.</p>"},{"location":"file-system-access/file-object/#parameters_12","title":"Parameters","text":"Parameter Type Description <code>newName</code> String The new file name, with no path."},{"location":"file-system-access/file-object/#returns_16","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"file-system-access/file-object/#fileresolve","title":"File.resolve()","text":"<p><code>fileObj.resolve()</code></p>"},{"location":"file-system-access/file-object/#description_41","title":"Description","text":"<p>If this object references an alias or shortcut, this method resolves that alias and returns a new File object that references the file-system element to which the alias resolves.</p>"},{"location":"file-system-access/file-object/#returns_17","title":"Returns","text":"<p>The new File object, or <code>null</code> if this object does not reference an alias, or if the alias cannot be resolved.</p>"},{"location":"file-system-access/file-object/#filesavedlg","title":"File.saveDlg()","text":"<p><code>fileObj.saveDlg([prompt=\"\"][, preset=\"\"])</code></p>"},{"location":"file-system-access/file-object/#description_42","title":"Description","text":"<p>Opens the built-in platform-specific file-browsing dialog, in which the user can select an existing file location to which to save information, and creates a new File object to represent the selected file.</p> <p>Differs from the class method saveDialog() in that it presets the current folder to this File object's parent folder and the file to this object's associated file.</p>"},{"location":"file-system-access/file-object/#parameters_13","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>prompt</code></p> <p>String</p> <p>Optional. The prompt text, if the dialog allows a prompt.</p> <p><code>filter</code></p> <p>String or Function</p> <p>Optional. A filter that limits the types of files displayed in the dialog.</p> <p>In Windows, a filter expression, such as <code>\"JavaScript:*.jsx;All files:*.*\"</code></p> <p>Tip</p> <ul> <li>Separate expression with a semicolon (<code>;</code>) to filter by all these types at once; (show <code>jsx</code> AND <code>all</code>)</li> <li>Separate with a comma (<code>,</code>) to populate the filter dropdown, to select one type at a time (show <code>jsx</code> OR <code>all</code>)</li> </ul> <p>Not used in MacOS</p>"},{"location":"file-system-access/file-object/#returns_18","title":"Returns","text":"<p>The File object for the selected file.</p> <p>If the user cancels, returns <code>null</code>.</p>"},{"location":"file-system-access/file-object/#fileseek","title":"File.seek()","text":"<p><code>fileObj.seek(pos[, mode=0])</code></p>"},{"location":"file-system-access/file-object/#description_43","title":"Description","text":"<p>Seeks to the specified position in the file. The new position cannot be less than 0 or greater than the current file size.</p>"},{"location":"file-system-access/file-object/#parameters_14","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>pos</code></p> <p>Number</p> <p>The new current position in the file as an offset in bytes from the start, current position, or end, depending on the mode.</p> <p><code>mode</code></p> <p>Number</p> <p>Optional. The seek mode, one of:</p> <ul> <li><code>0</code>: Seek to absolute position, where pos=0 is the first byte of the file. This is the default.</li> <li><code>1</code>: Seek relative to the current position.</li> <li><code>2</code>: Seek backward from the end of the file.</li> </ul>"},{"location":"file-system-access/file-object/#returns_19","title":"Returns","text":"<p>Boolean. <code>true</code> if the position was changed.</p>"},{"location":"file-system-access/file-object/#filetell","title":"File.tell()","text":"<p><code>fileObj.tell()</code></p>"},{"location":"file-system-access/file-object/#description_44","title":"Description","text":"<p>Retrieves the current position index as a byte offset from the start of the file.</p>"},{"location":"file-system-access/file-object/#returns_20","title":"Returns","text":"<p>Number</p>"},{"location":"file-system-access/file-object/#filewrite","title":"File.write()","text":"<p><code>fileObj.write( text[, text...]...)</code></p>"},{"location":"file-system-access/file-object/#description_45","title":"Description","text":"<p>Writes the specified text to the file at the current position. For encoded files, writing a single Unicode character may write multiple bytes.</p> <p>Warning</p> <p>Be careful not to write to a file that is open in another application or object, as this can overwrite existing data.</p>"},{"location":"file-system-access/file-object/#parameters_15","title":"Parameters","text":"Parameter Type Description <code>text</code> String One or more strings to write, which are concatenated to form a single string."},{"location":"file-system-access/file-object/#returns_21","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"file-system-access/file-object/#filewriteln","title":"File.writeln()","text":"<p><code>fileObj.writeln (text[, text...]...)</code></p>"},{"location":"file-system-access/file-object/#description_46","title":"Description","text":"<p>Writes the specified text to the file at the current position, and appends a Line Feed sequence in the style specified by the linefeed property.For encoded files, writing a single Unicode character may write multiple bytes.</p> <p>Warning</p> <p>Be careful not to write to a file that is open in another application or object, as this can overwrite existing data.</p>"},{"location":"file-system-access/file-object/#parameters_16","title":"Parameters","text":"Parameter Type Description <code>text</code> String One or more strings to write, which are concatenated to form a single string."},{"location":"file-system-access/file-object/#returns_22","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"file-system-access/folder-object/","title":"Folder Object","text":"<p>Represents a file-system folder or directory in a platform-independent manner. All properties and methods resolve file system aliases automatically and act on the original file unless otherwise noted.</p>"},{"location":"file-system-access/folder-object/#folder-object-constructors","title":"Folder Object Constructors","text":"<pre><code>Folder( [path] ); // Can return a File object\nnew Folder( [path] ); // Always returns a Folder object\n</code></pre> <p>To create a Folder object, use the Folder function or the new operator. The constructor accepts full or partial path names, and returns the new object.</p> <p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>path</code></p> <p>String</p> <p>Optional. The absolute or relative path to the Folder associated with this object, specified in platform-specific or URI format; see Specifying paths. The value stored in the object is the absolute path.</p> <p>The path need not refer to an existing Folder. If not supplied, a temporary name is generated.</p> <p>If the path refers to an existing file:</p> <ul> <li>The Folder function returns a File object instead of a File object.</li> <li>The new operator returns a Folder object for a nonexisting folder with the same name.</li> </ul> <p>Warning</p> <p>In After Effects on MacOS, if <code>path.length</code> is more than 1002, After Effects crashes.</p> <p>This has been reported on MacOS 10.11.6 and After Effects 13.8 and 14.0.</p>"},{"location":"file-system-access/folder-object/#folder-class-attributes","title":"Folder Class Attributes","text":"<p>These properties are available as static properties of the Folder class. It is not necessary to create an instance to access them.</p>"},{"location":"file-system-access/folder-object/#folderappdata","title":"Folder.appData","text":"<p><code>Folder.appData</code></p>"},{"location":"file-system-access/folder-object/#description","title":"Description","text":"<p>A Folder object for the folder that contains application data for all users.</p> <ul> <li>In Windows, the value of <code>%PROGRAMDATA%</code> (by default, <code>C:\\ProgramData</code>)</li> <li>In Mac OS, <code>/Library/Application Support</code></li> </ul>"},{"location":"file-system-access/folder-object/#type","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#folderapppackage","title":"Folder.appPackage","text":"<p><code>Folder.appPackage</code></p>"},{"location":"file-system-access/folder-object/#description_1","title":"Description","text":"<p>The Folder object for the folder that contains the bundle of the running application.</p> <ul> <li>In Windows, for example: <code>C:\\Program Files (x86)\\Adobe\\Adobe ExtendScript Toolkit CC\\</code></li> <li>In Mac OS, for example: <code>/Applications/Adobe ExtendScript Toolkit CC/ExtendScript Toolkit.app</code></li> </ul>"},{"location":"file-system-access/folder-object/#type_1","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#foldercommonfiles","title":"Folder.commonFiles","text":"<p><code>Folder.commonFiles</code></p>"},{"location":"file-system-access/folder-object/#description_2","title":"Description","text":"<p>A Folder object for the folder that contains files common to all programs.</p> <ul> <li>In Windows, the value of <code>%CommonProgramFiles%</code> (by default, <code>C:\\Program Files\\Common Files</code>)</li> <li>In Mac OS, <code>/Library/Application Support</code></li> </ul>"},{"location":"file-system-access/folder-object/#type_2","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#foldercurrent","title":"Folder.current","text":"<p><code>Folder.current</code></p>"},{"location":"file-system-access/folder-object/#description_3","title":"Description","text":"<p>A Folder object for the current folder. Assign either a Folder object or a string containing the new path name to set the current folder.</p>"},{"location":"file-system-access/folder-object/#type_3","title":"Type","text":"<p>Folder</p>"},{"location":"file-system-access/folder-object/#folderdesktop","title":"Folder.desktop","text":"<p><code>Folder.desktop</code></p>"},{"location":"file-system-access/folder-object/#description_4","title":"Description","text":"<p>A Folder object for the folder that contains the user's desktop.</p> <ul> <li>In Windows, <code>C:\\Users\\[username]\\Desktop</code></li> <li>In Mac OS, <code>~/Desktop</code></li> </ul>"},{"location":"file-system-access/folder-object/#type_4","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#folderfs","title":"Folder.fs","text":"<p><code>Folder.fs</code></p>"},{"location":"file-system-access/folder-object/#description_5","title":"Description","text":"<p>The name of the file system.</p> <p>One of:</p> <ul> <li><code>Windows</code>,</li> <li><code>Macintosh</code>, or</li> <li><code>Unix</code></li> </ul>"},{"location":"file-system-access/folder-object/#type_5","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#foldermydocuments","title":"Folder.myDocuments","text":"<p><code>Folder.myDocuments</code></p>"},{"location":"file-system-access/folder-object/#description_6","title":"Description","text":"<p>A Folder object for the user's default document folder.</p> <ul> <li>In Windows, <code>C:\\Users\\[username]\\Documents</code></li> <li>In Mac OS, <code>~/Documents</code></li> </ul>"},{"location":"file-system-access/folder-object/#type_6","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#folderstartup","title":"Folder.startup","text":"<p><code>Folder.startup</code></p>"},{"location":"file-system-access/folder-object/#description_7","title":"Description","text":"<p>A Folder object for the folder containing the executable image of the running application.</p>"},{"location":"file-system-access/folder-object/#type_7","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#foldersystem","title":"Folder.system","text":"<p><code>Folder.system</code></p>"},{"location":"file-system-access/folder-object/#description_8","title":"Description","text":"<p>A Folder object for the folder containing the operating system files.</p> <ul> <li>In Windows, the value of <code>%windir%</code> (by default, <code>C:\\Windows</code>)</li> <li>In Mac OS, <code>/System</code></li> </ul>"},{"location":"file-system-access/folder-object/#type_8","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#foldertemp","title":"Folder.temp","text":"<p><code>Folder.temp</code></p>"},{"location":"file-system-access/folder-object/#description_9","title":"Description","text":"<p>A Folder object for the default folder for temporary files.</p>"},{"location":"file-system-access/folder-object/#type_9","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#foldertrash","title":"Folder.trash","text":"<p><code>Folder.trash</code></p>"},{"location":"file-system-access/folder-object/#description_10","title":"Description","text":"<ul> <li>In Mac OS, a Folder object for the folder containing deleted items.</li> <li>In Windows, where the Recycle Bin is a database rather than a folder, value is <code>null</code>.</li> </ul>"},{"location":"file-system-access/folder-object/#type_10","title":"Type","text":"<p>Folder or <code>null</code>. Read only.</p>"},{"location":"file-system-access/folder-object/#folderuserdata","title":"Folder.userData","text":"<p><code>Folder.userData</code></p>"},{"location":"file-system-access/folder-object/#description_11","title":"Description","text":"<p>A Folder object for the folder that contains application data for the current user.</p> <ul> <li>In Windows, the value of %APPDATA% (by default, <code>C:\\Users\\[username]\\Appdata\\Roaming</code>)</li> <li>In Mac OS, <code>~/Library/Application Support</code></li> </ul>"},{"location":"file-system-access/folder-object/#type_11","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#folder-class-methods","title":"Folder Class Methods","text":"<p>These functions are available as a static methods of the Folder class. It is not necessary to create an instance in order to call them.</p>"},{"location":"file-system-access/folder-object/#folderdecode","title":"Folder.decode()","text":"<p><code>Folder.decode(uri)</code></p>"},{"location":"file-system-access/folder-object/#description_12","title":"Description","text":"<p>Decodes the specified string as required by RFC 2396.</p> <p>All special characters must be encoded in UTF-8 and stored as escaped characters starting with the percent sign followed by two hexadecimal digits. For example, the string <code>\"my%20file\"</code> is decoded as <code>\"my file\"</code>. Special characters are those with a numeric value greater than 127, except the following:</p> <pre><code>``/ - _ . ! ~ * ' ( )``\n</code></pre>"},{"location":"file-system-access/folder-object/#parameters","title":"Parameters","text":"Parameter Type Description <code>uri</code> String The encoded string to decode."},{"location":"file-system-access/folder-object/#returns","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/folder-object/#folderencode","title":"Folder.encode()","text":"<p><code>Folder.encode(name)</code></p>"},{"location":"file-system-access/folder-object/#description_13","title":"Description","text":"<p>Encodes the specified string as required by RFC 2396.</p> <p>All special characters must be encoded in UTF-8 and stored as escaped characters starting with the percent sign followed by two hexadecimal digits. For example, the string <code>\"my%20file\"</code> is decoded as <code>\"my file\"</code>. Special characters are those with a numeric value greater than 127, except the following:</p> <pre><code>``/ - _ . ! ~ * ' ( )``\n</code></pre>"},{"location":"file-system-access/folder-object/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>name</code> String The string to encode."},{"location":"file-system-access/folder-object/#returns_1","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/folder-object/#folderisencodingavailable","title":"Folder.isEncodingAvailable()","text":"<p><code>Folder.isEncodingAvailable(name)</code></p>"},{"location":"file-system-access/folder-object/#description_14","title":"Description","text":"<p>Checks whether a given encoding is available.</p>"},{"location":"file-system-access/folder-object/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>name</code> String The encoding name. Typical values are <code>\"ASCII\"</code>, <code>\"binary\"</code>, or <code>\"UTF-8\"</code>. See File- and Folder-supported encoding names."},{"location":"file-system-access/folder-object/#returns_2","title":"Returns","text":"<p>Boolean. <code>true</code> if your system supports the specified encoding, <code>false</code> otherwise.</p>"},{"location":"file-system-access/folder-object/#folderselectdialog","title":"Folder.selectDialog()","text":"<p><code>Folder.selectDialog([prompt])</code></p>"},{"location":"file-system-access/folder-object/#description_15","title":"Description","text":"<p>Opens the built-in platform-specific file-browsing dialog, and creates a new File or Folder object for the selected file or folder. Differs from the object method selectDlg() in that it does not preselect a folder.</p>"},{"location":"file-system-access/folder-object/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>prompt</code> String Optional. The prompt text, if the dialog allows a prompt."},{"location":"file-system-access/folder-object/#returns_3","title":"Returns","text":"<p>If the user clicks <code>OK</code>, returns a File or Folder object for the selected file or folder.</p> <p>If the user cancels, returns <code>null</code>.</p>"},{"location":"file-system-access/folder-object/#folder-object-attributes","title":"Folder Object Attributes","text":"<p>These properties are available for Folder objects.</p>"},{"location":"file-system-access/folder-object/#folderabsoluteuri","title":"Folder.absoluteURI","text":"<p><code>folderObj.absoluteURI</code></p>"},{"location":"file-system-access/folder-object/#description_16","title":"Description","text":"<p>The full path name for the referenced folder in URI notation.</p>"},{"location":"file-system-access/folder-object/#type_12","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#folderalias","title":"Folder.alias","text":"<p><code>folderObj.alias</code></p>"},{"location":"file-system-access/folder-object/#description_17","title":"Description","text":"<p>When <code>true</code>, the object refers to a file system alias or shortcut.</p>"},{"location":"file-system-access/folder-object/#type_13","title":"Type","text":"<p>Boolean. Read only.</p>"},{"location":"file-system-access/folder-object/#foldercreated","title":"Folder.created","text":"<p><code>folderObj.created</code></p>"},{"location":"file-system-access/folder-object/#description_18","title":"Description","text":"<p>The creation date of the referenced folder, or null if the object does not refer to a folder on disk.</p>"},{"location":"file-system-access/folder-object/#type_14","title":"Type","text":"<p>Date. Read only.</p>"},{"location":"file-system-access/folder-object/#folderdisplayname","title":"Folder.displayName","text":"<p><code>folderObj.displayName</code></p>"},{"location":"file-system-access/folder-object/#description_19","title":"Description","text":"<p>The localized name of the referenced folder, without the path.</p>"},{"location":"file-system-access/folder-object/#type_15","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#foldererror","title":"Folder.error","text":"<p><code>folderObj.error</code></p>"},{"location":"file-system-access/folder-object/#description_20","title":"Description","text":"<p>A message describing the most recent file system error; see File access error messages.</p> <p>Typically set by the file system, but a script can set it. Setting this value clears any error message and resets the error bit for opened files. Contains the empty string if there is no error.</p>"},{"location":"file-system-access/folder-object/#type_16","title":"Type","text":"<p>String</p>"},{"location":"file-system-access/folder-object/#folderexists","title":"Folder.exists","text":"<p><code>folderObj.exists</code></p>"},{"location":"file-system-access/folder-object/#description_21","title":"Description","text":"<p>When <code>true</code>, this object refers to a folder that currently exists in the file system.</p>"},{"location":"file-system-access/folder-object/#type_17","title":"Type","text":"<p>Boolean. Read only.</p>"},{"location":"file-system-access/folder-object/#folderfsname","title":"Folder.fsName","text":"<p><code>folderObj.fsName</code></p>"},{"location":"file-system-access/folder-object/#description_22","title":"Description","text":"<p>The platform-specific name of the referenced folder as a full path name.</p>"},{"location":"file-system-access/folder-object/#type_18","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#folderfullname","title":"Folder.fullName","text":"<p><code>folderObj.fullName</code></p>"},{"location":"file-system-access/folder-object/#description_23","title":"Description","text":"<p>The full path name for the referenced folder in URI notation.</p>"},{"location":"file-system-access/folder-object/#type_19","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#folderlocalizedname","title":"Folder.localizedName","text":"<p><code>folderObj.localizedName</code></p>"},{"location":"file-system-access/folder-object/#description_24","title":"Description","text":"<p>A localized version of the folder name portion of the absolute URI for the referenced file, without the path specification.</p>"},{"location":"file-system-access/folder-object/#type_20","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#foldermodified","title":"Folder.modified","text":"<p><code>folderObj.modified</code></p>"},{"location":"file-system-access/folder-object/#description_25","title":"Description","text":"<p>The date of the referenced folder's last modification, or <code>null</code> if the object does not refer to a folder on disk.</p>"},{"location":"file-system-access/folder-object/#type_21","title":"Type","text":"<p>Date. Read only.</p>"},{"location":"file-system-access/folder-object/#foldername","title":"Folder.name","text":"<p><code>folderObj.name</code></p>"},{"location":"file-system-access/folder-object/#description_26","title":"Description","text":"<p>The folder name portion of the absolute URI for the referenced file, without the path specification.</p>"},{"location":"file-system-access/folder-object/#type_22","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#folderparent","title":"Folder.parent","text":"<p><code>folderObj.parent</code></p>"},{"location":"file-system-access/folder-object/#description_27","title":"Description","text":"<p>The Folder object for the folder that contains this folder, or <code>null</code> if this object refers to the root folder of a volume.</p>"},{"location":"file-system-access/folder-object/#type_23","title":"Type","text":"<p>Folder. Read only.</p>"},{"location":"file-system-access/folder-object/#folderpath","title":"Folder.path","text":"<p><code>folderObj.path</code></p>"},{"location":"file-system-access/folder-object/#description_28","title":"Description","text":"<p>The path portion of the absolute URI for the referenced folder, without the folder name.</p>"},{"location":"file-system-access/folder-object/#type_24","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#folderrelativeuri","title":"Folder.relativeURI","text":"<p><code>folderObj.relativeURI</code></p>"},{"location":"file-system-access/folder-object/#description_29","title":"Description","text":"<p>The path name for the referenced folder in URI notation, relative to the current folder.</p>"},{"location":"file-system-access/folder-object/#type_25","title":"Type","text":"<p>String. Read only.</p>"},{"location":"file-system-access/folder-object/#folder-object-methods","title":"Folder Object Methods","text":"<p>These functions are available for Folder objects.</p>"},{"location":"file-system-access/folder-object/#folderchangepath","title":"Folder.changePath()","text":"<p><code>folderObj.changePath(path)</code></p>"},{"location":"file-system-access/folder-object/#description_30","title":"Description","text":""},{"location":"file-system-access/folder-object/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>path</code> String The new path, absolute or relative to the current parent folder. <p>Changes the path specification of the referenced folder.</p>"},{"location":"file-system-access/folder-object/#returns_4","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"file-system-access/folder-object/#foldercreate","title":"Folder.create()","text":"<p><code>folderObj.create()</code></p>"},{"location":"file-system-access/folder-object/#description_31","title":"Description","text":"<p>Creates a folder at the location given by this object's path property.</p>"},{"location":"file-system-access/folder-object/#returns_5","title":"Returns","text":"<p>Boolean. <code>true</code> if the folder was created successfully.</p>"},{"location":"file-system-access/folder-object/#folderexecute","title":"Folder.execute()","text":"<p><code>folderObj.execute()</code></p>"},{"location":"file-system-access/folder-object/#description_32","title":"Description","text":"<p>Opens this folder in the platform-specific file browser (as if it had been double-clicked in the file browser).</p>"},{"location":"file-system-access/folder-object/#returns_6","title":"Returns","text":"<p>Boolean. <code>true</code> immediately if the folder was opened successfully.</p>"},{"location":"file-system-access/folder-object/#foldergetfiles","title":"Folder.getFiles()","text":"<p><code>folderObj.getFiles([mask])</code></p>"},{"location":"file-system-access/folder-object/#description_33","title":"Description","text":"<p>Retrieves the contents of this folder, filtered by the supplied mask.</p>"},{"location":"file-system-access/folder-object/#parameters_5","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>mask</code></p> <p>String or Function</p> <p>Optional. A search mask for file names.</p> <p>A string that can contain question mark (<code>?</code>) and asterisk (<code>*</code>) wild cards. Default is \"<code>*</code>\", which matches all file names.</p> <p>Can also be the name of a function that takes a File or Folder object as its argument.</p> <p>It is called for each file or folder found in the search; if it returns <code>true</code>, the object is added to the return array.</p> <p>Note</p> <p>In Windows, all aliases end with the extension <code>.lnk</code>; ExtendScript strips this from the file name when found, in order to preserve compatibility with other operating systems. You can search for all aliases by supplying the search mask <code>\"*.lnk\"</code>, but note that such code is not portable.</p>"},{"location":"file-system-access/folder-object/#returns_7","title":"Returns","text":"<p>Returns an array of File and Folder objects, or <code>null</code> if this object's referenced folder does not exist.</p>"},{"location":"file-system-access/folder-object/#foldergetrelativeuri","title":"Folder.getRelativeURI()","text":"<p><code>folderObj.getRelativeURI([basePath])</code></p>"},{"location":"file-system-access/folder-object/#description_34","title":"Description","text":"<p>Retrieves the path for this folder relative to the specified base path or the current folder, in URI notation.</p>"},{"location":"file-system-access/folder-object/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>basePath</code> String Optional. The base path for the relative URI. Default is the current folder."},{"location":"file-system-access/folder-object/#returns_8","title":"Returns","text":"<p>String</p>"},{"location":"file-system-access/folder-object/#folderremove","title":"Folder.remove()","text":"<p><code>folderObj.remove()</code></p>"},{"location":"file-system-access/folder-object/#description_35","title":"Description","text":"<p>Deletes the empty folder associated with this object from disk, immediately, without moving it to the system trash.</p> <p>Folders must be empty before they can be deleted. Does not resolve aliases; instead, deletes the referenced alias or shortcut file itself.</p> <p>Note</p> <p>Cannot be undone. It is recommended that you prompt the user for permission before deleting.</p>"},{"location":"file-system-access/folder-object/#returns_9","title":"Returns","text":"<p>Boolean. <code>true</code> if the folder is deleted successfully.</p>"},{"location":"file-system-access/folder-object/#folderrename","title":"Folder.rename()","text":"<p><code>folderObj.rename(newName)</code></p>"},{"location":"file-system-access/folder-object/#description_36","title":"Description","text":""},{"location":"file-system-access/folder-object/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>newName</code> String The new folder name, with no path. <p>Renames the associated folder. Does not resolve aliases; instead, renames the referenced alias or shortcut file itself.</p>"},{"location":"file-system-access/folder-object/#returns_10","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"file-system-access/folder-object/#folderresolve","title":"Folder.resolve()","text":"<p><code>folderObj.resolve()</code></p>"},{"location":"file-system-access/folder-object/#description_37","title":"Description","text":"<p>If this object references an alias or shortcut, this method resolves that alias</p>"},{"location":"file-system-access/folder-object/#returns_11","title":"Returns","text":"<p>A new Folder object that references the file-system element to which the alias resolves, or <code>null</code> if this object does not reference an alias, or if the alias cannot be resolved.</p>"},{"location":"file-system-access/folder-object/#folderselectdlg","title":"Folder.selectDlg()","text":"<p><code>folderObj.selectDlg(prompt)</code></p>"},{"location":"file-system-access/folder-object/#description_38","title":"Description","text":"<p>Opens the built-in platform-specific file-browsing dialog, and creates a new File or Folder object for the selected file or folder.</p> <p>Differs from the class method <code>selectDialog()</code> in that it preselects this folder.</p>"},{"location":"file-system-access/folder-object/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>prompt</code> String The prompt text, if the dialog allows a prompt."},{"location":"file-system-access/folder-object/#returns_12","title":"Returns","text":"<p>If the user clicks <code>OK</code>, returns a File or Folder object for the selected file or folder.</p> <p>If the user cancels, returns <code>null</code>.</p>"},{"location":"file-system-access/using-file-and-folder-objects/","title":"Using File and Folder objects","text":"<p>Because path name syntax is very different on Windows, Mac OS, and UNIX\u00ae, Adobe ExendScript defines the <code>File</code> and <code>Folder</code> objects to provide platform-independent access to the underlying file system. A File object represents a disk file, a Folder object represents a directory or folder.</p> <ul> <li>The <code>Folder</code> object supports file system functionality such as traversing the hierarchy; creating, renaming or removing files; or resolving file aliases.</li> <li>The <code>File</code> object supports input/output functions to read or write files.</li> </ul> <p>There are several ways to distinguish between a File and a Folder object. For example:</p> <pre><code>if ( f instanceof File ) ...\nif ( typeof f.open == \"undefined\" ) ... // Folders do not open\n</code></pre> <p>File and Folder objects can be used anywhere that a path name is required, such as in properties and arguments for files and folders.</p> <p>Note</p> <p>When you create two File objects that refer to the same disk file, they are treated as distinct objects. If you open one of them for I/O, the operating system may inhibit access from the other object, because the disk file already is open.</p>"},{"location":"file-system-access/using-file-and-folder-objects/#specifying-paths","title":"Specifying paths","text":"<p>When creating a File or Folder object, you can specify a platform-specific path name, or an absolute or relative path in a platform-independent format known as universal resource identifier (URI) notation. The path stored in the object is always an absolute, full path name that points to a fixed location on the disk.</p> <ul> <li>Use the toString method to obtain the name of the file or folder as string containing an absolute path name in URI notation.</li> <li>Use the <code>fsName</code> property to obtain the platform-specific file name.</li> </ul>"},{"location":"file-system-access/using-file-and-folder-objects/#absolute-and-relative-path-names","title":"Absolute and relative path names","text":"<p>An absolute path name in URI notation describes the full path from a root directory down to a specific file or folder. It starts with one or two slashes (<code>/</code>), and a slash separates path elements.</p> <p>For example, the following describes an absolute location for the file <code>myFile.jsx</code>:</p> <pre><code>/dir1/dir2/mydir/myFile.jsx\n</code></pre> <p>A relative path name in URI notation is appended to the path of the current directory, as stored in the globally available <code>current</code> property of the Folder class. It starts with a folder or file name, or with one of the special names dot (<code>.</code>) for the current directory, or dot dot (<code>..</code>) for the parent of the current directory. A slash (<code>/</code>) separates path elements.</p> <p>For example, the following paths describe various relative locations for the file <code>myFile.jsx</code>:</p> File reference Location <code>myFile.jsx</code> In the current directory. <code>./myFile.jsx</code> <code>../myFile.jsx</code> In the parent of the current directory. <code>../../myFile.jsx</code> In the grandparent of the current directory. <code>../dir1/myFile.jsx</code> In <code>dir1</code>, which is parallel to the current directory. <p>Relative path names are independent of different volume names on different machines and operating systems, and therefore make your code considerably more portable. You can, for example, use an absolute path for a single operation, to set the current directory in the Folder.current property, and use relative paths for all other operations. You would then need only a single code change to update to a new platform or file location.</p>"},{"location":"file-system-access/using-file-and-folder-objects/#character-interpretation-in-paths","title":"Character interpretation in paths","text":"<p>There are some platform differences in how pathnames are interpreted:</p> <ul> <li>On Windows and Mac OS, path names are not case sensitive. In UNIX, paths are case sensitive.</li> <li>On Windows, both the slash (<code>/</code>) and the backslash (<code>\\</code>) are valid path element separators. Backslash is the escape character, so you must use a double backslash (<code>\\\\</code>) to indicate the character.</li> <li>On Mac OS, both the slash (<code>/</code>) and the colon (<code>:</code>) are valid path element separators.</li> </ul> <p>If a path name starts with two slashes (or backslashes on Windows), the first element refers to a remote server. For example, <code>//myhost/mydir/myfile</code> refers to the path <code>/mydir/myfile</code> on the server myhost.</p> <p>URI notation allows special characters in pathnames, but they must specified with an escape character (%) followed by a hexadecimal character code. Special characters are those which are not alphanumeric and not one of the characters:</p> <pre><code>/ - - . ! ~ * ' ( )\n</code></pre> <p>A space, for example, is encoded as <code>%20</code>, so the file name <code>\"my file\"</code> is specified as <code>\"my%20file\"</code>. Similarly, the character <code>\u00e4</code> is encoded as <code>%E4</code>, so the file name <code>\"Br\u00e4un\"</code> is specified as <code>\"Br%E4un\"</code>.</p> <p>This encoding scheme is compatible with the global JavaScript functions <code>encodeURI</code> and <code>decodeURI</code>.</p>"},{"location":"file-system-access/using-file-and-folder-objects/#the-home-directory","title":"The home directory","text":"<p>A path name can start with a tilde (<code>~</code>) to indicate the user's home directory. It corresponds to the platform's <code>HOME</code> environment variable.</p> <p>UNIX and Mac OS assign the HOME environment variable according to the user login. On Mac OS, the default home directory is <code>/Users/username</code>. In UNIX, it is typically <code>/home/username</code> or <code>/users/username.</code> ExtendScript assigns the home directory value directly from the platform value.</p> <p>On Windows, the <code>HOME</code> environment variable is optional. If it is assigned, its value must be a Windows path name or a path name referring to a remote server (such as <code>\\\\myhost\\mydir</code>). If the <code>HOME</code> environment variable is undefined, the ExtendScript default is the user's home directory, usually the <code>C:\\Users\\username</code> folder.</p> <p>Note</p> <p>A script can access many of the folders that are specified with platform-specific variables through static, globally available Folder class properties; for instance, <code>appData</code> contains the folder that stores application data for all users.</p>"},{"location":"file-system-access/using-file-and-folder-objects/#volume-and-drive-names","title":"Volume and drive names","text":"<p>A volume or drive name can be the first part of an absolute path in URI notation. The values are interpreted according to the platform.</p>"},{"location":"file-system-access/using-file-and-folder-objects/#mac-os-volumes","title":"Mac OS volumes","text":"<p>When Mac OS X starts, the startup volume is the root directory of the file system. All other volumes, including remote volumes, are part of the /Volumes directory. The File and Folder objects use these rules to interpret the first element of a path name:</p> <ul> <li>If the name is the name of the startup volume, discard it.</li> <li>If the name is a volume name, prepend <code>/Volumes</code>.</li> <li>Otherwise, leave the path as is.</li> </ul> <p>Mac OS 9 is not supported as an operating system, but the use of the colon as a path separator is still supported and corresponds to URI and to Mac OS X paths as shown in the following table. These examples assume that the startup volume is <code>MacOSX</code>, and that there is a mounted volume <code>Remote</code>.</p> URI path name Mac OS 9 path name Mac OS X path name <code>/MacOSX/dir/file</code> <code>MacOSX:dir:file</code> <code>/dir/file</code> <code>/Remote/dir/file</code> <code>Remote:dir:file</code> <code>/Volumes/Remote/dir/file</code> <code>/root/dir/file</code> <code>Root:dir:file</code> <code>/root/dir/file</code> <code>~/dir/file</code> <code>/Users/jdoe/dir/file</code>"},{"location":"file-system-access/using-file-and-folder-objects/#windows-drives","title":"Windows drives","text":"<p>On Windows, volume names correspond to drive letters. The URI path /c/temp/file normally translates to the Windows path <code>C:\\temp\\file</code>.</p> <p>If a drive exists with a name matching the first part of the path, that part is always interpreted as that drive.</p> <p>It is possible for there to be a folder in the root that has the same name as the drive; imagine, for example, a folder <code>C:\\C</code> on Windows. A path starting with /c always addresses the drive <code>C:</code>, so in this case, to access the folder by name, you must use both the drive name and the folder name, for example <code>/c/c</code> for <code>C:\\C</code>.</p> <p>If the current drive contains a root folder with the same name as another drive letter, that name is considered to be a folder. That is, if there is a folder <code>D:\\C</code>, and if the current drive is <code>D:</code>, the URI path <code>/c/temp/file</code> translates to the Windows path <code>D:\\c\\temp\\file</code>. In this case, to access drive <code>C</code>, you would have to use the Windows path name conventions.</p> <p>To access a remote volume, use a uniform naming convention (UNC) path name of the form <code>//servername/sharename</code>. These path names are portable, because both Max OS X and UNIX ignore multiple slash characters. Note that on Windows, UNC names do not work for local volumes. These examples assume that the current drive is <code>D:</code></p> URI path name Windows path name <code>/c/dir/file</code> <code>c:\\\\dir\\\\file</code> <code>/remote/dir/file</code> <code>D:\\\\remote\\\\dir\\\\file</code> <code>/root/dir/file</code> <code>D:\\\\root\\\\dir\\\\file</code> <code>~/dir/file</code> <code>C:\\\\Users\\\\jdoe\\\\dir\\\\file</code>"},{"location":"file-system-access/using-file-and-folder-objects/#aliases","title":"Aliases","text":"<p>When you access an alias, the operation is transparently forwarded to the real file. The only operations that affect the alias are calls to <code>rename</code> and <code>remove</code>, and setting properties <code>readonly</code> and <code>hidden</code>. When a File object represents an alias, the <code>alias</code> property of the object returns <code>true</code>, and the <code>resolve</code> method returns the File or Folder object for the target of the alias.</p> <p>On Windows, all file system aliases (called shortcuts) are actual files whose names end with the extension <code>.lnk</code>. Never use this extension directly; the File and Folder objects work without it.</p> <p>For example, suppose there is a shortcut to the file <code>/folder1/some.txt</code> in the folder <code>/folder2</code>. The full Windows file name of the shortcut file is <code>\\folder2\\some.txt.lnk</code>.</p> <p>To access the shortcut from a File object, specify the path <code>/folder2/some.txt</code>. Calling that File object's open method opens the linked file (in <code>/folder1</code>). Calling the File object's <code>rename</code> method renames the shortcut file itself (leaving the <code>.lnk</code> extension intact).</p> <p>However, Windows permits a file and its shortcut to reside in the same folder. In this case, the File object always accesses the original file. You cannot create a File object to access the shortcut when it is in the same folder as its linked file.</p> <p>A script can create a file alias by creating a File object for a file that does not yet exist on disk, and using its <code>createAlias</code> method to specify the target of the alias.</p>"},{"location":"file-system-access/using-file-and-folder-objects/#portability-issues","title":"Portability issues","text":"<p>If your application will run on multiple platforms, use relative path names, or try to originate path names from the home directory. If that is not possible, work with Mac OS X and UNIX aliases, and store your files on a machine that is remote to your Windows machine so that you can use UNC names.</p> <p>As an example, suppose you use the UNIX machine myServer for data storage. If you set up an alias share in the root directory of <code>myServer</code>, and if you set up a Windows-accessible share at share pointing to the same data location, the path name <code>//myServer/share/file</code> would work for all three platforms.</p>"},{"location":"file-system-access/using-file-and-folder-objects/#unicode-io","title":"Unicode I/O","text":"<p>When doing file I/O, Adobe applications convert 8-bit character encoding to Unicode. By default, this conversion process assumes that the system encoding is used (code page 1252 on Windows or Mac Roman on Mac OS). The <code>encoding</code> property of a File object returns the current encoding. You can set the encoding property to the name of the desired encoding. The File object looks for the corresponding encoder in the operating system to use for subsequent I/O. The name is one of the standard Internet names that are used to describe the encoding of HTML files, such as <code>ASCII</code>, <code>X-SJIS</code>, or <code>ISO-8859-1</code>. For a complete list, see File- and Folder-supported encoding names.</p> <p>A special encoder, <code>BINARY</code>, is provided for binary I/O. This encoder simply extends every 8-bit character it finds to a Unicode character between 0 and 255. When using this encoder to write binary files, the encoder writes the lower 8 bits of the Unicode character. For example, to write the Unicode character <code>1000</code>, which is <code>0x3E8</code>, the encoder actually writes the character 232 (<code>0xE8</code>).</p> <p>The data of some of the common file formats (UCS-2, UCS-4, UTF-8, UTF-16) starts with a special byte order mark (BOM) character (<code>\\uFEFF</code>). The <code>File.open</code> method reads a few bytes of a file looking for this character. If it is found, the corresponding encoding is set automatically and the character is skipped. If there is no BOM character at the beginning of the file, open() reads the first 2 KB of the file and checks whether the data might be valid UTF-8 encoded data, and if so, sets the encoding to UTF-8.</p> <p>To write 16-bit Unicode files in UTF-16 format, use the encoding UCS-2. This encoding uses whatever byte-order format the host platform supports.</p> <p>When using UTF-8 encoding or 16-bit Unicode, always write the BOM character <code>\"\\uFEFF\"</code> as the first character of the file.</p>"},{"location":"file-system-access/using-file-and-folder-objects/#file-error-handling","title":"File error handling","text":"<p>Each object has an <code>error</code> property. If accessing a property or calling a method causes an error, this property contains a message describing the type of the error. On success, the property contains the empty string. You can set the property, but setting it only causes the error message to be cleared. If a file is open, assigning an arbitrary value to the property also resets its error flag.</p> <p>For a complete list of supported error messages, see File access error messages.</p>"},{"location":"integrating-external-libraries/","title":"Integrating External Libraries","text":"<p>You can extend the JavaScript DOM for an application by writing a C or C++ shared library, compiling it for the platform you are using, and loading it into JavaScript as an ExternalObject object. A shared library is implemented by a DLL in Windows, a bundle or framework in Mac OS, or a SharedObject in UNIX.</p> <p>You can access the library functions directly through the ExternalObject instance, or you can define an interface that allows your C/C++ code to create and access JavaScript classes and objects.</p> <p>All Adobe Creative Suite 4 applications support this feature.</p>"},{"location":"integrating-external-libraries/#example-code","title":"Example code","text":"<p>The sample code distributed with the Adobe ExtendScript SDK includes an example that demonstrates how write a C/C++ shared library to be integrated with JavaScript. It is in the directory:</p> <pre><code>sdkInstall/sdksamples/cpp/\n</code></pre> <p>The sample shows how to write a plug-in for Adobe Bridge in C/C++, using the ExternalObject mechanism, which enables the C/C++ code to be called from the JavaScript context. Project files for Microsoft Visual Studio 2005 and XCode 2.4 are included in subfolders of <code>sdkInstall/sdksamples/cpp/build.</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/","title":"Defining entry points for direct access","text":"<p>A library to be loaded and accessed directly through an ExternalObject instance must publish the following entry points.</p> <p>Note</p> <p>These must be exported as C functions, not C++ functions</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#entry-points","title":"Entry Points","text":"<p>The following entry points are required if you wish to use an ExternalObject instance:</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#esinitialize","title":"ESInitialize()","text":"<p><code>char* ESInitialize (TaggedData* argv, long argc);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#description","title":"Description","text":"<p>Called when your library is loaded into memory.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#parameters","title":"Parameters","text":"Parameter Description <code>argv, argc</code> The pointer to and number of arguments passed to the constructor, in the form of TaggedData."},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#returns","title":"Returns","text":"<p>A string of function signatures; see Library initialization.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#esgetversion","title":"ESGetVersion()","text":"<p><code>long ESGetVersion (void );</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#description_1","title":"Description","text":"<p>Takes no arguments, and returns a version number for the library as a long integer.</p> <p>The result is available in JavaScript as ExternalObject.version.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#returns_1","title":"Returns","text":"<p>Long integer</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#esfreemem","title":"ESFreeMem()","text":"<p><code>void ESFreeMem (void* p);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#description_2","title":"Description","text":"<p>Called to free memory allocated for a null-terminated string passed to or from library functions.</p> Parameter Description <code>p</code> A pointer to the string."},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#returns_2","title":"Returns","text":"<p>Nothing</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#esterminate","title":"ESTerminate()","text":"<p><code>void ESTerminate (void );</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#description_3","title":"Description","text":"<p>Called when your library is being unloaded. See Library termination.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#returns_3","title":"Returns","text":"<p>Nothing</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#additional-functions","title":"Additional functions","text":"<p>The shared library can contain any number of additional functions. Each function corresponds to a JavaScript method in the ExternalObject instance. If a function is undefined, ExtendScript throws a run-time error.</p> <p>Each function must accept the following arguments:</p> <ul> <li>An array of TaggedData.</li> <li>An argument count.</li> <li>A variant data structure that takes the return value.</li> </ul> <p>The variant data does not support JavaScript objects. The following data types are allowed:</p> <ul> <li><code>undefined</code></li> <li>Boolean</li> <li><code>double</code></li> <li>String - Must be UTF-8 encoded. The library must define an entry point ESFreeMem(), which ExtendScript calls to release a returned string pointer. If this entry point is missing, ExtendScript does not attempt to release any returned string data.</li> <li><code>Script</code> - A string to be evaluated by ExtendScript. Use to return small JavaScript scripts that define arbitrarily complex data.</li> </ul> <p>If, when a function is invoked, a supplied parameter is undefined, ExtendScript sets the data type to <code>undefined</code> and does not attempt to convert the data to the requested type.</p> <p>Note</p> <p>The data type of a return value cannot be predefined; JavaScript functions can return any data type.</p> <p>The called function is free to return any of the listed data types.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#library-initialization","title":"Library initialization","text":"<p>ExtendScript calls ESInitialize() to initialize the library.</p> <p>The function receives an argument vector containing the additional arguments passed in to the ExternalObject constructor.</p> <p>The function can return an array of function name-signature strings, which are used to support the ExtendScript reflection interface, and to cast function arguments to specific types. You do not need to define a signature for a function in order to make it callable in JavaScript.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#function-signatures","title":"Function signatures","text":"<p>If you choose to return a set of function name-signature strings, each string associates a function name with that function's parameter types, if any. For example:</p> <pre><code>[\"functionName1_argtypes\", \"functionName2_argtypes\", \"functionName3\"]\n</code></pre> <p>For each function, the string begins with the function name, followed by an underscore character and a list of argument data types, represented as a single character for each argument. If the function does not have arguments, you can omit the trailing underscore character (unless there is an underscore in the function name).</p> <p>The characters that indicate data types are:</p> Characeter Description <code>a</code> Any type. The argument is not converted. This is the default, if no type is supplied or if a type code is unrecognized. <code>b</code> Boolean <code>d</code> signed 32 bit integer <code>u</code> unsigned 32 bit integer <code>f</code> 64 bit floating point <code>s</code> String <p>For example, suppose your library defines these two entry points:</p> <pre><code>One (Integer a, String b);\nTwo ();\n</code></pre> <p>The signature strings for these two functions would be <code>\"One_ds\"</code>, <code>\"Two\"</code>.</p> <p>Warning</p> <p>You cannot define function overloading by returning multiple different signatures for one function.</p> <p>Attempting to do so produces undefined results.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-direct-access/#library-termination","title":"Library termination","text":"<p>Define the entry point ESInitialize() to free any memory you have allocated when your library is unloaded.</p> <p>Whenever a JavaScript function makes a call to a library function, it increments a reference count for that library. When the reference count for a library reaches 0, the library is automatically unloaded; your termination function is called, and the <code>ExternalObject</code> instance is deleted. Note that deleting the <code>ExternalObject</code> instance does not unload the library if there are remaining references.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/","title":"Defining entry points for indirect access","text":"<p>The C-client object interface for external libraries allows your C or C++ shared-library code to define, create, use, and manage JavaScript objects.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#entry-points","title":"Entry Points","text":"<p>The following entry points are required if you wish to use the object interface:</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#esclientinterface","title":"ESClientInterface()","text":"<p><code>int ESClientInterface (SoCClient_e kReason, SoServerInterface* pServer, SoHServer hServer)</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description","title":"Description","text":"<p>Your library must define this global function in order to use the object interface to JavaScript. The function is called twice in each session, immediately upon loading the library, and again when unloading it.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters","title":"Parameters","text":"<p>Parameter</p> <p>Description</p> <p><code>kReason</code></p> <p>The reason for this call, one of these constants:</p> <ul> <li><code>kSoCClient_init</code>: The function is being called for initialization upon load.</li> <li><code>kSoCClient_term</code>.: The function is being called for termination upon unload.</li> </ul> <p><code>pServer</code></p> <p>A pointer to an SoServerInterface containing function pointers for the entry points, which enable the shared-library code to call into JavaScript to create and access JavaScript classes and objects.</p> <p>The shared-library code is responsible for storing this structure between the initialization and termination call, and retrieving it to access the functions.</p> <p><code>hServer</code></p> <p>An Support structures reference for this shared library. The server is an object factory that creates and manages Support structures objects.</p> <p>The shared-library code is responsible for storing this structure between the initialization and termination calls. You must pass it to taggedDataInit() and taggedDataFree().</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#esmallocmem","title":"ESMallocMem()","text":"<p><code>void * ESMallocMem (size_t nbytes)</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_1","title":"Description","text":"<p>Provides a memory allocation routine to be used by JavaScript for managing memory associated with the library's objects.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_1","title":"Parameters","text":"Parameter Description <code>nbytes</code> The number of bytes to allocate."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_1","title":"Returns","text":"<p>A pointer to the allocated block of memory.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#shared-library-function-api","title":"Shared-library function API","text":"<p>Your shared-library C/C++ code defines its interface to JavaScript in two sets of functions, collected in SoServerInterface and SoObjectInterface function-pointer structures.</p> <p>Return values from most functions are integer constants. The error code <code>kESErrOK == 0</code> indicates success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#soserverinterface","title":"SoServerInterface","text":"<p><code>SoServerInterface</code> is a structure of function pointers which enable the shared-library code to call</p> <p>JavaScript objects. It is passed to the global ESClientInterface() function for initialization when the library is loaded, and again for cleanup when the library is unloaded. Between these calls, your shared-library code must store the structure and use it to access the communication functions.</p> <p>You can store information for every object and class in your C code. The recommended method is to create a data structure during the initialize() and free it during finalize(). You can then access that data with setClientData() and getClientData().</p> <p>The SoServerInterface structure contains these function pointers:</p> <pre><code>SoServerInterface {\n    SoServerDumpServer_f\n    SoServerDumpObject_f\n\n    dumpServer; //debugging, show server in console\n    dumpObject; //debugging, show object in console\n\n    SoServerAddClass_f\n\n    addClass; //define a JS class\n\n    SoServerAddMethod_f\n    SoServerAddMethods_f\n    SoServerAddProperty_f\n    SoServerAddProperties_f\n\n    addMethod; // define a method\n    addMethods; // define a set of methods\n    addProperty; // define a property\n    addProperties; // define a set of properties\n\n    SoServerGetClass_f\n    SoServerGetServer_f\n\n    getClass; // get class for an instance\n    getServer; // get server for an instance\n\n    SoServerSetClientData_f\n    SoServerGetClientData_f\n\n    setClientData; //set data in instance\n    getClientData; //get data from instance\n\n    SoServerEval_f\n    eval; // call JavaScript interpreter\n    SoServerTaggedDataInit_f taggedDataInit; // init tagged data\n    SoServerTaggedDataFree_f taggedDataFree; // free tagged data\n}\n</code></pre> <p>These functions allow your C/C++ shared library code to create, modify, and access JavaScript classes and objects. The functions must conform to the following type definitions.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#dumpserver","title":"dumpServer()","text":"<p><code>ESerror_t dumpServer (SoHServer hServer);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_2","title":"Description","text":"<p>Prints the contents of this server to the JavaScript Console in the ExtendScript Toolkit, for debugging.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_2","title":"Parameters","text":"Parameter Description <code>hServer</code> The Support structures reference for this shared library, as passed to your global ESClientInterface() function on initialization."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_2","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#dumpobject","title":"dumpObject()","text":"<p><code>ESerror_t dumpObject (SoHObject hObject);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_3","title":"Description","text":"<p>Prints the contents of this object to the JavaScript Console in the ExtendScript Toolkit, for debugging.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_3","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_3","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#addclass","title":"addClass()","text":"<p><code>ESerror_t addClass (SoHServer hServer, char* name, SoObjectInterface_p pObjectInterface);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_4","title":"Description","text":"<p>Creates a new JavaScript class.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_4","title":"Parameters","text":"Parameter Description <code>hServer</code> The Support structures reference for this shared library, as passed to your global ESClientInterface() function on initialization. <code>name</code> String. The unique name of the new class. The name must begin with an uppercase alphabetic character. <code>pObjectInterface</code> A pointer to an SoObjectInterface. A structure containing pointers to the object interface methods for instances of this class."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_4","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#addmethod","title":"addMethod()","text":"<p><code>ESerror_t addMethod (SoHObject hObject, const char* name, int id, char* desc);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_5","title":"Description","text":"<p>Adds new method to an instance.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_5","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>name</code> String. The unique name of the new method. <code>id</code> Number. The unique identifier for the new method. <code>desc</code> String. A descriptive string for the new method."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_5","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#addmethods","title":"addMethods()","text":"<p><code>ESerror_t addMethods (SoHObject hObject, SoCClientName_p pNames);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_6","title":"Description","text":"<p>Adds a set of new methods to an instance.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_6","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>pNames[]</code> SoCClientName. A structure containing the names and identifiers of methods to be added."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_6","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#addproperty","title":"addProperty()","text":"<p><code>ESerror_t addProperty (SoHObject hObject, const char* name, int id, char* desc);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_7","title":"Description","text":"<p>Adds new property to an instance.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_7","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>name</code> String. The unique name of the new property. <code>id</code> Number. The unique identifier for the new property. <code>desc</code> String. Optional. A descriptive string for the new property, or null."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_7","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#addproperties","title":"addProperties()","text":"<p><code>ESerror_t addProperties (SoHObject hObject, SoCClientName_p pNames);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_8","title":"Description","text":"<p>Adds a set of new properties to an instance.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_8","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>pNames[]</code> SoCClientName. A structure containing the names and identifiers of properties to be added."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_8","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#getclass","title":"getClass()","text":"<p><code>ESerror_t getClass (SoHObject hObject, char* name, int name_l);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_9","title":"Description","text":"<p>Retrieves this object's parent class name.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_9","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>name</code> String. A buffer in which to return the unique name of the class. <code>name_1</code> Number. The size of the name buffer."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_9","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#getserver","title":"getServer()","text":"<p><code>ESerror_t getServer (SoHObject hObject, SoHServer* phServer, SoServerInterface_p* ppServerInterface);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_10","title":"Description","text":"<p>Retrieves the interface methods for this object, and the server object that manages it.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_10","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>phServer</code> A buffer in which to return the Support structures reference for this object. <code>ppServerInterface</code> A buffer in which to return the SoObjectInterface reference for this object."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_10","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#setclientdata","title":"setClientData()","text":"<p><code>ESerror_t setClientData (SoHObject hObject, void* pData);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_11","title":"Description","text":"<p>Sets your own data to be stored with an object.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_11","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>pData</code> A pointer to the library-defined data."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_11","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#getclientdata","title":"getClientData()","text":"<p><code>ESerror_t setClientData (SoHObject hObject, void** pData);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_12","title":"Description","text":"<p>Retrieves data that was stored with setClientData().</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_12","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>pData</code> A buffer in which to return a pointer to the library-defined data."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_12","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#eval","title":"eval()","text":"<p><code>ESerror_t eval (SohServer hServer, char* string, TaggedData* pTaggedData);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_13","title":"Description","text":"<p>Calls the JavaScript interpreter to evaluate a JavaScript expression.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_13","title":"Parameters","text":"Parameter Description <code>hServer</code> The Support structures reference for this shared library, as passed to your global ESClientInterface() function on initialization. String A string containing the JavaScript expression to evaluate. <code>pTaggedData</code> A pointer to a TaggedData object in which to return the result of evaluation."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_13","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#taggeddatainit","title":"taggedDataInit()","text":"<p><code>ESerror_t taggedDataInit (SoHSever hServer, TaggedData* pTaggedData);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_14","title":"Description","text":"<p>Initializes a TaggedData structure.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_14","title":"Parameters","text":"Parameter Description <code>hServer</code> The Support structures reference for this shared library, as passed to your global ESClientInterface() function on initialization. <code>pTaggedData</code> A pointer to a TaggedData."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_14","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#taggeddatafree","title":"taggedDataFree()","text":"<p><code>ESerror_t setClientData (SoHServer hServer, TaggedData* pTaggedData);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_15","title":"Description","text":"<p>Frees memory being used by a TaggedData structure.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_15","title":"Parameters","text":"Parameter Description <code>hServer</code> The Support structures reference for this shared library, as passed to your global ESClientInterface() function on initialization. <code>pTaggedData</code> A pointer to a TaggedData."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_15","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#soobjectinterface","title":"SoObjectInterface","text":"<p>When you add a JavaScript class with SoServerInterface.addClass(), you must provide this interface. JavaScript calls the provided functions to interact with objects of the new class.</p> <p>The SoObjectInterface is an array of function pointers defined as follows:</p> <pre><code>SoObjectInterface {\n    SoObjectInitialize_f initialize;\n    SoObjectPut_f        put;\n    SoObjectGet_f        get;\n    SoObjectCall_f       call;\n    SoObjectValueOf_f    valueOf;\n    SoObjectToString_f   toString;\n    SoObjectFinalize_f   finalize;\n}\n</code></pre> <p>All <code>SoObjectInterface</code> members must be valid function pointers, or NULL. You must implement <code>initialize()</code> and <code>finalize()</code>. The functions must conform to the following type definitions.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#initialize","title":"initialize()","text":"<p><code>ESerror_t initialize (SoHObject hObject, int argc, TaggedData* argv);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_16","title":"Description","text":"<p>Required. Called when JavaScript code instantiates this class with the new operator:</p> <pre><code>var xx = New MyClass(arg1, ...)\n</code></pre> <p>The initialization function typically adds properties and methods to the object. Objects of the same class can offer different properties and methods, which you can add with the addMethod() and addProperty() functions in the stored SoServerInterface.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_16","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>argc, argv</code> The number of and pointer to arguments passed to the constructor, in the form of TaggedData."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_16","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#put","title":"put()","text":"<p><code>ESerror_t put (SoHObject hObject, SoCClientName* name, TaggedData* pValue);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_17","title":"Description","text":"<p>Called when JavaScript code sets a property of this class:</p> <pre><code>xx.myproperty = \"abc\" ;\n</code></pre> <p>If you provide <code>NULL</code> for this function, the JavaScript object is read-only.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_17","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>name</code> The name of the property, a pointer to an SoCClientName. <code>pValue</code> The new value, a pointer to a TaggedData."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_17","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#get","title":"get()","text":"<p><code>ESerror_t get (SoHObject hObject, SoCClientName* name, TaggedData* pValue);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_18","title":"Description","text":"<p>Called when JavaScript code accesses a property of this class:</p> <pre><code>alert(xx.myproperty);\n</code></pre>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_18","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>name</code> The name of the property, a pointer to an SoCClientName. <code>pValue</code> A buffer in which to return the property value, a TaggedData."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_18","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#call","title":"call()","text":"<p><code>ESerror_t call (SoHObject hObject, SoCClientName* name, int argc, TaggedData* argv, TaggedData* pResult);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_19","title":"Description","text":"<p>Called when JavaScript code calls a method of this class:</p> <pre><code>xx.mymethod()\n</code></pre> <p>Required in order for JavaScript to call any methods of this class.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_19","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>name</code> The name of the property, a pointer to an SoCClientName. <code>argc, argv</code> The number and pointer to arguments passed to the call, in the form of TaggedData <code>pResult</code> A buffer in which to return the result of the call, in the form of TaggedData"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_19","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#valueof","title":"valueOf()","text":"<p><code>ESerror_t valueOf (SoHObject hObject, TaggedData* pResult);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_20","title":"Description","text":"<p>Creates and returns the value of the object, with no type conversion.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_20","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>pResult</code> A buffer in which to return the result of the value, in the form of TaggedData"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_20","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#tostring","title":"toString()","text":"<p><code>ESerror_t toString (SoHObject hObject, TaggedData* pResult);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_21","title":"Description","text":"<p>Creates and returns a string representing the value of this object.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_21","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class. <code>pResult</code> A buffer in which to return the result of the string, in the form of TaggedData"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_21","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#finalize","title":"finalize()","text":"<p><code>ESerror_t finalize (SoHObject hObject);</code></p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#description_22","title":"Description","text":"<p>Required. Called when JavaScript deletes an instance of this class.</p> <p>Use this function to free any memory you have allocated.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_22","title":"Parameters","text":"Parameter Description <code>hObject</code> The Support structures reference for an instance of this class."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#returns_22","title":"Returns","text":"<p>Returns an error code, <code>kESErrOK</code> on success.</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#support-structures","title":"Support structures","text":"<p>These support structures are passed to functions that you define for your JavaScript interface:</p>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_23","title":"Parameters","text":"Parameter Description <code>SoHObject</code> An opaque pointer <code>(long *)</code> to the C/C++ representation of a JavaScript object. <code>SoHServer</code> An opaque pointer <code>(long *)</code> to the server object, which acts as an object factory for the shared library. <code>SoCClientName</code> A structure that uniquely identifies methods and properties. <code>TaggedData</code> A structure that encapsulates data values with type information, to be passed between C/C++ and JavaScript."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#socclientname","title":"SoCClientName","text":"<p>The SoCClientName data structure stores identifying information for methods and properties of JavaScript objects created by shared-library C/C++ code. It is defined as follows:</p> <pre><code>SoCClientName {\n    char* name_sig ;\n    uint32_t id ;\n    char* desc ;\n}\n</code></pre>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_24","title":"Parameters","text":"Parameter Description <code>name_sig</code> The name of the property or method, unique within the class. Optionally contains a signature following an underscore, which identifies the types of arguments to methods; see Function signatures. When names are passed back to your SoObjectInterface functions, the signature portion is omitted. <code>id</code> A unique identifying number for the property or method, or 0 to assign a generated UID. If you assign the UID, your C/C++ code can use it to avoid string comparisons when identifying JavaScript properties and methods. It is recommended that you either assign all UIDs explicitly, or allow them all to be generated. <code>desc</code> A descriptive string or <code>NULL</code>."},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#taggeddata","title":"TaggedData","text":"<p>The TaggedData structure is used to communicate data values between JavaScript and shared-library C/C++ code. Types are automatically converted as appropriate:</p> <pre><code>typedef struct {\n    union {\n        long intval;\n        double fltval;\n        char* string;\n        SoHObject* hObject;\n    } data;\n    long type;\n    long filler;\n} TaggedData;\n</code></pre>"},{"location":"integrating-external-libraries/defining-entry-points-for-indirect-access/#parameters_25","title":"Parameters","text":"<p>Parameter</p> <p>Description</p> <p><code>intval</code></p> <p>Integer and boolean data values. Type is <code>kTypeInteger</code>, <code>kTypeUInteger</code>, or <code>kTypeBool</code>.</p> <p><code>fltval</code></p> <p>Floating-point numeric data values. Type is <code>kTypeDouble</code>.</p> <p>String</p> <p>String data values. All strings are UTF-8 encoded and null-terminated. Type is <code>kTypeString</code> or <code>kTypeScript</code>.</p> <ul> <li>The library must define an entry point ESFreeMem(), which ExtendScript calls to release a returned string pointer. If this entry point is missing, ExtendScript does not attempt to release any returned string data.</li> <li>When a function returns a string of type kTypeScript, ExtendScript evaluates the script and returns the result of evaluation as the result of the function call.</li> </ul> <p><code>hObject</code></p> <p>A C/C++ representation of a JavaScript object data value. Type is <code>kTypeLiveObject</code> or <code>kTypeLiveObjectRelease</code>.</p> <ul> <li>When a function returns an object of type kTypeLiveObject, ExtendScript does not release the object.</li> <li>When a function returns an object of type kTypeLiveObjectRelease, ExtendScript releases the object.</li> </ul> <p><code>type</code></p> <p>The data type tag. One of:</p> <ul> <li><code>kTypeUndefined</code>: a null value, equivalent of JavaScript <code>undefined</code>. The return value for a function is always set to this by default.</li> <li><code>kTypeBool</code>: a boolean value, 0 for <code>false</code>, 1 for <code>true</code>.</li> <li><code>kTypeDouble</code>: a 64-bit floating-point number.</li> <li><code>kTypeString</code>: a character string.</li> <li><code>kTypeLiveObject</code>: a pointer to an internal representation of an object (SoHObject).</li> <li><code>kTypeLiveObjectRelease</code>: a pointer to an internal representation of an object (SoHObject).</li> <li><code>kTypeInteger</code>: a 32-bit signed integer value.</li> <li><code>kTypeUInteger</code>: a 32-bit unsigned integer value.</li> <li><code>kTypeScript</code>: a string containing an executable JavaScript script.</li> </ul> <p><code>filler</code></p> <p>A 4-byte filler for 8-byte alignment.</p>"},{"location":"integrating-external-libraries/externalobject-object/","title":"ExternalObject object","text":"<p>You specify the name of the library in the constructor. The constructor searches for the named library using the paths defined in the static property ExternalObject.searchFolders.</p> <p>If you are having difficulty loading your library as an ExternalObject, set the property <code>ExternalObject.log</code> to <code>true</code>, then call <code>ExternalObject.search('lib:myLibrary')</code>. This function performs the search, and the log reports the paths that have been searched to the ExtendScript Toolkit Console.</p> <p>Before loading the library, the current folder is temporarily switched to the location of the found executable file.</p> <ul> <li>In Mac OS, the current directory is set to the bundle or framework folder for the library.</li> <li>In Windows and UNIX, the current directory is set to the folder that contains the library.</li> </ul>"},{"location":"integrating-external-libraries/externalobject-object/#externalobject-constructor","title":"ExternalObject constructor","text":"<p><code>obj = new ExternalObject (\"lib:\" + filespec, arg1, ...argn);</code></p> <p>Parameter</p> <p>Description</p> <p><code>filespec</code></p> <p>The specifier \"lib:\" is case sensitive, and serves as the marker for dynamic libraries. Concatenate this to the base name of the shared library, with or without an extension.</p> <p>ExtendScript appends a file extension if necessary, according to the operating system:</p> <ul> <li><code>.dll</code> in Windows</li> <li><code>.bundle</code> or <code>.framework</code> in Mac OS (only Mach-O bundles are supported)</li> <li><code>.so</code> in UNIX (except for HP/UX, where the extension is <code>.sl</code>)<ul> <li>The name of the library is case sensitive in UNIX.</li> </ul> </li> </ul> <p><code>arg1...argn</code></p> <p>Optional. Any number of arguments to pass to the library's initialization routine.</p> <p>For example:</p> <pre><code>var mylib = new ExternalObject( \"lib:myLibrary\" );\n</code></pre>"},{"location":"integrating-external-libraries/externalobject-object/#externalobject-class-attributes","title":"ExternalObject Class Attributes","text":"<p>The ExternalObject class provides these static properties:</p>"},{"location":"integrating-external-libraries/externalobject-object/#externalobjectlog","title":"ExternalObject.log","text":"<p><code>ExternalObject.log</code></p>"},{"location":"integrating-external-libraries/externalobject-object/#description","title":"Description","text":"<p>Set to <code>true</code> to write status information to standard output (the JavaScript Console in the ExtendScript Toolkit).</p> <p>Set to <code>false</code> to turn logging off. Default is <code>false</code>.</p>"},{"location":"integrating-external-libraries/externalobject-object/#type","title":"Type","text":"<p>Boolean</p>"},{"location":"integrating-external-libraries/externalobject-object/#externalobjectsearchfolders","title":"ExternalObject.searchFolders","text":"<p><code>ExternalObject.searchFolders</code></p>"},{"location":"integrating-external-libraries/externalobject-object/#description_1","title":"Description","text":"<p>A set of alternate paths in which to search for the shared library files, a single string with multiple path specifications delimited by semicolons (;).</p> <p>Paths can be absolute or relative to the Folder.startup location.</p> <p>Default value is:</p> <ul> <li>In Windows, <code>\"Plugins;Plug-Ins;.\"</code></li> <li>In Mac OS, <code>\"Plugins;Plug-Ins;Frameworks;.;../../../Plugins;../../../Plug-ins;../../../Frameworks;../../..;\"</code></li> <li>In UNIX, <code>\"Plugins;Plug-Ins;plugins;.\"</code></li> </ul>"},{"location":"integrating-external-libraries/externalobject-object/#type_1","title":"Type","text":"<p>String</p>"},{"location":"integrating-external-libraries/externalobject-object/#externalobjectversion","title":"ExternalObject.version","text":"<p><code>ExternalObject.version</code></p>"},{"location":"integrating-external-libraries/externalobject-object/#description_2","title":"Description","text":"<p>The version of the library, as returned by ESGetVersion().</p>"},{"location":"integrating-external-libraries/externalobject-object/#type_2","title":"Type","text":"<p>Number</p>"},{"location":"integrating-external-libraries/externalobject-object/#externalobject-class-methods","title":"ExternalObject Class Methods","text":"<p>The ExternalObject class provides this static function to help debug problems with loading libraries as external objects:</p>"},{"location":"integrating-external-libraries/externalobject-object/#externalobjectsearch","title":"ExternalObject.search()","text":"<p><code>ExternalObject.search(spec)</code></p>"},{"location":"integrating-external-libraries/externalobject-object/#description_3","title":"Description","text":"<p>Reports whether a compiled C/C++ library can be found, but does not load it. If logging is on, the paths searched are reported to the JavaScript Console in the ExtendScript Toolkit.</p>"},{"location":"integrating-external-libraries/externalobject-object/#parameters","title":"Parameters","text":"Parameter Type Description <code>spec</code> String The file specification for the compiled library, with or without path information."},{"location":"integrating-external-libraries/externalobject-object/#returns","title":"Returns","text":"<p>Boolean. <code>true</code> if the library is found, <code>false</code> otherwise.</p>"},{"location":"integrating-external-libraries/externalobject-object/#externalobject-object-methods","title":"ExternalObject Object Methods","text":""},{"location":"integrating-external-libraries/externalobject-object/#externalobjectterminate","title":"ExternalObject.terminate()","text":"<p><code>externalObj.terminate()</code></p>"},{"location":"integrating-external-libraries/externalobject-object/#description_4","title":"Description","text":"<p>Explicitly shuts down the <code>ExternalObject</code> dynamic library wrapped by this instance.</p> <p>It can be helpful to force a shutdown of the external library if termination of external libraries during the shutdown of the hosting application does not occur in the correct order.</p>"},{"location":"integrating-external-libraries/externalobject-object/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"integrating-external-libraries/loading-and-using-shared-libraries/","title":"Loading and using shared libraries","text":"<p>To load an external shared library into JavaScript, create a new ExternalObject object. The instance acts as a container and manager for the JavaScript interface to the library. It provides a logging facility that prints status information to the JavaScript Console in the ExtendScript Toolkit, to help you debug your external library use.</p> <p>Once the library has been loaded, its exported symbols become available to JavaScript. In your JavaScript code, you can call the functions defined in the library directly in the <code>ExternalObject</code> instance, or indirectly through library-defined object types.</p>"},{"location":"integrating-external-libraries/loading-and-using-shared-libraries/#direct-access-to-library-calls-through-the-externalobject-instance","title":"Direct access to library calls through the ExternalObject instance","text":"<p>Use the direct-access style for C-language libraries. For each function defined in the C library, there is a corresponding method in the ExternalObject object. You can pass data to these methods and receive the return value directly.</p> <p>For example:</p> <pre><code>mylib = new ExternalObject (\"lib:\" + samplelib); // load the library\nalert(mylib.version) ;\n// access functions directly from ExternalObject instance\nvar a = mylib.method_abc(1,2.0,true, \"this is data\") ;\nalert(a) ;\nmylib.unload() ;\n</code></pre> <p>For details of how to define functions for direct access through the ExternalObject object, see Defining entry points for direct access</p>"},{"location":"integrating-external-libraries/loading-and-using-shared-libraries/#indirect-access-to-library-calls-through-javascript-classes","title":"Indirect access to library calls through JavaScript classes","text":"<p>Use the indirect style to access classes defined in a C++ library. For each C++ class defined in the library, a corresponding JavaScript class is automatically defined, and you can access the properties and methods through an instance of that class.</p> <p>For example:</p> <pre><code>anotherlib= new ExternalObject (\"lib:\" + filespec); // load the library\nalert(anotherlib.version) ;\n// instantiate library-defined class\nvar myObject = new MyNewClass() ;\n// access functions from instance\nvar a = myObject.method_abc(1,2.0,true,\"this is data\") ;\nalert(a) ;\nanotherlib.unload() ;\n</code></pre> <p>For details of how to define functions for direct access through the ExternalObject object, see Defining entry points for indirect access.</p>"},{"location":"integrating-xml/","title":"Integrating XML into JavaScript","text":"<p>ExtendScript defines the XML object, which allows you to process XML with your JavaScript scripts. This feature offers a subset of the functionality specified by the ECMA-357 specification (E4X). For more information on this standard, see: http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-357.pdf</p>"},{"location":"integrating-xml/the-xml-object/","title":"The XML Object","text":"<p>The XML object represents an XML element node in an XML tree. The topmost <code>XML</code> object for an XML file represents the root node. It acts as a list, which contains additional <code>XML</code> objects for each element. These in turn contain XML objects for their own member elements, and so on.</p> <p>The child elements of an element tree are available as properties of the <code>XML</code> object for the parent. The name of the property corresponds to the name of the element. Each property contains an array of <code>XML</code> objects, each of which represents one element of the named type.</p> <p>For example, suppose you have the following, minimal XML code:</p> <pre><code>&lt;rootElement&gt;\n    &lt;elementA&gt;\n        &lt;elementB&gt;&lt;/elementB&gt;\n    &lt;/elementA&gt;\n    &lt;elementA&gt;\n        &lt;elementB&gt;&lt;/elementB&gt;\n    &lt;/elementA&gt;\n&lt;/rootElement&gt;\n</code></pre> <p>In a JavaScript script, the XML object that you create from this XML code represents the root element:</p> <pre><code>var myRoot = new XML( \"&lt;rootElement&gt; &lt;elementA&gt; &lt;elementB&gt;&lt;/elementB&gt; &lt;/elementA&gt; &lt;elementA&gt; &lt;elementB&gt;&lt;/elementB&gt; &lt;/elementA&gt; &lt;/rootElement&gt;\");\n</code></pre> <p>You can assign a constant to an XML value directly. The following implicitly creates the XML object assigned to <code>myRoot</code>:</p> <pre><code>var myRoot = &lt;rootElement&gt;\n    &lt;elementA&gt;\n        &lt;elementB&gt;&lt;/elementB&gt;\n    &lt;/elementA&gt;\n    &lt;elementA&gt;\n        &lt;elementB&gt;&lt;/elementB&gt;\n    &lt;/elementA&gt;\n&lt;/rootElement&gt;;\n</code></pre> <p>The object <code>myRoot</code> contains a property named <code>elementA</code>, which contains two <code>XML</code> objects for the two instances of that element. Each of these, in turn, contains an <code>elementB</code> property, which contains one empty <code>XML</code> object:</p> <pre><code>var elemB1 = myRoot.elementA[0].elementB[0];\n</code></pre> <p>If an element is empty in the XML, the corresponding property exists and contains an empty XML object; it is never <code>null</code> or <code>undefined</code>.</p>"},{"location":"integrating-xml/the-xml-object/#accessing-xml-elements","title":"Accessing XML elements","text":"<p>This sample XML code is used for examples throughout this chapter:</p> <pre><code>&lt;bookstore&gt;\n    &lt;book category=\"COOKING\"&gt;\n        &lt;title lang=\"en\"&gt;The Boston Cooking-School Cookbook&lt;/title&gt;\n        &lt;author&gt;Fannie Merrit Farmer&lt;/author&gt;\n        &lt;year&gt;1896&lt;/year&gt;\n        &lt;price&gt;49.99&lt;/price&gt;\n    &lt;/book&gt;\n    &lt;book category=\"CHILDREN\"&gt;\n        &lt;title lang=\"en\"&gt;The Wonderful Wizard of Oz&lt;/title&gt;\n        &lt;author&gt;L. Frank Baum&lt;/author&gt;\n        &lt;year&gt;1900&lt;/year&gt;\n        &lt;price&gt;39.95&lt;/price&gt;\n    &lt;/book&gt;\n    &lt;book category=\"CHILDREN\"&gt;\n        &lt;title lang=\"en\"&gt;Alice's Adventures in Wonderland&lt;/title&gt;\n        &lt;author&gt;Charles \"Lewis Carroll\" Dodgeson&lt;/author&gt;\n        &lt;author&gt;Charles Dodgeson&lt;/author&gt;\n        &lt;author&gt;Lewis Carroll&lt;/author&gt;\n        &lt;year&gt;1865&lt;/year&gt;\n        &lt;price&gt;29.99&lt;/price&gt;\n    &lt;/book&gt;\n    &lt;book category=\"MUSIC\"&gt;\n        &lt;title lang=\"en\"&gt;Gilbert and Sullivan Opera; A History and a Comment&lt;/title&gt;\n        &lt;author&gt;H. M. Walbrook&lt;/author&gt;\n        &lt;year&gt;1922&lt;/year&gt;\n        &lt;price&gt;30.00&lt;/price&gt;\n    &lt;/book&gt;\n&lt;/bookstore&gt;\n</code></pre> <p>To encapsulate this code in an XML object, serialize it into a string and pass that string to the constructor:</p> <pre><code>var bookXmlStr = \"...\";\nvar bookstoreXML = new XML (bookXmlStr);\n</code></pre> <p>Using this example, the root element <code>&lt;bookstore&gt;</code>, is represented by the XML object returned from the constructor. Each of the <code>&lt;book&gt;</code> elements is available as a member of the book property of the XML object.</p> <ul> <li>The Javascript statement <code>bookstoreXML.book;</code> returns the entire list of books.</li> <li>The statement <code>bookstoreXML.book[0];</code> returns the <code>XML</code> object for the first book.</li> <li>The statement <code>bookstoreXML.book[0].author;</code> returns all authors of the first book.</li> </ul> <p>For additional ways of accessing elements in the tree, see Retrieving contained elements, and Creating and accessing namespaces</p>"},{"location":"integrating-xml/the-xml-object/#accessing-xml-attributes","title":"Accessing XML attributes","text":"<p>Attribute are properties of their parent elements. In ExtendScript, access an attribute name by using a preceding at-sign (<code>@</code>). An attribute property is a one-element list, which contains an XML object for the value of the attribute. For example:</p> <pre><code>bookstoreXML.book [0].@category;\n</code></pre> <p>This returns the category attribute of the first book, whose value is the string <code>\"COOKING\"</code>.</p> <p>To access all category attributes of all books, use this statement:</p> <pre><code>bookstoreXML.book.@category\n</code></pre> <p>You can reference a set of elements with a particular attribute value, using a predicate in this form:</p> <pre><code>element.(@attribute == value)\n</code></pre> <p>For example, this statement returns only book elements that have a category attribute with the value <code>\"CHILDREN\"</code>:</p> <pre><code>bookstoreXML.book.(@category == \"CHILDREN\");\n</code></pre>"},{"location":"integrating-xml/the-xml-object/#viewing-xml-objects","title":"Viewing XML objects","text":"<p>The XML object, like all ExtendScript objects, has a ref:controlobj-toString method that serializes the contents into a string. In this case, the string contains only the text content of the element, not the tags. For example, for the element <code>&lt;x&gt;text&lt;/x&gt;</code>, the <code>toString()</code> method returns <code>\"text\"</code>.</p> <p>This method is called when you evaluate the object in the JavaScript Console of the ExtendScript Toolkit. It recreates the XML text that the object encapsulates. Thus, if you evaluate the object <code>bookstoreXML.book[1]</code> in the Console, you see the XML text for the encapsulated tree, formatted with line feeds and spaces:</p> <pre><code>&gt; bookstoreXML.book[1];\n    &lt;book category=\"CHILDREN\"&gt;\n        &lt;title lang=\"en\"&gt;The Wonderful Wizard of Oz&lt;/title&gt;\n        &lt;author&gt;L. Frank Baum&lt;/author&gt;\n        &lt;year&gt;1900&lt;/year&gt;\n        &lt;price&gt;39.95&lt;/price&gt;\n    &lt;/book&gt;\n</code></pre> <p>If you evaluate an object with a text value, you see the text value. For example:</p> <pre><code>&gt; bookstoreXML.book[1].@category;\n    CHILDREN\n</code></pre> <p>If you access multiple values, the values are concatenated:</p> <pre><code>&gt; bookstoreXML.book.@category\n    COOKINGCHILDRENCHILDRENMUSIC\n</code></pre> <p>The toXMLString() method serializes the entire element, including the tags, into a string.</p> <p>For example, for the element <code>&lt;x&gt;text&lt;/x&gt;</code>, the method returns <code>\"&lt;x&gt;text&lt;/x&gt;\"</code>.</p>"},{"location":"integrating-xml/the-xml-object/#modifying-xml-elements-and-attributes","title":"Modifying XML elements and attributes","text":"<p>You can change an element by assigning a value to the corresponding property.</p> <ul> <li>If the value assigned is an XML element, the element is simply replaced. If there are multiple elements of the same type, the first element is replaced, and all other elements are deleted.</li> <li>If the value assigned is not XML, it is converted to a string, and the content of the element is replaced with that string.</li> <li>If no element of this type is present, a new element is appended to the XML.</li> </ul> <p>You can change the values of attributes using the same technique.</p>"},{"location":"integrating-xml/the-xml-object/#modification-examples","title":"Modification examples","text":"<p>In the sample XML, the third book has several  elements. This statement replaces all of them with a single element, containing a new string: <pre><code>bookstoreXML.book[2].author = \"Charles 'Lewis Carroll' Dodgeson\";\n</code></pre> <p>The result is this XML:</p> <pre><code>&lt;book category=\"CHILDREN\"&gt;\n    &lt;title lang=\"en\"&gt;Alice's Adventures in Wonderland&lt;/title&gt;\n    &lt;author&gt;Charles 'Lewis Carroll' Dodgeson&lt;/author&gt;\n    &lt;year&gt;1865&lt;/year&gt;\n    &lt;price&gt;29.99&lt;/price&gt;\n&lt;/book&gt;\n</code></pre> <p>To replace just the first author, leaving all the other authors in place, use this statement:</p> <pre><code>bookstoreXML.book[2].author[0] = \"Charles Dodgeson, aka Lewis Carroll\";\n</code></pre> <p>This statement changes the content of the  element in the second book. ExtendScript automatically converts the numeric value to a string: <pre><code>bookstoreXML.book[1].year = 1901;\n</code></pre> <p>This following statement adds a new  element to the second book: <p><code>&gt; bookstoreXML.book[1].rating = \"**\\***\";</code></p> <p>The result is this XML:</p> <pre><code>&lt;book category=\"CHILDREN\"&gt;\n    &lt;title lang=\"en\"&gt;The Wonderful Wizard of Oz&lt;/title&gt;\n    &lt;author&gt;L. Frank Baum&lt;/author&gt;\n    &lt;year&gt;1900&lt;/year&gt;\n    &lt;price&gt;39.95&lt;/price&gt;\n    &lt;rating&gt;*****&lt;/rating&gt;\n&lt;/book&gt;\n</code></pre> <p>This statement changes the value of the category attribute of the second book:</p> <pre><code>bookstoreXML.book[1].@category = \"LITERATURE, FANTASY\"\n</code></pre> <p>The result is this XML:</p> <pre><code>&lt;book category=\"LITERATURE, FANTASY\"&gt;\n&lt;title lang=\"en\"&gt;The Wonderful Wizard of Oz&lt;/title&gt;\n...\n</code></pre>"},{"location":"integrating-xml/the-xml-object/#deleting-elements-and-attributes","title":"Deleting elements and attributes","text":"<p>To delete an element or attribute in the XML, use the JavaScript <code>delete</code> operator to delete the corresponding element or attribute property. If there are multiple instances of an element, you can delete all, or refer to a single one by its index.</p>"},{"location":"integrating-xml/the-xml-object/#deletion-examples","title":"Deletion examples","text":"<p>This statement deletes all authors from the third book:</p> <pre><code>delete bookstoreXML.book[2].author;\n</code></pre> <p>This statement deletes only the second author from the third book:</p> <pre><code>delete bookstoreXML.book[2].author[1];\n</code></pre> <p>This statement deletes the category attribute from the third book:</p> <pre><code>delete bookstoreXML.book[2].@category;\n</code></pre>"},{"location":"integrating-xml/the-xml-object/#retrieving-contained-elements","title":"Retrieving contained elements","text":"<p>The <code>XML</code> object provides methods that allow you to retrieve elements contained at various levels of the tree:</p> <ul> <li><code>XML.</code>children() gets the direct child elements, including text elements.</li> <li><code>XML.</code>elements() gets the direct child elements that are XML tags, but does not get text.</li> <li><code>XML.</code>descendants() allows you to match a specific tag, and gets all matching elements at any level of nesting. You can also use a \"double dot\" notation to access descendants of an element. For example, these statements are equivalent:     <pre><code>xml..title\nxml.descendants(\"title\")\n</code></pre></li> </ul> <p>For example, consider this XML code loaded into a top-level <code>XML</code> object named <code>x</code>:</p> <pre><code>&lt;top&gt;\n    &lt;one&gt;one text&lt;/one&gt;\n    &lt;two&gt;\n        two text\n        &lt;inside&gt;inside text&lt;/inside&gt;\n    &lt;/two&gt;\n    top text\n&lt;/top&gt;\n</code></pre> <p>Here are the results of the different calls.</p> <ul> <li>The result of <code>XML.</code>children() contains 3 elements, the direct child tags <code>&lt;one&gt;</code> and <code>&lt;two&gt;</code>, and the directly contained text of the <code>&lt;top&gt;</code> tag:     <pre><code>**&gt; x.children()**\n    &lt;one&gt;one text&lt;/one&gt;\n    &lt;two&gt;\n    two text\n    &lt;inside&gt;inside text&lt;/inside&gt;\n    &lt;/two&gt;\n    top text\n\n**&gt; x.children().length()**\n    3\n</code></pre></li> <li>The result of <code>XML.</code>elements() contains 2 elements, the direct child tags <code>&lt;one&gt;</code> and <code>&lt;two&gt;</code>:     <pre><code>**&gt; x.elements()**\n    &lt;one&gt;one text&lt;/one&gt;\n    &lt;two&gt;\n        two text\n        &lt;inside&gt;inside text&lt;/inside&gt;\n    &lt;/two&gt;\n**&gt; x.elements().length()**\n    2\n</code></pre></li> <li>The result of <code>XML.</code>descendants() contains 7 elements, the direct child tags <code>&lt;one&gt;</code> and <code>&lt;two&gt;</code>, the <code>&lt;inside&gt;</code> tag one level down, and the text contents of all the tags:     <pre><code>**&gt; x.descendants()**\n    &lt;one&gt;one text&lt;/one&gt;\n    one text\n    &lt;two&gt;\n        two text\n        &lt;inside&gt;inside text&lt;/inside&gt;\n    &lt;/two&gt;\n    two text\n    &lt;inside&gt;inside text&lt;/inside&gt;\n    inside text\n    top text\n**&gt; x.descendants().length()**\n    7\n</code></pre></li> </ul>"},{"location":"integrating-xml/the-xml-object/#creating-and-accessing-namespaces","title":"Creating and accessing namespaces","text":"<p>Simple access statements access elements in the default namespace. If you need to define elements in more than one namespace, you must use a Namespace object to access any elements that are NOT in the default namespace.</p>"},{"location":"integrating-xml/the-xml-object/#defining-a-namespace-within-the-tree","title":"Defining a namespace within the tree","text":"<p>You can define a namespace within an XML element using the xmlns attribute, and define elements within the schema as belonging to that namespace. For example, these additions to the example XML add a namespace that maps the prefix \"kids\" to the namespace \"http://kids.mybookstore.com\", and then uses the prefix to place a particular book element in that namespace:</p> <pre><code>&lt;bookstore **xmlns:kids=\"http://kids.mybookstore.com\"**&gt;\n\n&lt;book category=\"COOKING\"&gt;\n    &lt;title lang=\"en\"&gt;The Boston Cooking-School Cookbook&lt;/title&gt;\n    &lt;author&gt;Fannie Merrit Farmer&lt;/author&gt;\n    &lt;year&gt;1896&lt;/year&gt;\n    &lt;price&gt;49.99&lt;/price&gt;\n&lt;/book&gt;\n\n&lt;**kids:**book category=\"CHILDREN\"&gt;\n    &lt;title lang=\"en\"&gt;The Wonderful Wizard of Oz&lt;/title&gt;\n    &lt;author&gt;L. Frank Baum&lt;/author&gt;\n    &lt;year&gt;1900&lt;/year&gt;\n    &lt;price&gt;39.95&lt;/price&gt;\n&lt;/**kids:**book&gt;\n...\n</code></pre> <p>When this namespace is defined, the simple statement <code>bookstoreXML.book</code> no longer returns \"The Wonderful Wizard of Oz\", because that book is no longer in the default namespace. To access that book, you must define a Namespace object for the namespace, and use it to access the element.</p> <p>For example, this JavaScript code creates a Namespace object for the namespace defined in the  element, and accesses the books in the namespace through that object: <pre><code>var ns = new Namespace (\"http://kids.mybookstore.com\");\nbookstoreXML.ns::book;\n</code></pre>"},{"location":"integrating-xml/the-xml-object/#setting-a-default-namespace","title":"Setting a default namespace","text":"<p>By default, the default namespace is a namespace whose URI is the empty string. It is possible to set the default namespace; in this case, simple accessors access elements that are in that namespace.</p> <p>To set the default namespace, use the global function setDefaultXMLNamespace(), or this syntax:</p> <pre><code>default xml namespace = namespace_specifier;\n</code></pre> <p>The namespace specifier can be either a Namespace object, or a URL string. For example:</p> <pre><code>default xml namespace = \"http://books.mybookstore.com\";\n</code></pre> <p>Once you have set the default namespace:</p> <ul> <li>Elements that are meant to be in the default namespace (and thus accessible with simple accessors) must use the namespace prefix.</li> <li>All elements that do not have a specific namespace assignment are in the empty namespace, rather than the default namespace. In order to access them, you must use a Namespace object with the empty string as the URI.</li> </ul>"},{"location":"integrating-xml/the-xml-object/#accessing-elements-in-namespaces","title":"Accessing elements in namespaces","text":"<ul> <li>You can access elements that are in the default namespace directly, without using a Namespace object.<ul> <li>If you have not set a default, you can use direct access for elements with no namespace specifier.</li> <li>If you have set a default, you can use direct access for elements in that namespace.</li> </ul> </li> <li> <p>If you have assigned an element to a namespace, and have not made it the default, you must use a Namespace object to access those elements. For example:     <pre><code>var ns = new Namespace (**\"http://kids.mybookstore.com\"**);\nbookstoreXML.**ns::book**;\n</code></pre></p> <p>This returns all books that have been assigned to the \"kids\" namespace. - If you have set a default namespace, you can still access all objects that do not have any specific namespace assignment by using a Namespace object for the empty string, which is the default creation case: <pre><code>var emptyNS = new Namespace ();\nbookstoreXML.emptyNS::book;\n</code></pre></p> <p>This returns all books that have not been assigned to any namespace. - To access all elements, regardless of the namespace assignment, you can use an asterisk (*) wild-card character or null as the namespace name: <pre><code>bookstoreXML.*::book;\n</code></pre></p> <p>or <pre><code>var nullNS = null;\nbookstoreXML.nullNS::book;\n</code></pre></p> </li> </ul>"},{"location":"integrating-xml/the-xml-object/#mixing-xml-and-javascript","title":"Mixing XML and JavaScript","text":"<p>You can enclose JavaScript statements in curly brackets, and embed them into XML. The JavaScript part is evaluated during the construction of the XML.</p> <p>For example, this function returns an XML value, in which embedded JavaScript variables will be evaluated and included:</p> <pre><code>function makeXML (first, last) {\n    return &lt;person first={first} last={last}&gt;{first + \" \" + last}&lt;/person&gt;;\n}\n</code></pre> <p>Calling this function:</p> <pre><code>makeXML ( \"Jane\", \"Doe\" );\n</code></pre> <p>results in this XML:</p> <pre><code>&lt;person first=\"Jane\" last=\"Doe\"&gt;Jane Doe&lt;/person&gt;\n</code></pre> <p>You can also use these operators on XML elements:</p> <ul> <li>Use the plus operator, +, to combine XML elements into a list.</li> <li>Use the == operator to make an in-depth comparison of two XML trees.</li> </ul>"},{"location":"integrating-xml/the-xml-object/#xml-lists","title":"XML lists","text":"<p>ExtendScript defines an <code>XMLList</code> object, which is identical to the XML object except that you can create it by passing it an XML list, and it creates an XML list rather than an XML tag.</p> <p>All XML statements and functions that collect XML return the result as an <code>XMLList</code>, which can be empty if there is no match. For example, the following statement returns an empty list:</p> <pre><code>bookstoreXML.magazine;\n</code></pre>"},{"location":"integrating-xml/xml-object-reference/","title":"XML Object Reference","text":"<p>This section provides reference details for the properties and methods of the XML object itself, and for the related utility objects and global functions that you use to work with namespaces:</p> <ul> <li>XML object</li> <li>Namespace object</li> <li>QName object</li> <li>Global functions</li> </ul>"},{"location":"integrating-xml/xml-object-reference/#xml-object","title":"XML Object","text":"<p>The <code>XML</code> object provides both static properties and functions, available through the <code>XML</code> class, and dynamic properties and functions available through each instance.</p>"},{"location":"integrating-xml/xml-object-reference/#xml-object-constructor","title":"XML object constructor","text":"<p>The constructor returns the XML object representing the root node of an XML tree, which contains additional XML objects for all contained elements.</p> <p><code>[new] XML (xmlCode);</code></p> <p>Property</p> <p>Type</p> <p>Description</p> <p><code>xmlCode</code></p> <p>String or XML</p> <p>A string containing valid XML code, or an existing XML object.</p> <ul> <li>If a valid string is supplied, returns a new XML object encapsulating the XML code. If the XML code cannot be parsed, throws a JavaScript error.</li> <li>If an existing object is supplied and the <code>new</code> operator is used, returns a copy of the object; otherwise, returns the object itself.</li> </ul>"},{"location":"integrating-xml/xml-object-reference/#xml-settings","title":"XML Settings","text":"<p>These static properties are available through the XML class. They control how XML is parsed and generated:</p> Property Type Description <code>ignoreComments</code> Boolean Description When <code>true</code>, comments are stripped from the XML during parsing. Default is <code>false</code>. <code>ignoreProcessingInstructions</code> Boolean Description When <code>true</code>, processing instructions (<code>&lt;?xxx?&gt;</code> elements) are stripped from the XML during parsing. Default is <code>false</code>. <code>ignoreWhitespace</code> Boolean Description When <code>true</code>, white-space characters are stripped from the XML during parsing. Default is <code>true</code>. <code>prettyIndent</code> Number Description The number of spaces to use for indenting when pretty-printing. Default is 2. <code>prettyPrinting</code> Boolean Description When <code>true</code>, <code>toXMLString()</code> uses indenting and line feeds to create the XML string. Default is <code>true</code>."},{"location":"integrating-xml/xml-object-reference/#xml-class-methods","title":"XML Class Methods","text":"<p>These static functions are available through the XML class, and provide information about the global settings of the XML parser.</p>"},{"location":"integrating-xml/xml-object-reference/#xmldefaultsettings","title":"XML.defaultSettings()","text":"<p><code>XML.defaultSettings();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description","title":"Description","text":"<p>Retrieves the default global option settings that control how XML is parsed and generated.</p>"},{"location":"integrating-xml/xml-object-reference/#returns","title":"Returns","text":"<p>Returns a JavaScript object containing five properties, which correspond to the five XML Settings.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlsettings","title":"XML.settings()","text":"<p><code>XML.settings();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_1","title":"Description","text":"<p>Retrieves the current global option settings that control how XML is parsed and generated.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_1","title":"Returns","text":"<p>Returns a JavaScript object containing five properties, which correspond to the five XML Settings</p>"},{"location":"integrating-xml/xml-object-reference/#xmlsetsettings","title":"XML.setSettings()","text":"<p><code>XML.setSettings(object);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_2","title":"Description","text":"<p>Sets the global option settings that control how XML is parsed and generated. You can use this to restore settings retrieved with settings() or defaultSettings().</p>"},{"location":"integrating-xml/xml-object-reference/#parameters","title":"Parameters","text":"Parameter Type Description <code>object</code> Object A JavaScript object containing five properties, which correspond to the five XML Settings"},{"location":"integrating-xml/xml-object-reference/#returns_2","title":"Returns","text":"<p>Nothing</p>"},{"location":"integrating-xml/xml-object-reference/#xml-object-attributes","title":"XML Object Attributes","text":"<p>The properties of the XML object are named for and contain the values of the child elements and attributes of the element that the object represents.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlobjchildelementname","title":"xmlObj.childElementName","text":"<p><code>xmlObj.childElementName</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_3","title":"Description","text":"<p>Child-element properties are named with the child element name.</p>"},{"location":"integrating-xml/xml-object-reference/#type","title":"Type","text":"<p>XML object</p>"},{"location":"integrating-xml/xml-object-reference/#xmlobjattributename","title":"xmlObj.@attributeName","text":"<p><code>xmlObj.@attributeName</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_4","title":"Description","text":"<p>Attribute properties are named with the attribute name prefixed with the at-sign, <code>@</code>.</p>"},{"location":"integrating-xml/xml-object-reference/#type_1","title":"Type","text":"<p>XML object</p>"},{"location":"integrating-xml/xml-object-reference/#xml-object-methods","title":"XML Object Methods","text":""},{"location":"integrating-xml/xml-object-reference/#xmladdnamespace","title":"XML.addNamespace()","text":"<p><code>xmlObj.addNamespace(ns);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_5","title":"Description","text":"<p>Adds a namespace declaration to this node.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>ns</code> Namespace object Namespace declaration to add"},{"location":"integrating-xml/xml-object-reference/#returns_3","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlappendchild","title":"XML.appendChild()","text":"<p><code>xmlObj.appendChild(child);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_6","title":"Description","text":"<p>Appends a child element to this node, after any existing children. If the argument is not XML, creates a new XML element that contains the string as its text value, using the same element name as the last element currently contained in this object's node.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>child</code> XML object, or any value that can be converted to a String with <code>toString()</code> Child element to append"},{"location":"integrating-xml/xml-object-reference/#returns_4","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlattributes","title":"XML.attributes()","text":"<p><code>xmlObj.attributes(name);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_7","title":"Description","text":"<p>Retrieves a list of the named attribute elements contained in this node.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>name</code> String Ahe attribute name."},{"location":"integrating-xml/xml-object-reference/#returns_5","title":"Returns","text":"<p>An XML object containing all values of the named attribute.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlchild","title":"XML.child()","text":"<p><code>xmlObj.child(which);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_8","title":"Description","text":"<p>Retrieves a list of all child elements of this node of a given type.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>which</code> String or Number The element name, or a Number, a 0-based index into this node's child array."},{"location":"integrating-xml/xml-object-reference/#returns_6","title":"Returns","text":"<p>An XML object containing all child elements of the given type.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlchildindex","title":"XML.childIndex()","text":"<p><code>xmlObj.childIndex ();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_9","title":"Description","text":"<p>Retrieves the 0-based position index of this node within its parent node.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_7","title":"Returns","text":"<p>Number</p>"},{"location":"integrating-xml/xml-object-reference/#xmlchildren","title":"XML.children()","text":"<p><code>xmlObj.children();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_10","title":"Description","text":"<p>Retrieves all of the immediate child elements of this node, including text elements.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_8","title":"Returns","text":"<p>An XML object containing the child elements.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlcomments","title":"XML.comments()","text":"<p><code>xmlObj.comments();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_11","title":"Description","text":"<p>Retrieves all XML comment elements from this node.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_9","title":"Returns","text":"<p>An XML object containing the comments.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlcontains","title":"XML.contains()","text":"<p><code>xmlObj.contains(element);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_12","title":"Description","text":"<p>Reports whether an element is contained in this node at any level of nesting.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>element</code> XML object Element to check"},{"location":"integrating-xml/xml-object-reference/#returns_10","title":"Returns","text":"<p>Boolean. <code>true</code> if the element is contained in this XML tree.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlcopy","title":"XML.copy()","text":"<p><code>xmlObj.copy();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_13","title":"Description","text":"<p>Creates a copy of this node.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_11","title":"Returns","text":"<p>The new XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmldescendants","title":"XML.descendants()","text":"<p><code>xmlObj.descendants([name]);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_14","title":"Description","text":"<p>Retrieves all descendent elements of this node of a given element type, or all XML-valued descendants, at any level of nesting. Includes text elements.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>name</code> String Optional. The element name to match. If not provided, matches all elements."},{"location":"integrating-xml/xml-object-reference/#returns_12","title":"Returns","text":"<p>An XML object containing properties for each descendant element.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlelements","title":"XML.elements()","text":"<p><code>xmlObj.elements(name);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_15","title":"Description","text":"<p>Retrieves all of the immediate child elements of this node of the given type, or of all types. Does not include text elements.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>name</code> String Optional. The element name to match. If not provided, matches all elements."},{"location":"integrating-xml/xml-object-reference/#returns_13","title":"Returns","text":"<p>An XML object containing properties for each child element.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlhascomplexcontent","title":"XML.hasComplexContent()","text":"<p><code>xmlObj.hasComplexContent();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_16","title":"Description","text":"<p>Reports whether this node has complex content; that is, whether it contains child elements. Disregards contents of other kinds, including attributes, comments, processing instructions and text nodes.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_14","title":"Returns","text":"<p>Boolean. <code>true</code> if this node contains child elements.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlhassimplecontent","title":"XML.hasSimpleContent()","text":"<p><code>xmlObj.hasSimpleContent();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_17","title":"Description","text":"<p>Reports whether this node has simple content; that is, whether it represents a text node, an attribute node, or an element without child elements (regardless of whether it also contains attributes, comments, processing instructions or text).</p> <p>Object representing comments and processing instructions do not have simple content.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_15","title":"Returns","text":"<p>Boolean. <code>true</code> if this node contains no child elements.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlinscopenamespaces","title":"XML.inScopeNamespaces()","text":"<p><code>xmlObj.inScopeNamespaces();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_18","title":"Description","text":"<p>Retrieves the current list of valid namespaces in this element.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_16","title":"Returns","text":"<p>An Array of Namespace object, in which the last member is the default namespace.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlinsertchildafter","title":"XML.insertChildAfter()","text":"<p><code>xmlObj.insertChildAfter(child1, child2);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_19","title":"Description","text":"<p>Inserts a new child element or text node into this node, after another existing child element. If the relative element is not currently in this node, does not insert the new child.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>child1</code> XML object The existing child element after which to place the new child, or <code>null</code> to insert the new child at the beginning. <code>child2</code> XML object The new child element, or any value that can be converted to a String with <code>toString()</code>."},{"location":"integrating-xml/xml-object-reference/#returns_17","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlinsertchildbefore","title":"XML.insertChildBefore()","text":"<p><code>xmlObj.insertChildBefore(child1, child2);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_20","title":"Description","text":"<p>Inserts a new child element or text node into this node, before another existing child element. If the relative element is not currently in this node, does not insert the new child.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_9","title":"Parameters","text":"Parameter Type Description <code>child1</code> XML object The existing child element before which to place the new child, or null to insert the new child at the end. <code>child2</code> XML object The new child element, or any value that can be converted to a String with <code>toString()</code>."},{"location":"integrating-xml/xml-object-reference/#returns_18","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmllength","title":"XML.length()","text":"<p><code>xmlObj.length();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_21","title":"Description","text":"<p>Reports the number of child elements contained in this node. The minimum number is 1, the element that this object represents.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_19","title":"Returns","text":"<p>Number</p>"},{"location":"integrating-xml/xml-object-reference/#xmllocalname","title":"XML.localName()","text":"<p><code>xmlObj.localName();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_22","title":"Description","text":"<p>Retrieves the local name of this element; that is, the element name, without any namespace prefix.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_20","title":"Returns","text":"<p>String</p>"},{"location":"integrating-xml/xml-object-reference/#xmlname","title":"XML.name()","text":"<p><code>xmlObj.name();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_23","title":"Description","text":"<p>Retrieves the full name of this element, with the namespace information.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_21","title":"Returns","text":"<p>A QName object containing the element name and namespace URI.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlnamespace","title":"XML.namespace()","text":"<p><code>xmlObj.namespace();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_24","title":"Description","text":"<p>Retrieves the namespace URI of this element.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_22","title":"Returns","text":"<p>String</p>"},{"location":"integrating-xml/xml-object-reference/#xmlnodekind","title":"XML.nodeKind()","text":"<p><code>xmlObj.nodeKind();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_25","title":"Description","text":"<p>Reports the type of this node.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_23","title":"Returns","text":"<p>A String, one of:</p> <ul> <li><code>element</code></li> <li><code>attribute</code></li> <li><code>comment</code></li> <li><code>processing-instruction</code></li> <li><code>text</code></li> </ul>"},{"location":"integrating-xml/xml-object-reference/#xmlnamespacedeclarations","title":"XML.namespaceDeclarations()","text":"<p><code>xmlObj.namespaceDeclarations();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_26","title":"Description","text":"<p>Retrieves all of the namespace declarations contained in this node.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_24","title":"Returns","text":"<p>An Array of Namespace object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlnormalize","title":"XML.normalize()","text":"<p><code>xmlObj.normalize();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_27","title":"Description","text":"<p>Puts all text nodes in this and all descendant XML objects into a normal form by merging adjacent text nodes and eliminating empty text nodes.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_25","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlparent","title":"XML.parent()","text":"<p><code>xmlObj.parent();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_28","title":"Description","text":"<p>Retrieves the parent node of this node.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_26","title":"Returns","text":"<p>An XML object, or <code>null</code> for the root element.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlprependchild","title":"XML.prependChild()","text":"<p><code>xmlObj.prependChild(child);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_29","title":"Description","text":"<p>Prepends a child element to this node, before any existing children. If you prepend a string to a text element, the result is two text elements; call normalize() to concatenate them into a single text string.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_10","title":"Parameters","text":"Parameter Type Description <code>child</code> XML object or String Child element to prepend"},{"location":"integrating-xml/xml-object-reference/#returns_27","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlprocessinginstructions","title":"XML.processingInstructions()","text":"<p><code>xmlObj.processingInstructions ([name]);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_30","title":"Description","text":"<p>A String, the name of a processing instruction, or null to get all processing instructions.</p> <p>Retrieves processing instructions contained in this node.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_28","title":"Returns","text":"<p>An XML object containing the children of this object that are processing instructions, matching the name if supplied.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlreplace","title":"XML.replace()","text":"<p><code>xmlObj.replace(name, value);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_31","title":"Description","text":"<p>Replaces one or more property values in this node.</p> <p>If the named element does not exist, appends the given value as a text element.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_11","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>name</code></p> <p>String</p> <p>An element or attribute name, with or without the 0-based position index of a specific element, or the wildcard string <code>\"*\"</code>.</p> <ul> <li>If no position index is supplied, replaces the value of all matching elements.</li> <li>If the wildcard is supplied, replaces the value of all contained elements. When an element contain subelements, those are removed, and only the replacement value remains.</li> </ul> <p><code>value</code></p> <p>XML object or any value that can be converted to a String with <code>toString()</code></p> <p>Value to replace with</p>"},{"location":"integrating-xml/xml-object-reference/#returns_29","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlsetchildren","title":"XML.setChildren()","text":"<p><code>xmlObj.setChildren(value);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_32","title":"Description","text":"<p>Replaces all of the XML-valued properties in this object with a new value, which can be a simple text element, or can contain another set of XML properties.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_12","title":"Parameters","text":"Parameter Type Description <code>value</code> XML object or any value that can be converted to a String with <code>toString()</code>. Value to replace with"},{"location":"integrating-xml/xml-object-reference/#returns_30","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlsetlocalname","title":"XML.setLocalName()","text":"<p><code>xmlObj.setLocalName(name);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_33","title":"Description","text":"<p>Replaces the local name of this object; that is, the element name without any namespace prefix.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_13","title":"Parameters","text":"Parameter Type Description <code>name</code> String The new name."},{"location":"integrating-xml/xml-object-reference/#returns_31","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlsetname","title":"XML.setName()","text":"<p><code>xmlObj.setName(name);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_34","title":"Description","text":"<p>Replaces the full name of this object; that is, the element name and its namespace prefix.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_14","title":"Parameters","text":"Parameter Type Description <code>name</code> String The new name."},{"location":"integrating-xml/xml-object-reference/#returns_32","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmlsetnamespace","title":"XML.setNamespace()","text":"<p><code>xmlObj.setNamespace(ns);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_35","title":"Description","text":"<p>Sets the namespace for this XML element. If the namespace has not been declared in the tree above this element, add a namespace declaration instead.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_15","title":"Parameters","text":"Parameter Type Description <code>ns</code> Namespace object Namespace that has been declared in the tree above this element."},{"location":"integrating-xml/xml-object-reference/#returns_33","title":"Returns","text":"<p>This XML object.</p>"},{"location":"integrating-xml/xml-object-reference/#xmltext","title":"XML.text()","text":"<p><code>xmlObj.text();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_36","title":"Description","text":"<p>Retrieves text nodes from this element.</p> <p>An XML object containing all properties of this object that represent XML text nodes.</p>"},{"location":"integrating-xml/xml-object-reference/#xmltostring","title":"XML.toString()","text":"<p><code>xmlObj.toString();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_37","title":"Description","text":"<p>Creates a string representation of this object.</p> <ul> <li>For text and attribute nodes, this is the textual value of the node.</li> <li>For other elements, it is the result of toXMLString().</li> <li>If this XML object is a list, concatenates the result of calling the function on each contained element.</li> </ul>"},{"location":"integrating-xml/xml-object-reference/#returns_34","title":"Returns","text":"<p>String</p>"},{"location":"integrating-xml/xml-object-reference/#xmltoxmlstring","title":"XML.toXMLString()","text":"<p><code>xmlObj.toXMLString();</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_38","title":"Description","text":"<p>Creates an XML-encoded string representation of this XML object.</p> <p>This result includes the start tag, attributes and end tag of the XML object, regardless of its content. Formats the string as specified by the global settings XML.prettyPrinting and XML.prettyIndent.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_35","title":"Returns","text":"<p>String</p>"},{"location":"integrating-xml/xml-object-reference/#xmlxpath","title":"XML.xpath()","text":"<p><code>xmlObj.xpath(expression[, variables]);</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_39","title":"Description","text":"<p>Evaluates an XPath expression in accordance with the W3C XPath recommendation, using this XML object as the context node. The context position and size are set to 1, and all variables are initially unbound. If this XML object is a list, evaluates all contained XML element nodes (not comments or other node types) and return the results in a list in the order of execution.</p> <p>If the XPath expression does not evaluate to a node list, throws a JavaScript exception.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_16","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>expression</code></p> <p>String</p> <p>A String containing an XPath expression.</p> <p>Note</p> <p>In this context, include the actual top level element. For example, an expression for the example XML must start with \"/bookstore\". This is unlike JavaScript property access, where the top level element is implied.</p> <p><code>variables</code></p> <p>Object</p> <p>Optional. A JavaScript object containing variable definitions. The properties are used to look up XPath variables contained in the expression. For example, if the expression contains the variable <code>$abc</code>, the value is in the object's <code>abc</code> property.</p>"},{"location":"integrating-xml/xml-object-reference/#returns_36","title":"Returns","text":"<p>An XML object, the result of evaluation.</p>"},{"location":"integrating-xml/xml-object-reference/#global-functions","title":"Global functions","text":"<p>These functions are available in the JavaScript global namespace.</p>"},{"location":"integrating-xml/xml-object-reference/#isxmlname","title":"isXMLName()","text":"<p><code>isXMLName(String name)</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_40","title":"Description","text":"<p>Reports whether a string contains a name that conforms to valid XML syntax.</p> <p>Note</p> <p>This implementation uses the same rules as for a JavaScript name, except for the '$' character, which is disallowed, and the '-' character, which as added.</p> <p>It does not follow the W3C definition of an XML name, which adds more Unicode characters to the valid set of characters.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_17","title":"Parameters","text":"Parameter Type Description <code>name</code> String Whether the string is an XML Name"},{"location":"integrating-xml/xml-object-reference/#returns_37","title":"Returns","text":"<p>Boolean. <code>true</code> if the name is a valid XML name, <code>false</code> otherwise.</p>"},{"location":"integrating-xml/xml-object-reference/#setdefaultxmlnamespace","title":"setDefaultXMLNamespace()","text":"<p><code>setDefaultXMLNamespace(Namespace ns)</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_41","title":"Description","text":"<p>Sets the default namespace for XML objects. You can also set the default namespace using this syntax:</p> <pre><code>default xml namespace = Namespace object\ndefault xml namespace = URL_string\n</code></pre>"},{"location":"integrating-xml/xml-object-reference/#parameters_18","title":"Parameters","text":"Parameter Type Description <code>ns</code> Namespace object Object to set as default. Any prefix is ignored."},{"location":"integrating-xml/xml-object-reference/#returns_38","title":"Returns","text":"<p>Nothing</p>"},{"location":"integrating-xml/xml-object-reference/#qname-object","title":"QName Object","text":"<p>This object encapsulates a fully qualified XML name, the combination of a local XML name and its namespace URI.</p>"},{"location":"integrating-xml/xml-object-reference/#qname-object-constructor","title":"QName object constructor","text":"<p>The constructor takes several forms:</p> <pre><code>new QName ()\nnew QName (name)\nnew QName (ns)\nnew QName (uri, name)\n</code></pre> <p>When no arguments are supplies, creates a <code>QName</code> object with an empty local name and no URI.</p> Parameter Type Description name String Creates a <code>QName</code> object with the given local name and the URI of the default namespace. Can be the wildcard character, \"*\". name QName Creates a copy of an existing QName object. ns Namespace Creates a <code>QName</code> object with an empty local name and the URI of the Namespace object. uri, name String Create a <code>QName</code> object with the given namespace URI and local name. If the local name is supplied as the wildcard character, \"*\", the <code>uri</code> argument is ignored, and the URI value is that of the default namespace."},{"location":"integrating-xml/xml-object-reference/#qname-object-attributes","title":"QName Object Attributes","text":""},{"location":"integrating-xml/xml-object-reference/#qnamename","title":"QName.name","text":"<p><code>QName.name</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_42","title":"Description","text":"<p>The local element name portion of the XML element's fully qualified XML name.</p>"},{"location":"integrating-xml/xml-object-reference/#type_2","title":"Type","text":"<p>String</p>"},{"location":"integrating-xml/xml-object-reference/#qnameuri","title":"QName.uri","text":"<p><code>QName.uri</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_43","title":"Description","text":"<p>The namespace prefix of the XML element's fully qualified XML name.</p>"},{"location":"integrating-xml/xml-object-reference/#type_3","title":"Type","text":"<p>String</p>"},{"location":"integrating-xml/xml-object-reference/#namespace-object","title":"Namespace object","text":"<p>This object encapsulates the definition of an XML namespace. A namespace associates an XML-name prefix with a complete URI. The prefix is a string that precedes the local name of an XML element or attribute and identifies the namespace, while the URI points to the actual location where the definition of the namespace is found.</p> <p>For example, this XML definition contains a namespace declaration:</p> <pre><code>&lt;?xml xmlns:adobe=http://www.adobe.com/test?&gt;\n</code></pre> <p>In the corresponding namespace, the prefix is <code>adobe</code>, and the URI is <code>http://www.adobe.com/test</code>.</p>"},{"location":"integrating-xml/xml-object-reference/#namespace-object-constructor","title":"Namespace object constructor","text":"<p>The Namespace constructor takes several forms:</p> <pre><code>new Namespace()\nnew Namespace (String uri)\nnew Namespace (QName prefix)\nnew Namespace (Namespace ns)\nnew Namespace (String prefix, String uri)\n</code></pre> <p>When no argument is supplied, creates a namespace with an empty prefix and URI.</p>"},{"location":"integrating-xml/xml-object-reference/#parameters_19","title":"Parameters","text":"Parameter Type Description <code>uri</code> String Creates a Namespace object with an empty prefix and the given URI. <code>prefix</code> QName Creates a namespace with an empty prefix and the URI set to the URI of the QName object (if the QName object contains a URI). <code>ns</code> Namespace Creates a copy of the given Namespace object. If the <code>Namespace()</code> function is called without the <code>new</code> operator, and the only argument is a <code>Namespace</code> object, the function simply returns that object, rather than creating a copy. <code>prefix, uri</code> String Creates a <code>Namespace</code> object with the given prefix and the given URI."},{"location":"integrating-xml/xml-object-reference/#namespace-object-attributes","title":"Namespace Object Attributes","text":""},{"location":"integrating-xml/xml-object-reference/#namespaceprefix","title":"Namespace.prefix","text":"<p><code>namespace.prefix</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_44","title":"Description","text":"<p>The element-name prefix associated with the namespace URI. The prefix value can be <code>undefined</code>, as when a specified prefix is not a valid XML name.</p> <p>Namespaces with an undefined prefix are completely ignored; they are not added to an XML namespace declaration.</p>"},{"location":"integrating-xml/xml-object-reference/#type_4","title":"Type","text":"<p>String</p>"},{"location":"integrating-xml/xml-object-reference/#namespaceuri","title":"Namespace.uri","text":"<p><code>namespace.uri</code></p>"},{"location":"integrating-xml/xml-object-reference/#description_45","title":"Description","text":"<p>The location of the namespace definition, a URI.</p>"},{"location":"integrating-xml/xml-object-reference/#type_5","title":"Type","text":"<p>String</p>"},{"location":"interapplication-communication/","title":"Interapplication Communication with Scripts","text":"<p>The Adobe scripting environment provides an interapplication messaging framework, a way for to send and receive information and scripts from one Adobe application to another. An application that supports the messaging framework is said to be message enabled.</p> <p>Code samples that demonstrate various techniques are provided with the Adobe ExtendScript SDK, and referenced by name in the relevant sections.</p>"},{"location":"interapplication-communication/application-and-namespace-specifiers/","title":"Application and namespace specifiers","text":"<p>All forms of interapplication communication use Application specifiers to identify Adobe applications.</p> <p>In all ExtendScript scripts, the #target directive can use an specifier to identify the application that should run that script. See Preprocessor directives.</p> <p>In interapplication messages, the specifier is used as the value of the target property of the message object, to identify the target application for the message.</p> <p>Adobe Bridge (which is integrated with many Adobe applications) uses an application specifier as the value of the <code>document.owner</code> property, to identify another application that created or opened an Adobe Bridge browser window. For details, see the Adobe Bridge JavaScript Reference.</p> <p>When a script for one application invokes cross-DOM or exported functions, it identifies the exporting application using Namespace specifiers.</p>"},{"location":"interapplication-communication/application-and-namespace-specifiers/#application-specifiers","title":"Application specifiers","text":"<p>Application specifiers are strings that encode the application name, a version number and a language code. They take the following form: <code>appname[_instance[[-version[-locale]]]</code></p> <p>Specifier</p> <p>Description</p> <p><code>appname</code></p> <p>An Adobe application name. For example, these are the identifying strings for applications that can use the ExtendScript Toolkit in Creative Suite 4:</p> <ul> <li><code>aftereffects</code></li> <li><code>bridge</code></li> <li><code>estoolkit</code></li> <li><code>illustrator</code></li> <li><code>incopy</code></li> <li><code>indesign</code></li> <li><code>indesignserver</code></li> <li><code>photoshop</code></li> </ul> <p><code>instance</code></p> <p>Optional. An additional string appended with an underscore, that distinguishes the instance for those applications (such as InDesign Server) that support the launching and running of multiple instances.</p> <p>For example, for a server launched with SOAP port 12345, the specifier would be <code>indesignserver_configuration_12345</code>.</p> <p><code>version</code></p> <p>Optional. A number indicating at least a major version. The number should include a minor version separated from the major version number by a dot; for example, 1.5.</p> <p>If not supplied, assumes the same suite version as the sending application, if possible; otherwise, the highest available version number.</p> <p>This is the complete list of identifying names and version numbers for applications that can use interapplication messaging in Creative Suite 4:</p> <ul> <li><code>acrobat-9.0</code></li> <li><code>aftereffects-9.0</code></li> <li><code>soundbooth-2.0</code></li> <li><code>bridge-3.0</code></li> <li><code>contribute-5.0</code></li> <li><code>devicecentral-2.0</code></li> <li><code>dreamweaver-10.0</code></li> <li><code>encore-4.0</code></li> <li><code>estoolkit-3.0</code></li> <li><code>fireworks-10.0</code></li> <li><code>flash-10.0</code></li> <li><code>illustrator-14.0</code></li> <li><code>indesign-6.0</code></li> <li><code>indesignserver-6.0</code></li> <li><code>incopy-6.0</code></li> <li><code>photoshop-11.0</code></li> <li><code>premierepro-4.0</code></li> <li><code>audition-4.0</code></li> <li><code>ame-1.0</code></li> <li><code>exman-2.0</code></li> </ul> <p><code>locale</code></p> <p>Optional. An Adobe locale code, consisting of a 2-letter ISO-639 language code and an optional 2-letter ISO 3166 country code separated by an underscore. Case is significant.</p> <p>For example, <code>en_us</code>, <code>en_uk</code>, <code>ja_jp</code>, <code>de_de</code>, <code>fr_fr</code>. If not supplied, ExtendScript uses the current platform locale.</p> <p>Do not specify a locale for a multilingual application, such as Bridge, that has all locale versions included in a single installation.</p> <p>The following are examples of legal specifiers:</p> <ul> <li><code>photoshop</code></li> <li><code>bridge-3.0</code></li> <li><code>indesign_1-6.0</code></li> <li><code>illustrator-14.0</code></li> <li><code>illustrator-14.0-de_de</code></li> </ul> <p>If a specifier does not supply specific version and locale information, the framework tries to find the most appropriate available installation. It tries to match to available applications in this order:</p> <ol> <li>Peer applications (from the same suite)</li> <li>Applications with the highest available version number</li> <li>Applications that are currently running</li> <li>Applications that match the current locale</li> <li>Applications for any locale</li> </ol>"},{"location":"interapplication-communication/application-and-namespace-specifiers/#namespace-specifiers","title":"Namespace specifiers","text":"<p>When calling cross-DOM and exported functions from other applications, a namespace specifier qualifies the function call, directing it to the appropriate application.</p> <p>Namespace specifiers consist of an application name, as used in an application specifier, with an optional major version number. Use it as a prefix to an exported function name, with the JavaScript dot notation. appname[majorVersion].functionName(args)</p> <p>For example:</p> <ul> <li>To call the cross-DOM function quit in Photoshop, use photoshop.quit(), and to call it in Adobe Illustrator\u00ae, use illustrator.quit().</li> <li>To call the exported function place, defined for Illustrator CS5 version 15 call illustrator15.place(myFiles).</li> </ul> <p>For information about the cross-DOM and exported functions, see Remote function calls.</p>"},{"location":"interapplication-communication/bridgetalk-class/","title":"BridgeTalk class","text":"<p>Static properties and methods of this class provide a way for your script to determine basic messaging system information before you create any specific message objects. Static methods allow you to check if an application is installed and is already running, and to launch the application. A callback defined on the class determines how the application processes incoming messages.</p> <p>You can access static properties and methods in the BridgeTalk class, which is available in the global namespace. For example:</p> <pre><code>var thisApp = BridgeTalk.appName;\n</code></pre> <p>Note</p> <p>You must instantiate the BridgeTalk class to create the BridgeTalk message object, which is used to send message packets between applications. Dynamic properties and methods can be accessed only in instances.</p>"},{"location":"interapplication-communication/bridgetalk-class/#attributes","title":"Attributes","text":"<p>The BridgeTalk class provides these static properties, which are available in the global namespace:</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkappinstance","title":"BridgeTalk.appInstance","text":"<p><code>BridgeTalk.appInstance</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description","title":"Description","text":"<p>The instance identifier of an application launched by the messaging framework, the instance portion of an application specifier; see Application specifiers.</p> <p>Used only for those applications, such as InDesign, that support launching and running multiple instances.</p>"},{"location":"interapplication-communication/bridgetalk-class/#type","title":"Type","text":"<p>String. Read only.</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkapplocale","title":"BridgeTalk.appLocale","text":"<p><code>BridgeTalk.appLocale</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_1","title":"Description","text":"<p>The locale of this application, the locale portion of an application specifier; see Application specifiers. When a message is sent, this is the locale of the sending application.</p>"},{"location":"interapplication-communication/bridgetalk-class/#type_1","title":"Type","text":"<p>String. Read only.</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkappname","title":"BridgeTalk.appName","text":"<p><code>BridgeTalk.appName</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_2","title":"Description","text":"<p>The name of this application, the appname portion of an application specifier; see Application specifiers. When a message is sent, this is the name of the sending application.</p>"},{"location":"interapplication-communication/bridgetalk-class/#type_2","title":"Type","text":"<p>String. Read only.</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkappspecifier","title":"BridgeTalk.appSpecifier","text":"<p><code>BridgeTalk.appSpecifier</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_3","title":"Description","text":"<p>A lower-case string containing the complete specifier for this application; see Application specifiers.</p>"},{"location":"interapplication-communication/bridgetalk-class/#type_3","title":"Type","text":"<p>String.</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkappstatus","title":"BridgeTalk.appStatus","text":"<p><code>BridgeTalk.appStatus</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_4","title":"Description","text":"<p>The current processing status of this application. One of:</p> <ul> <li><code>busy</code>: The application is currently busy, but not processing messages. This is the case, for example, when a modal dialog is shown.</li> <li><code>idle</code>: The application is currently idle, but processes messages regularly.</li> <li><code>not installed</code>: The application is not installed.</li> </ul>"},{"location":"interapplication-communication/bridgetalk-class/#type_4","title":"Type","text":"<p>String. Read only.</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkappversion","title":"BridgeTalk.appVersion","text":"<p><code>BridgeTalk.appVersion</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_5","title":"Description","text":"<p>The version number of this application, the version portion of an application specifier; see Application specifiers. When a message is sent, this is the version of the sending application.</p>"},{"location":"interapplication-communication/bridgetalk-class/#type_5","title":"Type","text":"<p>String. Read only.</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkonreceive","title":"BridgeTalk.onReceive","text":"<p><code>BridgeTalk.onReceive</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_6","title":"Description","text":""},{"location":"interapplication-communication/bridgetalk-class/#returns","title":"Returns","text":"<p>callback function that this application applies to unsolicited incoming messages. The default function evaluates the body of the received message and returns the result of evaluation. To change the default behavior, set this to a function definition in the following form:</p> <pre><code>BridgeTalk.onReceive = function( bridgeTalkObject ) {\n    // act on received message\n};\n</code></pre> <p>The body property of the received message object contains the received data. The function can return any type. See Handling unsolicited messages.</p> <p>Note</p> <p>This function is not applied to a message that is received in response to a message sent from this application. Response messages are processed by the onResult, onReceived, or onError callbacks associated with the sent message.</p>"},{"location":"interapplication-communication/bridgetalk-class/#type_6","title":"Type","text":"<p>Function</p>"},{"location":"interapplication-communication/bridgetalk-class/#methods","title":"Methods","text":"<p>The BridgeTalk class provides these static methods, which are available in the global namespace:</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkbringtofront","title":"BridgeTalk.bringToFront()","text":"<p><code>BridgeTalk.bringToFrontapp)</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_7","title":"Description","text":"<p>Brings all windows of the specified application to the front of the screen.</p> <p>In Mac OS, an application can be running but have no windows open. In this case, calling this function might or might not open a new window, depending on the application. For Adobe Bridge, it opens a new browser window.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters","title":"Parameters","text":"Parameter Type Description <code>app</code> Application specifiers A specifier for the target application"},{"location":"interapplication-communication/bridgetalk-class/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkgetapppath","title":"BridgeTalk.getAppPath()","text":"<p><code>BridgeTalk.getAppPathapp)</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_8","title":"Description","text":"<p>Retrieves the full path of the executable file for a specified application.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>app</code> Application specifiers A specifier for the target application"},{"location":"interapplication-communication/bridgetalk-class/#returns_2","title":"Returns","text":"<p>String</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkgetdisplayname","title":"BridgeTalk.getDisplayName()","text":"<p><code>BridgeTalk.getDisplayNameapp)</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_9","title":"Description","text":"<p>Returns a localized display name for an application, or <code>null</code> if the application is not installed. For example:</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>app</code> Application specifiers A specifier for the target application"},{"location":"interapplication-communication/bridgetalk-class/#returns_3","title":"Returns","text":"<p>String</p>"},{"location":"interapplication-communication/bridgetalk-class/#example","title":"Example","text":"<pre><code>BridgeTalk.getDisplayName(\"photoshop-10.0\");\n=&gt; Adobe Photoshop CS4\n</code></pre>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkgetspecifier","title":"BridgeTalk.getSpecifier()","text":"<p><code>BridgeTalk.getSpecifierappName[, version][, locale])</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_10","title":"Description","text":"<p>Retrieves a complete application specifier.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_3","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>appName</code></p> <p>The base name of the application to search for.</p> <p><code>version</code></p> <p>Number</p> <p>Optional. The specific version number to search for. If <code>0</code> or not supplied, returns the most recent version. If negative, returns the highest version up to and including the absolute value.</p> <p>If a major version is specified, returns the highest minor-version variation. For example, if Photoshop CS versions 9, 9.1, and 10 are installed:</p> <p><pre><code>BridgeTalk.Specifier( \"photoshop\", \"9\" )\n =&amp;gt; [\"photoshop-9.1\"]\n</code></pre></p> <p><code>locale</code></p> <p>String</p> <p>Optional. The specific locale to search for. If not supplied and multiple language versions are installed, prefers the version for the current locale.</p>"},{"location":"interapplication-communication/bridgetalk-class/#returns_4","title":"Returns","text":"<p>Application specifier for a messaging-enabled application version installed on this computer, or <code>null</code> if the requested version of the application is not installed.</p>"},{"location":"interapplication-communication/bridgetalk-class/#example_1","title":"Example","text":"<p>For example, assuming installed applications include Photoshop CS4 11.0 <code>en_us</code>, Photoshop CS2 8.5 <code>de_de</code>, Photoshop CS2 9.0 <code>de_de</code>, and Photoshop CS2 9.5 <code>de_de</code>, and that the current locale is <code>en_US</code></p> <pre><code>BridgeTalk.getSpecifier (\"photoshop\");\n    =&gt; [\"photoshop-11.0-en_us\"]\n\nBridgeTalk.getSpecifier (\"photoshop\", 0, \"en_us\");\n    =&gt; [\"photoshop-11.0-en_us\"]\n\nBridgeTalk.getSpecifier (\"photoshop\", 0, \"de_de\");\n    =&gt; [\"photoshop-9.5-de_de\"]\n\nBridgeTalk.getSpecifier (\"photoshop\", -9.2, \"de_de\");\n    =&gt; [\"photoshop-9.0-de_de\"]\n\nBridgeTalk.getSpecifier (\"photoshop\", 8);\n    =&gt; [\"photoshop-8.5-de_de\"]\n</code></pre>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkgetstatus","title":"BridgeTalk.getStatus()","text":"<p><code>BridgeTalk.getStatus(targetSpec)</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_11","title":"Description","text":"<p>Retrieves the processing status of an application.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>targetSpec</code> Application specifiers Optional. A specifier for the target application. If not supplied, returns the processing status of the current application."},{"location":"interapplication-communication/bridgetalk-class/#returns_5","title":"Returns","text":"<p>String, one of:</p> <ul> <li><code>BUSY</code>: The application is currently busy, but not processing messages. This is the case, for example, when a modal dialog is shown.</li> <li><code>IDLE</code>: The application is currently idle, but processes messages regularly.</li> <li><code>PUMPING</code>: The application is currently processing messages.</li> <li><code>ISNOTRUNNING</code>: The application is installed but not running.</li> <li><code>ISNOTINSTALLED</code>: The application is not installed.</li> <li><code>UNDEFINED</code>: The application is running but not responding to ping requests. This can be true of a CS2 application that uses an earlier version of the messaging framework.</li> </ul>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkgettargets","title":"BridgeTalk.getTargets()","text":"<p><code>BridgeTalk.getTargets([version],[locale])</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_12","title":"Description","text":"<p>Retrieves a list of messaging-enabled applications installed on this computer.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_5","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>version</code></p> <p>Number</p> <p>Optional. The specific version number to search for, or <code>null</code> to return the most appropriate version (matching, most recent, or running), with version information.</p> <p>Specify only a major version number to return the highest minor-version variation.</p> <p>For example, if Photoshop CS versions 9, 9.5, and 10 are installed</p> <p><pre><code>BridgeTalk.getTargets( \"9\" )\n=&amp;gt; [photoshop-9.5]\n</code></pre></p> <p>Specify a negative value to return all versions up to the absolute value of the version number. For example</p> <p><pre><code>BridgeTalk.getTargets( \"-9.9\" )\n=&amp;gt; [photoshop-9.0, photoshop-9.5]\n</code></pre></p> <p><code>locale</code></p> <p>String</p> <p>Optional. The specific locale to search for, or null to <code>return</code> applications for all locales, with locale information. If not supplied when version is supplied, returns specifiers with version information only.</p>"},{"location":"interapplication-communication/bridgetalk-class/#returns_6","title":"Returns","text":"<p>Returns an array of Application specifiers.</p> <ul> <li>If version is supplied, specifiers include the base name plus the version information.</li> <li>If locale is supplied, specifiers include the full name, with both version and locale information.</li> <li>If neither version nor locale is supplied, returns base specifiers with neither version nor locale information, but tries to find the most appropriate version and locale; see Application specifiers.</li> </ul>"},{"location":"interapplication-communication/bridgetalk-class/#example_2","title":"Example","text":"<p>For example, assuming installed applications include Photoshop CS3 10.0 <code>en_US</code>, Photoshop CS4 11.0 <code>en_us</code>, and Illustrator CS4 14.0 <code>de_de</code></p> <pre><code>BridgeTalk.getTargets();\n    =&gt; [photoshop,illustrator]\n\nBridgeTalk.getTargets( \"10.0\" );\n    =&gt; [photoshop-10.0]\n\nBridgeTalk.getTargets( null );\n    =&gt; [photoshop-11.0, illustrator-14.0]\n\nBridgeTalk.getTargets( null, \"en_US\" );\n    =&gt; [photoshop-10.0-en_US, photoshop-11.0-en_US]\n\nBridgeTalk.getTargets( null, null );\n    =&gt; [photoshop-10.0-en_US, photoshop-11.0-en_us, illustrator-14.0-de_de]\n</code></pre>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkisrunning","title":"BridgeTalk.isRunning()","text":"<p><code>BridgeTalk.isRunning(specifier)</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_13","title":"Description","text":"<p>Checks whether a given application is running and active on the local computer.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>specifier</code> Application specifiers A specifier for the target application"},{"location":"interapplication-communication/bridgetalk-class/#returns_7","title":"Returns","text":"<p>Boolean</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalklaunch","title":"BridgeTalk.launch()","text":"<p><code>BridgeTalk.launch(specifier[, where])</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_14","title":"Description","text":"<p>Launches the given application on the local computer. It is not necessary to launch an application explicitly in order to send it a message; sending a message to an application that is not running automatically launches it.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>specifier</code> Application specifiers A specifier for the target application <code>where</code> Unknown. Optional. If the value \"background\" is specified, the application's main window is not brought to the front of the screen."},{"location":"interapplication-communication/bridgetalk-class/#returns_8","title":"Returns","text":"<p>Boolean. <code>true</code> if the application has already been launched, <code>false</code> if it was launched by this call.</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkloadappscript","title":"BridgeTalk.loadAppScript()","text":"<p><code>BridgeTalk.loadAppScript(specifier)</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_15","title":"Description","text":"<p>Loads the startup script for an application from the common StartupScripts folders. Use to implement late loading of startup scripts.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>specifier</code> Application specifiers A specifier for the target application"},{"location":"interapplication-communication/bridgetalk-class/#returns_9","title":"Returns","text":"<p>Boolean. <code>true</code> if the script was successfully loaded.</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkping","title":"BridgeTalk.ping()","text":"<p><code>BridgeTalk.ping(specifier, pingRequest)</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_16","title":"Description","text":"<p>Sends a message to another application to determine whether it can be contacted.</p>"},{"location":"interapplication-communication/bridgetalk-class/#parameters_9","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>specifier</code></p> <p>Application specifiers</p> <p>A specifier for the target application</p> <p><code>pingRequest</code></p> <p>Identifying key string, one of:</p> <ul> <li><code>STATUS</code>: Returns the processing status; see getStatus().</li> <li><code>DIAGNOSTICS</code>: Returns a diagnostic report that includes a list of valid ping keys.</li> <li><code>ECHO_REQUEST</code>: Returns <code>ECHO_RESPONSE</code> for a simple ping request.</li> </ul> <p>Specific type of return value.</p>"},{"location":"interapplication-communication/bridgetalk-class/#returns_10","title":"Returns","text":"<p>String</p>"},{"location":"interapplication-communication/bridgetalk-class/#bridgetalkpump","title":"BridgeTalk.pump()","text":"<p><code>BridgeTalk.pump()</code></p>"},{"location":"interapplication-communication/bridgetalk-class/#description_17","title":"Description","text":"<p>Checks all active messaging interfaces for outgoing and incoming messages, and processes them if there are any.</p> <p>Note</p> <p>Most applications have a message processing loop that continually checks the message queues, so use of this method is rarely required.</p>"},{"location":"interapplication-communication/bridgetalk-class/#returns_11","title":"Returns","text":"<p>Boolean. <code>true</code> if any messages have been processed, <code>false</code> otherwise.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/","title":"BridgeTalk message object","text":"<p>The message object defines the basic communication packet that is sent between applications. Its properties allow you to specify the receiving application (the target), the data to send to the target (the body), and the type of data that is sent. The messaging protocol is extensible; it allows you to define new types of data for the type property, and to send and receive arbitrary additional information with the headers property.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#bridgetalk-message-object-constructor","title":"BridgeTalk message object constructor","text":"<p>Create a new message object using a simple constructor:</p> <pre><code>var bt = new BridgeTalk;\n</code></pre> <p>Before you send a message to another application, you must set the target property to the receiving application, and the body property to the data message (typically a script) you want to send.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#bridgetalk-message-object-properties","title":"BridgeTalk message object properties","text":""},{"location":"interapplication-communication/bridgetalk-message-object/#body","title":"body","text":"<p><code>bridgeTalkObj.body</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description","title":"Description","text":"<p>The data payload of the message.</p> <ul> <li>If this is an unsolicited message to another application, typically contains a script packaged as a string. The target application's full document object model (DOM) is available within the script.</li> <li>If this message is a result returned from the static BridgeTalk <code>onReceive</code> method of a target application, directed to an onResult callback in this object, contains the return result from that method flattened into a string. See Passing values between applications.</li> <li>If this message contains an error notification for the onError callback, contains the error message.</li> </ul>"},{"location":"interapplication-communication/bridgetalk-message-object/#type","title":"Type","text":"<p>String</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#headers","title":"headers","text":"<p><code>bridgeTalkObj.headers</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description_1","title":"Description","text":"<p>A JavaScript object containing script-defined headers.</p> <p>Use this property to define custom header data to send supplementary information between applications. You can add any number of new headers. The headers are name/value pairs, and can be accessed with the JavaScript dot notation (<code>msgObj.headers.propName</code>), or bracket notation (<code>msgObj.headers[propName]</code>). If the header name conforms to JavaScript symbol syntax, use the dot notation. If not, use the bracket notation.</p> <p>The predefined header <code>[\"Error-Code\"]</code> is used to return error messages to a sender; see Messaging error codes.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#type_1","title":"Type","text":"<p>Object</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#example","title":"Example","text":"<p>Examples of setting headers:</p> <pre><code>bt.headers.info = \"Additional Information\";\nbt.headers [\"Error-Code\"] = 8;\n</code></pre> <p>Examples of getting header values:</p> <pre><code>var info = bt.headers.info;\nvar error = bt.headers [\"Error-Code\"];\n</code></pre>"},{"location":"interapplication-communication/bridgetalk-message-object/#sender","title":"sender","text":"<p><code>bridgeTalkObj.sender</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description_2","title":"Description","text":"<p>The application specifier for the sending application (see Application specifiers).</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#type_2","title":"Type","text":"<p>String</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#target","title":"target","text":"<p><code>bridgeTalkObj.target</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description_3","title":"Description","text":"<p>The application specifier for the target, or receiving, application (see Application specifiers).</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#type_3","title":"Type","text":"<p>String</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#timeout","title":"timeout","text":"<p><code>bridgeTalkObj.timeout</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description_4","title":"Description","text":"<p>The number of seconds before the message times out.</p> <p>If a message has not been removed from the input queue for processing before this time elapses, the message is discarded. If the sender has defined an onTimeout() callback for the message, the target application sends a time-out message back to the sender.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#type_4","title":"Type","text":"<p>Number</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#type_5","title":"type","text":"<p><code>bridgeTalkObj.type</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description_5","title":"Description","text":"<p>The message type, which indicates what type of data the body contains.</p> <p>Default is <code>ExtendScript</code>.</p> <p>You can define a type for script-defined data. If you do so, the target application must have a static <code>BridgeTalk</code> <code>onReceive_</code> method that checks for and processes that type.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#type_6","title":"Type","text":"<p>String</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#bridgetalk-message-object-callbacks","title":"BridgeTalk message object callbacks","text":"<p>Note</p> <p>The message callbacks are optional, and are not implemented by all message-enabled applications.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#onerror","title":"onError()","text":"<p><code>bridgeTalkObj.onError()</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description_6","title":"Description","text":"<p>A callback function that the target application invokes to return an error response to the sender. It can send JavaScript run-time errors or exceptions, or C++ exceptions.</p> <p>To define error-response behavior, set this to a function definition in the following form:</p> <pre><code>bridgeTalkObj.onError = function( errorMsgObject ) {\n    // error handler defined here\n};\n</code></pre> <p>The body property of the received message object contains the error message, and the headers property contains the error code in its <code>Error-Code</code> property. See Messaging error codes.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#onreceived","title":"onReceived()","text":""},{"location":"interapplication-communication/bridgetalk-message-object/#description_7","title":"Description","text":"<p><code>bridgeTalkObj.onReceived()</code></p> <p>A callback function that the target application invokes to confirm that the message was received. (Note that this is different from the static <code>onReceive_</code> method of the <code>BridgeTalk</code> class that handles unsolicited messages.)</p> <p>To define a response to receipt notification, set this to a function definition in the following form:</p> <pre><code>bridgeTalkObj.onReceived = function( origMsgObject ) {\n    // handler defined here\n};\n</code></pre> <p>The target passes back the original message object, with the body property set to the empty string.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#onresult","title":"onResult()","text":""},{"location":"interapplication-communication/bridgetalk-message-object/#description_8","title":"Description","text":"<p><code>bridgeTalkObj.onResult()</code></p> <p>A callback function that the target application invokes to return a response to the sender. This can be an intermediate response or the final result of processing the message.</p> <p>To handle the response, set this to a function definition in the following form:</p> <pre><code>bridgeTalkObj.onResult = function( responseMsgObject ) {\n    // handler defined here\n};\n</code></pre> <p>The target passes a new message object, with the body property set to the result string.</p> <p>This is the result of the target application's static BridgeTalk onReceive method, packaged as a UTF-8-encoded string. See Passing values between applications.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#ontimeout","title":"onTimeout()","text":""},{"location":"interapplication-communication/bridgetalk-message-object/#description_9","title":"Description","text":"<p><code>bridgeTalkObj.onTimeout()</code></p> <p>A callback function that the target application invokes with a time-out message if time-out occurred before the target finished processing another message previously sent by this application.</p> <p>To enable this callback, the message must specify a value for the timeout property.</p> <p>To define a response to the timeout event, set this to a function definition in the following form:</p> <pre><code>bridgeTalkObj.onTimeout = function( timeoutMsgObject ) {\n    // handler defined here\n};\n</code></pre>"},{"location":"interapplication-communication/bridgetalk-message-object/#bridgetalk-message-object-functions","title":"BridgeTalk message object functions","text":""},{"location":"interapplication-communication/bridgetalk-message-object/#send","title":"send()","text":"<p><code>bridgeTalkObj.send([timoutInSecs[, launchParameters]])</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description_10","title":"Description","text":"<p>Sends this message to the target application.</p> <p>If the target application is not running and the message contains a body, the messaging system automatically launches the target application, passing in any supplied launch parameters. In this case, the message is queued rather than sent immediately, and this method returns <code>false</code>. The message is processed once the application is running.</p> <p>Sending the message does not guarantee that the target actually receives it. You can request notification of receipt by defining an onReceived callback for this message object. (Note that this is different from the static onReceive method of the BridgeTalk class that handles unsolicited messages.)</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#parameters","title":"Parameters","text":"Parameter Type Description <code>timoutInSecs</code> Number Optional. A maximum number of seconds to wait for a result before returning from this function. The message is sent synchronously, and the function does not return until the target has processed the message or this number of seconds have passed. If not supplied or 0, the message is sent asynchronously, and the function returns immediately without waiting for a result. <code>launchParameters</code> String Optional. A string of parameters to append to the name of the target application when launching it, if the application is not already running. If the target application is already running, this value is ignored."},{"location":"interapplication-communication/bridgetalk-message-object/#returns","title":"Returns","text":"<p>Boolean. <code>true</code> if the message could be sent immediately, <code>false</code> if it could not be sent or was queued for sending later.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#sendresult","title":"sendResult()","text":"<p><code>bridgeTalkObj.sendResult(result)</code></p>"},{"location":"interapplication-communication/bridgetalk-message-object/#description_11","title":"Description","text":"<p>When processing an unsolicited message, the static BridgeTalk onReceive method can return an intermediate result to the sender by calling this method in the received message object. It invokes the onResult callback of the original message, passing a new message object containing the specified result value.</p> <p>This allows you to send multiple responses to messages.</p>"},{"location":"interapplication-communication/bridgetalk-message-object/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>result</code> Any You can send data of any type as the result value. The messaging framework creates a BridgeTalk message object, and flattens this value into a string which it stores in the body of that message. See Passing values between applications."},{"location":"interapplication-communication/bridgetalk-message-object/#returns_1","title":"Returns","text":"<p>Boolean. <code>true</code> if the received message has an onResult callback defined and the response message can be sent, <code>false</code> otherwise.</p>"},{"location":"interapplication-communication/communicating-through-messages/","title":"Communicating through messages","text":"<p>Adobe Bridge provides an application programming interface (API) that defines a communication protocol between Adobe ExtendScript- and message-enabled applications. This provides the most general mechanism for communication between applications. A messaging-enabled application can launch another messaging-enabled application, and send or receive scripts to effect certain actions. For example, from within Adobe Bridge, a script can launch Photoshop, and then send a script to Photoshop that requests a photomerge operation.</p> <p>While the exported functions allow specific access to certain capabilities of the application, the script in an interapplication message allows full access to the target application's document object model (DOM), in addition to all cross-DOM and application exported functions.</p> <p>The messaging API defines the BridgeTalk class, whose globally available static properties and functions provide access to environmental information relevant for communication between applications. You can instantiate this class to create a BridgeTalk message object, which encapsulates a message and allows you to send it to another application. For details of these objects, see Messaging framework API reference.</p>"},{"location":"interapplication-communication/communicating-through-messages/#sending-messages","title":"Sending messages","text":"<p>To send a script or other data to another application, you must create and configure a BridgeTalk message object.</p> <p>This object contains the data to be sent (generally a script to be executed in the target application), and also specifies how to handle the response.</p> <p>This simple example walks through the steps of sending a script from Adobe Bridge CS5 to Photoshop CS5, and receiving a response.</p>"},{"location":"interapplication-communication/communicating-through-messages/#step-1-check-that-the-target-application-is-installed","title":"Step 1: Check that the target application is installed","text":"<p>Before you can actually send a message, you must check that the required version of the target application is installed. The function getSpecifier(), available in the global namespace through the BridgeTalk class, provides this information.</p> <p>For example, this code, which will send a message to Adobe Bridge CS5 as part of a script being executed by Photoshop CS5, checks that the required version of Adobe Bridge is installed:</p> <pre><code>var targetApp = BridgeTalk.getSpecifier( \"bridge-3.0\");\nif( targetApp ) {\n    // construct and send message\n}\n</code></pre> <p>When you send the message, the messaging framework automatically launches the target application, if it is not already running.</p>"},{"location":"interapplication-communication/communicating-through-messages/#step-2-construct-a-message-object","title":"Step 2: Construct a message object","text":"<p>The next step is to construct a message to send to the application. You do this by creating a BridgeTalk message object, and assigning values to its properties. You must specify the target application and the message body, which is usually a script packaged into a string.</p> <p>Scripts sent in messages can be very complex, and can use the full DOM of the target application. This example defines a message script that accesses the Adobe Bridge DOM to request the number of files or folders found in a specific folder:</p> <pre><code>// create a new BridgeTalk message object\nvar bt = new BridgeTalk;\n\n// send this msg to the Adobe Bridge CS4 application\nvar targetApp = BridgeTalk.getSpecifier( \"bridge-3.0\");\nbt.target = targetApp;\n\n// the script to evaluate is contained in a string in the \"body\" property\nbt.body = \"new Document('C:\\\\BridgeScripts');app.document.target.children.length;\"\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#step-3-specify-how-to-handle-a-response","title":"Step 3: Specify how to handle a response","text":"<p>If you want to handle a response for this message, or use the data that is returned from the script's evaluation, you must set up the response-handling mechanism before you send the message. You do this by defining the onResult() callback in the message object.</p> <p>Note</p> <p>The message callbacks are optional, and are not implemented by all message-enabled applications. The response to a message is, by default, the result of evaluation of the script contained in that message's body property. The target application might define some different kind of response; see Receiving messages.</p> <p>When the target has finished processing this message, it looks for an onResult callback in the message object it received. If it is found, the target automatically invokes it, passing it the response. The response is packaged into a string, which is in turn packaged into the body property of a new message object. That message object is the argument to your onResult callback function.</p> <p>This handler, for example, processes the returned result using a script-defined processResult function:</p> <p><code>``javascript</code> bt.onResult = function(returnBtObj) {     processResult(returnBtObj.body); } <pre><code>If you want to handle errors that might arise during script processing, you can define an [onError()](bridgetalk-message-object.md#onerror) callback in the message object. Similarly, you can define a [timeout](bridgetalk-message-object.md#timeout) value and [onTimeout()](bridgetalk-message-object.md#ontimeout) callback to handle the case where the target cannot process the message within a given time. For more information, see [Handling responses from the message target](#handling-responses-from-the-message-target).\n\n!!! note\n    If you define callbacks to handle a response, you must store the message in a variable that still exists when the response is received. Otherwise, JavaScript might garbage-collect the message object, and the response would be lost.\n\n### Step 4: Send the message\n\nTo send the message, call the message object's `send` method. You do not need to specify where to send the message to, since the target application is set in the message itself:\n\n```javascript\nbt.send();\n</code></pre></p> <p>You can optionally specify a timeout value, which makes the call synchronous; when you do this, the method waits for a response from the target application, or for the timeout value to expire, before returning. When a timeout is not specified, as in this example, the call is asynchronous and the <code>send()</code> method returns immediately.</p> <p>A second optional parameter allows you to specify launch parameters, in case the target application is not currently running, and the messaging framework needs to launch it.</p> <p>The complete script looks like this:</p> <pre><code>// script to be executed in Photoshop CS4\n#target \"photoshop-11.0\"\n\n// check that the target app is installed\nvar targetApp = BridgeTalk.getSpecifier( \"bridge-3.0\");\n\nif( targetApp ) {\n    // construct a message object\n    var bt = new BridgeTalk;\n\n    // the message is intended for Adobe Bridge CS4\n    bt.target = targetApp;\n\n    // the script to evaluate is contained in a string in the \"body\" property\n    bt.body = \"new Document('C:\\\\BridgeScripts');app.document.target.children.length;\"\n\n    // define result handler callback\n    bt.onResult = function(returnBtObj) {\n    processResult(returnBtObj.body); } //fn defined elsewhere\n\n    // send the message asynchronously\n    bt.send();\n}\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#receiving-messages","title":"Receiving messages","text":"<p>An application can be the target of a message; that is, it receives an unsolicited message from another application. An unsolicited message is handled by the static BridgeTalk.onReceive callback function in the target application. See Handling unsolicited messages.</p> <p>An application that sends a message can receive response messages; that is, messages that come as the result of requesting a response when a message was sent. These can be:</p> <ul> <li>The result of an error in processing the message</li> <li>The result of a timeout when attempting to process the message</li> <li>A notification of receipt of the message</li> <li>Intermediate responses</li> <li>The final result of processing the message.</li> </ul> <p>All of these response messages are sent automatically by the target application, and are handled by callbacks defined in the sending message object. For details, see Handling responses from the message target.</p>"},{"location":"interapplication-communication/communicating-through-messages/#handling-unsolicited-messages","title":"Handling unsolicited messages","text":"<p>To specify how the application should handle unsolicited incoming messages, define a callback handler function in the static onReceive property of the <code>BridgeTalk</code> class. This function takes a single argument, a BridgeTalk message object.</p> <p>The default behavior of the <code>onReceive</code> handler is to evaluate the body of the received message with JavaScript, and return the result of that evaluation. (The result of evaluating a script is the result of the last line of the script.) To return the result, it creates a new message object, encapsulates the result in a string in the body property of that object, and passes that object to the onResult() callback defined in the original message.</p> <p>If an error occurs on evaluation, the default <code>onReceive</code> handler returns the error information using a similar mechanism. It creates a new message object, encapsulates the error information in a string in the body property of that object, and passes that object to the onError() callback defined in the original message.</p> <p>To change the default behavior set the <code>BridgeTalk.onReceive</code> property to a function definition in the following form:</p> <pre><code>BridgeTalk.onReceive = function( bridgeTalkObject ) {\n    // callback definition here\n};\n</code></pre> <p>The <code>body</code> property of the received message object contains the received data.</p> <p>The function can return any type.</p> <p>The function that you define does not need to explicitly create and return a <code>BridgeTalk</code> message object.</p> <p>The messaging framework creates a new <code>BridgeTal``k message object, and packages the return value of the ``onReceive</code> handler as a string in the body property of that object.</p> <p>Return values are flattened into a string using the Unicode Transformation Format-8 (UTF-8) encoding. If the function does not specify a return value, the resulting string is the empty string.</p> <p>The result object is transmitted back to the sender if the sender has implemented an <code>onResult</code> callback for the original message.</p>"},{"location":"interapplication-communication/communicating-through-messages/#message-handling-examples","title":"Message-handling examples","text":"<p>This example shows the default mechanism for handling unsolicited messages received from other applications. This simple handler executes the message's data as a script and returns the results of that execution:</p> <pre><code>BridgeTalk.onReceive = function (message) {\n    return eval( message.body );\n}\n</code></pre> <p>This example shows how you might extend the receive handler to process a new type of message:</p> <pre><code>BridgeTalk.onReceive = function (message) {\n    switch (message.type) {\n        case \"Data\":\n            return processData( message );\n            break;\n        default: //\"ExtendScript\"\n            return eval( mesage.body );\n    }\n}\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#handling-responses-from-the-message-target","title":"Handling responses from the message target","text":"<p>To handle responses to a message you have sent, you define callback handler functions in the message object itself. The target application cannot send a response message back to the sender unless the message object it received has the appropriate callback defined.</p> <p>Note</p> <p>The message callbacks are optional, and are not implemented by all message-enabled applications.</p> <p>When your message is received by its target, the target application's static BridgeTalk object's onReceive method processes that message, and can invoke one of the message object's callbacks to return a response. In each case, the messaging framework packages the response in a new message object, whose target application is the sender. Your callback functions receive this response message object as an argument.</p> <p>A response message can be:</p> <ul> <li>The result of an error in processing the message. This is handled by the onError() callback.<ul> <li>If an error occurs in processing the message body (as the result of a JavaScript syntax error, for instance), the target application invokes the onError() callback, passing a response message that contains the error code and error message. If you do not have an onError() callback defined, the error is completely transparent. It can appear that the message has not been processed, since no result is ever returned to the onResult() callback.</li> </ul> </li> <li>A notification of receipt of the message. This is handled by the onReceived() callback.<ul> <li>Message sending is asynchronous. Getting a <code>true</code> result from the send method does not guarantee that your message was actually received by the target application. If you want to be notified of the receipt of your message, define the onReceived() callback in the message object. The target sends back the original message object to this callback, first replacing the body value with an empty string.</li> </ul> </li> <li>The result of a time-out. This is handled by the onTimeout() callback.<ul> <li>You can specify a number of seconds in a message object's timeout property. If the message is not removed from the input queue for processing before the time elapses, it is discarded. If the sender has defined an onTimeout() callback for the message, the target application sends a time-out message back to the sender.</li> </ul> </li> <li>Intermediate responses. These are handled by the onResult() callback.<ul> <li>The script that you send can send back intermediate responses by invoking the original message object's sendResult() method. It can send data of any type, but that data is packaged into a body string in a new message object, which is passed to your callback. See Passing values between applications.</li> </ul> </li> <li>The final result of processing the message. This is handled by the onResult() callback.<ul> <li>When it finishes processing your message, the target application can send back a result of any type. If you have sent a script, and the target application is using the default BridgeTalk onReceive callback to process messages, the return value is the final result of evaluating that script. In any case, the return value is packaged into a body string in a new message object, which is passed to your callback. See Passing values between applications.</li> </ul> </li> </ul> <p>The following examples demonstrate how to handle simple responses and multiple responses, and how to integrate error handling with response handling.</p>"},{"location":"interapplication-communication/communicating-through-messages/#example-receiving-a-simple-response","title":"Example: Receiving a simple response","text":"<p>In this example, an application script asks Adobe Bridge to find out how many files and folders are in a certain folder, which the evaluation of the script returns. (The default BridgeTalk.onReceive method processes this correctly.)</p> <p>The <code>onResult</code> method saves that number in <code>fileCountResult</code>, a script-defined property of the message, for later use:</p> <pre><code>var bt = new BridgeTalk;\nbt.target = \"bridge-3.0\";\nbt.body = \"new Document('C:\\\\BridgeScripts');app.document.target.children.length;\"\nbt.onResult = function( retObj ) {\n    processFileCount(retObj.body);\n}\n\nbt.send();\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#example-handling-any-error","title":"Example: Handling any error","text":"<p>In this example, the onError handler re-throws the error message within the sending application:</p> <pre><code>var bt = new BridgeTalk;\nbt.onError = function (btObj) {\n    var errorCode = parseInt (btObj.headers [\"Error-Code\"]);\n    throw new Error (errorCode, btObj.body);\n}\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#example-handling-expected-errors-and-responses","title":"Example: Handling expected errors and responses","text":"<p>This example creates a message that asks Adobe Bridge to return XMP metadata for a specific file. The <code>onResult</code> method processes the data using a script-defined processFileSize function. Any errors are handled by the <code>onError</code> method. For example, if the file requested is not an existing file, the resulting error is returned to the onError method:</p> <pre><code>var bt = new BridgeTalk;\nbt.target = \"bridge-3.0\";\nbt.body = \"var tn = new Thumbnail('C/MyPhotos/temp.gif'); tn.core.immediate.size;\"\nbt.onResult = function( resultMsg ) {\n    processFileSize(resultMsg.body);\n}\n\nbt.onError = function( errorMsg ) {\n    var errCode = parseInt (errorMsg.headers [\"Error-Code\"]);\n    throw new Error (errCode, errorMsg.body);\n}\n\nbt.send();\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#example-setting-up-a-target-to-send-multiple-responses","title":"Example: Setting up a target to send multiple responses","text":"<p>This example integrates the sending of multiple responses with the evaluation of a message body. It sets up a handler for a message such as the one sent in the following example.</p> <p>The target application (Adobe Bridge) defines a static onReceive method to allow for a new type of message, which it calls an iterator. An iterator type of message expects the message.body to use the iteration variable i within the script, so that different results are produced for each pass through the while loop. Each result is sent back to the sending application with the sendResult() method. When the message.body has finished processing its task, it sets a flag to end the while loop:</p> <pre><code>// Code for processing the message and sending intermediate responses\n// in the target application (Adobe Bridge)\nBridgeTalk.onReceive = function (message){\n    switch (message.type) {\n        case \"iterator\":\n            done = false;\n            i = 0;\n            while (!done) {\n                // the message.body uses \"i\" to produce different results\n                // for each execution of the message.\n                // when done, the message.body sets \"done\" to `true`\n                // so this onReceive method breaks out of the loop.\n                message.sendResult(eval(message.body));\n                i++;\n            }\n            break;\n        default: //\"ExtendScript\"\n            return eval( message.body );\n    }\n}\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#example-setting-up-a-sender-to-receive-multiple-responses","title":"Example: Setting up a sender to receive multiple responses","text":"<p>This example sends a message of the type iterator, to be handled by the onReceive handler in the previous example, and processes the responses received from that target.</p> <p>The sending application creates a message whose script (contained in the body string) iterates through all files in a specific folder (represented by an Adobe Bridge Thumbnail object), using the iterator variable i.</p> <p>For each file in the folder, it returns file size data. For each contained folder, it returns -1. The last executed line in the script is the final result value for the message.</p> <p>The <code>onResult</code> method of the message object receives each intermediate result, stores it into an array, <code>resArr</code>, and processes it immediately using a script-defined function processInterResult:</p> <pre><code>// Code for send message and handling response\n// in the sending application (any message-enabled application)\nvar idx = 0;\nvar resArr = new Array;\nbt = new BridgeTalk;\nbt.target = \"bridge\";\nbt.type = \"iterator\";\nbt.body = \"\nvar fld = new Thumbnail(Folder('C/Junk'));\nif (i == (fld.children.length - 1))\ndone = true; //no more files, end loop\ntn = fld.children[i];\nif (tn.spec.constructor.name == 'File')\nmd = tn.core.immediate.size;\nelse md = -1;\n\";\n\n// store intermediate results\nbt.onResult = function(rObj) {\n    resArr[idx] = rObj.body;\n    processInterResult(resArr[idx]);\n    idx++;\n};\n\nbt.onError = function(eObj) {\n    bt.error = eObj.body\n};\n\nbt.send();\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#passing-values-between-applications","title":"Passing values between applications","text":"<p>The BridgeTalk.onReceive static callback function can return values of any type. The messaging framework, however, packages the response into a response message, and passes any returned values in the message body, first converting the result to a UTF-8-encoded string.</p>"},{"location":"interapplication-communication/communicating-through-messages/#passing-simple-types","title":"Passing simple types","text":"<p>When your message object's onResult callback receives a response, it must interpret the string it finds in the body of the response message to obtain a result of the correct type. Results of various types can be identified and processed as follows:</p> Type Description Number JavaScript allows you to access a string that contains a number directly as a number, without doing any type conversion. However, be careful when using the plus operator (+), which works with either strings or numbers. If one of the operands is a string, both operands are converted to strings and concatenated. String No conversion is required. Boolean The result string is either \"true\" or \"false.\" You can convert it to a true boolean by evaluating it with the <code>eval</code> method. Date The result string contains the date in the form: <code>\"dow mmm dd yyyy hh:mm:ss GMT-nnnn\".</code> For example \"Wed Jun 23 2004 00:00:00 GMT-0700\". Array The result string contains a comma delimited list of the elements of the array. For example, If the result array is <code>[12, \"test\", 432]</code>, the messaging framework flattens this into the string <code>\"12,test,432\"</code>. As an alternative to simply returning the array, the message target can use the <code>toSource</code> method to return the code used to create the array. In this case, the sender must reconstitute the array by using the <code>eval</code> method on the result string in the response body. See discussion below."},{"location":"interapplication-communication/communicating-through-messages/#passing-complex-types","title":"Passing complex types","text":"<p>When returning complex types (arrays and objects), the script that you send must construct a result string, using the toSource method to serialize the array or object. In this case, the sender must reconstitute the array or object by using the eval method on the result string in the response body.</p>"},{"location":"interapplication-communication/communicating-through-messages/#passing-an-array-with-tosource-and-eval","title":"Passing an array with toSource and eval","text":"<p>For example, the following code sends a script that returns an array in this way. The onResult callback that receives the response uses eval to reconstruct the array:</p> <pre><code>// Code for send message and handling response\n// in the sending application (any message-enabled application)\nvar idx = 0;\nvar resArr = new Array;\nvar bt = new BridgeTalk;\nbt.target = \"bridge-3.0\";\n\n// the script passed to the target application\n// needs to return the array using \"toSource\"\nbt.body = \"var arr = [10, this string, 324]; arr.toSource()\";\n\nbt.onResult = function(resObj) {\n    // use eval to reconstruct the array\n    arr = eval(resObj.body);\n\n    // now you can access the returned array\n    for (i=0; i&lt; arr.length(); i++)\n        doSomething(arr[i]);\n}\n\n// send the message\nbt.send();\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#passing-an-object-with-tosource-and-eval","title":"Passing an object with toSource and eval","text":"<p>This technique is the only way to pass objects between applications. For example, this code sends a script that returns an object containing some of the metadata for a specific file and defines an onResult callback that receives the object:</p> <pre><code>var bt = new BridgeTalk;\nbt.target = \"bridge-3.0\";\n\n//the script passed to the target application\n// returns the object using \"toSource\"\nbt.body = \"var tn = new Thumbnail(File('C:\\\\Myphotos\\\\photo1.jpg'));\nvar md = {fname:tn.core.immediate.name,\nfsize:tn.core.immediate.size};\nmd.toSource();\"\n\n//For the result, use eval to reconstruct the object\nbt.onResult = function(resObj) {\n    md = bt.result = eval(resObj.body);\n    // now you can access fname and fsize properties\n    doSomething (md.fname, md.fsize);\n}\n\n// send the message\nbt.send();\n</code></pre>"},{"location":"interapplication-communication/communicating-through-messages/#passing-a-dom-object","title":"Passing a DOM object","text":"<p>You can send a script that returns a DOM object, but the resulting object contains only those properties that were accessed within the script. For example, the following script requests the return of the Adobe Bridge DOM Thumbnail object. Only the properties path and uri are accessed by the script, and only those properties are returned:</p> <pre><code>var bt = new BridgeTalk;\nbt.target = \"bridge\";\n\n//set up the script passed to the target application\n// to return the array using \"toSource\"\nbt.body = \"var tn = new Thumbnail(File('C:\\\\Myphotos\\\\photo1.jpg'));\nvar p = tn.path; var u = tn.uri;\ntn.toSource();\"\n\n//For the result, use eval to reconstruct the object\nbt.onResult = function(resObj) {\n    // use eval to reconstruct the object\n    tn = eval(resObj.body);\n    // now the script can access tn.path and tn.uri,\n    // but no other properties of the Adobe Bridge DOM Thumbnail object\n    doSomething (tn.path, tn.uri);\n}\n\n// send the message\nbt.send();\n</code></pre>"},{"location":"interapplication-communication/communications-overview/","title":"Communications overview","text":"<p>Scripts written for any message-enabled application can communicate with other message-enabled applications in two ways; through directly calling functions defined in a remote application, and by sending messages and receiving responses from a remote application. A specific syntax is provided for identifying applications unambiguously.</p>"},{"location":"interapplication-communication/communications-overview/#remote-function-calls","title":"Remote function calls","text":"<p>A limited set of basic functions (the cross-DOM) are common across all message-enabled applications, and allow your script to, for example, open or print files in other applications, simply by calling the open or print function for that application.</p> <ul> <li>Cross-DOM functions describes the usage of this feature.</li> <li>Cross-DOM API reference provides reference details for the functions of the basic cross-DOM.</li> </ul> <p>Each message-enabled application can also export a set of functions to provide a selected set of application-specific functionality; see Application-specific exported functions.</p> <p>For example, an Adobe Bridge script can request a photo merge in Photoshop by calling <code>photoshop.photomerge(files)</code>. The set of functions available for each application varies widely.</p>"},{"location":"interapplication-communication/communications-overview/#messaging-framework","title":"Messaging framework","text":"<p>The interapplication messaging framework is a JavaScript application programming interface (API) that allows extensive control over communication between applications. The API allows you to send messages to other applications and receive results, and to receive messages sent by other applications and return results. Typically the data passed between applications are JavaScript scripts. However, the messaging framework is extensible. It allows you to define different types of data to send between applications, and to specify how they are handled.</p> <ul> <li>Communicating through messages describes the usage of this feature.</li> <li>Messaging framework API reference provides complete reference details.</li> </ul>"},{"location":"interapplication-communication/communications-overview/#identifying-applications","title":"Identifying applications","text":"<p>When calling external functions or exchanging messages, you must identify particular applications using namespace specifiers. A specifier consists of a specific name string (such as photoshop), and optional additions that identify a particular release or locale version. Application specifiers are used occasionally in other contexts as well. For details of the syntax, see Application and namespace specifiers.</p> <p>Regardless of which method you use to perform interapplication communication, you must place your script in a location where the application you want to run it can see it. There are different locations for the startup scripts of the applications themselves, and for scripts provided by developers.</p> <p>Because all JavaScript-enabled applications look in the same locations for scripts to run, the scripts themselves must be explicit about which application they are meant for. A script should check that all applications it needs to communicate with are installed with the correct version, and that any other applications that might be installed do not run the script. For details, see Scripting for specific applications.</p>"},{"location":"interapplication-communication/cross-dom-functions/","title":"Cross-DOM functions","text":"<p>The cross-DOM is a small application programming interface (API), which provides a set of functions that are common across message-enabled applications. These include functions to open files, execute scripts, and print files. For details of the function set, see Cross-DOM API reference.</p> <p>You can access cross-DOM functions in any script by prefixing the function name with the namespace specifier for the target application (see Namespace specifiers). For example, a Photoshop CC script can call indesign.open(file) to open a file in Adobe InDesign\u00ae CC.</p> <p>The cross-DOM functions for each application are implemented in JavaScript. You can see the implementation for each installed application by reading its associated startup script in the Adobe startup folder. For example, Adobe Illustrator\u00ae CC defines illustrator.open() in the illustrator-14.jsx startup script (14 is the version number of the installed application). See Startup folder locations.</p>"},{"location":"interapplication-communication/cross-dom-functions/#example","title":"Example","text":"<p>The sample code distributed with the Adobe ExtendScript SDK includes these code examples that specifically demonstrate the use of cross-DOM functions:</p> Example Description OpenImageInPhotoshop.jsx Shows how to send an image file to be opened in Photoshop."},{"location":"interapplication-communication/cross-dom-functions/#application-specific-exported-functions","title":"Application-specific exported functions","text":"<p>In addition to the required base cross-DOM functions, each message-enabled application can provide application-specific functionality to all scripts through a simple syntax. You can access exported functions in any script by prefixing the function name with the namespace specifier for the target application (see Namespace specifiers). For example, Photoshop CS5 exports the photomerge function, so an Illustrator CS5 script can directly call photoshop.photomerge(files).</p> <p>The only difference between cross-DOM functions and the application-specific exported functions is that all applications expose the same set of cross-DOM functions, whereas each application exposes its own set of application-specific functions. Each application determines the extent of its exported functionality.</p> <p>Some applications provide extensive support for exported functions, others less.</p> <p>For details of additional functions that are exported by individual applications, refer to the startup scripts for those applications. The application startup scripts are named appname-n.jsx, where n is the version number of the installed application. See Startup folder locations.</p>"},{"location":"interapplication-communication/cross-dom-functions/#startup-folder-locations","title":"Startup folder locations","text":"<p>For each platform, there is a startup folder shared by all Adobe Creative Suite 4 applications that support JavaScript, and an application-specific startup folder.</p> <ul> <li>In Windows\u00ae, the installation startup folders are: <code>%CommonProgramFiles%\\Adobe\\Startup Scripts CS5\\Adobe AppName\\</code></li> <li>In Mac OS\u00ae, the installation startup folders are: <code>/Library/Application Support/Adobe/Startup Scripts CS5/Adobe AppName/</code></li> </ul> <p>Note</p> <p>This is not the location in which to store your own startup scripts; see Scripting for specific applications.</p>"},{"location":"interapplication-communication/cross-dom-functions/#cross-dom-api-reference","title":"Cross-DOM API reference","text":"<p>All exported functions, including those of the cross-DOM API, are invoked through the exporting application, identified by its namespace specifier (see Namespace specifiers). For example:</p> <pre><code>//execute an Illustrator script in version 12\nillustrator12.executeScript(myAIScript);\n</code></pre> <p>A specifier with no version information invokes the highest installed version of the application. For example:</p> <pre><code>//execute a Photoshop script in the highest available version\nphotoshop.executeScript (myPSScript)\n</code></pre>"},{"location":"interapplication-communication/cross-dom-functions/#cross-dom-functions_1","title":"Cross-DOM Functions","text":"<p>All message-enabled applications implement the following cross-DOM functions:</p>"},{"location":"interapplication-communication/cross-dom-functions/#executescript","title":"executeScript()","text":"<p><code>appspec.executeScript(script)</code></p>"},{"location":"interapplication-communication/cross-dom-functions/#description","title":"Description","text":"<p>Performs a JavaScript eval on the specified script. The entire document object model (DOM) of the target application is available to the script.</p>"},{"location":"interapplication-communication/cross-dom-functions/#parameters","title":"Parameters","text":"Parameter Type Description <code>script</code> String The script to be evaluated."},{"location":"interapplication-communication/cross-dom-functions/#returns","title":"Returns","text":"<p>Nothing</p>"},{"location":"interapplication-communication/cross-dom-functions/#open","title":"open()","text":"<p><code>appspec.open(files)</code></p>"},{"location":"interapplication-communication/cross-dom-functions/#description_1","title":"Description","text":"<p>Performs the equivalent of the target application's File &gt; Open command on the specified files.</p>"},{"location":"interapplication-communication/cross-dom-functions/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>files</code> File object or array of File objects. File(s) to open. For applications that use compound documents, this should be a project file."},{"location":"interapplication-communication/cross-dom-functions/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"interapplication-communication/cross-dom-functions/#openasnew","title":"openAsNew()","text":"<p><code>appspec.openAsNew([options])</code></p>"},{"location":"interapplication-communication/cross-dom-functions/#description_2","title":"Description","text":"<p>Performs the equivalent of the target application's File &gt; New command.</p>"},{"location":"interapplication-communication/cross-dom-functions/#parameters_2","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>options</code></p> <p>Application-specific creation options: - Adobe Bridge: none - Photoshop: none - InDesign: creation options are: <code>(Boolean:showingWindow, ObjectOrString:documentPresets)</code>. See the arguments for <code>documents.add()</code> in the Adobe InDesign CS5 Scripting Reference. - Illustrator: creation options are: <code>([DocumentColorSpace:colorspace][, Number:width, Number:height])</code>. See the arguments for documents.add() in the Adobe Illustrator CS5 JavaScript Reference.</p> <p>Optional. Creation options.</p>"},{"location":"interapplication-communication/cross-dom-functions/#returns_2","title":"Returns","text":"<p>Boolean. <code>true</code> on success.</p>"},{"location":"interapplication-communication/cross-dom-functions/#print","title":"print()","text":"<p><code>appspec.print(files)</code></p>"},{"location":"interapplication-communication/cross-dom-functions/#description_3","title":"Description","text":"<p>Performs the equivalent of the target application's File &gt; Print command on the specified files.</p>"},{"location":"interapplication-communication/cross-dom-functions/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>files</code> File object or array of File objects. File(s) to print. For applications that use compound documents, this should be a project file."},{"location":"interapplication-communication/cross-dom-functions/#returns_3","title":"Returns","text":"<p>Nothing</p>"},{"location":"interapplication-communication/cross-dom-functions/#quit","title":"quit()","text":"<p><code>appspec.quit()</code></p>"},{"location":"interapplication-communication/cross-dom-functions/#description_4","title":"Description","text":"<p>Performs the equivalent of the target application's File &gt; Exit or File &gt; Close command.</p> <p>Note</p> <p>This function is available for Adobe Acrobat\u00ae, but does nothing. Scripts cannot terminate the application.</p>"},{"location":"interapplication-communication/cross-dom-functions/#returns_4","title":"Returns","text":"<p>Nothing</p>"},{"location":"interapplication-communication/cross-dom-functions/#reveal","title":"reveal()","text":"<p><code>appspec.reveal(file)</code></p>"},{"location":"interapplication-communication/cross-dom-functions/#description_5","title":"Description","text":"<p>Gives the target application the operating-system focus, and, if the specified file is open in that application, brings it to the foreground.</p>"},{"location":"interapplication-communication/cross-dom-functions/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>file</code> File object or String File info to reveal"},{"location":"interapplication-communication/cross-dom-functions/#returns_5","title":"Returns","text":"<p>Nothing</p>"},{"location":"interapplication-communication/messaging-error-codes/","title":"Messaging error codes","text":"<p>The interapplication messaging protocol defines the following error codes, which are compatible with ExtendScript error codes. Negative values indicate unrecoverable errors that cause ExtendScript to terminate a running script.</p> Code Description <code>1</code> General error <code>8</code> Syntax error <code>20</code> Bad argument list <code>27</code> Stack overrun <code>-28</code> Out of memory <code>-29</code> Uncaught exception <code>31</code> Bad URI <code>32</code> Cannot perform requested action <code>-33</code> Internal error <code>-36</code> Not yet implemented <code>41</code> Range error <code>44</code> Cannot convert <code>47</code> Type mismatch <code>48</code> File or folder does not exist <code>49</code> File of folder already exists <code>50</code> I/O device is not open <code>51</code> Read past EOF <code>52</code> I/O error <code>53</code> Permission denied <code>54</code> JavaScript execution <code>56</code> Cannot connect <code>57</code> Cannot resolve reference <code>58</code> I/O timeout <code>59</code> No response"},{"location":"interapplication-communication/messaging-framework-api-reference/","title":"Messaging framework API reference","text":"<p>This application programming interface (API) defines a communication protocol between message-enabled applications. These objects are available to all ExtendScript scripts when any of the applications is loaded.</p> <p>The messaging protocol is extensible. Although it is primarily designed to send scripts, you can use it to send other kinds of data.</p> <p>The messaging API defines the BridgeTalk class. Static properties and methods of the class provide access to environmental information relevant for communication between applications. Instantiate the class to create a BridgeTalk message object, which encapsulates the message itself. For discussion and examples, see Communicating through messages, and the example code provided with the Adobe ExtendScript SDK.</p>"},{"location":"interapplication-communication/messaging-framework-api-reference/#example-code","title":"Example code","text":"<p>The sample code distributed with the Adobe ExtendScript SDK includes these code examples that specifically demonstrate the use of interapplication messaging:</p> Interapplication messaging example Description MessagingBetweenApps.jsx Shows how to send a message to a Creative Suite application and receive a response. MessageSendingToInDesign.jsx Sends message to InDesign through BridgeTalk. SendArrayToPhotoshop.jsx Sends message to Photoshop that creates an array in the target and passes it back to the sender. SendObjectToPhotoshop.jsx Sends message to Photoshop that creates a JavaScript object in the target and passes it back to the sender. SendDOMObjectToPhotoshop.jsx Sends message to Photoshop that creates a Photoshop object in the target and passes values from it back to the sender. SaveAsDifferentFileType.jsx Locates an image file, uses messaging to load it into Photoshop and save it as a different file type."},{"location":"introduction/extendscript-overview/","title":"ExtendScript overview","text":"<p>Adobe provides an extended implementation of JavaScript, called ExtendScript, that is used by many Adobe applications that provide a scripting interface. In addition to implementing the JavaScript language according to the ECMA JavaScript specification, ExtendScript provides certain additional features and utilities.</p> <p>This document describes JavaScript modules, tools, utilities, and features that are available to all JavaScript-enabled Adobe applications.</p> <p>Note</p> <p>Some modules, and features of some modules, are optional. Check the product documentation for each application for details of which modules and features are implemented.</p>"},{"location":"introduction/extendscript-overview/#example-code","title":"Example code","text":"<p>The Adobe ExtendScript SDK, which contains this document, also contains a set of code samples that demonstrate how to use features of ScriptUI, interapplication communication, and external communication. This book refers to these samples by name for illustration of concepts and techniques.</p> <p>You can download the latest (and last) SDK from Github. Earlier versions might still be accessible through direct links.</p> <p>The samples are located under the ExtendScript SDK root directory:</p> <ul> <li><code>SDKroot/Samples/javascript/</code>: sample scripts</li> <li><code>SDKroot/Samples/resources/</code>: resources, such as image or flash files</li> </ul>"},{"location":"introduction/extendscript-overview/#development-and-debugging-tools","title":"Development and debugging tools","text":"<p>For help in developing, debugging, and testing scripts, Adobe provides the ExtendScript Toolkit, an interactive development and testing environment for ExtendScript, which is installed with all JavaScript-enabled applications.</p> <p>For complete details, see The ExtendScript Toolkit.</p> <p>ExtendScript also provides global objects that support development and debugging:</p> <ul> <li>A global debugging object, the Dollar ($) object.</li> <li>A reporting utility for ExtendScript elements, the ExtendScript reflection interface.</li> </ul> <p>For complete details, see ExtendScript Tools and Features.</p>"},{"location":"introduction/extendscript-overview/#cross-platform-file-system-access","title":"Cross-platform file-system access","text":"<p>Adobe ExtendScript defines File and Folder classes that simplify cross-platform file-system access. These classes are available to all applications that support a JavaScript interface.</p> <p>For complete details, see File System Access.</p>"},{"location":"introduction/extendscript-overview/#user-interface-development-tools","title":"User-interface development tools","text":"<p>Adobe provides the ScriptUI module, which works with the ExtendScript JavaScript interpreter to provide JavaScript scripts with the ability to create and interact with user interface elements. It provides an object model for windows and user-interface control elements within an Adobe application. For complete details, see User-Interface Tools.</p> <p>In addition, ExtendScript provides:</p> <ul> <li>Global functions for localization of display strings; see Localizing ExtendScript strings</li> <li>Global functions for displaying short messages in dialog boxes; see User notification dialogs.</li> <li>An object type for specifying measurement values together with their units; see Specifying measurement values.</li> </ul>"},{"location":"introduction/extendscript-overview/#interapplication-communication-and-messaging","title":"Interapplication communication and messaging","text":"<p>ExtendScript provides a common scripting environment for all Adobe JavaScript-enabled applications, and allows interapplication communication through scripts.</p> <p>Different levels of communication are provided through the cross-DOM and the messaging framework.</p> <ul> <li>Cross-DOM functions are a limited set of basic functions common across all message-enabled applications, which allow your script to, for example, open or print files in other applications, simply by calling the open or print function for that application. In addition to the basic set of common functions, some applications provide more extensive sets of exported JavaScript functions to other applications.</li> <li>The interapplication messaging framework is an application programming interface (API) that allows extensive control over communication between applications. The API allows you to send messages to other applications and receive results, and to receive messages sent by other applications and return results. Typically the data passed between applications are JavaScript scripts. However, the messaging framework is extensible. It allows you to define different types of data to send between applications, and to specify how they are handled.</li> </ul> <p>For complete details, see Interapplication Communication with Scripts.</p>"},{"location":"introduction/extendscript-overview/#external-communication","title":"External communication","text":"<p>ExtendScript offers tools for communicating with other computers or the internet using standard protocols. The Socket object supports low-level TCP connections.</p> <p>For complete details, see External Communication Tools.</p>"},{"location":"introduction/extendscript-overview/#external-shared-library-integration","title":"External shared-library integration","text":"<p>You can extend the JavaScript DOM for an application by writing a C or C++ shared library, compiling it for the platform you are using, and loading it into JavaScript as an ExternalObject instance. A shared library is implemented by a DLL in Windows, a bundle or framework in Mac OS, or a SharedObject in UNIX.</p> <p>For complete details, see Integrating External Libraries.</p>"},{"location":"introduction/extendscript-overview/#additional-utilities-and-features","title":"Additional utilities and features","text":"<p>ExtendScript provides these utilities and features:</p> <ul> <li>JavaScript language enhancements<ul> <li>Tools for combining scripts, such as a <code>#include</code> directive. See Preprocessor directives.</li> <li>Support for extending or overriding math and logical operator behavior on a class-by-class basis. See Operator overloading.</li> <li>For complete details, see ExtendScript Tools and Features.</li> </ul> </li> <li>JavaScript compilation, through the ExtendScript Toolkit. See The ExtendScript Toolkit.</li> <li>XML integration: ExtendScript defines the XML object, which allows you to process XML with your JavaScript scripts. For complete details, see Integrating XML into JavaScript.</li> <li>Scripting support for XMP metadata manipulation: XMPScript provides a JavaScript API for the Adobe</li> </ul>"},{"location":"introduction/scripting-for-specific-applications/","title":"Scripting for specific applications","text":"<p>On startup, all Adobe JavaScript-enabled applications execute JSX files that they find in their startup directories; some of these are installed by applications, and some can be installed by scripters. The policies of different applications vary as to the locations, write access, and loading order.</p> <p>In addition, individual applications may look for application-specific scripts in particular directories, which may be configurable. Some applications allow access to scripts from menus; all of them allow you to load and run scripts using the ExtendScript Toolkit.</p> <p>For details of how to load and run scripts for any individual application, see the JavaScript Scripting Guide for that application.</p>"},{"location":"introduction/scripting-for-specific-applications/#startup-scripts","title":"Startup scripts","text":"<p>A script in a startup directory might be executed on startup by multiple applications. If you place a script in such a directory, it must contain code to check whether it is being run by the intended application. You can do this using the appName static property of the BridgeTalk class. For example:</p> <pre><code>if ( BridgeTalk.appName == \"bridge\" ) {\n    //continue executing script\n}\n</code></pre> <p>If a script that is run by one application will communicate with another application or add functionality that depends on another application, it must first check whether that application/version is installed. You can do this using the <code>`BridgeTalk.getSpecifier()</code> static function. For example:</p> <pre><code>if ( BridgeTalk.appName == \"bridge-2.0\" ) {\n    // Check to see that Photoshop is installed.\n    if ( BridgeTalk.getSpecifier( \"photoshop\", 10 ) ){\n        // Add the Photoshop automate menu to the Adobe Bridge UI.\n    }\n}\n</code></pre> <p>For details of interapplication communication, see Interapplication Communication with Scripts.</p>"},{"location":"introduction/scripting-for-specific-applications/#javascript-variables","title":"JavaScript variables","text":"<p>Scripting shares a global environment, so any script executed at startup can define variables and functions that are available to all scripts. In all cases, variables and functions, once defined by running a script that contains them, persist in subsequent scripts during a given application session. Once the application is quit, all such globally defined variables and functions are cleared. Scripters should be careful about giving variables in scripts unique names, so that a script does not inadvertently reassign global variables intended to persist throughout a session.</p>"},{"location":"scripting-xmp/","title":"Scripting Access to XMP Metadata","text":"<p>XMPScript, the XMP ExtendScript API, offers JavaScript access to the Adobe XMP Core and XMP Files libraries. This chapter provides reference information for the JavaScript objects related to XMP, with their properties and methods.</p> <p>This chapter is not intended to provide complete details of the XMP metadata technology. For more information about XMP metadata, see the XMP Specification at Adobe Developer Center.</p> <p>Adobe Bridge CS5 makes the XMP library available in its libraries folder. Scripts must load the library at run time to use the API; it is not automatically loaded when Adobe Bridge launches. The XMPScript API is separate from the Adobe Bridge DOM. You can use it independently, to get and set metadata in supported formats; or you can use it with the Adobe Bridge API to modify the metadata that you access from files using the Adobe Bridge DOM's <code>Thumbnail</code> object.</p> <p>Note</p> <p>Adobe Bridge provides a means of embedding metadata values in a script (to describe the script file itself) using XML delimited by special tags within a comment block. This is not related to metadata access for files and thumbnails. For details, see the Adobe Bridge JavaScript Guide.</p>"},{"location":"scripting-xmp/accessing-the-xmp-scripting-api/","title":"Accessing the XMP scripting API","text":"<p>To use the XMP objects, you must load the XMP library as an ExtendScript ExternalObject. To avoid loading multiple instances of the library, use code like the following:</p> <pre><code>// load the library\nif ( ExternalObject.AdobeXMPScript == undefined ) {\n    ExternalObject.AdobeXMPScript = new ExternalObject( \"lib:AdobeXMPScript\");\n}\n</code></pre> <p>After the library has been loaded, these primary XMP classes are available in the global JavaScript namespace:</p> Object Description XMPMeta object Provides the core services of the XMP Toolkit. Allows you to create and delete metadata properties, and to retrieve and modify property values. XMPFile object Provides convenient I/O access to the main, or document level, XMP for a file. Allows you to retrieve existing metadata from a file, update file metadata, and add new metadata to a file. <p>Additional top-level objects include array-handling utilities, a date-time object, and constant definitions that include namespace constants. The top-level objects provide access to additional support classes that encapsulate individual metadata properties, file information, and XMP packet information, and a utility that allows iteration through properties.</p> <p>See XMPScript object reference for details of the classes, their properties, and their methods.</p>"},{"location":"scripting-xmp/accessing-the-xmp-scripting-api/#using-the-xmp-scripting-api","title":"Using the XMP scripting API","text":"<p>The XMPMeta object is the primary means of access to the namespaces and properties of an XMP metadata packet. Through this object, you can create and delete namespaces and properties, and examine and modify property values.</p> <p>You can obtain or create an XMPMeta object in several ways:</p> <ul> <li>You can use an XMPFile object to retrieve existing metadata directly from a file. The <code>XMPFile.</code>getXMP() method creates an XMPMeta object, which you can use to examine or modify the properties and their values. You can then use <code>XMPFile.</code>putXMP() to write the modified metadata back to the file.</li> <li>You can create an XMPMeta object with the constructor, initializing it with an XMP packet created or obtained elsewhere.</li> <li>You can create a new, empty XMPMeta object with the constructor, and use its methods to create entirely new namespaces and properties. You can then use <code>XMPFile.</code>putXMP() to inject the new metadata into a file.</li> </ul> <p>In Adobe Bridge, you can pass XMP metadata between the built-in <code>Metadata</code> object and the XMPScript XMPMeta object using serialized XMP.</p> <ul> <li> <p>You can use XMPScript to examine thumbnail metadata by creating the XMPMeta object from the metadata stored with a <code>Thumbnail</code> object, using the object constructor. To ensure that the metadata is up-to-date, use synchronous mode (which is off by default):     <pre><code>var thumb = new Thumbnail( new File( \"/C/myImage.jpg\") );\napp.synchronousMode = true;\n\nvar xmp = new XMPMeta( thumb.metadata.serialize() );\n</code></pre></p> <p>or: <pre><code>var xmp = new XMPMeta( thumb.synchronousMetadata.serialize() );\n</code></pre></p> </li> <li> <p>You can modify the metadata in an Adobe Bridge thumbnail by creating a new <code>Metadata</code> object with serialized XMP. Continuing the previous example:     <pre><code>// Create a compact XMP packet\nvar newPacket = xmp.serialize( XMPConst.SERIALIZE_OMIT_PACKET_WRAPPER | XMPConst.SERIALIZE_USE_COMPACT_FORMAT ) );\nthumb.metadata = new Metadata( newPacket );\n</code></pre></p> </li> <li> <p>To write metadata back to the file for a thumbnail, you can access the thumbnail's file and create an XMPFile object object to access the embedded metadata directly:     <pre><code>var xmp = new XMPFile( thumb.spec.fsName, XMPConst.UNKNOWN, XMPConst.OPEN_FOR_UPDATE );\n</code></pre></p> </li> </ul> <p>Note</p> <p>The <code>XMPFile</code> object does not support all of the file formats that Adobe Bridge supports.</p>"},{"location":"scripting-xmp/accessing-the-xmp-scripting-api/#creating-new-metadata","title":"Creating new metadata","text":"<p>This code creates an empty XMPMeta object, uses it to set a metadata property, and serializes it to a string, which you could pass to an authoring tool, for example, or store in a file.</p> <pre><code>var xmp = new XMPMeta();\nxmp.setProperty( XMPConst.NS_XMP, \"CreatorTool\", \"My Script\" );\nvar xmpStr = xmp.serialize(); // Serialize the XMP packet to XML\n\n// Retrieve property\nvar prop = xmp.getProperty(XMPConst.NS_XMP, \"CreatorTool\");\n$.writeln( \"namespace: \" + prop.namespace + \"\\n\" +\n    \"property path + name: \" + prop.path + \"\\n\" +\n    \"value: \" + prop ); // same as prop.value\n</code></pre>"},{"location":"scripting-xmp/accessing-the-xmp-scripting-api/#modifying-existing-metadata","title":"Modifying existing metadata","text":"<p>This code accesses an existing XMP packet, assuming the location has been assigned to a string variable. It sets the modification-date property to the current date and time, and stores the updated XMP packet back to the string, making it as small as possible.</p> <pre><code>var xmp = new XMPMeta( xmpStr ); // Object initialized with xmp packet as string\nvar dateTime = new XMPDateTime( new Date() ); // Now\nvar oldModificationDate = mp.getProperty( XMPConst.NS_XMP, \"ModifyDate\", \"xmpdate\" );\n\n$.writeln( \"Old modification date: \" + oldModificationDate );\nxmp.setProperty( XMPConst.NS_XMP, \"ModifyDate\", dateTime, \"xmpdate\" );\n\n// Serialize to XML, in compact style\nvar xmpStr = xmp.serialize( XMPConst.SERIALIZE_USE_COMPACT_FORMAT );\n</code></pre>"},{"location":"scripting-xmp/accessing-the-xmp-scripting-api/#using-xmpfile-for-batch-processing","title":"Using XMPFile for batch processing","text":"<p>This example iterates through a folder of image files and processes the metadata. The script processes each picture as follows:</p> <ul> <li>Reads and parses the metadata. If an image file does not contain XMP metadata, the legacy metadata is automatically converted to XMP.</li> <li>Deletes the list of existing creators, and adds a new creator value.</li> <li>Writes the modified metadata back to the file.</li> </ul> <pre><code>$.writeln( \"XMPFiles batch processing example\" );\n\n// Define folder containing images (make sure that you use copies)\nvar picFolder = \"/c/temp/photos\";\n\n// Load the XMPScript library\nif ( ExternalObject.AdobeXMPScript == undefined ) {\n    ExternalObject.AdobeXMPScript = new ExternalObject( \"lib:AdobeXMPScript\" );\n}\n\n// Iterate through the photos in the folder\nvar pics = Folder(picFolder).getFiles();\nfor ( var i = 0; i &lt; pics.length; i++ ) {\n    var file = pics[i];\n    $.writeln( \"Process file: \" + file.fsName );\n\n    // Applies only to files, not to folders\n    if ( file instanceof File ) {\n        var xmpFile = new XMPFile( file.fsName, XMPConst.UNKNOWN, XMPConst.OPEN_FOR_UPDATE );\n        var xmp = xmpFile.getXMP();\n\n        // Delete existing authors and add a new one\n        // Existing metadata stays untouched\n        xmp.deleteProperty( XMPConst.NS_DC, \"creator\" );\n        xmp.appendArrayItem( XMPConst.NS_DC, \"creator\", \"Judy\", 0, XMPConst.ARRAY_IS_ORDERED );\n\n        // Write updated metadata into the file\n        if ( xmpFile.canPutXMP( xmp ) ) {\n            xmpFile.putXMP( xmp );\n        }\n        xmpFile.closeFile( XMPConst.CLOSE_UPDATE_SAFELY );\n    }\n}\n</code></pre>"},{"location":"scripting-xmp/accessing-the-xmp-scripting-api/#integrating-xmpscript-with-adobe-bridge","title":"Integrating XMPScript with Adobe Bridge","text":"<p>This script adds a command to the context menu for Thumbnails that shows some of the XMP properties.</p> <p>It demonstrates how to retrieve the XMP metadata that is stored with the Thumbnail object, and use it to create an XMPMeta object, then use that object to retrieve different types of property values.</p> <p>To use this script, place it in the \"Startup Scripts\" folder for Adobe Bridge (see Startup scripts). When you start Adobe Bridge, select a thumbnail for a document that contains XMP metadata, right click, and choose Show XMP Properties from the menu.</p> <pre><code>$.writeln(\"XMPFiles batch processing example\");\n\n// Define folder containing images (make sure that you use copies)\nvar picFolder = \"/c/temp/photos\";\n\n// Load the XMPScript library\n$.writeln(\"XMPScript Adobe Bridge Integration Example\");\n\n// Load the XMPScript library\nif ( ExternalObject.AdobeXMPScript == undefined ) {\n    ExternalObject.AdobeXMPScript = new ExternalObject( \"lib:AdobeXMPScript\" );\n}\n// Add a context menu item to Thumbnails\nvar xmpCommand = new MenuElement( \"command\", \"Show XMP Properties\", \"at the end of Thumbnail\", \"showProperties\" );\n\n// Define command behavior\nxmpCommand.onSelect = function(m) {\n\n// Get the first selected thumbnail\nvar thumb = app.document.selections[0];\n\n// If there is one, and it has metadata\nif ( thumb &amp;&amp; thumb.metadata ) {\n\n    // Retrieve metadata from the thumbnail into an XMPMeta object`\n    // ( if app.synchronousMode is set, use thumb.metadata )\n\n    var xmp = new XMPMeta( thumb.synchronousMetadata.serialize() );\n\n    // Retrieve some of the XMP property values\n    // A simple property with a localized string value\n    var msg = \"Title: \" + xmp.getLocalizedText( XMPConst.NS_DC, \"title\", null, \"en\" ) + \"\\n\";\n\n    // An array property\n    msg += \"Authors of the document:\\n\";\n    var num = xmp.countArrayItems( XMPConst.NS_DC, \"creator\" );\n\n    for ( var i = 1; i &lt;= num; i++ ) {}\n        msg += \"* \" + xmp.getArrayItem( XMPConst.NS_DC, \"creator\", i ) + \"\\n\";\n    }\n\n    // A simple property with a date value\n    msg += \"Creation Date: \" + xmp.getProperty( XMPConst.NS_XMP, \"CreateDate\" )\n\n    // Display the values\n    Window.alert( msg );\n} else {\n    Window.alert( \"No thumbnail selected or no XMP contained\" );\n}\n</code></pre>"},{"location":"scripting-xmp/xmpscript-object-reference/","title":"XMPScript object reference","text":"<p>The classes defined for the XMP JavaScript API, with their properties and methods, are listed here in alphabetical order.</p> <p>After the library has been loaded, these XMP classes are available in the global JavaScript namespace:</p> Object Description XMPMeta object Provides the core services of the XMP Toolkit. XMPFile object Provides convenient I/O access to the main, or document level, XMP for a file. XMPUtils object Provides additional utility functions for array handling. XMPDateTime object Represents date-time values. XMPConst object Contains numeric and string constant values for use with the JavaScript API. <p>These top-level objects provide access to additional support classes:</p> Object Description XMPIterator object Allows iteration through properties in an XMPMeta object. XMPProperty object Describes a metadata property. XMPAliasInfo object Describes a metadata alias. XMPFileInfo object Describes a file. XMPPacketInfo object Describes a raw XMP packet in a file."},{"location":"scripting-xmp/xmpscript-object-reference/#xmpaliasinfo-object","title":"XMPAliasInfo object","text":"<p>This object is returned by XMPMeta.resolveAlias. The read-only properties describe an XMP metadata alias.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpaliasinfo-object-properties","title":"XMPAliasInfo object properties","text":"<p>Property</p> <p>Type</p> <p>Description</p> <p>arrayForm</p> <p>Number</p> <p>A constant that describes the property type of the resolved alias, 0 for a simple property. Constants are:</p> <ul> <li><code>XMPConst.ALIAS_TO_SIMPLE_PROP</code>: A direct mapping. It can be simple-to-simple, array-to-array, or structure-to-structure.</li> <li><code>XMPConst.ALIAS_TO_ARRAY</code>: The actual property is an unordered array; the alias is to the first element.</li> <li><code>XMPConst.ALIAS_TO_ORDERED_ARRAY</code>: The actual property is an ordered array; the alias is to the first element.</li> <li><code>XMPConst.ALIAS_TO_ALT_ARRAY</code>: The actual property is an alternate array; the alias is to the first element.</li> <li><code>XMPConst.ALIAS_TO_ALT_TEXT</code>: The actual property is an alternate text array; the alias is to the <code>x-default</code> element.</li> </ul> <p>name</p> <p>String</p> <p>The name of the property to which the alias resolves.</p> <p>namespace</p> <p>String</p> <p>The namespace of the property to which the alias resolves. See Schema namespace string constants.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpconst-object","title":"XMPConst object","text":"<p>This object contains the read-only constant definitions for use with the JavaScript XMP API. Some of these are listed in the context in which they are used. Longer lists are provided here.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#schema-namespace-string-constants","title":"Schema namespace string constants","text":"<p>Constant values for the namespace URI strings used in all get and set property operations. See XMPMeta object.</p> Namespace Description <code>NS_DC</code> The XML namespace for the Dublin Core schema, http://purl.org/dc/elements/1.1 <code>NS_IPTC_CORE</code> The XML namespace for the IPTC Core schema. <code>NS_RDF</code> The XML namespace for RDF. <code>NS_XML</code> The XML namespace for XML. <code>NS_XMP</code> The XML namespace for the XMP basic schema. <code>NS_XMP_RIGHTS</code> The XML namespace for the XMP copyright schema. <code>NS_XMP_MM</code> The XML namespace for the XMP digital asset management schema. <code>NS_XMP_BJ</code> The XML namespace for the job management schema. <code>NS_XMP_NOTE</code> The XML namespace for the XMP note schema. An Adobe private namespace; do not create new properties. <code>NS_PDF</code> The XML namespace for the PDF schema. <code>NS_PDFX</code> The XML namespace for the PDFX schema. An Adobe private namespace; do not create new properties. <code>NS_PHOTOSHOP</code> The XML namespace for the Adobe Photoshop custom schema. <code>NS_PS_ALBUM</code> The XML namespace for the Adobe Photoshop Album custom schema. <code>NS_EXIF</code> The XML namespace for Adobe's EXIF schema. <code>NS_EXIF_AUX</code> The XML namespace for Adobe's EXIF auxiliary schema. <code>NS_TIFF</code> The XML namespace for Adobe's TIFF schema. <code>NS_PNG</code> The XML namespace for the PNG schema. <code>NS_JPEG</code> The XML namespace for the JPEG schema. <code>NS_SWF</code> The XML namespace for the Flash small web format schema. <code>NS_JPK</code> The XML namespace for the JPK schema. <code>NS_CAMERA_RAW</code> The XML namespace for the Camera Raw schema. <code>NS_DM</code> The XML namespace for the DM schema. <code>NS_ADOBE_STOCK_PHOTO</code> The XML namespace for the Adobe Stock Photos schema. <code>NS_ASF</code> The XML namespace for the Microsoft advanced streaming format schema."},{"location":"scripting-xmp/xmpscript-object-reference/#type-namespace-string-constants","title":"Type namespace string constants","text":"<p>Constant values for the field-type namespace URI strings used in all structured property operations. See XMPMeta object.</p> Namespace Description <code>TYPE_IDENTIFIER_QUAL</code> The XML namespace for qualifiers of the xmp:Identifier property. <code>TYPE_DIMENSIONS</code> The XML namespace for fields of the Dimensions type. <code>TYPE_TEXT</code> The XML namespace for the XMP text document schema. <code>TYPE_PAGEDFILE</code> The XML namespace for the XMP paged document schema. <code>TYPE_GRAPHICS</code> The XML namespace for a structure containing the characteristics of a colorant (swatch) used in a document. <code>TYPE_IMAGE</code> The XML namespace for fields of a graphical image. Used for the Thumbnail type. <code>TYPE_FONT</code> The XML namespace for a structure containing the characteristics of a font used in a document. <code>TYPE_RESOURCE_EVENT</code> The XML namespace for fields of the ResourceEvent type. <code>TYPE_RESOURCE_REF</code> The XML namespace for fields of the ResourceRef type. <code>TYPE_ST_VERSION</code> The XML namespace for fields of the Version type. <code>TYPE_ST_JOB</code> The XML namespace for fields of the JobRef type. <code>TYPE_MANIFEST_ITEM</code> The XML namespace for the elements of a manifest array. <code>TYPE_PDFA_SCHEMA</code> <code>TYPE_PDFA_PROPERTY</code> <code>TYPE_PDFA_TYPE</code> <code>TYPE_PDFA_FIELD</code> <code>TYPE_PDFA_ID</code> <code>TYPE_PDFA_EXTENSION</code> The XML namespaces for PDF subtypes"},{"location":"scripting-xmp/xmpscript-object-reference/#file-format-numeric-constants","title":"File format numeric constants","text":"<p>Constant values for supported file types, used in I/O operations. See XMPFile object.</p> Constant Description <code>FILE_UNKNOWN</code> Unknown file-format. <code>FILE_PDF</code> PDF <code>FILE_POSTSCRIPT</code> PS, general PostScript following DSC conventions <code>FILE_EPS</code> EPS, encapsulated PostScript <code>FILE_JPEG</code> JPEG <code>FILE_JPEG2K</code> JPX, JPEG 2000 file <code>FILE_TIFF</code> TIFF <code>FILE_GIF</code> GIF <code>FILE_PNG</code> PNG <code>FILE_SWF</code> SWF, Flash file <code>FILE_FLA</code> FLA, Flash authoring file <code>FILE_FLV</code> FLV, Flash video file <code>FILE_MOV</code> MOV, Quicktime <code>FILE_AVI</code> AVI <code>FILE_CIN</code> CIN, Cineon <code>FILE_WAV</code> WAV <code>FILE_MP3</code> MP3 <code>FILE_SES</code> SES, Audition session <code>FILE_CEL</code> CEL, Audition loop <code>FILE_MPEG</code> MPEG <code>FILE_MPEG2</code> MP2 <code>FILE_MPEG4</code> MP4 <code>FILE_WMAV</code> WMAV, Windows Media Audio and Video <code>FILE_AIFF</code> AIFF <code>FILE_HTML</code> HTML <code>FILE_XML</code> XML <code>FILE_TEXT</code> TEXT <code>FILE_PHOTOSHOP</code> PSD, Photoshop <code>FILE_ILLUSTRATOR</code> AI, Illustrator <code>FILE_INDESIGN</code> INDD, Indesign <code>FILE_AE_PROJECT</code> AE, After Effects <code>FILE_AE_PROJECT_TEMPLATE</code> AET, After Effects Project Template <code>FILE_AE_FILTER_PRESET</code> FFX, After Effects Filter Preset file <code>FILE_ENCORE_PROJECT</code> NCOR, Encore DVD project file <code>FILE_PREMIERE_PROJECT</code> PRPJ, Premiere Project file <code>FILE_PREMIERE_TITLE</code> PRTL, Premiere Title file"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetime-object","title":"XMPDateTime object","text":"<p>This class represents a date and time. Times include a time zone, and can have up to nanosecond resolution.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetime-object-constructors","title":"XMPDateTime object constructors","text":"<pre><code>new XMPDateTime();            // creates an object containing a 0 date\nnew XMPDateTime(date);        // initializes the object with a JavaScript date\nnew XMPDateTime(iso8601Date); // initializes the object with an ISO date\n</code></pre>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameter","title":"Parameter","text":"Parameter Type Description date A JavaScript <code>Date</code> object. The time zone is set to the local operation-system time-zone value. Times in the XMP Toolkit can have up to nanosecond resolution; however, when converting to or from a JavaScript Date value, time resolution is reduced to milliseconds. iso8601Date String The date-time in ISO 8601 format; for example: <code>\"2007-04-10T17:54:50+01:00\"</code>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetime-object-properties","title":"XMPDateTime object properties","text":"<p>All properties are read-write, and allow you to modify the date-time value. If values are set outside the allowed range, they are automatically set to the minimum or maximum allowed value.</p> <p>Property</p> <p>Type</p> <p>Description</p> <p><code>year</code></p> <p>Number</p> <p>The year, in the range <code>[0000...9999]</code>.</p> <p><code>month</code></p> <p>Number</p> <p>The month, in the range <code>[1...12]</code>.</p> <p><code>day</code></p> <p>Number</p> <p>The day, in the range <code>[1...31]</code>.</p> <p><code>hour</code></p> <p>Number</p> <p>The hour, in the range <code>[1...23]</code>.</p> <p><code>minute</code></p> <p>Number</p> <p>The minute, in the range <code>[1...59]</code>.</p> <p><code>second</code></p> <p>Number</p> <p>The second, in the range <code>[1...59]</code>.</p> <p><code>nanosecond</code></p> <p>Number</p> <p>The nanosecond, in the range <code>[0...1e+9 -1]</code>.</p> <p><code>tzSign</code></p> <p>Number</p> <p>The time zone direction of offset. - <code>0</code>: UTC - <code>-1</code>: west - <code>1</code>: east</p> <p><code>tzHour</code></p> <p>Number</p> <p>The time zone hour offset from the prime meridian, in the range <code>[1...23]</code>.</p> <p><code>tzMinute</code></p> <p>Number</p> <p>The time zone minute offset from the prime meridian, in the range <code>[1...59]</code>.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetime-object-functions","title":"XMPDateTime object functions","text":""},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetimecompareto","title":"XMPDateTime.compareTo()","text":"<p><code>XMPDateTime.compareTo(xmpDateTime)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description","title":"Description","text":"<p>Reports the time order of two date-time values.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters","title":"Parameters","text":"Parameter Type Description xmpDataTime XMPDateTime object Object to compare to"},{"location":"scripting-xmp/xmpscript-object-reference/#returns","title":"Returns","text":"<ul> <li><code>0</code> if the two values are the same,</li> <li><code>1</code> if this date-time is later than the comparison value</li> <li><code>-1</code> if this date-time is earlier than the comparison value</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetimeconverttolocaltime","title":"XMPDateTime.convertToLocalTime()","text":"<p><code>XMPDateTime.convertToLocalTime()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_1","title":"Description","text":"<p>Sets the time zone in this object to the local operating-system time zone, adjusting the time values from the previous time zone, if necessary.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetimeconverttoutctime","title":"XMPDateTime.convertToUTCTime()","text":"<p><code>XMPDateTime.convertToUTCTime()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_2","title":"Description","text":"<p>Sets the time zone in this object to UTC (coordinated universal time), adjusting the time values from the previous time zone, if necessary.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_2","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetimegetdate","title":"XMPDateTime.getDate()","text":"<p><code>XMPDateTime.getDate()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_3","title":"Description","text":"<p>Converts this date-time value to a JavaScript Date. The time zone is normalized (time zones are not supported in the JavaScript format), and the accuracy is reduced to milliseconds.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_3","title":"Returns","text":"<p>Returns a JavaScript <code>Date</code> object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpdatetimesetlocaltimezone","title":"XMPDateTime.setLocalTimeZone()","text":"<p><code>XMPDateTime.setLocalTimeZone()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_4","title":"Description","text":"<p>Sets the time zone in this object to the current operation-system value, replacing any existing value.</p> <p>Does not affect other fields.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_4","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfile-object","title":"XMPFile object","text":"<p>This class corresponds to the Adobe XMP Toolkit's File Handler component, which provides convenient I/O access to the main, or document level, XMP for a file.</p> <p>The File Handler supports those file formats in which you can embed XMP metadata, as defined in the XMP Specification. It allows you to add XMP where none currently exists, expand existing XMP without regard to existing padding, and reconcile XMP with other metadata formats.</p> <p>The XMP Toolkit also supplies the Packet Scanner as a fallback solution for unsupported file formats. It provides more limited accesses to all file formats by performing a dump file scan. It can update a file, but cannot extend the packet or reconcile other metadata formats.</p> <p>The XMPScript API does not currently support retrieving thumbnails.</p> <p>Note</p> <p>You can also use the Adobe Bridge <code>Metadata</code> object to access embedded metadata in files. It supports thumbnails and previews, and additional file formats such as PDF and Camera Raw.</p> <p>For details, see the Adobe Bridge JavaScript Guide and Adobe Bridge JavaScript Reference.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfile-object-constructors","title":"XMPFile object constructors","text":"<p><code>new XMPFile(filePath, format, openFlags)</code></p> <p>Property</p> <p>Type</p> <p>Description</p> <p><code>filePath</code></p> <p>String</p> <p>File path</p> <p><code>format</code></p> <p>File format numeric constant</p> <p>Format to create as.</p> <p><code>openFlags</code></p> <p>Constant. One of:</p> <ul> <li><code>XMPConst.OPEN_FOR_READ</code> - Open for read-only access.</li> <li><code>XMPConst.OPEN_FOR_UPDATE</code> - Open for reading and writing.</li> <li><code>XMPConst.OPEN_ONLY_XMP</code> - Only the XMP is wanted, allows space/time optimizations.</li> <li><code>XMPConst.OPEN_STRICTLY</code> - Be strict about locating XMP and reconciling with other forms.</li> <li><code>XMPConst.OPEN_USE_SMART_HANDLER</code> - Require the use of a smart handler. No packet scanning is performed.</li> <li><code>XMPConst.OPEN_USE_PACKET_SCANNING</code> - Force packet scanning, do not use a smart handler.</li> <li><code>XMPConst.OPEN_LIMITED_SCANNING</code> - Only packet-scan files known to need scanning.</li> </ul> <p>The open options for the file.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfile-class-properties","title":"XMPFile class properties","text":"<p>This property is available as a static property of the XMPFile class. It is not necessary to create an instance to access it.</p> Property Type Descriptiopn <code>version</code> String The descriptive string for this version of the XMP Toolkit."},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfile-class-functions","title":"XMPFile class functions","text":"<p>This function is available as a static method of the XMPFile class. It is not necessary to create an instance to call it.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfilegetformatinfo","title":"XMPFile.getFormatInfo()","text":"<p><code>XMPFile.getFormatInfo(format)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_5","title":"Description","text":"<p>Reports the supported features for the given file format.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>format</code> File format numeric constants The format to get info from"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_5","title":"Returns","text":"<p>A logical OR of bit-flag constants, or 0 if the format is not handled. Constants are:</p> <ul> <li><code>XMPConst.HANDLER_CAN_INJECT_XMP</code> - Can inject first-time XMP into an existing file.</li> <li><code>XMPConst.HANDLER_CAN_EXPAND</code> - Can expand XMP or other metadata in an existing file.</li> <li><code>XMPConst.HANDLER_CAN_REWRITE</code> - Can copy one file to another, writing new metadata.</li> <li><code>XMPConst.HANDLER_PPEFERS_IN_PLACE</code> - Can expand, but prefers in-place update.</li> <li><code>XMPConst.HANDLER_CAN_RECONCILE</code> - Supports reconciliation between XMP and other forms.</li> <li><code>XMPConst.HANDLER_ALLOWS_ONLY_XMP</code> - Allows access to just the XMP, ignoring other forms.</li> <li><code>XMPConst.HANDLER_RETURNS_RAW_PACKETS</code> - File handler returns raw XMP packet information.</li> <li><code>XMPConst.HANDLER_RETURNS_TNAIL</code> - File handler returns native thumbnail.</li> <li><code>XMPConst.HANDLER_OWNS_FILE</code> - File handler does the file open and close.</li> <li><code>XMPConst.HANDLER_ALLOWS_SAFE_UPDATE</code> - File handler allows crash-safe file updates.</li> <li><code>XMPConst.HANDLER_NEEDS_READONLY_PACKET</code> - File format needs XMP packet to be read-only.</li> <li><code>XMPConst.HANDLER_USES_SIDECAR_XMP</code> - Fle handler uses a sidecar file for the XMP.</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfile-object-functions","title":"XMPFile object functions","text":""},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfilecanputxmp","title":"XMPFile.canPutXMP()","text":"<p><code>XMPFileObj.canPutXMP(xmpObj)</code></p> <p><code>XMPFileObj.canPutXMP(xmpPacket)</code></p> <p><code>XMPFileObj.canPutXMP(xmpBuffer)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_6","title":"Description","text":"<p>Reports whether XMP metadata of a given size can be updated for this file. This is particularly important if the packet size is increased.</p> <p>Considers only the length of the serialized packet; does not keep the provided XMP. Use putXMP() to actually update the XMP in the open file.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>xmpObj</code> XMPMeta object The XMP metadata to check <code>xmpPacket</code> String A string containing an XMP packet. <code>xmpBuffer</code> Array of Number The raw XMP packet data."},{"location":"scripting-xmp/xmpscript-object-reference/#retrurns","title":"Retrurns","text":"<p>Boolean. <code>true</code> if the given XMP can be put into this file.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfileclosefile","title":"XMPFile.closeFile()","text":"<p><code>XMPFileObj.closeFile(closeFlags)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_7","title":"Description","text":"<p>Closes this open file, after writing to it as necessary; that is, if the file was opened for update, and if the XMP metadata was updated or injected. The options provided when the file was opened determine whether this function reconciles the XMP with other forms of metadata; that is, whether any legacy metadata is also updated to be consistent with the XMP metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_3","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>closeFlags</code> </p> <p>Close-option constant, or <code>0</code>. One of: - <code>XMPConst.CLOSE_UPDATE_SAFELY</code> - Write into a temporary file then swap for crash safety.</p> <p>Flags to use for closing </p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_6","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfilegetxmp","title":"XMPFile.getXMP()","text":"<p><code>XMPFileObj.getXMP()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_8","title":"Description","text":"<p>Retrieves and parses the existing XMP metadata from this file. If the file format contains legacy metadata in a format that is recognized by the File Handler, the function creates an XMP packet containing the metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_7","title":"Returns","text":"<p>An XMPMeta object, or <code>null</code> if the files does not contain XMP or convertible legacy metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfilegetpacketinfo","title":"XMPFile.getPacketInfo()","text":"<p><code>XMPFileObj.getPacketInfo()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_9","title":"Description","text":"<p>Retrieves the raw XMP packet from this file, along with information about the packet. The options with which the file was opened determine whether this function reconciles other forms of metadata with the XMP.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_8","title":"Returns","text":"<p>An XMPPacketInfo object, or <code>null</code> if the files does not contain XMP metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfilegetfileinfo","title":"XMPFile.getFileInfo()","text":"<p><code>XMPFileObj.getFileInfo()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_10","title":"Description","text":"<p>Retrieves basic information about this file.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_9","title":"Returns","text":"<p>An XMPFileInfo object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfileputxmp","title":"XMPFile.putXMP()","text":"<p><code>XMPFileObj.putXMP(xmpObj)</code></p> <p><code>XMPFileObj.putXMP(xmpPacket)</code></p> <p><code>XMPFileObj.putXMP(xmpOBuffer)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_11","title":"Description","text":""},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>xmpObj</code> XMPMeta object The XMP metadata as an XMPMeta object. <code>xmpPacket</code> String The XMP metadata as a String containing an XMP packet. <code>xmpBuffer</code> Array of Numbers The XMP metadata as an Array of Number containing raw XMP packet data. <p>Supplies new XMP metadata for this file. The file is not actually written until closeFile() is called. The options provided when the file was opened determine whether that function reconciles the XMP with other forms of metadata; that is, whether any legacy metadata is also updated to be consistent with the XMP metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_10","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfileinfo-object","title":"XMPFileInfo object","text":"<p>This object is returned by XMPFile.getFileInfo. The read-only properties describe the file represented by the XMPFile object.</p> <p>Note</p> <p>This object is not related to the XMP File Info dialog that Adobe Creative Suite 4 applications use to display metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpfileinfo-object-properties","title":"XMPFileInfo object properties","text":"<p>Property</p> <p>Type</p> <p>Description</p> <p><code>filePath</code></p> <p>String</p> <p>The absolute path of the file, in JavaScript notation.</p> <p><code>format</code></p> <p>Number</p> <p>One of the file-format constants. See File format numeric constants.</p> <p><code>handlerFlags</code></p> <p>Number</p> <p>The features that are supported for this format. A logical OR of these bit-flag constants:</p> <ul> <li><code>XMPConst.HANDLER_CAN_INJECT_XMP</code> - Can inject first-time XMP into an existing file.</li> <li><code>XMPConst.HANDLER_CAN_EXPAND</code> - Can expand XMP or other metadata in an existing file.</li> <li><code>XMPConst.HANDLER_CAN_REWRITE</code> - Can copy one file to another, writing new metadata.</li> <li><code>XMPConst.HANDLER_PPEFERS_IN_PLACE</code> - Can expand, but prefers in-place update.</li> <li><code>XMPConst.HANDLER_CAN_RECONCILE</code> - Supports reconciliation between XMP and other forms.</li> <li><code>XMPConst.HANDLER_ALLOWS_ONLY_XMP</code> - Allows access to just the XMP, ignoring other forms.</li> <li><code>XMPConst.HANDLER_RETURNS_RAW_PACKETS</code> - File handler returns raw XMP packet information.</li> <li><code>XMPConst.HANDLER_RETURNS_TNAIL</code> - File handler returns native thumbnail.</li> <li><code>XMPConst.HANDLER_OWNS_FILE</code> - File handler does the file open and close.</li> <li><code>XMPConst.HANDLER_ALLOWS_SAFE_UPDATE</code> - File handler allows crash-safe file updates.</li> </ul> <p><code>openFlags</code></p> <p>Number</p> <p>The options with which this file was opened. One of these constants:</p> <ul> <li><code>XMPConst.OPEN_FOR_READ</code> - Open for read-only access.</li> <li><code>XMPConst.OPEN_FOR_UPDATE</code> - Open for reading and writing.</li> <li><code>XMPConst.OPEN_ONLY_XMP</code> - Only the XMP is wanted, allows space/time optimizations.</li> <li><code>XMPConst.OPEN_STRICTLY</code> - Be strict about locating XMP and reconciling with other forms.</li> <li><code>XMPConst.OPEN_USE_SMART_HANDLER</code> - Require the use of a smart handler. No packet scanning is performed.</li> <li><code>XMPConst.OPEN_USE_PACKET_SCANNING</code> - Force packet scanning, do not use a smart handler.</li> <li><code>XMPConst.OPEN_LIMITED_SCANNING</code> - Only packet-scan files known to need scanning.</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpiterator-object","title":"XMPIterator object","text":"<p>Created by a call to XMPMeta.iterator. Walks recursively through the properties and qualifiers of an XMPMeta object, and returns them as XMPProperty object.</p> <p>The object has no JavaScript properties.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpiterator-object-functions","title":"XMPIterator object functions","text":""},{"location":"scripting-xmp/xmpscript-object-reference/#xmpiteratornext","title":"XMPIterator.next()","text":"<p><code>XMPIteratorObj.next()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_12","title":"Description","text":"<p>Retrieves the next item in the metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_11","title":"Returns","text":"<p>An XMPProperty object, or null if there are no more items.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpiteratorskipsiblings","title":"XMPIterator.skipSiblings()","text":"<p><code>XMPIteratorObj.skipSiblings()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_13","title":"Description","text":"<p>Skips the subtree below and the siblings of the current node on the subsequent call to next().</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_12","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpiteratorskipsubtree","title":"XMPIterator.skipSubtree()","text":"<p><code>XMPIteratorObj.skipSubtree()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_14","title":"Description","text":"<p>Skips the subtree below the current node on the subsequent call to next().</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_13","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmeta-object","title":"XMPMeta object","text":"<p>This class provides the core services of the XMP Toolkit. The functions provide the ability to create and query metadata properties from an XMP namespace. The class also provides static functions that allow you to create and query namespaces and aliases.</p> <p>There is one static property on the class that provides XMP version information; there are no JavaScript properties in the instance. The object encapsulates a set of metadata properties, which you access through the object functions.</p> <p>The generic functions getProperty(), setProperty(), and deleteProperty() allow you to manipulate all types of properties, when used with appropriately composed path expressions. For convenience, the object also provides more specific functions for use with specific types of properties, such as arrays.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmeta-object-constructors","title":"XMPMeta object constructors","text":"<p>To create an <code>XMPMeta</code> object, use the <code>new</code> operator. The constructor accepts an RDF/XML serialized metadata packet as a string, or as an array of numbers that contain only byte values. It returns the new object. If no argument is supplied, the new object is empty; you can use the object's functions to add namespaces and properties.</p> <p>The first call to any of these constructors initializes the library by registering the standard namespaces and aliases:</p> <pre><code>new XMPMeta ( ); // creates an empty object\nnew XMPMeta ( packet );\nnew XMPMeta ( buffer );\n</code></pre>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>packet</code> String An XML file or an XMP packet. <code>buffer</code> Array of Numbers The UTF-8 or UTF-16 encoded bytes of an XML file or an XMP packet. This array is the result of XMPMeta.serializeToArray."},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmeta-class-properties","title":"XMPMeta class properties","text":"<p>The <code>XMPMeta</code> class provides this static property. It is not necessary to create an instance to access it.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#properties","title":"Properties","text":"Property Type Description <code>version</code> String The descriptive string for this version of the XMP Toolkit."},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmeta-class-functions","title":"XMPMeta class functions","text":"<p>The <code>XMPMeta</code> class provides these static functions. It is not necessary to create an instance to call them.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadeletealias","title":"XMPMeta.deleteAlias()","text":"<p><code>XMPMeta.deleteAlias(aliasNS, aliasProp)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_15","title":"Description","text":"<p>Deletes the specified alias; does not delete the aliased property.</p> <p>If the alias does not exist, does nothing.</p> <p>Note</p> <p>Not yet implemented in the XMP Toolkit.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>aliasNS</code> String The namespace URI string. See Schema namespace string constants. <code>aliasProp</code> String The alias property string."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_14","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadeletenamespace","title":"XMPMeta.deleteNamespace()","text":"<p><code>XMPMeta.deleteNamespace(namespaceURI)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_16","title":"Description","text":"<p>Deletes a registered prefix - namespace URI pair.</p> <p>Note</p> <p>Not yet implemented in the XMP Toolkit.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>namespaceURI</code> String The namespace URI string. See Schema namespace string constants."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_15","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadumpaliases","title":"XMPMeta.dumpAliases()","text":"<p><code>XMPMeta.dumpAliases()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_17","title":"Description","text":"<p>Creates and returns a human-readable string containing the list of registered aliases and their targets.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_16","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadumpnamespaces","title":"XMPMeta.dumpNamespaces()","text":"<p><code>XMPMeta.dumpNamespaces()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_18","title":"Description","text":"<p>Creates and returns a human-readable string containing the list of registered namespace URIs and their associated prefixes.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_17","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetagetnamespaceprefix","title":"XMPMeta.getNamespacePrefix()","text":"<p><code>XMPMeta.getNamespacePrefix(namespaceURI)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_19","title":"Description","text":"<p>Retrieves the prefix associated with a registered namespace URI.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>namespaceURI</code> String The namespace URI string. See Schema namespace string constants."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_18","title":"Returns","text":"<p>The prefix string followed by a colon.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetagetnamespaceuri","title":"XMPMeta.getNamespaceURI()","text":"<p><code>XMPMeta.getNamespaceURI(namespacePrefix)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_20","title":"Description","text":"<p>Retrieves the registered namespace URI associated with a namespace prefix.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_9","title":"Parameters","text":"Parameter Type Description <code>namespacePrefix</code> String The namespace prefix string."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_19","title":"Returns","text":"<p>The URI String.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetaregisteralias","title":"XMPMeta.registerAlias()","text":"<p><code>XMPMeta.registerAlias(aliasNS, aliasProp, actualNS, actualProp, arrayForm)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_21","title":"Description","text":"<p>Defines an alias mapping from one namespace and property to another. An alias can be a direct mapping where the alias and actual property have the same data type, or it can map a simple alias to an item in an array, either the first item, or the <code>x-default</code> item in an alternate-text array.</p> <p>Multiple alias names can map to the same actual property, as long as the forms match. If the same alias and form exists, the call does nothing.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_10","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>aliasNS</code></p> <p>String</p> <p>The alias namespace string. See Schema namespace string constants.</p> <p><code>aliasProp</code></p> <p>String</p> <p>The alias property, a simple name string.</p> <p><code>actualNS</code></p> <p>Schema namespace string constants</p> <p>The namespace string of the aliased property.</p> <p><code>actualProp</code></p> <p>String</p> <p>The aliased property, a simple name string.</p> <p><code>arrayForm</code></p> <p>Number</p> <p>The array form for a simple alias to an array item, which controls how the array is created if it is set for the first time through the alias. One of these constants:</p> <ul> <li><code>XMPConst.ALIAS_TO_SIMPLE_PROP</code> (default) - A direct mapping. It can be simple-to-simple, array-to-array, or structure-to-structure.</li> <li><code>XMPConst.ALIAS_TO_ARRAY</code> - The actual is an unordered array, the alias is to the first element of the array.</li> <li><code>XMPConst.ALIAS_TO_ORDERED_ARRAY</code> - The actual is an ordered array, the alias is to the first element of the array.</li> <li><code>XMPConst.ALIAS_TO_ALT_ARRAY</code> - The actual is an alternate array, the alias is to the first element of the array.</li> <li><code>XMPConst.ALIAS_TO_ALT_TEXT</code> - The actual is an alternate-text array (a localized property), the alias is to the x-default element of the array.</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_20","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetaregisternamespace","title":"XMPMeta.registerNamespace()","text":"<p><code>XMPMeta.registerNamespace(namespaceURI, suggestedPrefix)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_22","title":"Description","text":"<p>Registers a namespace with a prefix. If the suggested prefix is already in use, generates, registers, and returns a different prefix.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_11","title":"Parameters","text":"Parameter Type Description namespaceURI Schema namespace string constants The namespace URI string. suggestedPrefix String The suggested namespace prefix string."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_21","title":"Returns","text":"<p>A String containing the actual registered prefix. This is the <code>suggestedPrefix</code>, unless that one is already assigned to another namespace.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetaresolvealias","title":"XMPMeta.resolveAlias()","text":"<p><code>XMPMeta.resolveAlias(aliasNS, aliasProp)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_23","title":"Description","text":"<p>Retrieves information about the actual property to which an alias is mapped.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_12","title":"Parameters","text":"Parameter Type Description schemaNS Schema namespace string constants The alias namespace URI string. aliasProp The alias property string."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_22","title":"Returns","text":"<p>An XMPAliasInfo object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmeta-object-functions","title":"XMPMeta object functions","text":""},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetaappendarrayitem","title":"XMPMeta.appendArrayItem()","text":"<p><code>XMPMetaObj.appendArrayItem(schemaNS, arrayName[, itemOptions], itemValue[, arrayOptions])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_24","title":"Description","text":"<p>Appends an item to an existing array, or creates a new array-type property if the named array does not exist.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_13","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>schemaNS</code></p> <p>Schema namespace string constants.</p> <p>The namespace URI string.</p> <p><code>arrayName</code></p> <p>String</p> <p>The array-type property name string. Can be a general path expression.</p> <p><code>itemOptions</code></p> <p>Number</p> <p>Optional. A flag that describes the new item, if it is being created. One of:</p> <ul> <li><code>0</code>: The default. A simple item, or the type implied by the arrayOptions value.</li> <li><code>XMPConst.PROP_IS_ARRAY</code>: The item is an array (of type alt, bag, or seq).</li> <li><code>XMPConst.PROP_IS_STRUCT</code>: The item is a structure with nested fields.</li> </ul> <p><code>itemValue</code></p> <p>String</p> <p>The new item value string. Pass <code>null</code> for array items that do not have values.</p> <p><code>arrayOptions</code></p> <p>Number</p> <p>Optional. A flag that describes the array form. Must be provided if the array is being created; ignored if the array already exists. One of:</p> <ul> <li><code>XMPConst.ARRAY_IS_ORDERED</code> - Item order is significant. Implies <code>XMPConst.PROP_IS_ARRAY</code>.</li> <li><code>XMPConst.ARRAY_IS_ALTERNATIVE</code> - Items are mutually exclusive alternates. Implies <code>XMPConst.PROP_IS_ARRAY</code> and <code>XMPConst.ARRAY_IS_ORDERED</code>.</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_23","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetacountarrayitems","title":"XMPMeta.countArrayItems()","text":"<p><code>XMPMetaObj.countArrayItems(schemaNS, arrayName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_25","title":"Description","text":"<p>Reports the number of items in an array-type metadata property.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_14","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>arrayName</code> String The array-type property name string. Can be a general path expression."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_24","title":"Returns","text":"<p>Number</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadeletearrayitem","title":"XMPMeta.deleteArrayItem()","text":"<p><code>XMPMetaObj.deleteArrayItem(schemaNS, arrayName, itemIndex)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_26","title":"Description","text":"<p>Deletes the metadata tree that has the given array item as its root.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_15","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>arrayName</code> String The array-type property name string. Can be a general path expression. <code>itemIndex</code> Number The 1-based position index of the item. Use <code>XMPConst.ARRAY_LAST_ITEM</code> to reference the last existing item in the array."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_25","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadeleteproperty","title":"XMPMeta.deleteProperty()","text":"<p><code>XMPMetaObj.deleteProperty(schemaNS, propName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_27","title":"Description","text":"<p>Deletes the metadata tree that has the given property as its root. If the property does not exist, does nothing.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_16","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>propName</code> String The property name string. Can be a general path expression."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_26","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadeletestructfield","title":"XMPMeta.deleteStructField()","text":"<p><code>XMPMetaObj.deleteStructField(schemaNS, structName, fieldNS, fieldName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_28","title":"Description","text":"<p>Deletes the metadata tree that has the given structure field as its root.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_17","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>structName</code> String The structure name string. Can be a general path expression. <code>fieldNS</code> Schema namespace string constants The field type namespace string. <code>fieldName</code> String The field name string. Must be a simple XML name."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_27","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadeletequalifier","title":"XMPMeta.deleteQualifier()","text":"<p><code>XMPMetaObj.deleteQualifier(schemaNS, structName, qualNS, qualName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_29","title":"Description","text":"<p>Deletes the metadata tree that has the given qualifier as its root. If the qualifier does not exist, does nothing.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_18","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. structName String The structure name string. Can be a general path expression. qualNS String The URI string of the qualifier namespace. qualName String The qualifier name string. Must be a simple XML name."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_28","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadoesarrayitemexist","title":"XMPMeta.doesArrayItemExist()","text":"<p><code>XMPMetaObj.doesArrayItemExist(schemaNS, arrayName, itemIndex)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_30","title":"Description","text":"<p>Reports whether an array item with a given index currently exists in an existing array in the metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_19","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>arrayName</code> String The array name string. Can be a general path expression. <code>itemIndex</code> Number The 1-based position index of the item."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_29","title":"Returns","text":"<p>Boolean. <code>true</code> if the array and item exist.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadoespropertyexist","title":"XMPMeta.doesPropertyExist()","text":"<p><code>XMPMetaObj.doesPropertyExist(schemaNS, propName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_31","title":"Description","text":"<p>Reports whether a property with a given name currently exists in the metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_20","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>propName</code> String The property name string. Can be a general path expression."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_30","title":"Returns","text":"<p>Boolean. <code>true</code> if the property exists.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadoesstructfieldexist","title":"XMPMeta.doesStructFieldExist()","text":"<p><code>XMPMetaObj.deleteStructField(schemaNS, structName, fieldNS, fieldName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_32","title":"Description","text":"<p>Reports whether a structure field with a given name currently exists in the metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_21","title":"Parameters","text":"Parameter Type Description schemaNS Schema namespace string constants The namespace URI string. structName String The structure name string. Can be a general path expression. fieldNS Schema namespace string constants The field type namespace string. fieldName String The field name string. Must be a simple XML name."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_31","title":"Returns","text":"<p>Boolean. <code>true</code> if the structure and field exist.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadoesqualifierexist","title":"XMPMeta.doesQualifierExist()","text":"<p><code>XMPMetaObj.doesQualifierExist(schemaNS, structName, qualNS, qualName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_33","title":"Description","text":"<p>Reports whether a qualifier with a given name currently exists for a given property.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_22","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. structName String The structure name string. Can be a general path expression. qualNS String The URI string of the qualifier namespace. qualName String The qualifier name string. Must be a simple XML name."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_32","title":"Returns","text":"<p>Boolean. <code>true</code> if the property and qualifier exist.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetadumpobject","title":"XMPMeta.dumpObject()","text":"<p><code>XMPMetaObj.dumpObject()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_34","title":"Description","text":"<p>Creates and returns a string containing the metadata content of this object as RDF.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_33","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetagetarrayitem","title":"XMPMeta.getArrayItem()","text":"<p><code>XMPMetaObj.getArrayItem(schemaNS, arrayName, itemIndex)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_35","title":"Description","text":"<p>Retrieves an item from an array-type metadata property.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_23","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>arrayName</code> String The array name string. Can be a general path expression. <code>itemIndex</code> Number The 1-based position index of the item. Use <code>XMPConst.ARRAY_LAST_ITEM</code> to reference the last existing item in the array."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_34","title":"Returns","text":"<p>An XMPProperty object, or <code>undefined</code> if the property is not found.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetagetlocalizedtext","title":"XMPMeta.getLocalizedText()","text":"<p><code>XMPMetaObj.getLocalizedText(schemaNS, altTextName, genericLang, specificLang)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_36","title":"Description","text":"<p>Retrieves the text value for a specific language from an alternate-text array. First tries to match the specific language. If not found, tries to match the generic language, if specified. If not found, gets the x-default item, if any. Otherwise, gets the first item.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_24","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>altTextName</code> String The alternate-text array name string. Can be a general path expression. <code>genericLang</code> String The name of the generic language as an RFC 3066 primary subtag. Can be <code>null</code> or the empty string. <code>specificLang</code> String The name of the specific language as an RFC 3066 primary subtag; for example, en-US. Must be specified."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_35","title":"Returns","text":"<p>String, or <code>undefined</code> if no matching value is not found.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetagetproperty","title":"XMPMeta.getProperty()","text":"<p><code>XMPMetaObj.getProperty(schemaNS, propName[, valueType])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_37","title":"Description","text":"<p>Retrieves the value and options of a metadata property. Use for top-level, simple properties, or after using the path-composition functions in the XMPUtils object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_25","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>schemaNS</code></p> <p>Schema namespace string constants</p> <p>The namespace URI string.</p> <p><code>propName</code></p> <p>String</p> <p>The property name string. Can be a general path expression.</p> <p><code>valueType</code></p> <p>String</p> <p>Optional. The property data type, one of:</p> <ul> <li><code>XMPConst.STRING</code></li> <li><code>XMPConst.INTEGER</code></li> <li><code>XMPConst.NUMBER</code></li> <li><code>XMPConst.BOOLEAN</code></li> <li><code>XMPConst.XMPDATE</code></li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_36","title":"Returns","text":"<p>An XMPProperty object, or <code>undefined</code> if the property is not found.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetagetstructfield","title":"XMPMeta.getStructField()","text":"<p><code>XMPMetaObj.getStructField(schemaNS, structName, fieldNS, fieldName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_38","title":"Description","text":"<p>Retrieves a field value from within a nested structure in metadata.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_26","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>structName</code> String The structure name string. Can be a general path expression. <code>fieldNS</code> Schema namespace string constants The field type namespace string. <code>fieldName</code> String The field name string. Must be a simple XML name."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_37","title":"Returns","text":"<p>An XMPProperty object, or <code>undefined</code> if the property is not found.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetagetqualifier","title":"XMPMeta.getQualifier()","text":"<p><code>XMPMetaObj.getQualifier(schemaNS, structName, qualNS, qualName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_39","title":"Description","text":"<p>Retrieves a qualifier attached to a metadata property.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_27","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>structName</code> String The structure name string. Can be a general path expression. <code>qualNS</code> String The URI string of the qualifier namespace. <code>qualName</code> String The qualifier name string. Must be a simple XML name."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_38","title":"Returns","text":"<p>An XMPProperty object, or <code>undefined</code> if the property is not found.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetainsertarrayitem","title":"XMPMeta.insertArrayItem()","text":"<p><code>XMPMetaObj.insertArrayItem(schemaNS, arrayName, itemIndex, itemValue[, itemOptions])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_40","title":"Description","text":"<p>Inserts an item into an array, before an existing item. The index positions of all later items are incremented. The array must exist.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_28","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>schemaNS</code></p> <p>The namespace URI string. See Schema namespace string constants.</p> <p><code>arrayName</code></p> <p>String</p> <p>The array-type property name string. Can be a general path expression.</p> <p><code>itemIndex</code></p> <p>Number</p> <p>The 1-based position index at which to insert the new item. Use <code>XMPConst.ARRAY_LAST_ITEM</code> to reference the last existing item in the array.</p> <p><code>itemValue</code></p> <p>String</p> <p>The new item value. Pass <code>null</code> for array items that do not have values.</p> <p><code>itemOptions</code></p> <p>Number</p> <p>Optional. A flag that describes the new item, if it is being created. One of:</p> <ul> <li><code>0</code>: A simple item, the default.</li> <li><code>XMPConst.PROP_IS_ARRAY</code>: The item is an array (of type alt, bag, or seq).</li> <li><code>XMPConst.PROP_IS_STRUCT</code>: The item is a structure with nested fields.</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_39","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetaiterator","title":"XMPMeta.iterator()","text":"<p><code>XMPMetaObj.iterator(options, schemaNS, propName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_41","title":"Description","text":"<p>Creates an iteration object that can iterate over the properties, arrays, and qualifiers within this metadata. Specify options, a namespace, and a property to limit the range and granularity of the resulting items.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_29","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>options</code></p> <p>A logical OR of these bit-flag constants:</p> <ul> <li><code>XMPConst.ITERATOR_JUST_CHILDREN</code> - Limit iteration to immediate children of the root property. By default, iterates into subtrees.</li> <li><code>XMPConst.ITERATOR_JUST_LEAFNODES</code> - Limit iteration to leaf nodes. By default, iterates into all nodes of a subtree.</li> <li><code>XMPConst.ITERATOR_JUST_LEAFNAMES</code> - Return only the leaf part of the path. By default, returns a full path.</li> <li><code>XMPConst.ITERATOR_INCLUDE_ALIASES</code> - Include aliases. By default, considers only actual properties.</li> <li><code>XMPConst.ITERATOR_OMIT_QUALIFIERS</code> - Omit qualifiers from iteration.</li> </ul> <p>The set of options that control how the iteration is performed, and how values are returned.</p> <p><code>schemaNS</code></p> <p>Schema namespace string constants</p> <p>The namespace URI string.</p> <p><code>propName</code></p> <p>String</p> <p>The array-type property name string. Can be a general path expression.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_40","title":"Returns","text":"<p>An XMPIterator object for this metadata object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetaserialize","title":"XMPMeta.serialize()","text":"<p><code>XMPMetaObj.serialize([options, padding, indent, newline, baseIndent])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_42","title":"Description","text":"<p>Serializes this XMP metadata into a string as RDF.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_30","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>options</code></p> <p>Optional. A logical OR of these bit-flag constants:</p> <ul> <li><code>XMPConst.SERIALIZE_OMIT_PACKET_WRAPPER</code> - Do not include an XML packet wrapper.</li> <li><code>XMPConst.SERIALIZE_READ_ONLY_PACKET</code> - Create a read-only XML packet wrapper.</li> <li><code>XMPConst.SERIALIZE_USE_COMPACT_FORMAT</code> - Use a highly compact RDF syntax and layout.</li> <li><code>XMPConst.SERIALIZE_USE_PLAIN_XMP</code> - Serialize a plain XMP (not currently supported).</li> <li><code>XMPConst.SERIALIZE_INCLUDE_THUMBNAIL_PAD</code> - Include typical space for a JPEG thumbnail in the padding if no xmp:Thumbnail property is present.</li> <li><code>XMPConst.SERIALIZE_EXACT_PACKET_LENGTH</code> - Compute padding to meet the overall packet length provided by the padding parameter. Throws an exception if the unpadded packet exceeds this length.</li> <li><code>XMPConst.SERIALIZE_WRITE_ALIAS_COMMENTS</code> - Include XML comments for aliases.</li> </ul> <p>The set of options that control how the serialization is performed. The options must be logically consistent; if they conflict, the function throws an exception.</p> <p><code>padding</code></p> <p>Number</p> <p>Optional.</p> <ul> <li>If the options value is <code>SERIALIZE_EXACT_PACKET_LENGTH</code>, this the exact length of the packet, including padding characters that are added to meet this length.</li> <li>If the options value is not <code>SERIALIZE_EXACT_PACKET_LENGTH</code>, this is a number of padding characters to add.</li> <li>Default is <code>0</code>, meaning to use the appropriate amount of padding.</li> </ul> <p><code>indent</code></p> <p>String</p> <p>Optional. The string to use as an indent. Default is two spaces.</p> <p><code>newline</code></p> <p>String</p> <p>Optional. The newline character to use. Default is <code>U+000A</code>.</p> <p><code>baseIndent</code></p> <p>Number</p> <p>Optional. The level of indentation of the outermost XML element. Default is <code>0</code>.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_41","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetaserializetoarray","title":"XMPMeta.serializeToArray()","text":"<p><code>XMPMetaObj.serializeToArray([options, padding, indent, newline, baseIndent])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_43","title":"Description","text":"<p>Serializes this XMP metadata into a string as RDF, then converts that to an array of one-byte numeric values, the UTF-8 or UTF-16 encoded characters.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_31","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>options</code></p> <p>A logical OR of these bit-flag constants:</p> <ul> <li><code>XMPConst.SERIALIZE_OMIT_PACKET_WRAPPER</code> - Do not include an XML packet wrapper.</li> <li><code>XMPConst.SERIALIZE_READ_ONLY_PACKET</code> - Create a read-only XML packet wrapper.</li> <li><code>XMPConst.SERIALIZE_USE_COMPACT_FORMAT</code> - Use a highly compact RDF syntax and layout.</li> <li><code>XMPConst.SERIALIZE_USE_PLAIN_XMP</code> - Serialize a plain XMP (not currently supported).</li> <li><code>XMPConst.SERIALIZE_INCLUDE_THUMBNAIL_PAD</code> - Include typical space for a JPEG thumbnail in the padding if no xmp:Thumbnail property is present.</li> <li><code>XMPConst.SERIALIZE_EXACT_PACKET_LENGTH</code> - Compute padding to meet the overall packet length provided by the padding parameter. Throws an exception if the unpadded packet exceeds this length.</li> <li><code>XMPConst.SERIALIZE_WRITE_ALIAS_COMMENTS</code> - Include XML comments for aliases.</li> </ul> <p>Optional. The set of options that control how the serialization is performed. The options must be logically consistent; if they conflict, the function throws an exception.</p> <p><code>padding</code></p> <p>Number</p> <p>Optional.</p> <ul> <li>If the options value is <code>SERIALIZE_EXACT_PACKET_LENGTH</code>, this the exact length of the packet, including padding characters that are added to meet this length.</li> <li>If the options value is not <code>SERIALIZE_EXACT_PACKET_LENGTH</code>, this is a number of padding characters to add.</li> <li>Default is <code>0</code>, meaning to use the appropriate amount of padding.</li> </ul> <p><code>indent</code></p> <p>String</p> <p>Optional. The string to use as an indent. Default is two spaces.</p> <p><code>newline</code></p> <p>String</p> <p>Optional. The newline character to use. Default is <code>U+000A</code>.</p> <p><code>baseIndent</code></p> <p>Number</p> <p>Optional. The level of indentation of the outermost XML element. Default is <code>0</code>.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_42","title":"Returns","text":"<p>An Array of Numbers.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetasetarrayitem","title":"XMPMeta.setArrayItem()","text":"<p><code>XMPMetaObj.setArrayItem(schemaNS, arrayName, itemIndex, itemValue[, itemOptions])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_44","title":"Description","text":"<p>Replaces an item within an array, or appends an item. The array must exist. To create an item, appendArrayItem() and insertArrayItem() are preferred.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_32","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>schemaNS</code></p> <p>Schema namespace string constants</p> <p>The namespace URI string.</p> <p><code>arrayName</code></p> <p>String</p> <p>The array-type property name string. Can be a general path expression.</p> <p><code>itemIndex</code></p> <p>Number</p> <p>The 1-based position index at which to insert the new item. Use <code>XMPConst.ARRAY_LAST_ITEM</code> to replace the last existing item in the array.</p> <p><code>itemValue</code></p> <p>String</p> <p>The new item value string. Pass <code>null</code> for array items that do not have values.</p> <p><code>itemOptions</code></p> <p>A flag that describes the new item, if it is being created. One of:</p> <ul> <li><code>0</code>: A simple item, the default.</li> <li><code>XMPConst.PROP_IS_ARRAY</code>: The item is an array (of type alt, bag, or seq).</li> <li><code>XMPConst.PROP_IS_STRUCT</code>: The item is a structure with nested fields.</li> </ul> <p>Optional</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_43","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetasetlocalizedtext","title":"XMPMeta.setLocalizedText()","text":"<p><code>XMPMetaObj.setLocalizedText(schemaNS, altTextName, genericLang, specificLang, itemValue, setOptions)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_45","title":"Description","text":"<p>Sets the text value for a specific language in an alternate-text array. Handles special cases for the x-default item.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_33","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>altTextName</code> String The name string of the alternate-text array. Can be a general path expression. <code>genericLang</code> String The name of the generic language as an RFC 3066 primary subtag. Can be null or the empty string. <code>specificLang</code> String The name of the specific language as an RFC 3066 primary subtag; for example, en-US. Must be specified. <code>itemValue</code> String The new string value. <code>setOptions</code> Unknown Not used."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_44","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetasetstructfield","title":"XMPMeta.setStructField()","text":"<p><code>XMPMetaObj.setStructField(schemaNS, structName, fieldNS, fieldName, fieldValue[, options])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_46","title":"Description","text":"<p>Sets the value of a field within a structure-type property, or creates a new field if the named field does not exist in the structure, or creates a new structure containing the named field if the named structure does not exist.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_34","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>schemaNS</code></p> <p>Schema namespace string constants</p> <p>The namespace URI string.</p> <p><code>structName</code></p> <p>String</p> <p>The name string of an existing structure. Can be a general path expression.</p> <p><code>fieldNS</code></p> <p>Schema namespace string constants</p> <p>The field type namespace string.</p> <p><code>fieldName</code></p> <p>String</p> <p>The field name string. Must be a simple XML name.</p> <p><code>fieldValue</code></p> <p>String</p> <p>The new field value string. Pass null for fields that do not have values.</p> <p><code>options</code></p> <p>Option flags that describe a new structure. One of:</p> <ul> <li><code>0</code> - A simple item, the default.</li> <li><code>XMPConst.PROP_IS_ARRAY</code> - The item is an array (of type alt, bag, or seq).</li> <li><code>XMPConst.PROP_IS_STRUCT</code> - The item is a structure with nested fields.</li> </ul> <p>Optional. Used only if the structure is being created.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_45","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetasetqualifier","title":"XMPMeta.setQualifier()","text":"<p><code>XMPMetaObj.setQualifier(schemaNS, propName, qualNS, qualName, qualValue[, options])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_47","title":"Description","text":"<p>Attaches a new qualifier to a metadata property. A qualifier can be added to a simple property, an array item, a struct field, or another qualifier.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_35","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>schemaNS</code></p> <p>Schema namespace string constants</p> <p>The namespace URI string.</p> <p><code>propName</code></p> <p>String</p> <p>The name string of an existing property. Can be a general path expression.</p> <p><code>qualNS</code></p> <p>String</p> <p>The URI of the qualifier namespace. Has the same URI and prefix usage as a schema namespace.</p> <p><code>qualName</code></p> <p>String</p> <p>The name of the qualifier. Must be a simple XML name. Has the same prefix usage as a property name.</p> <p><code>qualValue</code></p> <p>String</p> <p>The new qualifier value string. Pass null for qualifiers that do not have values.</p> <p><code>options</code></p> <p>Option flags that describe the qualifier. One of:</p> <ul> <li><code>0</code> - A simple item, the default.</li> <li><code>XMPConst.PROP_IS_ARRAY</code> - The item is an array (of type alt, bag, or seq).</li> <li><code>XMPConst.PROP_IS_STRUCT</code> - The item is a structure with nested fields.</li> </ul> <p>Optional. Used only if the qualifier is being created.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_46","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetasetproperty","title":"XMPMeta.setProperty()","text":"<p><code>XMPMetaObj.setProperty(schemaNS, propName, propValue[, setOptions, valueType])</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_48","title":"Description","text":"<p>Sets the value of a simple metadata property, creating the property if necessary, or creates a new array or structure property. For creating array and structure properties, setArrayItem() and setStructField() are preferred. Use this call to create or set top-level, simple properties, or after using the path-composition functions in the XMPUtils object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_36","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>schemaNS</code></p> <p>Schema namespace string constants</p> <p>The namespace URI string.</p> <p><code>propName</code></p> <p>String</p> <p>The property name string. Can be a general path expression.</p> <p><code>propValue</code></p> <p>String</p> <p>The new property value string. Pass null to create an array or non-leaf level structure property.</p> <p><code>setOptions</code></p> <p>A simple-valued property. Other constant values are:</p> <ul> <li><code>0</code> - A simple item, the default.</li> <li><code>XMPConst.PROP_IS_ARRAY</code> - The item is an array (of type alt, bag, or seq).</li> <li><code>XMPConst.PROP_IS_STRUCT</code> - The item is a structure with nested fields.</li> </ul> <p>Optional. The type of property to create, if the named property does not exist. Default is <code>0</code>.</p> <p><code>valueType</code></p> <p>The property data type. One of:</p> <ul> <li><code>XMPConst.STRING</code></li> <li><code>XMPConst.INTEGER</code></li> <li><code>XMPConst.NUMBER</code></li> <li><code>XMPConst.BOOLEAN</code></li> <li><code>XMPConst.XMPDATE</code></li> </ul> <p>Optional. If supplied, the value is converted to this type.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_47","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpmetasort","title":"XMPMeta.sort()","text":"<p><code>XMPMetaObj.sort()</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_49","title":"Description","text":"<p>Sorts the XMP contents alphabetically.</p> <ul> <li>At the top level, sorts namespaces by their prefixes.</li> <li>Within a namespace, sorts top-level properties are sorted by name.</li> <li>Within a struct, sorts fields by their qualified name (that is, the XML <code>prefix:local</code> form.)</li> <li>Sorts unordered arrays of simple items by value.</li> <li>Sorts language alternative arrays by the <code>xml:lang</code> qualifiers, with the <code>\"x-default\"</code> item placed first.</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_48","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmppacketinfo-object","title":"XMPPacketInfo object","text":"<p>This object is returned by XMPFile.getPacketInfo(). The read-only properties describe the XMP packet for the file represented by the XMPFile object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmppacketinfo-object-properties","title":"XMPPacketInfo object properties","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>charForm</code></p> <p>Number</p> <p>The character encoding in the packet, one of: - <code>0</code> - UTF8 - <code>2</code> - UTF-16, MSB-first (big-endian) - <code>3</code> - UTF-16, LSB-first (little-endian) - <code>4</code> - UTF 32, MSB-first (big-endian) - <code>5</code> - UTF 32, LSB-first (little-endian)</p> <p><code>length</code></p> <p>Number</p> <p>The length of the packet in bytes.</p> <p><code>offset</code></p> <p>Number</p> <p>The byte-offset from the start of the file where the packet begins.</p> <p><code>packet</code></p> <p>String</p> <p>The raw packet data.</p> <p><code>padSize</code></p> <p>Number</p> <p>The packet's padding size in bytes, 0 if unknown.</p> <p><code>writeable</code></p> <p>Boolean</p> <p>If <code>true</code>, the packet is writeable.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpproperty-object","title":"XMPProperty object","text":"<p>This object is returned by various property accessor functions of the XMPMeta object, such as getProperty. The read-only properties describe a metadata property.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmpproperty-object-properties","title":"XMPProperty object properties","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p>locale</p> <p>String</p> <p>The language of the property value. This value is set by calls to getLocalizedText(), which assigns the language of the selected alternative text item, if an appropriate item is found.</p> <p>namespace</p> <p>String</p> <p>The namespace of the property; see Schema namespace string constants. Typically used when browsing metadata with an XMPIterator object.</p> <p>options</p> <p>Number</p> <p>A constant that describes the property type, 0 for a simple property. Constants are:</p> <ul> <li><code>XMPConst.PROP_IS_ARRAY</code> - The property is an array (of type alt, bag, or seq).</li> <li><code>XMPConst.PROP_IS_STRUCT</code> - The property is a structure with nested fields.</li> </ul> <p>path</p> <p>String</p> <p>The property path, including the property name. For a simple property, the entire path is the property name.</p> <p>value</p> <p>Variant</p> <p>The value of the property, if any. Arrays and non-leaf levels of structures do not have values.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputils-object","title":"XMPUtils object","text":"<p>This class provides additional utility functions for the XMP Toolkit, layered upon the functionality of the XMPMeta object. It has only static functions, you cannot create an instance.</p> <p>Path-composition functions such as composeArrayItemPath(), provide support for composing path expressions to deeply nested properties, which you can then pass to the accessor functions in XMPMeta object, such as xmpmetaobj-getProperty.</p> <p>Higher-level functions such as xmputils-duplicateSubtree allow you to manipulate the metadata tree in an XMPMeta object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputils-class-functions","title":"XMPUtils class functions","text":""},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilsappendproperties","title":"XMPUtils.appendProperties()","text":"<p><code>XMPUtils.appendProperties(source, dest, options)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_50","title":"Description","text":"<p>Copies properties from a source XMPMeta object and appends them to a destination XMPMeta object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_37","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>source</code></p> <p>XMPMeta Object</p> <p>The source XMPMeta object.</p> <p><code>dest</code></p> <p>XMPMeta Object</p> <p>The destination XMPMeta object.</p> <p><code>options</code></p> <p>A logical OR of these bit-flag constants:</p> <ul> <li><code>XMPConst.APPEND_ALL_PROPERTIES</code> - Include both internal and external properties. By default, copies only external properties. This applies only to top-level properties.</li> <li><code>XMPConst.APPEND_REPLACE_OLD_VALUES</code> - Replace the values of existing properties with the value from the source object. By default, existing values are retained. This applies to properties at all levels of hierarchy.</li> <li><code>XMPConst.APPEND_DELETE_EMPTY_VALUES</code> - Delete properties if the new value is empty.</li> </ul> <p>Option flags that control the copying operation. Default is <code>0</code>.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_49","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilscatenatearrayitems","title":"XMPUtils.catenateArrayItems()","text":"<p><code>XMPUtils.catenateArrayItems(xmpObj, schemaNS, arrayName, separator, quotes, options)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_51","title":"Description","text":"<p>Concatenates a set of array item values into a single string. The resulting string can be separated back out into array items using separateArrayItems().</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_38","title":"Parameters","text":"Parameter Type Description <code>xmpObj</code> XMPMeta Object The XMPMeta object containing the array. <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>arrayName</code> String The array property name string. Can be a general path expression. Each item in the array must be a simple string value. <code>separator</code> String The string used to separate the items in the result string. Default is '; ', an ASCII semicolon and space (U+003B,U+0020). <code>quotes</code> String The character used to quote items that contain a separator. Default is '\"', an ASCII double quote (U+0022). <code>options</code> Constant value Option flag that controls the concatenation. The constant value <code>XMPConst.SEPARATE_ALLOW_COMMAS</code> - Allow commas in item values (such as \"LastName, FirstName\"). This option must be set the same way in this function and in separateArrayItems() to reconstruct the items correctly. Default is <code>0</code>."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_50","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilscomposearrayitempath","title":"XMPUtils.composeArrayItemPath()","text":"<p><code>XMPUtils.composeArrayItemPath(schemaNS, arrayName, itemIndex)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_52","title":"Description","text":"<p>Creates and returns a string containing the path expression for an item in an array, using the registered prefix for the namespace, in the form:</p> <pre><code>schemaNS:arrayName[itemIndex]\n</code></pre>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_39","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>arrayName</code> String The array property name string. Can be a general path expression. <code>itemIndex</code> Number The 1-based position index of the item. Use <code>XMPConst.ARRAY_LAST_ITEM</code> to reference the last existing item in the array. In this case, the resulting path is <code>ns:arrayName[last()]</code>."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_51","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilscomposefieldselector","title":"XMPUtils.composeFieldSelector()","text":"<p><code>XMPUtils.composeFieldSelector(schemaNS, arrayName, fieldNS, fieldName, fieldValue)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_53","title":"Description","text":"<p>Creates and returns a string containing the path expression to select an alternate item by a field's value, using the registered prefixes for the namespaces, in the form:</p> <pre><code>schemaNS:arrayName[fieldNS:fieldName=\"fieldValue\"]\n</code></pre>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_40","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>arrayName</code> String The array property name string. Can be a general path expression. <code>fieldNS</code> String The field namespace URI string. <code>fieldName</code> String The field name. Must be a simple XML name. <code>fieldValue</code> Any The desired field value."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_52","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilscomposelanguageselector","title":"XMPUtils.composeLanguageSelector()","text":"<p><code>XMPUtils.composeLanguageSelector(schemaNS, arrayName, locale)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_54","title":"Description","text":"<p>Creates and returns a string containing the path expression to select an alternate item in an alt text array by language, using the registered prefix for the namespace, in the form:</p> <pre><code>schemaNS:arrayName[@xml:lang=\"langName\"]\n</code></pre> <p>Note</p> <p>Do not use this in place of getLocalizedText() or setLocalizedText().</p> <p>Those functions provide extra logic to choose the appropriate language and maintain consistency with the x-default value. This function provides a path expression for an explicit language, and only for that language.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_41","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>arrayName</code> String The array property name string. Can be a general path expression. <code>locale</code> String The RFC3066 locale code string for the desired language."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_53","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilscomposestructfieldpath","title":"XMPUtils.composeStructFieldPath()","text":"<p><code>XMPUtils.composeStructFieldPath(schemaNS, structName, fieldNS, fieldName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_55","title":"Description","text":"<p>Creates and returns a string containing the path expression for a field in a structure, using the registered prefixes for the namespaces, in the form:</p> <pre><code>schemaNS:structName/fieldNS:fieldName\n</code></pre>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_42","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>structName</code> String The structure property name string. Can be a general path expression. <code>fieldNS</code> String The field namespace URI string. <code>fieldName</code> String The field name. Must be a simple XML name."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_54","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilscomposequalifierpath","title":"XMPUtils.composeQualifierPath()","text":"<p><code>XMPUtils.composeQualifierPath(schemaNS, propName, qualNS, qualName)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_56","title":"Description","text":"<p>Creates and returns a string containing the path expression for a qualifier attached to a property, using the registered prefix for the namespace, in the form:</p> <pre><code>schemaNS:propName/?qualNS:qualName\n</code></pre>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_43","title":"Parameters","text":"Parameter Type Description <code>schemaNS</code> Schema namespace string constants The namespace URI string. <code>propName</code> String The property name string. Can be a general path expression. <code>qualNS</code> String The qualifier namespace URI string. <code>qualName</code> String The qualifier name. Must be a simple XML name."},{"location":"scripting-xmp/xmpscript-object-reference/#returns_55","title":"Returns","text":"<p>String</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilsduplicatesubtree","title":"XMPUtils.duplicateSubtree()","text":"<p><code>XMPUtils.duplicateSubtree(source, dest, sourceNS, sourceRoot, destNS, destRoot, options)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_57","title":"Description","text":"<p>Copies properties in the specified subtree from a source XMPMeta object and adds them into a destination XMPMeta object.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_44","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>source</code></p> <p>XMPMeta Object</p> <p>The source XMPMeta object.</p> <p><code>dest</code></p> <p>XMPMeta Object</p> <p>The destination XMPMeta object.</p> <p><code>sourceNS</code></p> <p>Schema namespace string constants</p> <p>The source namespace URI string.</p> <p><code>sourceRoot</code></p> <p>String</p> <p>The property name string for the root location of the source subtree. Can be a general path expression.</p> <p><code>destNS</code></p> <p>Schema namespace string constants</p> <p>The destination namespace URI string.</p> <p><code>destRoot</code></p> <p>String</p> <p>Optional. The property name string for the root location of the destination subtree. Can be a general path expression. Default is the source root location.</p> <p><code>options</code></p> <p>A logical OR of these bit-flag constants:</p> <p>Option flags that control the copying operation. Default is <code>0</code>.</p> <ul> <li><code>XMPConst.APPEND_ALL_PROPERTIES</code> - Include both internal and external properties. By default, copies only external properties. This applies only to top-level properties.</li> <li><code>XMPConst.APPEND_REPLACE_OLD_VALUES</code> - Replace the values of existing properties with the value from the source object. By default, existing values are retained. This applies to properties at all levels of hierarchy.</li> <li><code>XMPConst.APPEND_DELETE_EMPTY_VALUES</code> - Delete properties if the new value is empty.</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_56","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilsremoveproperties","title":"XMPUtils.removeProperties()","text":"<p><code>XMPUtils.removeProperties(xmpObj, schemaNS, propName, options)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_58","title":"Description","text":"<p>Removes multiple properties from an XMPMeta object.</p> <p>If both the namespace and property name are supplied, removes the property if it is external, even if it is an alias. If it is internal, removes it if the option <code>XMPConst.REMOVE_ALL_PROPERTIES</code> is specified.</p> <p>If the namespace is supplied and the property name is not, removes all external properties in the namespace, and optionally all internal properties. Removes aliases only if the option <code>XMPConst.REMOVE_INCLUDE_ALIASES</code> is specified.</p> <p>If neither the namespace nor the property name are supplied, removes all external properties, and optionally all internal properties. Aliases are handled implicitly, because the associated actual is removed.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_45","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>xmpObj</code></p> <p>XMPMeta Object</p> <p>The object to remove properties from</p> <p><code>schemaNS</code></p> <p>Schema namespace string constants. Optional. The namespace URI string. Must be supplied if a property name is supplied.</p> <p><code>propName</code></p> <p>String</p> <p>Optional. The property name string. Can be a general path expression.</p> <p><code>options</code></p> <p>A logical OR of these bit-flag constants:</p> <p>Option flags that control the deletion operation. Default is <code>0</code>.</p> <ul> <li><code>XMPConst.REMOVE_ALL_PROPERTIES</code> - Remove internal and external properties. By default, removes only external properties. Applies only to top-level properties.</li> <li><code>XMPConst.REMOVE_INCLUDE_ALIASES</code> - Remove aliases defined in the namespace. If the property name is supplied, removes it regardless of this option.</li> </ul>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_57","title":"Returns","text":"<p>Nothing</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#xmputilsseparatearrayitems","title":"XMPUtils.separateArrayItems()","text":"<p><code>XMPUtils.separateArrayItems(xmpObj, schemaNS, arrayName, arrayOptions, concatString)</code></p>"},{"location":"scripting-xmp/xmpscript-object-reference/#description_59","title":"Description","text":"<p>Updates individual array item strings in the XMPMeta object from a concatenated string returned by catenateArrayItems(). Recognizes a large set of separator characters, including semicolons, commas, tab, return, linefeed, and multiple spaces.</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#parameters_46","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>xmpObj</code></p> <p>XMPMeta Object</p> <p>The object to separate items from</p> <p><code>schemaNS</code></p> <p>The namespace URI string. See Schema namespace string constants.</p> <p><code>arrayName</code></p> <p>String</p> <p>The array property name string. Can be a general path expression. Each item in the array must be a simple string value.</p> <p><code>arrayOptions</code></p> <p>A logical OR of these bit-flag constants:</p> <ul> <li><code>XMPConst.APPEND_ALL_PROPERTIES</code> - Include both internal and external properties. By default, copies only external properties. This applies only to top-level properties.</li> <li><code>XMPConst.APPEND_REPLACE_OLD_VALUES</code> - Replace the values of existing properties with the value from the source object. By default, existing values are retained. This applies to properties at all levels of hierarchy.</li> <li><code>XMPConst.APPEND_DELETE_EMPTY_VALUES</code> - Delete properties if the new value is empty.</li> <li><code>XMPConst.SEPARATE_ALLOW_COMMAS</code> - Allow commas in item values. If not specified, an item containing a comma (such as \"LastName, FirstName\") is separated into two array items.</li> </ul> <p>Option flags that control how the array property is updated from the separated string. Default is <code>0</code>.</p> <p><code>concatString</code></p> <p>String</p> <p>The string containing the concatenated array values, as returned by catenateArrayItems().</p>"},{"location":"scripting-xmp/xmpscript-object-reference/#returns_58","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/","title":"User-Interface Tools","text":"<p>Adobe provides the ScriptUI component, which works with the ExtendScript JavaScript interpreter to provide JavaScript scripts with the ability to create and interact with user interface elements. It provides an object model for windows and user-interface control elements within an Adobe application.</p> <ul> <li>The first part of this chapter describes the features and programming model, with details of how you can use JavaScript to build a user interface with ScriptUI objects.</li> <li>ScriptUI object reference provides reference details of the objects, properties, methods, and creation parameters. You can also choose the ScriptUI Classes dictionary from the Help menu in the ExtendScript Toolkit to inspect the objects in the Object Model Viewer.</li> </ul>"},{"location":"user-interface-tools/automatic-layout/","title":"Automatic layout","text":"<p>When a script creates a window and its associated user-interface elements, it can explicitly control the size and location of each element and of the container elements, or it can take advantage of the automatic layout capability provided by ScriptUI. The automatic layout mechanism uses certain available information about user-interface elements, along with a set of layout rules, to establish a visually pleasing layout of the controls in a dialog, automatically determining the proper sizes for elements and containers.</p> <p>Automatic layout is easier to program than explicit layout. It makes a script easier to modify and maintain, and easier to localize for different languages. It also makes the script automatically adapt to the default font and font size used by the host application for ScriptUI windows.</p> <p>The script programmer has considerable control over the automatic layout process. Each container has an associated layout manager object, specified in the layout property. The layout manager controls the sizes and positions of the contained elements, and also sizes the container itself. There is a default layout manager object, or you can create a new one:</p> <pre><code>myWin.layout = new AutoLayoutManager( myWin );\n</code></pre>"},{"location":"user-interface-tools/automatic-layout/#default-layout-behavior","title":"Default layout behavior","text":"<p>By default, the autoLayoutManager object implements the default layout behavior. A script can modify the properties of the default layout manager object, or create a new, custom layout manager if it needs more specialized layout behavior. See Custom layout-manager example.</p> <p>Child elements of a container can be organized in a single row or column, or in a stack, where the elements overlap one other in the same region of the container, and only the top element is fully visible. This is controlled by the container's orientation property, which can have the value row, column, or stack.</p> <p>You can nest Panel and Group containers to create more complex organizations. For example, to display two columns of controls, you can create a panel with a row orientation that in turn contains two groups, each with a column orientation.</p> <p>Containers have properties to control inter-element spacing and margins within their edges. The layout manager provides defaults if these are not set.</p> <p>The alignment of child elements within a container is controlled by the alignChildren property of the container, and the alignment property of the individual controls. The alignChildren property determines an overall strategy for the container, which can be overridden by a particular child element's alignment value.</p> <p>A layout manager can determine the best size for a child element through the element's preferredSize property. The value defaults to dimensions determined by ScriptUI based on characteristics of the control type and variable characteristics such as a displayed text string, and the font and size used to display text. A value of -1 for either the width or height in the preferredSize value causes the layout manager to calculate that dimension, while using the specified value for the other.</p> <p>For details of how you can set these property values to affect the automatic layout, see Automatic layout properties.</p> <p>Note</p> <p>The default font and font size are chosen differently on different platforms, and by different applications on the same platform, so ScriptUI windows that are created the same way can appear different in different contexts.</p>"},{"location":"user-interface-tools/automatic-layout/#automatic-layout-properties","title":"Automatic layout properties","text":"<p>Your script establishes rules for the layout manager by setting the values of certain properties, both in the container object and in the child elements. The following examples show the effects of various combinations of values for these properties. The examples are based on a simple window containing a StaticText, Button and EditText element, created (using Resource specifications) as follows:</p> <pre><code>var w = new Window( \"window { \\\n    orientation: 'row', \\\n    st: StaticText { }, \\\n    pb: Button { text: 'OK' }, \\\n\n    et: EditText { characters:4, justify:'right' } \\\n}\");\n\nw.show();\n</code></pre> <p>Each example shows the effects of setting particular layout properties in various ways. In each window, w. text is set so that the window title shows which property is being varied, and w.st.text is set to display the particular property value being demonstrated.</p>"},{"location":"user-interface-tools/automatic-layout/#container-orientation","title":"Container orientation","text":"<p>The <code>orientation</code> property of a container specifies the organization of child elements within it. It can have these values:</p> Value Behavior <code>row</code> Child elements are arranged next to each other, in a single row from left to right across the container. The height of the container is based on the height of the tallest child element in the row, and the width of the container is based on the combined widths of all the child elements. <code>column</code> Child elements are arranged above and below each other, in a single column from top to bottom across the container. The height of the container is based on the combined heights of all the child elements, and the width of the container is based on the widest child element in the column. <code>stack</code> Child elements are arranged overlapping one another, as in a stack of papers. The elements overlie one another in the same region of the container. Only the top element is fully visible. The height of the container is based on the height of the tallest child element in the stack, and the width of the container is based on the widest child element in the stack. <p>The following figure shows the results of laying out the sample window with each of these orientations:</p> <p> </p>"},{"location":"user-interface-tools/automatic-layout/#aligning-children","title":"Aligning children","text":"<p>The alignment of child elements within a container is controlled by two properties: alignChildren in the parent container, and alignment in each child. The alignChildren value in the parent container controls the alignment of all children within that container, unless it is overridden by the alignment value set on an individual child element.</p> <p>These properties use the same values, which specify alignment along one axis, depending on the orientation of the container. You can specify an array of two of these strings, to specify alignment along both axes. The first string specifies the horizontal value, the second specifies the vertical value. The property values are not case-sensitive; for example, the strings FILL, Fill, and fill are all valid.</p> <p>You can also set the value using the corresponding constants from the Alignment property of the ScriptUI class; for example:</p> <pre><code>myGroup.alignment = [ ScriptUI.Alignment.LEFT, ScriptUI.Alignment.TOP]\n</code></pre> <p>If you set the <code>alignment</code> value using a constant and then query the property, it returns an index number corresponding to the constant, rather than a string value.</p> <p>Elements in a row can be aligned along the vertical axis, in these ways:</p> Value Behavior <code>top</code> The element's top edge is located at the top margin of its container. <code>bottom</code> The element's bottom edge is located at the bottom margin of its container. <code>center</code> The element is centered within the top and bottom margins of its container. <code>fill</code> The element's height is adjusted to fill the height of the container between the top and bottom margins. <p>Elements in a column can be aligned along the horizontal axis, in these ways:</p> Value Behavior <code>left</code> The element's left edge is located at the left margin of its container. <code>right</code> The element's right edge is located at the right margin of its container. <code>center</code> The element is centered within the right and left margins of its container. <code>fill</code> The element's width is adjusted to fill the width of the container between the right and left margins. <p>Elements in a stack can be aligned along either the vertical or the horizontal axis, in these ways:</p> Value Behavior <code>top</code> The element's top edge is located at the top margin of its container, and the element is centered within the right and left margins of its container. <code>bottom</code> The element's bottom edge is located at the bottom margin of its container, and the element is centered within the right and left margins of its container. <code>left</code> The element's left edge is located at the left margin of its container, and the element is centered within the top and bottom margins of its container. <code>right</code> The element's right edge is located at the right margin of its container, and the element is centered within the top and bottom margins of its container.- <code>center</code> The element is centered within the top, bottom, right and left margins of its container. <code>fill</code> The element's height is adjusted to fill the height of the container between the top and bottom margins., and the element's width is adjusted to fill the width of the container between the right and left margins. <p>The following figure shows the results of creating the sample window with row orientation and the <code>bottom</code> and <code>top</code> alignment settings in the parent's <code>alignChildren</code> property:</p> <p> </p> <p>The following figure shows the results of creating the sample window with column orientation and the right, left, and fill alignment settings in the parent's alignChildren property. Notice how in the fill case, each element is made as wide as the widest element in the container:</p> <p> </p> <p>You can override the container's child alignment, as specified by <code>alignChildren</code>, by setting the alignment property of a particular child element. The following diagram shows the result of setting alignment to right for the EditText element, when the parent's <code>alignChildren</code> value is left:</p> <p></p>"},{"location":"user-interface-tools/automatic-layout/#alignment-in-two-dimensions","title":"Alignment in two dimensions","text":"<p>You can set the alignment property with a two-string array instead of a single string, where the first string is the horizontal alignment and the second is the vertical alignment. This allows you to control the horizontal placement of children in a container with row orientation, and the vertical placement of children in a container with column orientation.</p> <p>The following figures show the results of the sample script SnpAlignElements.jsx, that demonstrates how to specify alignment in two dimensions.</p> <ul> <li>In the first, each control is centered vertically within its row, and placed at a specific horizontal position, using an alignment value such as <code>[\"left\", \"center\"]</code> for each element:     </li> <li>The vertical alignment example creates four columns, and places the controls within each column along the vertical axis. It uses alignment values such as <code>[\"fill\", \"top\"]</code> to distribute controls within the column, while still controlling the relative vertical positions:     </li> </ul>"},{"location":"user-interface-tools/automatic-layout/#setting-margins","title":"Setting margins","text":"<p>The margins property of a container specifies the number of pixels between the edges of a container and the outermost edges of the child elements. You can set this property to a simple number to specify equal margins, or using a Margins object, which allows you to specify different margins for each edge of the container.</p> <p>The following figure shows the results of creating the sample window with row orientation and margins of 5 and 15 pixels:</p> <p> </p> <p>This figure shows the results of creating the sample window with column orientation, a top margin of 0 pixels, a bottom margin of 20 pixels, and left and right margins of 15 pixels:</p> <p></p>"},{"location":"user-interface-tools/automatic-layout/#spacing-between-children","title":"Spacing between children","text":"<p>The spacing property of a container specifies the number of pixels separating one child element from its adjacent sibling element.</p> <p>This figure shows the results of creating the sample window with row orientation, and spacing of 15 and 5 pixels, respectively:</p> <p> </p> <p>This figure shows the results of creating the sample window with column orientation, and spacing of 20 pixels:</p> <p></p>"},{"location":"user-interface-tools/automatic-layout/#determining-a-preferred-size","title":"Determining a preferred size","text":"<p>Each element has a preferredSize property, which is initially defined with reasonable default dimensions for the element. The default value is calculated by ScriptUI, and is based on constant characteristics of each type of element, and variable characteristics such as the text string to be displayed in a button or text element.</p> <p>If an element's size property is not defined, the layout manager uses the value of preferredSize to determine the dimensions of each element during the layout process. Generally, you should avoid setting the preferredSize property explicitly, and let ScriptUI determine the best value based on the state of an element at layout time. This allows you to set the text properties of your user-interface elements using localizable strings (see Localization in ScriptUI objects). The width and height of each element are calculated at layout time based on the chosen language-specific text string, rather than relying on the script to specify a fixed size for each element.</p> <p>However, a script can explicitly set the preferredSize property to give hints to the layout manager about the intended sizes of elements for which a reasonable default size is not easily determined, such as an IconButton element that has no initial image to measure.</p> <p>You can set just one of the dimensions using the preferredSize; a value of -1 for either width or height causes the layout manager to calculate that dimension, while using the supplied value for the other.</p> <p>You can also set a maximum and/or minimum size value for a control, that limit how it can be resized. There is a default maximum size that prevents automatic layout from creating elements larger than the screen.</p> <p>You can explicitly resize the controls in a window to fit the current text contents, or after the window is resized by the user, using the resize() method of the layout object.</p>"},{"location":"user-interface-tools/automatic-layout/#creating-more-complex-arrangements","title":"Creating more complex arrangements","text":"<p>You can easily create more complex arrangements by nesting Group containers within Panel containers and other <code>Group</code> containers.</p> <p>Many dialogs consist of rows of information to be filled in, where each row has columns of related types of controls. For instance, an edit field is typically in a row next to a static text label that identifies it, and a series of such rows are arranged in a column. This example (created using Resource specifications) shows a simple dialog in which a user can enter information into two EditText fields, each arranged in a row with its StaticText label. To create the layout, a <code>Panel</code> with a column orientation contains two <code>Group</code> elements with row orientation. These groups contain the control rows. A third <code>Group</code>, outside the panel, contains the row of buttons.</p> <pre><code>var res = \"dialog { \\\n    info: Panel { orientation: 'column', \\\n        text: 'Personal Info', \\\n        name: Group { orientation: 'row', \\\n            s: StaticText { text:'Name:' }, \\\n            e: EditText { characters: 30 } \\\n        }, \\\n        addr: Group { orientation: 'row', \\\n            s: StaticText { text:'Street / City:' }, \\\n            e: EditText { characters: 30 } \\\n        } \\\n    }, \\\n    buttons: Group { orientation: 'row', \\\n        okBtn: Button { text:'OK', properties:{name:'ok'} }, \\\n        cancelBtn: Button { text:'Cancel', properties:{name:'cancel'} } \\\n    } \\\n}\";\nwin = new Window( res );\nwin.center();\nwin.show();\n</code></pre> <p></p> <p>In this simplest example, the columns are not vertically aligned. When you are using fixed-width controls in your rows, a simple way to get an attractive alignment of the StaticText labels for your EditText fields is to align the child rows in the Panel to the right of the panel. In the example, add the following to the Panel specification:</p> <pre><code>info: Panel { orientation: 'column', alignChildren:'right', \\\n</code></pre> <p>This creates the following result:</p> <p></p> <p>Suppose now that you need two panels, and want each panel to have the same width in the dialog. You can specify this at the level of the dialog window object, the parent of both panels. Specify <code>alignChildren=\"fill\"</code>, which makes each child of the dialog match its width to the widest child.</p> <pre><code>var res = \"dialog { alignChildren: 'fill', \\\n    info: Panel { orientation: 'column', alignChildren:'right', \\\n        text: 'Personal Info', \\\n        name: Group { orientation: 'row', \\\n            s: StaticText { text:'Name:' }, \\\n            e: EditText { characters: 30 } \\\n        } \\\n    }, \\\n    workInfo: Panel { orientation: 'column', \\\n        text: 'Work Info', \\\n        name: Group { orientation: 'row', \\\n            s: StaticText { text:'Company name:' }, \\\n            e: EditText { characters: 30 } \\\n        } \\\n    }, \\\n    buttons: Group { orientation: 'row', alignment: 'right', \\\n        okBtn: Button { text:'OK', properties:{name:'ok'} }, \\\n        cancelBtn: Button { text:'Cancel', properties:{name:'cancel'} } \\\n    } \\\n}\";\nwin = new Window( res );\nwin.center();\nwin.show();\n</code></pre> <p></p> <p>To make the buttons to appear at the right of the dialog, the <code>buttons</code> group overrides the <code>fill</code> alignment of its parent (the dialog), and specifies <code>alignment=\"right\"</code>.</p>"},{"location":"user-interface-tools/automatic-layout/#creating-dynamic-content","title":"Creating dynamic content","text":"<p>Many dialogs need to present different sets of information based on the user selecting some option within the dialog. You can use the stack orientation to present different views in the same region of a dialog.</p> <p>A <code>stack</code> orientation of a container places child elements so they are centered in a space which is wide enough to hold the widest child element, and tall enough to contain the tallest child element. If you arrange groups or panels in such a stack, you can show and hide them in different combinations to display a different set of controls in the same space, depending on other choices in the dialog.</p> <p>For example, this dialog changes dynamically according to the user's choice in the <code>DropDownList</code>.</p> <p> </p> <p>The following script creates this dialog. It compresses the \"Personal Info\" and \"Work Info\" panels from the previous example into a single <code>Panel</code> that has two <code>Groups</code> arranged in a stack. A <code>DropDownList</code> allows the user to choose which set of information to view. When the user makes a choice in the list, its <code>onChange</code> function shows one group, and hides the other.</p> <pre><code>var res = \"dialog { \\\n    whichInfo: DropDownList { alignment:'left' }, \\\n    allGroups: Panel { orientation:'stack', \\\n        info: Group { orientation: 'column', \\\n            name: Group { orientation: 'row', \\\n                s: StaticText { text:'Name:' }, \\\n                e: EditText { characters: 30 } \\\n            } \\\n        }, \\\n        workInfo: Group { orientation: 'column', \\\n            name: Group { orientation: 'row', \\\n                s: StaticText { text:'Company name:' }, \\\n                e: EditText { characters: 30 } \\\n            } \\\n        }, \\\n    }, \\\n    buttons: Group { orientation: 'row', alignment: 'right', \\\n        okBtn: Button { text:'OK', properties:{name:'ok'} }, \\\n        cancelBtn: Button { text:'Cancel', properties:{name:'cancel'} } \\\n    } \\\n}\";\n\nwin = new Window( res );\nwin.whichInfo.onChange = function () {\n    if ( this.selection !== null ) {\n        for ( var g = 0; g &lt; this.items.length; g++ ) {\n            this.items[ g ].group.visible = false; //hide all other groups\n        }\n        this.selection.group.visible = true;//show this group\n    }\n};\n\nvar item = win.whichInfo.add( \"item\", \"Personal Info\" );\nitem.group = win.allGroups.info;\nitem = win.whichInfo.add( \"item\", \"Work Info\" );\nitem.group = win.allGroups.workInfo;\n\n// TODO: Which of these are correct or best\nwin.whichInfo.selection = win.whichInfo.items[ 0 ];\nwin.whichInfo.selection = 0;\n\nwin.center();\nwin.show();\n</code></pre>"},{"location":"user-interface-tools/automatic-layout/#custom-layout-manager-example","title":"Custom layout-manager example","text":"<p>This script creates a dialog almost identical to the one in the previous example, except that it defines a layout-manager subclass, and assigns an instance of this class as the layout property for the last Group in the dialog. (The example also demonstrates the technique for defining a reusable class in JavaScript.)</p> <p>This script-defined layout manager positions elements in its container in a stair-step fashion, so that the buttons are staggered rather than in a straight line.</p> <p></p> <pre><code>// Define a custom layout manager that arranges the children\n// of \"container\" in a stair-step fashion.\nfunction StairStepButtonLayout( container ) {\n    this.initSelf( container );\n}\n\n// Define its \"method\" functions\nfunction SSBL_initSelf( container ) {\n    this.container = container;\n}\n\nfunction SSBL_layout() {\n    var top = 0,\n    left = 0;\n    var width;\n    var vspacing = 10,\n    hspacing = 20;\n    for ( i = 0; i &lt; this.container.children.length; i++ ) {\n        var child = this.container.children[ i ];\n\n        // If child is a container, call its layout method\n        if ( typeof child.layout !== \"undefined\" ) {\n            child.layout.layout();\n        }\n\n        child.size = child.preferredSize;\n        child.location = [ left, top ];\n        width = left + child.size.width;\n        top += child.size.height + vspacing;\n        left += hspacing;\n    }\n    this.container.preferredSize = [ width, top - vspacing ];\n}\n\n// Attach methods to Object's prototype\nStairStepButtonLayout.prototype.initSelf = SSBL_initSelf;\nStairStepButtonLayout.prototype.layout = SSBL_layout;\n\n// Define a string containing the resource specification for the controls\nvar res = \"dialog { \\\n    whichInfo: DropDownList { alignment:'left' }, \\\n    allGroups: Panel { orientation:'stack', \\\n        info: Group { orientation: 'column', \\\n            name: Group { orientation: 'row', \\\n                s: StaticText { text:'Name:' }, \\\n                e: EditText { characters: 30 } \\\n            } \\\n        }, \\\n        workInfo: Group { orientation: 'column', \\\n            name: Group { orientation: 'row', \\\n                s: StaticText { text:'Company name:' }, \\\n                e: EditText { characters: 30 } \\\n            } \\\n        }, \\\n    }, \\\n    buttons: Group { orientation: 'row', alignment: 'right', \\\n        okBtn: Button { text:'OK', properties:{name:'ok'} }, \\\n        cancelBtn: Button { text:'Cancel', properties:{name:'cancel'} } \\\n    } \\\n}\";\n\n// Create window using resource spec\nwin = new Window( res );\n\n// Create list items, select first one\nwin.whichInfo.onChange = function() {\n    if ( this.selection !== null ) {\n        for ( var g = 0; g &lt; this.items.length; g++ ) {\n            this.items[ g ].group.visible = false;\n        }\n        this.selection.group.visible = true;\n    }\n};\nvar item = win.whichInfo.add( \"item\", \"Personal Info\" );\nitem.group = win.allGroups.info;\nitem = win.whichInfo.add( \"item\", \"Work Info\" );\nitem.group = win.allGroups.workInfo;\n\nwin.whichInfo.selection = 0;\n\n// Override the default layout manager for the 'buttons' group\n// with custom layout manager\nwin.buttons.layout = new StairStepButtonLayout( win.buttons );\nwin.center();\nwin.show();\n</code></pre>"},{"location":"user-interface-tools/automatic-layout/#the-autolayoutmanager-algorithm","title":"The AutoLayoutManager algorithm","text":"<p>When a script creates a Window object and its elements and shows it the first time, the visible user-interface-platform window and controls are created. At this point, if no explicit placement of controls was specified by the script, all the controls are located at [0, 0] within their containers, and have default dimensions. Before the window is made visible, the layout manager's layout method is called to assign locations and sizes for all the elements and their containers.</p> <p>The default AutoLayoutManager's layout method performs these steps when invoked during the initial call to a Window object's show method:</p> <ol> <li>Read the bounds property for the managed container; if undefined, proceed with auto layout. If defined, assume that the script has explicitly placed the elements in this container, and cancel the layout operation (if both the location and size property have been set, this is equivalent to setting the bounds property, and layout does not proceed).</li> <li>Determine the container's margins and inter-element spacing from its margins and spacing properties, and the orientation and alignment of its child elements from the container's orientation and alignChildren properties. If any of these properties are undefined, use default settings obtained from platform and user-interface framework-specific default values.</li> <li>Enumerate the child elements, and for each child:<ul> <li>If the child is a container, call its layout manager (that is, execute this entire algorithm again for the container).</li> <li>Read its alignment property; if defined, override the default alignment established by the parent container with its alignChildren property.</li> <li>Read its size property: if defined, use it to determine the child's dimensions. If undefined, read its preferredSize property to get the child's dimensions. Ignore the child's location property.</li> <li>All the per-child information is collected for later use.</li> </ul> </li> <li>Based on the orientation, calculate the trial location of each child in the row or column, using inter-element spacing and the container's margins.</li> <li>Determine the column, row, or stack dimensions, based on the dimensions of the children.</li> <li>Using the desired alignment for each child element, adjust its trial location relative to the edges of its container.</li> <li>Set the bounds property for each child element.</li> <li>Set the container's preferredSize property, based on the margins and dimensions of the row or column of child elements.</li> </ol>"},{"location":"user-interface-tools/automatic-layout/#automatic-layout-restrictions","title":"Automatic layout restrictions","text":"<p>The following restrictions apply to the automatic layout mechanism:</p> <ul> <li>The default layout manager does not attempt to lay out a container that has a defined <code>bounds</code> property. The script programmer can override this behavior by defining a custom layout manager for the container.</li> <li>The layout mechanism does not track changes to element sizes after the initial layout has occurred. The script can initiate another layout by calling the layout manager's <code>layout</code> method, and can force the manager to recalculate the sizes of all child containers by passing the optional argument as <code>true</code>.</li> </ul>"},{"location":"user-interface-tools/code-examples-for-scriptui/","title":"Code examples for ScriptUI","text":"<p>The sample code distributed with the Adobe ExtendScript SDK includes code examples that specifically demonstrate different ways of building and populating a ScriptUI dialog.</p> Building ScriptUI dialogs Description SnpCreateDialog.jsx Creates a very simple, modeless dialog (a palette) with OK and Cancel button behavior. SnpCreateUIAddMethod.jsx Shows how to add controls to a dialog using the add method. SnpCreateUIResourceSpec.jsx Shows how to define a resource string that creates the control hierarchy in a dialog. SnpCreateTreeView.jsx Shows how to create a hierarchical list with subitems. SnpCreateProgressBar.jsx Shows how to create, initialize, and update a progress bar. SnpCreateSlider.jsx Shows how to create and handle input from a slider control. UsingFlashPlayer.jsx Shows how to create a Flash\u00ae Player, and use it to load a play back a movie defined in an SWF file. ActionScriptDemo.jsx Shows how to communicate between the Adobe application scripting environment and the ActionScript\u2122 scripting environment of the Flash Player. ColorSelector.jsx Shows how to use the graphics objects to change colors in a window. ColorPicker.jsx A more complex version of the color-selection dialog shows how to use additional graphics objects, including fonts and paths. SnpAlignElements.jsx Shows how to align elements along two dimensions in order to control the relative positions of controls within rows and columns. SnpCreateDynamicScriptUI.jsx Shows how to use automatic layout, switching component layout between \"row\" and \"stack\" orientation. AlertBoxBuilder1.jsx Shows a way to use resource specifications. Uses the add() method to build a dialog that collects values from the user, and creates a resource string from those values. Saves the string to a file, then uses it to build a new dialog. See Using resource strings. AlertBoxBuilder2.jsx Shows another way to use a resource specification, building the same user-input dialog itself from a resource string. See Using resource strings. SnpCustomLayoutManager.jsx Shows how to create a customized layout manager. See Custom layout-manager example."},{"location":"user-interface-tools/common-properties/","title":"Common properties","text":"<p>All types of user-interface elements, including windows, containers, and controls, share many of the same properties, although some have slightly different meanings for different types of objects. The following table summarizes which properties are used in which object types.</p> Property Window Panel TabbedPanel Tab Group Button Checkbox DropDownList EditText FlashPlayer IconButton Image ListBox ListItem ProgressBar RadioButton Scrollbar Slider StaticText TreeView <code>active</code> <code>alignChildren</code> <code>alignment</code> <code>bounds</code> <code>cancelElement</code> <code>characters</code> <code>checked</code> <code>children</code> <code>columns</code> <code>defaultElement</code> <code>enabled</code> <code>expanded</code> <code>frameBounds</code> <code>frameLocation</code> <code>frameSize</code> <code>graphics</code> <code>helpTip</code> <code>icon</code> <code>image</code> <code>index</code> <code>items</code> <code>itemSize</code> <code>jumpdelta</code> <code>justify</code> <code>layout</code> <code>location</code> <code>margins</code> <code>maximumSize</code> <code>maxvalue</code> <code>minimumSize</code> <code>minvalue</code> <code>orientation</code> <code>parent</code> <code>preferredSize</code> <code>properties</code> <code>resizeable</code> <code>selected</code> <code>selection</code> <code>shortcutKey</code> <code>size</code> <code>spacing</code> <code>stepdelta</code> <code>subitems</code> <code>text</code> <code>textselection</code> <code>title</code> <code>titleLayout</code> <code>type</code> <code>value</code> <code>visible</code> <code>window</code> <code>windowBounds</code>"},{"location":"user-interface-tools/communicating-with-the-flash-application/","title":"Communicating with the Flash application","text":"<p>ScriptUI supports a Flash Player, which runs the Flash application within a window in an Adobe application. The Flash application runs ActionScript, a different implementation of JavaScript from the ExtendScript version of JavaScript that Adobe applications run.</p> <p>To open a Flash Player, add a control of type FlashPlayer to your ScriptUI window. A control object of this type contains functions that allow your script to load SWF files and control movie playback. It also contains functions that allow your Adobe application script to communicate with the ActionScript environment of the Flash application. See FlashPlayer control functions.</p> <p>A limited set of data types can be passed between the two scripting environments:</p> <ul> <li>Number</li> <li>String</li> <li>Boolean</li> <li><code>null</code></li> <li><code>undefined</code></li> <li>Object</li> <li>Array</li> </ul> <p>The ActionScript <code>class</code> and <code>date</code> objects are not supported as parameter values.</p> <p>In the ActionScript script for your Flash application, you must prepare for two-way communication by providing access to the External API. Do this by importing the <code>ExternalInterface</code> class into your Flash application:</p> <pre><code>import flash.external.ExternalInterface;\n</code></pre>"},{"location":"user-interface-tools/communicating-with-the-flash-application/#calling-extendscript-functions-from-actionscript","title":"Calling ExtendScript functions from ActionScript","text":"<p>The ActionScript <code>ExternalInterface</code> class allows you to call an ExtendScript function that has been defined in the <code>FlashPlayer</code> element in the Adobe application script, and run it in the ActionScript environment. You must define the method in your FlashPlayer element with a matching function name.</p> <p>For example, in order for the SWF code to call an ExtendScript function named <code>myExtendScriptFunction</code>, define a function with the name <code>myExtendScriptFunction</code> as a method of your <code>FlashPlayer</code> control object. There are no special requirements for function names, but the function must take and return only data of the supported types.</p> <p>You do not need to register the ExtendScript function in the ActionScript environment. Your ActionScript script can simply call the external function using the <code>ExternalInterface.call()</code> method:</p> <pre><code>var res = ExternalInterface.call( \"myJavaScriptFunction\" );\n</code></pre> <p>When the Flash Player executes the ExternalInterface call, ScriptUI looks for a function with the same name as a method of the FlashPlayer element, and invokes it with the specified arguments. In the context of the function, the JavaScript this object refers to the <code>FlashPlayer</code> object.</p>"},{"location":"user-interface-tools/communicating-with-the-flash-application/#calling-actionscript-functions-from-a-scriptui-script","title":"Calling ActionScript functions from a ScriptUI script","text":"<p>From the ExtendScript side, use the <code>FlashPlayer</code> method invokePlayerFunction() to call ActionScript methods that have been defined within the Flash application:</p> <pre><code>var result = flashElement.invokePlayerFunction( \"ActionScript_function_name\", [ arg1, ..., argN ] );\n</code></pre> <p>You can use the optional arguments to pass data (of supported types) to the ActionScript method.</p> <p>Before you can call any ActionScript function from your Adobe application script, your Flash application must register that function with the <code>ExternalInterface</code> object, as a callback from the Flash container. To register a function, use the <code>ExternalInterface.addCallback()</code> method:</p> <pre><code>public static addCallback(methodName:String, instance:Object, method:Function);\n</code></pre> <p>This registers a function defined in your Adobe application script named <code>getActionScriptArray()</code>:</p> <pre><code>ExternalInterface.addCallback( \"getActionScriptArray\", this, getActionScriptArray );\n</code></pre>"},{"location":"user-interface-tools/communicating-with-the-flash-application/#flash-examples","title":"Flash Examples","text":"<p>These examples in the Adobe ExtendScript SDK demonstrate how to use the Flash Player:</p> Example Description UsingFlashPlayer.jsx Shows how to create a Flash\u00ae Player, and use it to load a play back a movie defined in an SWF file. ActionScriptDemo.jsx Shows how to communicate between the Adobe application scripting environment and the ActionScript\u2122 scripting environment of the Flash Player."},{"location":"user-interface-tools/control-objects/","title":"Control objects","text":"<p>UI elements that belong to windows can be containers or controls. Containers share some aspects of top-level windows, and some aspects of controls, and so are described here with controls.</p>"},{"location":"user-interface-tools/control-objects/#control-object-constructors","title":"Control object constructors","text":"<p>Use the <code>add</code> method to create new containers and controls. The <code>add</code> method is available on <code>window</code> and container (<code>panel</code> and <code>group</code>) objects. (See also add() for DropDownList and ListBox controls.)</p>"},{"location":"user-interface-tools/control-objects/#add","title":"add()","text":"<p><code>containerObj.(type[, bounds, text, {creation_props}]);</code></p>"},{"location":"user-interface-tools/control-objects/#description","title":"Description","text":"<p>Creates and returns a new control or container object and adds it to the children of this window or container.</p>"},{"location":"user-interface-tools/control-objects/#parameters","title":"Parameters","text":"Parameter Type Description <code>type</code> String The control type. See Control types and creation parameters. <code>bounds</code> Bounds object Optional. A bounds specification that describes the size and position of the new control or container, relative to its parent. If supplied, this value creates a new Bounds object which is assigned to the new object's <code>bounds</code> property. <code>text</code> String Optional. Initial text to be displayed in the control as the title, label, or contents, depending on the control type. If supplied, this value is assigned to the new object's <code>text</code> property. <code>creation_props</code> Object Optional. The properties of this object specify creation parameters, which are specific to each object type. See Control types and creation parameters."},{"location":"user-interface-tools/control-objects/#returns","title":"Returns","text":"<p>Returns the new object, or <code>null</code> if unable to create the object.</p>"},{"location":"user-interface-tools/control-objects/#control-types-and-creation-parameters","title":"Control types and creation parameters","text":"<p>The following keywords can be used in string literals as the type specifier for the <code>add</code> method, available on <code>Window</code> and container (<code>Panel</code> and <code>Group</code>) objects. The class names can be used in resource specifications to define controls within a container element (<code>Window</code>, <code>Panel</code>, or <code>Group</code>).</p> <p>All types of controls, including containers, have an optional creation parameter <code>name</code> that allows you to give the object a unique name.</p>"},{"location":"user-interface-tools/control-objects/#button","title":"button","text":"<p>Class Name: <code>Button</code></p>"},{"location":"user-interface-tools/control-objects/#description_1","title":"Description","text":"<p>A pushbutton containing a mouse-sensitive text string. Calls the onClick callback if the control is clicked or if its notify() method is called.</p>"},{"location":"user-interface-tools/control-objects/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the control. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control. For a modal dialog, the special name \"ok\" makes this defaultElement, and the special name \"cancel\" makes this the cancelElement of the parent dialog."},{"location":"user-interface-tools/control-objects/#example","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"button\"[, bounds, text, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#checkbox","title":"checkbox","text":"<p>Class Name: <code>Checkbox</code></p>"},{"location":"user-interface-tools/control-objects/#description_2","title":"Description","text":"<p>A dual-state control showing a box with a checkmark when value is <code>true</code>, empty when <code>value</code> is <code>false</code>.</p> <p>Calls the onClick callback if the control is clicked or if its notify() method is called.</p>"},{"location":"user-interface-tools/control-objects/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the control. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_1","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_1","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"checkbox\"[, bounds, text, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#dropdownlist","title":"dropdownlist","text":"<p>Class Name: <code>DropDownList</code></p>"},{"location":"user-interface-tools/control-objects/#description_3","title":"Description","text":"<p>A drop-down list with zero or more items. Calls the onChange callback if the item selection is changed by a script or the user, or if the object's notify() method is called.</p>"},{"location":"user-interface-tools/control-objects/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>items</code> Array of strings Optional. Supply this argument or the <code>creation_properties</code> argument, not both. The text of each list item. A <code>ListItem</code> object is created for each item. An item with the text string <code>\"-\"</code> creates a separator item. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_2","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control. <code>items</code> Array of strings The text of each list item. See the Parameters table for more info."},{"location":"user-interface-tools/control-objects/#example_2","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add( \"dropdownlist\", bounds[, items, {creation_properties}] );\n</code></pre>"},{"location":"user-interface-tools/control-objects/#editnumber","title":"editnumber","text":"<p>Class Name: <code>EditNumber</code></p> <p>Note</p> <p>This functionality was added in Photoshop 20.0 (CC 2019), and may not exist in other hosts.</p>"},{"location":"user-interface-tools/control-objects/#description_4","title":"Description","text":"<p>An editable text field the user can enter decimal numbers into. Fractions are allowed.</p> <p>Calls the onChange callback if the text is changed and the user types <code>ENTER</code> or the control loses focus, or if its notify() method is called.</p> <p>Calls the onChanging callback when any change is made to the text.</p> <p>The <code>textselection</code> property contains currently selected text.</p>"},{"location":"user-interface-tools/control-objects/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the control. <code>minValue</code> Number Optional. Minimum accepted value of number to be entered. <code>maxValue</code> Number Optional. Maximum accepted value of number to be entered. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_3","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control. <code>readonly</code> Boolean Optional. When <code>false</code> (the default), the control accepts text input. When <code>true</code>, the control does not accept input but only displays the contents of the <code>text</code> property. <code>noecho</code> Boolean Optional. When <code>false</code> (the default), the control displays input text. When <code>true</code>, the control does not display input text (used for password input fields). <code>enterKeySignalsOnChange</code> Boolean Optional. When <code>false</code> (the default), the control signals an onChange event when the editable text is changed and the control loses the keyboard focus (that is, the user tabs to another control, clicks outside the control, or types <code>ENTER</code>). When <code>true</code>, the control only signals an <code>onChange</code> event when the editable text is changed and the user types <code>ENTER</code>; other changes to the keyboard focus do not signal the event. <code>borderless</code> Boolean Optional. When <code>true</code>, the control is drawn with no border. Default is <code>false</code>."},{"location":"user-interface-tools/control-objects/#example_3","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"editnumber\"[, bounds, text, minValue, maxValue, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#edittext","title":"edittext","text":"<p>Class Name: <code>EditText</code></p>"},{"location":"user-interface-tools/control-objects/#description_5","title":"Description","text":"<p>An editable text field that the user can change. Calls the onChange callback if the text is changed and the user types <code>ENTER</code> or the control loses focus, or if its notify() method is called. Calls the onChanging callback when any change is made to the text.</p> <p>The <code>textselection</code> property contains currently selected text.</p>"},{"location":"user-interface-tools/control-objects/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the control. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_4","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control. <code>readonly</code> Boolean When <code>false</code> (the default), the control accepts text input. When <code>true</code>, the control does not accept input but only displays the contents of the <code>text</code> property. <code>noecho</code> Boolean When <code>false</code> (the default), the control displays input text. When <code>true</code>, the control does not display input text (used for password input fields). <code>enterKeySignalsOnChange</code> Boolean When <code>false</code> (the default), the control signals an onChange event when the editable text is changed and the control loses the keyboard focus (that is, the user tabs to another control, clicks outside the control, or types <code>ENTER</code>). When <code>true</code>, the control only signals an <code>onChange</code> event when the editable text is changed and the user types <code>ENTER</code>; other changes to the keyboard focus do not signal the event. <code>borderless</code> Boolean When <code>true</code>, the control is drawn with no border. Default is <code>false</code>. <code>multiline</code> Boolean When <code>false</code> (the default), the control accepts a single line of text. When <code>true</code>, the control accepts multiple lines, in which case the text wraps within the width of the control. <code>scrollable</code> Boolean (For multiline elements only) When <code>true</code> (the default), the text field has a vertical scrollbar that is enabled when the element contains more text than fits in the visible area. When <code>false</code>, no vertical scrollbar appears; if the element contains more text than fits in the visible area, the arrow keys can be used to scroll the text up and down."},{"location":"user-interface-tools/control-objects/#example_4","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"edittext\"[, bounds, text, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#flashplayer","title":"flashplayer","text":"<p>Class Name: <code>FlashPlayer</code></p>"},{"location":"user-interface-tools/control-objects/#description_6","title":"Description","text":"<p>A control that contains a Flash Player, which can load and play Flash movies stored in SWF files.</p> <p>The ScriptUI FlashPlayer element runs the Flash application within an Adobe application. The Flash application runs ActionScript, a different implementation of JavaScript from the ExtendScript version of JavaScript that Adobe applications run.</p> <p>A control object of this type contains functions that allow your script to load SWF files, control movie playback, and communicate with the ActionScript environment. See FlashPlayer control functions.</p>"},{"location":"user-interface-tools/control-objects/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>moveToLoad</code> String or File object Optional. A path or URL string or File for the SWF file to load into the player. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_5","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_5","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"flashplayer\"[, bounds, movieToLoad, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#group","title":"group","text":"<p>Class Name: <code>Group</code></p>"},{"location":"user-interface-tools/control-objects/#description_7","title":"Description","text":"<p>A container for other controls. Containers have additional properties that control the children; see Container Attributes.</p> <p>Hiding a group hides all its children. Making it visible makes visible those children that are not individually hidden.</p>"},{"location":"user-interface-tools/control-objects/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_6","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_6","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"group\"[, bounds, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#iconbutton","title":"iconbutton","text":"<p>Class Name: <code>IconButton</code></p>"},{"location":"user-interface-tools/control-objects/#description_8","title":"Description","text":"<p>A mouse-sensitive pushbutton containing an icon. Calls the onClick callback if the control is clicked or if its notify() method is called.</p>"},{"location":"user-interface-tools/control-objects/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>icon</code> Named resource, pathname, or File object Optional. The named resource for the icon or family of icons displayed in the button control, or a pathname or File for an image file. Images must be in PNG format. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_7","title":"Creation Properties","text":"<p>Property</p> <p>Type</p> <p>Description</p> <p><code>name</code></p> <p>String</p> <p>A unique name for the control.</p> <p><code>style</code></p> <p>String</p> <p>A string for the visual style, one of:</p> <ul> <li><code>button</code>: Has a visible border with a raised or 3D appearance.</li> <li><code>toolbutton</code>: Has a flat appearance, appropriate for inclusion in a toolbar</li> </ul> <p><code>toggle</code></p> <p>Boolean</p> <p>For a button-style control, a value of <code>true</code> causes it to get a button-pressed appearance the first time it is clicked, and alternate with the unpressed appearance each time it is clicked. The toggle state is reflected in the control's <code>value</code> property.</p>"},{"location":"user-interface-tools/control-objects/#example_7","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"iconbutton\"[, bounds, icon, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#image","title":"image","text":"<p>Class Name: <code>Image</code></p>"},{"location":"user-interface-tools/control-objects/#description_9","title":"Description","text":"<p>Displays an icon or image.</p>"},{"location":"user-interface-tools/control-objects/#parameters_9","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>icon</code> Named resource, pathname, or File object Optional. The named resource for the icon or family of icons displayed in the button control, or a pathname or File for an image file. Images must be in PNG format. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_8","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_8","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"image\"[, bounds, icon, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#item","title":"item","text":"<p>Class Name: <code>Array of ListItem</code></p>"},{"location":"user-interface-tools/control-objects/#description_10","title":"Description","text":"<p>The choice items in a list box or drop-down list. The objects are created when items are specified on creation of the parent list object, or afterward using the list control's add() method.</p> <p>Items in a drop-down list can be of type <code>separator</code>, in which case they cannot be selected, and are shown as a horizontal line.</p> <p>Item objects have these properties which are not found in other controls:</p> <ul> <li>checked</li> <li>expanded</li> <li>image</li> <li>index</li> <li>selected</li> </ul>"},{"location":"user-interface-tools/control-objects/#listbox","title":"listbox","text":"<p>Class Name: <code>ListBox</code></p>"},{"location":"user-interface-tools/control-objects/#description_11","title":"Description","text":"<p>A list box with zero or more items. Calls the onChange callback if the item selection is changed by a script or the user, or if the object's notify() method is called. A double click on an item selects that item and calls the onDoubleClick callback.</p>"},{"location":"user-interface-tools/control-objects/#parameters_10","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>items</code> Array of Strings Optional. The text of each list item. A ListItem object is created for each item. Supply this argument, or the items property in <code>creation_properties</code>, not both. A ListItem object is created for each item. An item with the text string <code>\"-\"</code> creates a separator item. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_9","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control. <code>multiselect</code> Boolean When <code>false</code> (the default), only one item can be selected. When <code>true</code>, multiple items can be selected. <code>items</code> Array of Strings The text of each list item. Supply this property, or the <code>items</code> argument, not both. This form is most useful for elements defined using Resource specifications. <code>numberOfColumns</code> Number A number of columns in which to display the items; default is 1. When there are multiple columns, each ListItem object represents a single selectable row. Its text and image values supply the label for the first column, and the <code>subitems</code> property specifies labels for additional columns. <code>showHeaders</code> Boolean <code>true</code> to display column titles. <code>columnWidths</code> Array of Numbers An array of numbers for the preferred width in pixels of each column. <code>columnTitles</code> Array of Strings A corresponding array of strings for the title of each column, to be shown if <code>showHeaders</code> is <code>true</code>."},{"location":"user-interface-tools/control-objects/#example_9","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"listbox\", bounds[, items, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#panel","title":"panel","text":"<p>Class Name: <code>Panel</code></p>"},{"location":"user-interface-tools/control-objects/#description_12","title":"Description","text":"<p>A container for other types of controls, with an optional frame.</p> <p>Containers have additional properties that control the children; see Container Attributes. Hiding a panel hides all its children. Making it visible makes visible those children that are not individually hidden.</p>"},{"location":"user-interface-tools/control-objects/#parameters_11","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the border of the panel. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_10","title":"Creation Properties","text":"<p>Property</p> <p>Type</p> <p>Description</p> <p><code>name</code></p> <p>String</p> <p>A unique name for the control.</p> <p><code>borderStyle</code></p> <p>String</p> <p>A string that specifies the appearance of the border drawn around the panel. Default is <code>etched</code>. One of:</p> <ul> <li><code>black</code></li> <li><code>etched</code></li> <li><code>gray</code></li> <li><code>raised</code></li> <li><code>sunken</code></li> <li><code>topDivider</code>: draws a horizonal line at the top of the panel only.</li> </ul> <p>Warning</p> <p>The <code>topDivider</code> property is officially undocumented and was found via research. Please contribute if you have more information on it!</p> <p><code>subPanelCoordinates</code></p> <p>Boolean</p> <p>When <code>true</code>, this panel automatically adjusts the positions of its children for compatability with Photoshop CS. Default is <code>false</code>, meaning that the panel does not adjust the positions of its children, even if the parent window has automatic adjustment enabled.</p>"},{"location":"user-interface-tools/control-objects/#example_10","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"panel\"[, bounds, text, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#progressbar","title":"progressbar","text":"<p>Class Name: <code>Progressbar</code></p>"},{"location":"user-interface-tools/control-objects/#description_13","title":"Description","text":"<p>A horizontal rectangle that shows progress of an operation.</p> <p>All <code>progressbar</code> controls have a horizontal orientation. The <code>value</code> property contains the current position of the progress indicator; the default is 0. There is a <code>minvalue</code> property, but it is always 0; attempts to set it to a different value are silently ignored.</p>"},{"location":"user-interface-tools/control-objects/#parameters_12","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>value</code> Number Optional. The initial position of the progress indicator. Default is 0. <code>minvalue</code> Number Optional. The minimum value that the <code>value</code> property can be set to. Default is 0. Together with <code>maxvalue</code>, defines the range. <code>maxvalue</code> Number Optional. The maximum value that the <code>value</code> property can be set to. Default is 100. Together with <code>minvalue</code>, defines the range. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_11","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_11","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"progressbar\"[, bounds, value, minvalue, maxvalue, creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#radiobutton","title":"radiobutton","text":"<p>Class Name: <code>RadioButton</code></p>"},{"location":"user-interface-tools/control-objects/#description_14","title":"Description","text":"<p>A dual-state control, grouped with other radiobuttons, of which only one can be in the selected state. Shows the selected state when <code>value</code> is <code>true</code>, empty when value is <code>false</code>. Calls the onClick callback if the control is clicked or if its notify() method is called.</p> <p>All radiobuttons in a group must be created sequentially, with no intervening creation of other element types. Only one <code>radiobutton</code> in a group can be set at a time; setting a different <code>radiobutton</code> unsets the original one.</p>"},{"location":"user-interface-tools/control-objects/#parameters_13","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the control. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_12","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_12","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"radiobutton\"[, bounds, text, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#scrollbar","title":"scrollbar","text":"<p>Class Name: <code>Scrollbar</code></p>"},{"location":"user-interface-tools/control-objects/#description_15","title":"Description","text":"<p>A scrollbar with a draggable scroll indicator and stepper buttons to move the indicator. The <code>scrollbar</code> control has a horizontal orientation if the <code>width</code> is greater than the <code>height</code> at creation time, or vertical if its <code>height</code> is greater than its <code>width</code>.</p> <p>Calls the onChange callback after the position of the indicator is changed or if its notify() method is called. Calls the onChanging callback repeatedly while the user is moving the indicator.</p>"},{"location":"user-interface-tools/control-objects/#properties","title":"Properties","text":"Property Type Description <code>value</code> Number Contains the current position of the scrollbar's indicator within the scrolling area, within the range of <code>minvalue</code> and <code>maxvalue</code>. <code>stepdelta</code> Number Determines the scrolling unit for the up or down arrow. Default is <code>1</code>. <code>jumpdelta</code> Number Determines the scrolling unit for a jump (as when the bar is clicked outside the indicator or arrows); default is 20% of the range between <code>minvalue</code> and <code>maxvalue</code>."},{"location":"user-interface-tools/control-objects/#parameters_14","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>value</code> Number Optional. The initial position of the scroll indicator. Default is 0. <code>minvalue</code> Number Optional. The minimum value that the <code>value</code> property can be set to. Default is 0. Together with <code>maxvalue</code>, defines the scrolling range. <code>maxvalue</code> Number Optional. The maximum value that the <code>value</code> property can be set to. Default is 100. Together with <code>minvalue</code>, defines the scrolling range. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_13","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_13","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"scrollbar\"[, bounds, value, minvalue, maxvalue, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#slider","title":"slider","text":"<p>Class Name: <code>Slider</code></p>"},{"location":"user-interface-tools/control-objects/#description_16","title":"Description","text":"<p>A slider with a moveable position indicator. All <code>slider</code> controls have a horizontal orientation. Calls the onChange callback after the position of the indicator is changed or if its notify() method is called.</p> <p>Calls the <code>onChanging</code> callback repeatedly while the user is moving the indicator.</p> <p>The <code>value</code> property contains the current position of the indicator within the range of <code>minvalue</code> and <code>maxvalue</code>.</p>"},{"location":"user-interface-tools/control-objects/#parameters_15","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>value</code> Number Optional. The initial position of the scroll indicator. Default is 0. <code>minvalue</code> Number Optional. The minimum value that the <code>value</code> property can be set to. Default is 0. Together with <code>maxvalue</code>, defines the range. <code>maxvalue</code> Number Optional. The maximum value that the <code>value</code> property can be set to. Default is 100. Together with <code>minvalue</code>, defines the range. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_14","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_14","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"slider\"[, bounds, value, minvalue, maxvalue, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#statictext","title":"statictext","text":"<p>Class Name: <code>StaticText</code></p>"},{"location":"user-interface-tools/control-objects/#description_17","title":"Description","text":"<p>A text field that the user cannot change.</p>"},{"location":"user-interface-tools/control-objects/#parameters_16","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the control. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_15","title":"Creation Properties","text":"<p>Property</p> <p>Type</p> <p>Description</p> <p><code>name</code></p> <p>String</p> <p>A unique name for the control.</p> <p><code>multiline</code></p> <p>Boolean</p> <p>When <code>false</code> (the default), the control displays a single line of text. When <code>true</code>, the control displays multiple lines, in which case the text wraps within the width of the control.</p> <p><code>scrolling</code> <code>truncate</code></p> <p>Boolean String</p> <p>When <code>false</code> (the default), the displayed text cannot be scrolled. When <code>true</code>, the displayed text can be vertically scrolled using scrollbars; this case implies <code>multiline</code> is <code>true</code>. Truncate behaviour, one of:</p> <ul> <li><code>middle</code></li> <li><code>end</code></li> <li><code>none</code></li> </ul> <p>If <code>middle</code> or <code>end</code>, defines where to remove characters from the text and replace them with an ellipsis if the specified title does not fit within the space reserved for it. If <code>none</code>, and the text does not fit, characters are removed from the end, without any replacement ellipsis character.</p>"},{"location":"user-interface-tools/control-objects/#example_15","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"statictext\"[, bounds, text, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#tab","title":"tab","text":"<p>Class Name: <code>Tab</code></p>"},{"location":"user-interface-tools/control-objects/#description_18","title":"Description","text":"<p>A container for other types of controls. Differs from a panel element in that is must be a direct child of a tabbedpanel element, the title is shown in the selection tab, and it does not have a script-definable border. The currently active tab is the value of the parent's <code>selection</code> property.</p> <p>Containers have additional properties that control the children; see Container Attributes. Hiding a panel hides all its children. Making it visible makes visible those children that are not individually hidden.</p>"},{"location":"user-interface-tools/control-objects/#parameters_17","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the control. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_16","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_16","title":"Example","text":"<p>To add a tab to a tabbed panel <code>t</code> in window <code>w</code>:</p> <pre><code>w.t.add(\"tab\"[, bounds, text, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#tabbedpanel","title":"tabbedpanel","text":"<p>Class Name: <code>TabbedPanel</code></p>"},{"location":"user-interface-tools/control-objects/#description_19","title":"Description","text":"<p>A container for selectable tab containers. Differs from a panel element in that it can contain only tab elements as direct children.</p> <p>Containers have additional properties that control the children; see Container Attributes. Hiding a panel hides all its children. Making it visible makes visible those children that are not individually hidden.</p> <p>The selected tab child is the value of the parent's <code>selection</code> property. One and only one of the <code>tab</code> children must be selected; selecting one deselects the others. When the value of the <code>selection</code> property changes, either by a user selecting a different tab, or by a script setting the property, the <code>tabbedpanel</code> receives an onChange notification.</p>"},{"location":"user-interface-tools/control-objects/#parameters_18","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>text</code> String Optional. The text displayed in the control. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_17","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control."},{"location":"user-interface-tools/control-objects/#example_17","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"tabbedpanel\"[, bounds, text, {creation_properties}]);\n</code></pre>"},{"location":"user-interface-tools/control-objects/#treeview","title":"treeview","text":"<p>Class Name: <code>TreeView</code></p>"},{"location":"user-interface-tools/control-objects/#description_20","title":"Description","text":"<p>A hierarchical list whose items can contain child items. Items at any level of the tree can be individually selected. Calls the onChange callback if the item selection is changed by a script or the user, or if the object's notify() method is called.</p>"},{"location":"user-interface-tools/control-objects/#parameters_19","title":"Parameters","text":"Parameter Type Description <code>bounds</code> Bounds object Optional. The control's position and size. <code>items</code> Array of Strings Optional. The text of each top-level list item. A ListItem object is created for each item. An item with the type node can contain child items. Supply this argument, or the <code>items</code> property in <code>creation_properties</code>, not both. <code>creation_properties</code> Object Optional. An object that contains any of the properties below."},{"location":"user-interface-tools/control-objects/#creation-properties_18","title":"Creation Properties","text":"Property Type Description <code>name</code> String A unique name for the control. <code>items</code> Array of Strings The text of each top-level list item. A ListItem object is created for each item. An item with the type <code>node</code> can contain child items. Supply this property, or the <code>items</code> argument, not both. This form is most useful for elements defined using Resource specifications."},{"location":"user-interface-tools/control-objects/#example_18","title":"Example","text":"<p>To add to a window <code>w</code>:</p> <pre><code>w.add(\"treeview\"[, bounds, items, {creation_properties}])\n</code></pre>"},{"location":"user-interface-tools/control-objects/#control-object-properties","title":"Control object properties","text":"<p>The following table shows the properties of ScriptUI control elements. Some values apply only to controls of particular types, as indicated.</p> <p>See Container Attributes for properties that apply to container elements (controls of type panel, tabbedpanel, tab, and group).</p>"},{"location":"user-interface-tools/control-objects/#active","title":"active","text":"<p><code>controlObj.active</code></p>"},{"location":"user-interface-tools/control-objects/#description_21","title":"Description","text":"<p>When <code>true</code>, the object is active, <code>false</code> otherwise. Set to <code>true</code> to make a given control or dialog active.</p> <ul> <li>A modal dialog that is visible is by definition the active dialog.</li> <li>An active palette is the front-most window.</li> <li>An active control is the one with focus-that is, the one that accepts keystrokes, or in the case of a Button, be selected when the user types ENTER in Windows, or presses the spacebar in Mac OS.</li> </ul>"},{"location":"user-interface-tools/control-objects/#type","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/control-objects/#alignment","title":"alignment","text":"<p><code>controlObj.alignment</code></p>"},{"location":"user-interface-tools/control-objects/#description_22","title":"Description","text":"<p>Applies to child elements of a container. If defined, this value overrides the <code>alignChildren</code> setting for the parent container.</p> <p>For a single string value, allowed values depend on the <code>orientation</code> value in the parent container.</p> <p><code>orientation</code> Value</p> <p>Allowed values</p> <p><code>\"row\"</code></p> <ul> <li><code>\"bottom\"</code></li> <li><code>\"center\"</code> (default)</li> <li><code>\"fill\"</code></li> <li><code>\"top\"</code></li> </ul> <p><code>\"column\"</code></p> <ul> <li><code>\"center\"</code> (default)</li> <li><code>\"fill\"</code></li> <li><code>\"left\"</code></li> <li><code>\"right\"</code></li> </ul> <p><code>\"stack\"</code></p> <ul> <li><code>\"bottom\"</code></li> <li><code>\"center\"</code> (default)</li> <li><code>\"fill\"</code></li> <li><code>\"left\"</code></li> <li><code>\"right\"</code></li> <li><code>\"top\"</code></li> </ul> <p>For an array value, the first string element defines the horizontal alignment and the second element defines the vertical alignment.</p> <p>The horizontal alignment value must be one of <code>\"left\"</code>, <code>\"right\"</code>, <code>\"center\"</code> or <code>\"fill\"</code>.</p> <p>The vertical alignment value must be one of <code>\"top\"</code>, <code>\"bottom\"</code>, <code>\"center\"</code>, or <code>\"fill\"</code>.</p> <p>Note</p> <p>Values are not case sensitive.</p>"},{"location":"user-interface-tools/control-objects/#type_1","title":"Type","text":"<p>String or Array of 2 Strings</p>"},{"location":"user-interface-tools/control-objects/#bounds","title":"bounds","text":"<p><code>controlObj.bounds</code></p>"},{"location":"user-interface-tools/control-objects/#description_23","title":"Description","text":"<p>A Bounds object describing the boundaries of the element, in screen coordinates for Window elements, and parent-relative coordinates for child elements (compare windowBounds). For windows, the bounds refer only to the window's content region.</p> <p>Warning</p> <p>Setting an element's <code>size</code> or <code>location</code> changes its <code>bounds</code> property, and vice-versa.</p>"},{"location":"user-interface-tools/control-objects/#type_2","title":"Type","text":"<p>Bounds</p>"},{"location":"user-interface-tools/control-objects/#characters","title":"characters","text":"<p><code>controlObj.characters</code></p>"},{"location":"user-interface-tools/control-objects/#description_24","title":"Description","text":"<p>Used by the LayoutManager object to determine the default preferredSize for a StaticText or EditText control.</p> <p>The control will be made wide enough to display the given number of <code>X</code> characters in the font used by the control. Setting this property is the best way to reserve space in a control for a maximum number of characters to display.</p>"},{"location":"user-interface-tools/control-objects/#type_3","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/control-objects/#checked","title":"checked","text":"<p><code>controlObj.checked</code></p>"},{"location":"user-interface-tools/control-objects/#description_25","title":"Description","text":"<p>Info</p> <p>For ListItem objects only.</p> <ul> <li>When <code>true</code>, the item is marked with the platform-appropriate checkmark.</li> <li>When <code>false</code>, no checkmark is drawn, but space is reserved for it in the left margin, so that the item lines up with other checkable items.</li> <li>When <code>undefined</code>, no space is reserved for a checkmark.</li> </ul>"},{"location":"user-interface-tools/control-objects/#type_4","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/control-objects/#columns","title":"columns","text":"<p><code>controlObj.columns</code></p>"},{"location":"user-interface-tools/control-objects/#description_26","title":"Description","text":"<p>Info</p> <p>For ListBox objects only.</p> <p>A JavaScript object with two read-only properties whose values are set by the creation parameters.</p>"},{"location":"user-interface-tools/control-objects/#properties_1","title":"Properties","text":"Property Type Description <code>titles</code> Array of Strings An array of column title strings, whose length matches the number of columns specified at creation. <code>preferredWidths</code> Array of Numbers An array of column widths, whose length matches the number of columns specified at creation."},{"location":"user-interface-tools/control-objects/#type_5","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/control-objects/#enabled","title":"enabled","text":"<p><code>controlObj.enabled</code></p>"},{"location":"user-interface-tools/control-objects/#description_27","title":"Description","text":"<ul> <li>When <code>true</code>, the control is enabled, meaning that it accepts input.</li> <li>When <code>false</code>, control elements do not accept input, and all types of elements have a dimmed appearance.</li> </ul> <p>Note</p> <p>A disabled ListItem is not selectable in a ListBox, DropDownList, or TreeView object.</p>"},{"location":"user-interface-tools/control-objects/#type_6","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/control-objects/#expanded","title":"expanded","text":"<p><code>controlObj.expanded</code></p>"},{"location":"user-interface-tools/control-objects/#description_28","title":"Description","text":"<p>For ListItem objects of type <code>node</code> in TreeView list controls. When <code>true</code>, the item is in the expanded state and its children are shown, when <code>false</code>, it is collapsed and children are hidden.</p>"},{"location":"user-interface-tools/control-objects/#type_7","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/control-objects/#graphics","title":"graphics","text":"<p><code>controlObj.graphics</code></p>"},{"location":"user-interface-tools/control-objects/#description_29","title":"Description","text":"<p>A ScriptUIGraphics object that can be used to customize the control's appearance, in response to the onDraw event.</p>"},{"location":"user-interface-tools/control-objects/#type_8","title":"Type","text":"<p>ScriptUIGraphics object</p>"},{"location":"user-interface-tools/control-objects/#helptip","title":"helpTip","text":"<p><code>controlObj.helpTip</code></p>"},{"location":"user-interface-tools/control-objects/#description_30","title":"Description","text":"<p>A brief help message (also called a tool tip) that is displayed in a small floating window when the mouse cursor hovers over a user-interface control element.</p> <p>Set to an empty string or <code>null</code> to remove help text.</p>"},{"location":"user-interface-tools/control-objects/#type_9","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/control-objects/#icon","title":"icon","text":"<p><code>controlObj.icon</code></p>"},{"location":"user-interface-tools/control-objects/#description_31","title":"Description","text":"<p>Danger</p> <p>Deprecated. Use Image instead.</p>"},{"location":"user-interface-tools/control-objects/#type_10","title":"Type","text":"<p>String or File object</p>"},{"location":"user-interface-tools/control-objects/#image_1","title":"image","text":"<p><code>controlObj.image</code></p>"},{"location":"user-interface-tools/control-objects/#description_32","title":"Description","text":"<p>A ScriptUIImage object, or the name of an icon resource, or the pathname or File object for a file that contains a platform-specific image in PNG or JPEG format, or for a shortcut or alias to such a file.</p> <ul> <li>For an IconButton, the icon appears as the content of the button.</li> <li>For an Image, the image is the entire content of the image element.</li> <li>For a ListItem, the image is displayed to the left of the text.<ul> <li>If the parent is a multi-column ListBox, this is the display image for the label in the first column, and labels for further columns are specified in the subitems array.</li> <li>See Creating multi-column lists.</li> </ul> </li> </ul>"},{"location":"user-interface-tools/control-objects/#type_11","title":"Type","text":"<p>ScriptUIImage object</p>"},{"location":"user-interface-tools/control-objects/#indent","title":"indent","text":"<p><code>controlObj.indent</code></p>"},{"location":"user-interface-tools/control-objects/#description_33","title":"Description","text":"<p>A number of pixels by which to indent the element during automatic layout. Applies for <code>column</code> orientation and <code>left</code> alignment, or <code>row</code> orientation and <code>top</code> alignment.</p>"},{"location":"user-interface-tools/control-objects/#type_12","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/control-objects/#index","title":"index","text":"<p><code>controlObj.index</code></p>"},{"location":"user-interface-tools/control-objects/#description_34","title":"Description","text":"<p>Info</p> <p>For ListItem objects only.</p> <p>The index of this item in the <code>items</code> collection of its parent list control.</p>"},{"location":"user-interface-tools/control-objects/#type_13","title":"Type","text":"<p>Number. Read only.</p>"},{"location":"user-interface-tools/control-objects/#items","title":"items","text":"<p><code>controlObj.items</code></p>"},{"location":"user-interface-tools/control-objects/#description_35","title":"Description","text":"<p>Info</p> <p>For ListBox, DropDownList, or TreeView objects only.</p> <p>A collection of ListItem objects for the items in the list. Access by 0-based index.</p> <p>Tip</p> <p>To obtain the number of items in the list, use <code>items.length</code>.</p>"},{"location":"user-interface-tools/control-objects/#type_14","title":"Type","text":"<p>Array of Objects. Read only.</p>"},{"location":"user-interface-tools/control-objects/#itemsize","title":"itemSize","text":"<p><code>controlObj.itemSize</code></p>"},{"location":"user-interface-tools/control-objects/#description_36","title":"Description","text":"<p>Info</p> <p>For ListBox, DropDownList, or TreeView objects only.</p> <p>A Dimension object describing the width and height in pixels of each item in the list.</p> <p>Used by auto-layout to determine the <code>preferredSize</code> of the list, if not otherwise specified.</p> <p>If not set explicitly, the size of each item is set to match the largest height and width among all items in the list.</p>"},{"location":"user-interface-tools/control-objects/#type_15","title":"Type","text":"<p>Dimension object</p>"},{"location":"user-interface-tools/control-objects/#jumpdelta","title":"jumpdelta","text":"<p><code>controlObj.jumpdelta</code></p>"},{"location":"user-interface-tools/control-objects/#description_37","title":"Description","text":"<p>Info</p> <p>For Scrollbar objects only.</p> <p>The amount to increment or decrement a Scrollbar indicator's position when the user clicks ahead or behind the moveable element.</p> <p>Default is 20% of the range between the <code>maxvalue</code> and <code>minvalue</code> property values.</p>"},{"location":"user-interface-tools/control-objects/#type_16","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/control-objects/#justify","title":"justify","text":"<p><code>controlObj.justify</code></p>"},{"location":"user-interface-tools/control-objects/#description_38","title":"Description","text":"<p>The justification of text in StaticText and EditText controls.</p> <p>One of:</p> <ul> <li><code>\"left\"</code> (default)</li> <li><code>\"center\"</code></li> <li><code>\"right\"</code></li> </ul> <p>Note</p> <p>Justification only works if the value is set on creation, using a resource specification or creation parameters.</p>"},{"location":"user-interface-tools/control-objects/#type_17","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/control-objects/#location","title":"location","text":"<p><code>controlObj.location</code></p>"},{"location":"user-interface-tools/control-objects/#description_39","title":"Description","text":"<p>A Point object describing the location of the element as an array, <code>[x, y]</code>, representing the coordinates of the upper left corner of the element. These are screen coordinates for <code>Window</code> elements, and parent-relative coordinates for other elements.</p> <p>The <code>location</code> is defined as <code>[bounds.x, bounds.y]</code>.</p> <p>By default, <code>location</code> is <code>undefined</code> until the parent container's layout manager is invoked.</p> <p>Warning</p> <p>Setting an element's <code>size</code> or <code>location</code> changes its <code>bounds</code> property, and vice-versa.</p>"},{"location":"user-interface-tools/control-objects/#type_18","title":"Type","text":"<p>Point object</p>"},{"location":"user-interface-tools/control-objects/#maximumsize","title":"maximumSize","text":"<p><code>controlObj.maximumSize</code></p>"},{"location":"user-interface-tools/control-objects/#description_40","title":"Description","text":"<p>A Dimension object that specifies the maximum height and width for an element.</p> <p>The default is 50 pixels less than the screen size in each dimension. In Windows, this can occupy the entire screen; you must define a <code>maximumSize</code> to be large enough for your intended usage.</p>"},{"location":"user-interface-tools/control-objects/#type_19","title":"Type","text":"<p>Dimension object</p>"},{"location":"user-interface-tools/control-objects/#minimumsize","title":"minimumSize","text":"<p><code>controlObj.minimumSize</code></p>"},{"location":"user-interface-tools/control-objects/#description_41","title":"Description","text":"<p>A Dimension object that specifies the minimum height and width for an element. Default is <code>[0,0]</code>.</p>"},{"location":"user-interface-tools/control-objects/#type_20","title":"Type","text":"<p>Dimension object</p>"},{"location":"user-interface-tools/control-objects/#maxvalue","title":"maxvalue","text":"<p><code>controlObj.maxvalue</code></p>"},{"location":"user-interface-tools/control-objects/#description_42","title":"Description","text":"<p>The maximum value that the <code>value</code> property can have.</p> <ul> <li>If <code>maxvalue</code> is reset less than <code>value</code>, <code>value</code> is reset to <code>maxvalue</code>.</li> <li>If <code>maxvalue</code> is reset less than <code>minvalue</code>, <code>minvalue</code> is reset to <code>maxvalue</code>.</li> </ul>"},{"location":"user-interface-tools/control-objects/#type_21","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/control-objects/#minvalue","title":"minvalue","text":"<p><code>controlObj.minvalue</code></p>"},{"location":"user-interface-tools/control-objects/#description_43","title":"Description","text":"<p>The minimum value that the <code>value</code> property can have.</p> <ul> <li>If <code>minvalue</code> is reset greater than <code>value</code>, <code>value</code> is reset to <code>minvalue</code>.</li> <li>If <code>minvalue</code> is reset greater than <code>maxvalue</code>, <code>maxvalue</code> is reset to <code>minvalue</code>.</li> </ul>"},{"location":"user-interface-tools/control-objects/#type_22","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/control-objects/#parent","title":"parent","text":"<p><code>controlObj.parent</code></p>"},{"location":"user-interface-tools/control-objects/#description_44","title":"Description","text":"<p>The immediate parent object of this element.</p>"},{"location":"user-interface-tools/control-objects/#type_23","title":"Type","text":"<p>Control Object. Read only.</p>"},{"location":"user-interface-tools/control-objects/#preferredsize","title":"preferredSize","text":"<p><code>controlObj.preferredSize</code></p>"},{"location":"user-interface-tools/control-objects/#description_45","title":"Description","text":"<p>A Dimension object used by layout managers to determine the best size for each element. If not explicitly set by a script, value is established by the user-interface framework in which ScriptUI is employed, and is based on such attributes of the element as its text, font, font size, icon size, and other user-interface framework-specific attributes.</p> <p>A script can explicitly set <code>preferredSize</code> before the layout manager is invoked in order to establish an element size other than the default. To set a specific value for only one dimension, specify the other dimension as <code>-1</code>.</p>"},{"location":"user-interface-tools/control-objects/#type_24","title":"Type","text":"<p>Dimension object</p>"},{"location":"user-interface-tools/control-objects/#properties_2","title":"properties","text":"<p><code>controlObj.properties</code></p>"},{"location":"user-interface-tools/control-objects/#description_46","title":"Description","text":"<p>An object that contains one or more creation properties of the element (properties used only when the element is created).</p>"},{"location":"user-interface-tools/control-objects/#type_25","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/control-objects/#selected","title":"selected","text":"<p><code>controlObj.selected</code></p>"},{"location":"user-interface-tools/control-objects/#description_47","title":"Description","text":"<p>Info</p> <p>For ListItem objects only.</p> <ul> <li>When <code>true</code>, the item is part of the <code>selection</code> for its parent list.</li> <li>When <code>false</code>, the item is not selected.</li> </ul> <p>Set to <code>true</code> to select this item in a single-selection list, or to add it to the selection array for a multi-selection list.</p>"},{"location":"user-interface-tools/control-objects/#type_26","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/control-objects/#selection","title":"selection","text":"<p><code>controlObj.selection</code></p>"},{"location":"user-interface-tools/control-objects/#description_48","title":"Description","text":"<p>Info</p> <p>For ListBox objects only.</p> <p>For a ListBox, an array of ListItem objects for the current selection in a multi-selection list. Setting this value causes the selected item to be highlighted and to be scrolled into view if necessary. If no items are selected, the value is <code>null</code>. Set to <code>null</code> to deselect all items.</p> <p>The value can also change because the user clicked or double-clicked an item, or because an item was removed with remove() or removeAll(). Whenever the value changes, the onChange callback is called. If the value is changed by a double click, calls the onDoubleClick callback.</p> <p>You can set the value using the index of an item or an array of indices, rather than object references. If set to an index value that is out of range, the operation is ignored. When set with index values, the property still returns object references.</p> <ul> <li>If you set the value to an array for a single-selection list, only the first item in the array is selected.</li> <li>If you set the value to a single item for a multi-selection list, that item is added to the current selection.</li> </ul>"},{"location":"user-interface-tools/control-objects/#type_27","title":"Type","text":"<p>Array of ListItem objects</p>"},{"location":"user-interface-tools/control-objects/#selection_1","title":"selection","text":"<p><code>controlObj.selection</code></p>"},{"location":"user-interface-tools/control-objects/#description_49","title":"Description","text":"<p>Info</p> <p>For DropDownList, or TreeView objects only.</p> <p>The currently selected ListItem object.</p> <p>Setting this value causes the selected item to be highlighted and to be scrolled into view if necessary. If no item is selected, the value is <code>null</code>. Set to <code>null</code> to deselect all items.</p> <p>The value can also change because the user clicked on an item, or because an item was removed with remove() or removeAll().</p> <p>Whenever the value changes, the onChange callback is called.</p> <p>You can set the value using the index of an item or an array of indices, rather than object references. If set to an index value that is out of range, the operation is ignored. When set with an index value, the property still returns an object reference.</p>"},{"location":"user-interface-tools/control-objects/#type_28","title":"Type","text":"<p><code>ListItem</code></p>"},{"location":"user-interface-tools/control-objects/#shortcutkey","title":"shortcutKey","text":"<p><code>controlObj.shortcutKey</code></p>"},{"location":"user-interface-tools/control-objects/#description_50","title":"Description","text":"<p>The key sequence that invokes the onShortcutKey callback for this element (in Windows only).</p>"},{"location":"user-interface-tools/control-objects/#type_29","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/control-objects/#size","title":"size","text":"<p><code>controlObj.size</code></p>"},{"location":"user-interface-tools/control-objects/#description_51","title":"Description","text":"<p>A Dimension object that defines the actual dimensions of an element.</p> <p>Initially <code>undefined</code>, and unless explicitly set by a script, it is defined by a LayoutManager object.</p> <p>Although a script can explicitly set size before the layout manager is invoked to establish an element size other than the <code>preferredSize</code> or the default size, this is not recommended.</p> <p>Defined as <code>[bounds.width, bounds.height]</code>.</p> <p>Warning</p> <p>Setting an element's <code>size</code> or <code>location</code> changes its <code>bounds</code> property, and vice-versa.</p>"},{"location":"user-interface-tools/control-objects/#type_30","title":"Type","text":"<p>Dimension object</p>"},{"location":"user-interface-tools/control-objects/#stepdelta","title":"stepdelta","text":"<p><code>controlObj.stepdelta</code></p>"},{"location":"user-interface-tools/control-objects/#description_52","title":"Description","text":"<p>The amount by which to increment or decrement a Scrollbar element's position when the user clicks a stepper button.</p>"},{"location":"user-interface-tools/control-objects/#type_31","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/control-objects/#subitems","title":"subitems","text":"<p><code>controlObj.subitems</code></p>"},{"location":"user-interface-tools/control-objects/#description_53","title":"Description","text":"<p>Info</p> <p>For ListItem objects only.</p> <p>When the parent is a multi-column ListBox, the ListItem.text and ListItem.image values describe the label in the first column, and this specifies additional labels for that row in the remaining columns.</p> <p>This contains an array of JavaScript objects, whose length is one less than the number of columns. Each member specifies a label in the corresponding column, with the first member (<code>subitems[0]</code>) describing the label in the second column.</p>"},{"location":"user-interface-tools/control-objects/#properties_3","title":"Properties","text":"<p>Each object has two properties, of which one or both can be supplied:</p> Property Type Description <code>text</code> String A localizable display string for this label. <code>image</code> Image An Image object for this label."},{"location":"user-interface-tools/control-objects/#type_32","title":"Type","text":"<p>Array</p>"},{"location":"user-interface-tools/control-objects/#text","title":"text","text":"<p><code>controlObj.text</code></p>"},{"location":"user-interface-tools/control-objects/#description_54","title":"Description","text":"<p>The title, label, or displayed text. Ignored for containers of type <code>group</code>.</p> <p>For controls, the meaning depends on the control type. Buttons use the <code>text</code> as a label, for example, while edit fields use the text to access the content.</p> <p>For ListItem objects, this is the display string for the list choice. If the parent is a multi-column list box, this is the display string for the label in the first column, and labels for further columns are specified in the subitems array. See Creating multi-column lists.</p> <p>This is a localizable string: see Localization in ScriptUI objects.</p>"},{"location":"user-interface-tools/control-objects/#type_33","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/control-objects/#textselection","title":"textselection","text":"<p><code>controlObj.textselection</code></p>"},{"location":"user-interface-tools/control-objects/#description_55","title":"Description","text":"<p>The currently selected text in a control that displays text, or the empty string if there is no text selected.</p> <p>Setting the value replaces the current text selection and modifies the value of the <code>text</code> property. If there is no current selection, inserts the new value into the <code>text</code> string at the current insertion point. The <code>textselection</code> value is reset to an empty string after it modifies the <code>text</code> value.</p> <p>Note</p> <p>Setting the <code>textselection</code> property before the EditText control's parent Window exists is an undefined operation.</p>"},{"location":"user-interface-tools/control-objects/#type_34","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/control-objects/#title","title":"title","text":"<p><code>controlObj.title</code></p>"},{"location":"user-interface-tools/control-objects/#description_56","title":"Description","text":"<p>Info</p> <p>For DropDownList, FlashPlayer, IconButton, Image, or TabbedPanel objects only.</p> <p>A text label for the element. The title can appear to the left or right of the element, or above or below it, or you can superimpose the title over the center of the element. The placement is controlled by the titleLayout value.</p>"},{"location":"user-interface-tools/control-objects/#type_35","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/control-objects/#titlelayout","title":"titleLayout","text":"<p><code>controlObj.titleLayout</code></p>"},{"location":"user-interface-tools/control-objects/#description_57","title":"Description","text":"<p>Info</p> <p>For DropDownList, FlashPlayer, IconButton, Image, or TabbedPanel objects only.</p> <p>For a control with a title value, the way the text label is shown in relation to the element.</p>"},{"location":"user-interface-tools/control-objects/#properties_4","title":"Properties","text":"Property Type Description <code>alignment</code> Array or Numbers The position of the title relative to the element, an array of [horizontal_alignment, vertical_alignment]. For possible alignment values, see alignment. Note that <code>fill</code> is not a valid alignment value for either horizontal or vertical alignment in this context. <code>characters</code> Number If <code>1</code> or greater, reserves a title width wide enough to hold the specified number of \"X\" characters in the font for this element. If 0, the title width is calculated based on the value of the <code>title</code> property during layout operations. <code>spacing</code> Number <code>0</code> or greater. The number of pixels separating the title from the element. <code>margins</code> Array of Numbers, <code>[left, top, right, bottom]</code> The number of pixels separating each edge of an element and the visible content within that element. This overrides the default margins. <code>justify</code> String One of <code>\"left\"</code>, <code>\"center\"</code>, or <code>\"right\"</code>, how to justify the text when the space allocated for the title width is greater than the actual width of the text. <code>truncate</code> String If <code>\"middle\"</code> or <code>\"end\"</code>, defines where to remove characters from the text and replace them with an ellipsis (\"...\") if the specified title does not fit within the space reserved for it. If <code>\"none\"</code>, and the text does not fit, characters are removed from the end, without any replacement ellipsis character."},{"location":"user-interface-tools/control-objects/#type_36","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/control-objects/#type_37","title":"type","text":"<p><code>controlObj.type</code></p>"},{"location":"user-interface-tools/control-objects/#description_58","title":"Description","text":"<p>Contains the type name of the element, as specified on creation.</p> <ul> <li>For <code>Window</code> objects, one of the type names window, palette, or dialog.</li> <li>For <code>controls</code>, the type of the control, as specified in the add method that created it.</li> </ul>"},{"location":"user-interface-tools/control-objects/#type_38","title":"Type","text":"<p>String. Read only.</p>"},{"location":"user-interface-tools/control-objects/#value","title":"value","text":"<p><code>controlObj.value</code></p>"},{"location":"user-interface-tools/control-objects/#description_59","title":"Description","text":"<p>Info</p> <p>For Checkbox or RadioButton objects only.</p> <p><code>true</code> if the control is in the selected or set state, <code>false</code> if it is not.</p>"},{"location":"user-interface-tools/control-objects/#type_39","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/control-objects/#value_1","title":"value","text":"<p><code>controlObj.value</code></p>"},{"location":"user-interface-tools/control-objects/#description_60","title":"Description","text":"<p>Info</p> <p>For Scrollbar or Slider objects only.</p> <p>The current position of the indicator. If set to a value outside the range specified by minvalue and maxvalue, it is automatically reset to the closest boundary.</p>"},{"location":"user-interface-tools/control-objects/#type_40","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/control-objects/#visible","title":"visible","text":"<p><code>controlObj.visible</code></p>"},{"location":"user-interface-tools/control-objects/#description_61","title":"Description","text":"<p>When <code>true</code>, the element is shown, when <code>false</code> it is hidden.</p> <p>When a container is hidden, its children are also hidden, but they retain their own visibility values, and are shown or hidden accordingly when the parent is next shown.</p>"},{"location":"user-interface-tools/control-objects/#type_41","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/control-objects/#window","title":"window","text":"<p><code>controlObj.window</code></p>"},{"location":"user-interface-tools/control-objects/#description_62","title":"Description","text":"<p>The Window that contains this control.</p>"},{"location":"user-interface-tools/control-objects/#type_42","title":"Type","text":"<p>Window object. Read only.</p>"},{"location":"user-interface-tools/control-objects/#windowbounds","title":"windowBounds","text":"<p><code>controlObj.windowBounds</code></p>"},{"location":"user-interface-tools/control-objects/#description_63","title":"Description","text":"<p>A Bounds object that contains the bounds of this control in the containing window's coordinates. Compare to this control object's <code>.bounds</code> property, in which coordinates are relative to the immediate parent container.</p>"},{"location":"user-interface-tools/control-objects/#type_43","title":"Type","text":"<p>Bounds object. Read only.</p>"},{"location":"user-interface-tools/control-objects/#function_name","title":"function_name","text":"<p><code>controlObj.function_name</code></p>"},{"location":"user-interface-tools/control-objects/#description_64","title":"Description","text":"<p>For the FlashPlayer control, a function definition for a callback from the Flash ActionScript environment.</p> <p>There are no special naming requirements, but the function must take and return only the supported data types:</p> <ul> <li>Array</li> <li>Boolean</li> <li>Null</li> <li>Number</li> <li>Object</li> <li>String</li> <li>undefined</li> </ul> <p>Note</p> <p>The ActionScript <code>class</code> and <code>date</code> objects are not supported as parameter values.</p>"},{"location":"user-interface-tools/control-objects/#type_44","title":"Type","text":"<p>Function</p>"},{"location":"user-interface-tools/control-objects/#control-object-functions","title":"Control object functions","text":"<p>The following table shows the methods defined for each element type, and for specific control types as indicated.</p>"},{"location":"user-interface-tools/control-objects/#addeventlistener","title":"addEventListener()","text":"<p><code>controlObj.addEventListener(eventName, handler[, capturePhase=false]);</code></p>"},{"location":"user-interface-tools/control-objects/#description_65","title":"Description","text":"<p>Registers an event handler for a particular type of event occurring in this control.</p>"},{"location":"user-interface-tools/control-objects/#parameter","title":"Parameter","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>eventName</code></p> <p>String</p> <p>The event name string. Predefined event names include:</p> <ul> <li><code>\"change\"</code></li> <li><code>\"changing\"</code></li> <li><code>\"move\"</code></li> <li><code>\"moving\"</code></li> <li><code>\"resize\"</code></li> <li><code>\"resizing\"</code></li> <li><code>\"show\"</code></li> <li><code>\"enterKey\"</code></li> <li><code>\"focus\"</code></li> <li><code>\"blur\"</code></li> <li><code>\"mousedown\"</code></li> <li><code>\"mouseup\"</code></li> <li><code>\"mousemove\"</code></li> <li><code>\"mouseover\"</code></li> <li><code>\"mouseout\"</code></li> <li><code>\"keyup\"</code></li> <li><code>\"keydown\"</code></li> <li><code>\"click\"</code> (detail = 1 for single, 2 for double)</li> </ul> <p><code>handler</code></p> <p>Function</p> <p>The function to register for the specified event in this target. This can be the name of a function defined in the extension, or a locally defined handler function to be executed when the event occurs. A handler function takes one argument, an object of the UIEvent base class. See Registering event listeners for windows or controls.</p> <p><code>capturePhase</code></p> <p>Boolean</p> <p>Optional. When <code>true</code>, the handler is called only in the capturing phase of the event propagation. Default is <code>false</code>, meaning that the handler is called in the bubbling phase if this object is an ancestor of the target, or in the at-target phase if this object is itself the target.</p>"},{"location":"user-interface-tools/control-objects/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#dispatchevent","title":"dispatchEvent()","text":"<p><code>controlObj.dispatchEvent(eventObj)</code></p>"},{"location":"user-interface-tools/control-objects/#description_66","title":"Description","text":"<p>Simulates the occurrence of an event in this target. A script can create an event object for a specific event, using ScriptUI.events.createEvent(), and pass it to this method to start the event propagation for the event.</p>"},{"location":"user-interface-tools/control-objects/#parameters_20","title":"Parameters","text":"Parameter Type Description <code>eventObj</code> Object An object of the UIEvent base class."},{"location":"user-interface-tools/control-objects/#returns_2","title":"Returns","text":"<p>Boolean. <code>false</code> if any of the registered listeners that handled the event called the event object's preventDefault() method, <code>true</code> otherwise.</p>"},{"location":"user-interface-tools/control-objects/#hide","title":"hide()","text":"<p><code>controlObj.hide()</code></p>"},{"location":"user-interface-tools/control-objects/#description_67","title":"Description","text":"<p>Hides this container or control. When a window or container is hidden, its children are also hidden, but when it is shown again, the children retain their own visibility states.</p>"},{"location":"user-interface-tools/control-objects/#returns_3","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#notify","title":"notify()","text":"<p><code>controlObj.notify([event])</code></p>"},{"location":"user-interface-tools/control-objects/#description_68","title":"Description","text":"<p>Sends a notification message, simulating the specified user interaction event.</p>"},{"location":"user-interface-tools/control-objects/#parameters_21","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>event</code></p> <p>String</p> <p>Optional. The name of the control event handler to call. One of:</p> <ul> <li><code>\"onClick\"</code></li> <li><code>\"onChange\"</code></li> <li><code>\"onChanging\"</code></li> </ul> <p>By default, simulates the onChange event for an EditText control, an onClick event for controls that support that event.</p>"},{"location":"user-interface-tools/control-objects/#returns_4","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#removeeventlistener","title":"removeEventListener()","text":"<p><code>controlbj.removeEventListener(eventName, handler[, capturePhase]);</code></p>"},{"location":"user-interface-tools/control-objects/#description_69","title":"Description","text":"<p>Unregisters an event handler for a particular type of event occurring in this control. All arguments must be identical to those that were used to register the event handler.</p>"},{"location":"user-interface-tools/control-objects/#parameters_22","title":"Parameters","text":"Parameter Type Description <code>eventName</code> String The event name. <code>handler</code> Function The function that was registered to handle the event. <code>capturePhase</code> Boolean Optional. Whether the handler was to respond only in the capture phase."},{"location":"user-interface-tools/control-objects/#returns_5","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#show","title":"show()","text":"<p><code>controlObj.show()</code></p>"},{"location":"user-interface-tools/control-objects/#description_70","title":"Description","text":"<p>Shows this container or control.</p> <p>When a window or container is hidden, its children are also hidden, but when it is shown again, the children retain their own visibility states.</p>"},{"location":"user-interface-tools/control-objects/#returns_6","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#tostring","title":"toString()","text":"<p><code>listItemObj.toString()</code></p>"},{"location":"user-interface-tools/control-objects/#description_71","title":"Description","text":"<p>Info</p> <p>For ListItem objects only.</p> <p>Retrieves the value of this item's text property as a string.</p>"},{"location":"user-interface-tools/control-objects/#returns_7","title":"Returns","text":"<p>String</p>"},{"location":"user-interface-tools/control-objects/#valueof","title":"valueOf()","text":"<p><code>listItemObj.valueOf()</code></p>"},{"location":"user-interface-tools/control-objects/#description_72","title":"Description","text":"<p>Info</p> <p>For ListItem objects only.</p> <p>Retrieves the index number of this item in the parent list's items array.</p>"},{"location":"user-interface-tools/control-objects/#returns_8","title":"Returns","text":"<p>Number</p>"},{"location":"user-interface-tools/control-objects/#list-control-object-functions","title":"List control object functions","text":"<p>The following table shows the methods defined for list objects only.</p>"},{"location":"user-interface-tools/control-objects/#add_1","title":"add()","text":"<p><code>listObj.add(type, text[, index=listObj.numItems])</code></p>"},{"location":"user-interface-tools/control-objects/#description_73","title":"Description","text":"<p>Info</p> <p>For ListBox, DropDownList, or TreeView objects only.</p> <p>Adds an <code>item</code> to the items array at the given index.</p>"},{"location":"user-interface-tools/control-objects/#parameters_23","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>type</code></p> <p>String</p> <p>The type of item to add. One of:</p> <ul> <li><code>item</code>: A basic, selectable item with a text label.</li> <li><code>separator</code>: A separator. For DropDownList objects only. In this case, the text value is ignored, and the method returns <code>null</code>.</li> </ul> <p><code>text</code></p> <p>String</p> <p>The localizable text label for the item.</p> <p><code>index</code></p> <p>Number</p> <p>Optional. The index into the current item list after which this item is inserted. If not supplied, or greater than the current list length, the new item is added at the end.</p>"},{"location":"user-interface-tools/control-objects/#returns_9","title":"Returns","text":"<p>Item object for <code>type = \"item\"</code>, or <code>null</code> for <code>type = \"separator\"</code>.</p>"},{"location":"user-interface-tools/control-objects/#find","title":"find()","text":"<p><code>listObj.find(text)</code></p>"},{"location":"user-interface-tools/control-objects/#description_74","title":"Description","text":"<p>Info</p> <p>For ListBox, DropDownList, or TreeView objects only.</p> <p>Looks in this object's <code>items</code> array for an item object with the given <code>text</code> value.</p>"},{"location":"user-interface-tools/control-objects/#parameters_24","title":"Parameters","text":"Parameter Type Description <code>text</code> String The text of the item to find."},{"location":"user-interface-tools/control-objects/#returns_10","title":"Returns","text":"<p>The ListItem object if found; otherwise <code>null</code>.</p>"},{"location":"user-interface-tools/control-objects/#remove","title":"remove()","text":"<p><code>containerObj.remove(index)</code></p> <p><code>containerObj.remove(text)</code></p> <p><code>containerObj.remove(child)</code></p>"},{"location":"user-interface-tools/control-objects/#description_75","title":"Description","text":"<ul> <li>For containers (Panel, Group): removes the specified child control from the container's <code>children</code> array.</li> <li>For ListBox, DropDownList, or TreeView objects: removes the specified item from this object's items array.</li> </ul> <p>No error results if the item does not exist.</p>"},{"location":"user-interface-tools/control-objects/#parameters_25","title":"Parameters","text":"Parameter Type Description <code>index</code>, <code>text</code>, <code>child</code> Number of String or Control object The item or child to remove, specified by <code>0</code>-based index, <code>text</code> value, or as a <code>control</code> object."},{"location":"user-interface-tools/control-objects/#returns_11","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#removeall","title":"removeAll()","text":"<p><code>listObj.removeAll()</code></p>"},{"location":"user-interface-tools/control-objects/#description_76","title":"Description","text":"<p>Info</p> <p>For ListBox, DropDownList, or TreeView objects only.</p> <p>Removes all items from the object's <code>items</code> array.</p>"},{"location":"user-interface-tools/control-objects/#returns_12","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#revealitem","title":"revealItem()","text":"<p><code>listObj.revealItem(item)</code></p>"},{"location":"user-interface-tools/control-objects/#description_77","title":"Description","text":"<p>Info</p> <p>For ListBox objects only.</p> <p>Scrolls the list to make the specified item visible, if necessary.</p>"},{"location":"user-interface-tools/control-objects/#parameters_26","title":"Parameters","text":"Parameter Type Description <code>item</code> Control object The item or child to reveal, a control object."},{"location":"user-interface-tools/control-objects/#returns_13","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#flashplayer-control-functions","title":"FlashPlayer control functions","text":"<p>Info</p> <p>For FlashPlayer objects only.</p>"},{"location":"user-interface-tools/control-objects/#limitations","title":"Limitations","text":"<p>There are limitations on how these functions can be used to control playback of Flash movies:</p> <ul> <li>Do not use stopMovie() and playMovie() to suspend and subsequently resume or restart an SWF file produced by Flex\u2122.</li> <li>The stopMovie() and playMovie() sequence does not make sense for some SWF files produced by Flash Authoring, depending on the exact details of how they were implemented. The sequence may not correctly reset the file to the initial state (when the <code>rewind</code> argument to playMovie() is <code>true</code>) nor suspend then resume the execution of the file (when <code>rewind</code> is <code>false</code>).</li> <li>Using stopMovie() from the player's hosting environment has no effect on an SWF file playing in a ScriptUI Flash Player element. It is, however, possible to produce an SWF using Flash Authoring that can stop itself in response to user interaction.</li> <li>Do not call playMovie() when an SWF file is already playing.</li> </ul>"},{"location":"user-interface-tools/control-objects/#invokeplayerfunction","title":"invokePlayerFunction()","text":"<p><code>flashPlayerObj.invokePlayerFunction(fnName, [arg1[,...argN]] )</code></p>"},{"location":"user-interface-tools/control-objects/#description_78","title":"Description","text":"<p>Invokes an ActionScript function defined in the Flash application.</p>"},{"location":"user-interface-tools/control-objects/#parameters_27","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>fnName</code></p> <p>String</p> <p>The name of a Flash ActionScript function that has been registered with the ExternalInterface object by the currently loaded SWF file; see Calling ActionScript functions from a ScriptUI script.</p> <p><code>args</code></p> <p>Any</p> <p>Optional. One or more arguments to pass through to the function, of these types:</p> <ul> <li>Array</li> <li>Boolean</li> <li><code>null</code></li> <li>Number</li> <li>Object</li> <li>String</li> <li><code>undefined</code></li> </ul>"},{"location":"user-interface-tools/control-objects/#returns_14","title":"Returns","text":"<p>The result of the invoked function, which must be one of the allowed types. The ActionScript <code>class</code> and <code>date</code> objects are not supported as return values.</p>"},{"location":"user-interface-tools/control-objects/#loadmovie","title":"loadMovie()","text":"<p><code>flashPlayerObj.loadMovie(file)</code></p>"},{"location":"user-interface-tools/control-objects/#description_79","title":"Description","text":"<p>Loads a movie into the Flash Player, and begins playing it. If you do not specify an associated movie file when creating the control, you must use this function to load one.</p>"},{"location":"user-interface-tools/control-objects/#parameters_28","title":"Parameters","text":"Parameter Type Description <code>file</code> File object The SWF file to load."},{"location":"user-interface-tools/control-objects/#returns_15","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#playmovie","title":"playMovie()","text":"<p><code>flashPlayerObj.playMovie(rewind)</code></p>"},{"location":"user-interface-tools/control-objects/#description_80","title":"Description","text":"<p>Restarts a movie that has been stopped.</p> <p>Warning</p> <p>Do not call when a movie is currently playing.</p>"},{"location":"user-interface-tools/control-objects/#parameters_29","title":"Parameters","text":"Parameter Type Description <code>rewind</code> Boolean When <code>true</code>, restarts the movie from the beginning; otherwise, starts playing from the point where it was stopped."},{"location":"user-interface-tools/control-objects/#returns_16","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#stopmovie","title":"stopMovie()","text":"<p><code>flashPlayerObj.stopMovie()</code></p>"},{"location":"user-interface-tools/control-objects/#description_81","title":"Description","text":"<p>Halts playback of the current movie.</p> <p>Note</p> <p>Does not work when called from the player's hosting environment.</p>"},{"location":"user-interface-tools/control-objects/#returns_17","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/control-objects/#control-event-handling-callbacks","title":"Control event-handling callbacks","text":"<p>The following events are signalled in certain types of controls. To handle the event, define a function with the corresponding name in the control object. Handler functions take no arguments and have no expected return values; see Defining behavior with event callbacks and listeners.</p>"},{"location":"user-interface-tools/control-objects/#onactivate","title":"onActivate","text":"<p>Called when the user gives a control the keyboard focus by clicking it or tabbing into it.</p>"},{"location":"user-interface-tools/control-objects/#onclick","title":"onClick","text":"<p>Called when the user clicks one of the following control types:</p> <ul> <li>Button</li> <li>Checkbox</li> <li>IconButton</li> <li>RadioButton</li> </ul>"},{"location":"user-interface-tools/control-objects/#onchange","title":"onChange","text":"<p>Called when the user finishes making a change in one of the following control types:</p> <ul> <li>DropDownList</li> <li>EditNumber</li> <li>EditText</li> <li>ListBox</li> <li>Scrollbar</li> <li>Slider</li> <li> <p>TreeView</p> </li> <li> <p>For EditNumber and EditText controls, called only when the change is complete-that is, when focus moves to another control, or the user types <code>ENTER</code>.</p> <ul> <li>The exact behavior depends on the creation parameter <code>enterKeySignalsOnChange</code>; see the EditText description.</li> </ul> </li> <li>For a Slider or Scrollbar, called when the user has finished dragging the position marker or has clicked the control.</li> <li>For a ListBox, DropDownList or TreeView control, called whenever the selection property changes.<ul> <li>This can happen when a script sets the property directly or removes a selected item from the list, or when the user changes the selection.</li> </ul> </li> </ul>"},{"location":"user-interface-tools/control-objects/#onchanging","title":"onChanging","text":"<p>Called for each incremental change in one of the following control types:</p> <ul> <li>EditNumber</li> <li>EditText</li> <li>Scrollbar</li> <li> <p>Slider</p> </li> <li> <p>For EditNumber and EditText controls, called for each keypress while the control has focus.</p> </li> <li>For a Slider or Scrollbar, called for any motion of the position marker.</li> </ul>"},{"location":"user-interface-tools/control-objects/#oncollapse","title":"onCollapse","text":"<p>Called when the user collapses (closes) a node in a TreeView control.</p> <p>The parameter to this function is the ListItem node object that was collapsed.</p>"},{"location":"user-interface-tools/control-objects/#ondeactivate","title":"onDeactivate","text":"<p>Called when the user removes keyboard focus from a previously active control by clicking outside it or tabbing out of it.</p>"},{"location":"user-interface-tools/control-objects/#ondoubleclick","title":"onDoubleClick","text":"<p>Called when the user double clicks an item in a ListBox control.</p> <p>The list's <code>selection</code> property is set to the clicked item.</p>"},{"location":"user-interface-tools/control-objects/#onenterkey","title":"onEnterKey","text":"<p>Warning</p> <p>This method/property is officially undocumented and was found via research. The information here may be inaccurate, and this whole method/property may disappear or stop working some point. Please contribute if you have more information on it!</p> <p>Called when the user presses return or enter in a EditText control.</p>"},{"location":"user-interface-tools/control-objects/#ondraw","title":"onDraw","text":"<p>Called when a container or control is about to be drawn. Allows the script to modify or control the appearance, using the control's associated ScriptUIGraphics object. Handler takes one argument, a DrawState object.</p>"},{"location":"user-interface-tools/control-objects/#onexpand","title":"onExpand","text":"<p>Called when the user expands (opens) a node in a TreeView control. The parameter to this function is the ListItem node object that was expanded.</p>"},{"location":"user-interface-tools/control-objects/#onshortcutkey","title":"onShortcutKey","text":"<p>Info</p> <p>For Windows objects only.</p> <p>Called when a shortcut-key sequence is typed that matches the shortcutKey value for an element in the active window.</p>"},{"location":"user-interface-tools/control-objects/#drawstate-object","title":"DrawState object","text":"<p>A helper object that describes an input state at the time of the triggering onDraw event. Contains properties that report whether the current control has the input focus, and the particular mouse button and key-press state.</p> <p>There is no object constructor.</p>"},{"location":"user-interface-tools/control-objects/#drawstate-object-properties","title":"DrawState object properties","text":"<p>The object contains the following read-only properties:</p> Property Type Behaviour <code>altKeyPressed</code> Boolean When <code>true</code>, the ALT key was pressed. (In Windows OS only.) <code>capsLockKeyPressed</code> Boolean When <code>true</code>, the CAPSLOCK key was pressed. <code>cmdKeyPressed</code> Boolean When <code>true</code>, the CMD key was pressed. (In Mac OS only.) <code>ctrlKeyPressed</code> Boolean When <code>true</code>, the CTRL key was pressed. <code>hasFocus</code> Boolean When <code>true</code>, the control containing this object has the input focus. <code>leftButtonPressed</code> Boolean When <code>true</code>, the left mouse button was pressed. <code>middleButtonPressed</code> Boolean When <code>true</code>, the middle mouse button was pressed. <code>mouseOver</code> Boolean When <code>true</code>, the cursor position was within the bounds of the control containing this object. <code>numLockKeyPressed</code> Boolean When <code>true</code>, the NUMLOCK key was pressed. <code>optKeyPressed</code> Boolean When <code>true</code>, the OPT key was pressed. (In Mac OS only.) <code>rightButtonPressed</code> Boolean When <code>true</code>, the right mouse button was pressed. <code>shiftKeyPressed</code> Boolean When <code>true</code>, the SHIFT key was pressed."},{"location":"user-interface-tools/defining-behavior-with-event-callbacks-and-listeners/","title":"Defining behavior with event callbacks and listeners","text":"<p>You must define the behavior of your controls in order for them to respond to user interaction. You can do this by defining event-handling callback functions as part of the definition of the control or window. To respond to a specific event, define a handler function for it, and assign a reference to that function in the corresponding property of the window or control object. Different types of windows and controls respond to different actions, or events:</p> <ul> <li>Windows generate events when the user moves or resizes the window. To handle these events, define callback functions for <code>onMove</code>, <code>onMoving</code>, <code>onResize</code>, <code>onResizing</code>.<ul> <li>To respond to the user opening or closing the window, define callback functions for <code>onShow</code> and <code>onClose</code>.</li> </ul> </li> <li>Button, RadioButton, and Checkbox controls generate events when the user clicks within the control bounds.<ul> <li>To handle the event, define a callback function for onClick.</li> </ul> </li> <li>EditNumber, EditText, Scrollbar, and Slider controls generate events when the content or value changes-that is, when the user types into an edit field, or moves the scroll or slider indicator. To handle these events, define callback functions for onChange and onChanging.</li> <li>ListBox, DropDownList, and TreeView controls generate events whenever the selection in the list changes. To handle the event, define a callback function for onChange.<ul> <li>The TreeView control also generates events when the user expands or collapses a node, handled by the onExpand and onCollapse callback functions.</li> </ul> </li> <li>The ListBox also generates an event when the user double-clicks an item. To handle it, define a callback function for the onDoubleClick event.</li> <li>Both containers and controls generate events just before they are drawn, that allow you to customize their appearance. To handle these events, define callback functions for onDraw.<ul> <li>Your handler can modify or control how the container or control is drawn using the methods defined in the control's associated ScriptUIGraphics object.</li> </ul> </li> <li>In Windows only, you can register a key sequence as a shortcutKey for a window or for most types of controls. To handle the key sequence, define a callback function for onShortcutKey in that control.</li> </ul>"},{"location":"user-interface-tools/defining-behavior-with-event-callbacks-and-listeners/#defining-event-handler-callback-functions","title":"Defining event-handler callback functions","text":"<p>Your script can define an event handler as a named function referenced by the callback property, or as an unnamed function defined inline in the callback property.</p> <ul> <li>If you define a named function, assign its name as the value of the corresponding callback property. For example:     <pre><code>function hasBtnsCbOnClick() { /* do something interesting */ }\nhasBtnsCb.onClick = hasBtnsCbOnClick;\n</code></pre></li> <li>For a simple, unnamed function, set the property value directly to the function definition:     <pre><code>UI-element.callback-name = function () { handler-definition };\n</code></pre></li> </ul> <p>Event-handler functions take no arguments.</p> <p>For example, the following sets the onClick property of the hasBtnsCb checkbox to a function that enables another control in the same dialog:</p> <pre><code>hasBtnsCb.onClick = function () {\n    this.parent.alertBtnsPnl.enabled = this.value;\n};\n</code></pre> <p>The following statements set the <code>onClick</code> event handlers for buttons that close the containing dialog, returning different values to the <code>show</code> method that invoked the dialog, so the calling script can tell which button was clicked:</p> <pre><code>buildBtn.onClick = function() {\n    this.parent.parent.close( 1 );\n};\n\ncancelBtn.onClick = function() {\n    this.parent.parent.close( 2 );\n};\n</code></pre>"},{"location":"user-interface-tools/defining-behavior-with-event-callbacks-and-listeners/#simulating-user-events","title":"Simulating user events","text":"<p>You can simulate user actions by sending an event notification directly to a window or control with the notify method. A script can use this method to generate events in the controls of a window, as if a user was clicking buttons, entering text, or moving the window. If you have defined an event-handler callback for the element, the <code>notify</code> method invokes it.</p> <p>The notify method takes an optional argument that specifies which event it should simulate. If a control can generate only one kind of event, notification generates that event by default.</p> <p>The following controls generate the <code>onClick</code> event:</p> <ul> <li><code>Button</code></li> <li><code>Checkbox</code></li> <li><code>IconButton</code></li> <li><code>RadioButton</code></li> </ul> <p>The following controls generate the <code>onChange</code> event:</p> <ul> <li><code>DropDownList</code></li> <li><code>EditNumber</code></li> <li><code>EditText</code></li> <li><code>ListBox</code></li> <li><code>Scrollbar</code></li> <li><code>Slider</code></li> <li><code>TreeView</code></li> </ul> <p>The following controls generate the <code>onChanging</code> event:</p> <ul> <li><code>EditNumber</code></li> <li><code>EditText</code></li> <li><code>Scrollbar</code></li> <li><code>Slider</code></li> </ul> <p>In the ListBox, double-clicking an item generates the <code>onDoubleClick</code> event.</p> <p>In <code>RadioButton</code> and <code>Checkbox</code> controls, the boolean value property automatically changes when the user clicks the control. If you use <code>notify()</code> to simulate a click, the value changes just as if the user had clicked.</p> <p>For example, if the value of a checkbox <code>hasBtnsCb</code> is <code>true</code>, this code changes the value to <code>false</code>:</p> <pre><code>if ( dlg.hasBtnsCb.value == true ) {\n    dlg.hasBtnsCb.notify(); // dlg.hasBtnsCb.value is now `false`\n}\n</code></pre>"},{"location":"user-interface-tools/defining-behavior-with-event-callbacks-and-listeners/#registering-event-listeners-for-windows-or-controls","title":"Registering event listeners for windows or controls","text":"<p>Another way to define the behavior of your windows and controls is register a handler function that responds to a specific type of event in that window or control. This technique allows you to respond to the cascading of an event through a hierarchy of containers and controls.</p> <p>Use addEventListener() or addEventListener() to register a handler. The function you register receives an event object (from the UIEvent base class) that encapsulates the event information. As an event cascades down through a hierarchy and back up through the hierarchy, your handler can respond at any level, or use the UIEvent object's stopPropagation() method to stop the event propagation at some level.</p> <p>You can register:</p> <ul> <li> <p>The name of a handler function defined in the extension that takes one argument, the event object. For example:     <pre><code>myButton.addEventListener( \"click\", myFunction );\n</code></pre></p> </li> <li> <p>A locally defined handler function that takes one argument, the event object. For example:     <pre><code>myButton.addEventListener( \"click\", \"function( e ) { /*handler code*/ }\" );\n</code></pre></p> </li> </ul> <p>The handler or registered code statement is executed when the specified event occurs in the target. A script can programmatically simulate an event by creating an event objects with ScriptUI.events.createEvent(), and passing it to an event target's dispatchEvent() function.</p> <p>You can remove a handler that has been previously registered by calling the event target's removeEventListener() function. The parameters you pass to this function must be identical to those passed to the addEventListener() call that registered the handler. Typically, a script would register all event handlers during initialization, and unregister them during termination; however, unregistering handlers on termination is not required.</p> <p>You can register for an event in a parent or ancestor object of the actual target; see the following section.</p> <p>The predefined types of <code>UIEvent</code> correspond to the event callbacks, as follows:</p> Callback UIEvent type <code>\"onChange\"</code> <code>\"change\"</code> <code>\"onChanging\"</code> <code>\"changing\"</code> <code>\"onClick\"</code> <code>\"click\"</code> (detail = 1) <code>\"onDoubleClick\"</code> <code>\"click\"</code> (detail = 2) <code>\"onEnterKey\"</code> <code>\"enterKey\"</code> <code>\"onMove\"</code> <code>\"move\"</code> <code>\"onMoving\"</code> <code>\"moving\"</code> <code>\"onResize\"</code> <code>\"resize\"</code> <code>\"onResizing\"</code> <code>\"resizing\"</code> <code>\"onShow\"</code> <code>\"show\"</code> <code>\"onActivate\"</code> <code>\"focus\"</code> <code>\"onDeactivate\"</code> <code>\"blur\"</code> <p>In addition, ScriptUI implements all types of W3C events according to the W3C DOM level 3 functional specification for UI events, with these modifications and exceptions:</p> <ul> <li>ScriptUI does not implement the <code>hasFeature()</code> method of the <code>DOMImplementation</code> interface; there is no way to query whether a given W3C DOM feature is implemented in ScriptUI.</li> <li>In ScriptUI, the W3C <code>EventTarget</code> interface is implemented by UI element objects (such as <code>Button</code>, <code>Window</code>, and so on).</li> <li>In ScriptUI, the W3C <code>AbstractView</code> object is a UI element (such as <code>Button</code>, <code>Window</code>, and so on).</li> <li>None of the \"namespace\" properties or methods are supported (such as <code>initEventNS</code> and <code>initMouseEventNS</code>).</li> </ul> <p>The ScriptUI implementation of W3C mouse events follows the W3C DOM level 3 functional specification for MouseEvent, with these differences:</p> <ul> <li>To create a <code>MouseEvent</code> instance, call <code>ScriptUI.events.createEvent( \"MouseEvent\" )</code>, rather than <code>DocumentEvent.createEvent( \"MouseEvent\" )</code>.</li> <li>The <code>getModifierState</code> method of the <code>MouseEvent</code> interface is not supported.</li> </ul> <p>The ScriptUI implementation of W3C keyboard events follows the W3C DOM level 3 functional specification for KeyboardEvent.</p>"},{"location":"user-interface-tools/defining-behavior-with-event-callbacks-and-listeners/#how-registered-event-handlers-are-called","title":"How registered event-handlers are called","text":"<p>When an event occurs in a target, all handlers that have been registered for that event and target are called. Multiple event handlers can be registered for the same event in different targets, even in targets of the same type. For example, if there is a dialog with two checkboxes, you might want to register a click handler for each checkbox object. You would do this, for example, if each checkbox reacts differently to the click.</p> <p>You can also register events for child objects with a parent object. If both checkboxes should react the same way to a mouse click, they require the same handler. In this case, you can register the handler with the parent window or container instead. When the click event occurs in either child control, the handler registered for the parent window is called.</p> <p>You can combine these two techniques, so that more than one action occurs in response to the event. That is, you can register a general event handler with the parent, and register a different, more specific handler for the same event with the child object that is the actual target.</p> <p>The rules for how multiple event handlers are called depend on three phases of event propagation, as follows:</p> <ul> <li>Capture phase - When an event occurs in an object hierarchy, it is captured by the topmost ancestor object at which a handler is registered (the window, for example). If no handler is registered for the topmost ancestor, ScriptUI looks for a handler for the next ancestor (the dialog, for example), on down through the hierarchy to the direct parent of actual target. When ScriptUI finds a handler registered for any ancestor of the target, it executes that handler then proceeds to the next phase.</li> <li>At-target phase - ScriptUI calls any handlers that are registered with the actual target object.</li> <li>Bubble phase - The event bubbles back out through the hierarchy; ScriptUI again looks for handlers registered for the event with ancestor objects, starting with the immediate parent, and working back up the hierarchy to the topmost ancestor. When ScriptUI finds a handler, it executes it and the event propagation is complete.</li> </ul> <p>For example, suppose a dialog window contains a group which contains a button. A script registers an event handler function for the click event at the Window object, another handler at the group object, and a third handler at the button object (the actual target).</p> <p>When the user clicks the button, the Window object's handler is called first (during the capture phase), then the button object's handler (during the at-target phase). Finally, ScriptUI calls the handler registered with the group object (during the bubble phase).</p> <p>If you register a handler at an ancestor object of the actual event target, you can specify the third argument to addEventListener(), so that the ancestor's handler responds only in the capture phase, not in the bubbling phase. For example, the following click handler, registered with the parent dialog object, responds only in the capture phase:</p> <pre><code>myDialog.addEventListener( \"click\", handleAllItems, true );\n</code></pre> <p>This value is <code>false</code> by default, so if it is not supplied, the handler can respond only in the bubbling phase when the object's descendent is the target, or when the object is itself the target of the event (the at-target phase).</p> <p>To distinguish which of multiple registered handlers is being executed at any given time, the event object provides the eventPhase, and the currentTarget, which In the capture and bubbling phases contains the ancestor of the target object at which the currently executing handler was registered.</p>"},{"location":"user-interface-tools/drawing-objects/","title":"Drawing objects","text":"<p>ScriptUI allows you to draw directly on controls to customize their appearance. You do this by calling methods of the ScriptUIGraphics object in response to the onDraw event (see Defining behavior with event callbacks and listeners).</p> <p>These methods take as parameters a number of helper objects that encapsulate drawing information, including the following:</p> Object Description ScriptUIGraphics Encapsulates the drawing methods. The graphics object is associated with each control is found in the control object's graphics property. ScriptUIBrush Describes the brush used to paint textures in a control. ScriptUIFont Describes the font used to write text into a control. ScriptUIImage Describes an image to be drawn in a control. ScriptUIPath Describes a drawing path for a figure to be drawn into a control. ScriptUIPen Describes the pen used to draw lines in a control. <p>For details of these objects, see Graphic customization objects.</p> <p>The <code>ScriptUIGraphics</code> object contains methods that create the other graphics objects; for example, <code>ScriptUIGraphics.newBrush()</code> creates a <code>ScriptUIBrush</code> instance with a specific color. These graphic objects are then used as property values in the <code>ScriptUIGraphics</code> object, which controls how a user-interface element is drawn on the screen. For example, if you put the new Brush object in the <code>backgroundColor</code> property, the element is drawn using that color for the background.</p> <p>To make the background of a window light gray, you could use this code:</p> <pre><code>g = myWindow.graphics;\nmyBrush = g.newBrush( g.BrushType.SOLID_COLOR, [ 0.75, 0.75, 0.75, 1 ] );\ng.backgroundColor = myBrush;\n</code></pre> <p>These examples in the Adobe ExtendScript SDK demonstrates how to use graphic customization objects:</p> Example Description ColorSelector.jsx Uses graphic objects to change the background color of a window as the user selects the color value with a slider. ColorPicker.jsx A more complex version of the color-selection dialog shows how to use additional graphics objects, including fonts and paths. <p>In addition, the Custom element class allows you to define completely customized elements of several types (ranges, buttons, lists), whose appearance is rendered entirely by your onDraw implementation.</p>"},{"location":"user-interface-tools/environment/","title":"Environment object","text":"<p>This global object is available through the ScriptUI.environment property.</p> <p>It defines attributes of the ScriptUI environment, and only contains one property.</p> <p>Due to this object including only a single property (that is itself an object), all of the relevant documentation will be contained in this page.</p>"},{"location":"user-interface-tools/environment/#environment-object-properties","title":"Environment object properties","text":"<p>The following element properties apply specifically to Environment elements:</p>"},{"location":"user-interface-tools/environment/#keyboard-state-object","title":"Keyboard state object","text":"<p>This JavaScript object reports the active state of the keyboard at any time; that is, the current key that is down and any modifiers that are pressed.</p> <p>This is independent of the event-handling system, which means that at any time in your script, you can use this object to check whether specific keys (such as keyboard modifiers) are pressed, and trigger alternative actions as a result.</p> <p>It is available through the ScriptUI.environment object:</p> <pre><code>var myKeyState = ScriptUI.environment.keyboardState;\n</code></pre> <p>The Keyboard State object contains the following properties:</p>"},{"location":"user-interface-tools/environment/#keyname","title":"keyName","text":"<p><code>ScriptUI.environment.keyboardState.keyName</code></p> <p>The name of the key currently pressed. This is the JavaScript name, a string such as <code>\"A\"</code> or <code>\"a\"</code>.</p> <p>Note</p> <p>This only works for single keys being pressed; holding multiple will report <code>undefined</code>.</p> <p>Modifier keys will report <code>undefined</code>; to get those, see shiftKey, ctrlKey, altKey, metaKey</p>"},{"location":"user-interface-tools/environment/#type","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/environment/#example","title":"Example","text":"<p>For example, with 'a' pressed:</p> <pre><code>var currentPressedKey = ScriptUI.environment.keyboardState.keyName;\n\nalert(currentPressedKey); // \"A\"\n</code></pre>"},{"location":"user-interface-tools/environment/#shiftkey-ctrlkey-altkey-metakey","title":"shiftKey, ctrlKey, altKey, metaKey","text":"<p><code>ScriptUI.environment.keyboardState.shiftKey</code></p> <p><code>ScriptUI.environment.keyboardState.ctrlKey</code></p> <p><code>ScriptUI.environment.keyboardState.altKey</code></p> <p><code>ScriptUI.environment.keyboardState.metaKey</code></p>"},{"location":"user-interface-tools/environment/#description","title":"Description","text":"<p><code>true</code> if the named modifier key is currently active.</p> <p>Note</p> <p><code>metaKey</code> captures both the <code>META</code> and <code>COMMAND</code> keys.</p>"},{"location":"user-interface-tools/environment/#type_1","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/environment/#example_1","title":"Example","text":"<p>For example, checking whether a modifier key is held during script execution:</p> <pre><code>var shiftHeld = ScriptUI.environment.keyboardState.shiftKey;\n\nif (shiftHeld) {\n    alert(\"User is holding shift!\");\n}\n</code></pre> <p>Or to check for keyboard modifier combinations:</p> <pre><code>var keyboardState = ScriptUI.environment.keyboardState;\n\nif (keyboardState.shiftKey &amp;&amp; keyboardState.altKey) {\n    alert(\"Shift and alt held!\");\n}\n</code></pre> <p>This can also be used within interface buttons as alternative to checking the modifiers via keyboard events, which can be more confusing and less user-intuitive, unless you're confident you're handling event states properly.</p> <p>For example:</p> <pre><code>button.onClick = function () {\n    if (ScriptUI.environment.keyboardState.shiftKey) {\n        // Special functionality for 'shift' key here\n        return;\n    }\n\n    // normal button behaviour here\n}\n</code></pre>"},{"location":"user-interface-tools/event-handling/","title":"Event handling","text":"<p>Several helper classes provide low-level event-handling capabilities.</p> <p>Event objects are normally created by ScriptUI and passed to your event handler. However, you can simulate a user action by constructing an event object using ScriptUI.events.createEvent(), and sending it to a target object's controlobj-dispatchEvent function.</p> <p>A helper object, Keyboard state object, provides global access to the keyboard state during function execution, outside the event-handling framework.</p>"},{"location":"user-interface-tools/event-handling/#uievent-base-class","title":"UIEvent Base Class","text":"<p>Encapsulates input event information for an event that propagates through a container and control hierarchy. This is a base class for the more specialized KeyboardEvent object and MouseEvent object.</p>"},{"location":"user-interface-tools/event-handling/#uievent-object-attributes","title":"UIEvent Object Attributes","text":"<p>Both keyboard and mouse events have these properties.</p>"},{"location":"user-interface-tools/event-handling/#bubbles","title":"bubbles","text":"<p><code>eventObj.bubbles</code></p>"},{"location":"user-interface-tools/event-handling/#description","title":"Description","text":"<p>When <code>true</code>, the event supports the bubbling phase.</p>"},{"location":"user-interface-tools/event-handling/#type","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#cancelable","title":"cancelable","text":"<p><code>eventObj.cancelable</code></p>"},{"location":"user-interface-tools/event-handling/#description_1","title":"Description","text":"<p>When <code>true</code>, the handler can call this object's preventDefault() method to cancel the default action of the event.</p>"},{"location":"user-interface-tools/event-handling/#type_1","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#currenttarget","title":"currentTarget","text":"<p><code>eventObj.currentTarget</code></p>"},{"location":"user-interface-tools/event-handling/#description_2","title":"Description","text":"<p>The element object where the currently executing handler was registered.</p> <p>This could be an ancestor of the target object, if the handler is invoked during the capture or bubbling phase.</p>"},{"location":"user-interface-tools/event-handling/#type_2","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/event-handling/#eventphase","title":"eventPhase","text":"<p><code>eventObj.eventPhase</code></p>"},{"location":"user-interface-tools/event-handling/#description_3","title":"Description","text":"<p>Current event propagation phase. One of these constants:</p> <ul> <li><code>Event.NOT_DISPATCHING</code></li> <li><code>Event.CAPTURING_PHASE</code></li> <li><code>Event.AT_TARGET</code></li> <li><code>Event.BUBBLING_PHASE</code></li> </ul>"},{"location":"user-interface-tools/event-handling/#type_3","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/event-handling/#target","title":"target","text":"<p><code>eventObj.target</code></p>"},{"location":"user-interface-tools/event-handling/#description_4","title":"Description","text":"<p>The element object where the event occurred.</p>"},{"location":"user-interface-tools/event-handling/#type_4","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/event-handling/#timestamp","title":"timeStamp","text":"<p><code>eventObj.timeStamp</code></p>"},{"location":"user-interface-tools/event-handling/#description_5","title":"Description","text":"<p>Time the event was initiated. A JavaScript Date object.</p>"},{"location":"user-interface-tools/event-handling/#type_5","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/event-handling/#type_6","title":"type","text":"<p><code>eventObj.type</code></p>"},{"location":"user-interface-tools/event-handling/#description_6","title":"Description","text":"<p>The name of the event that occurred. Predefined events types are:</p> <ul> <li><code>\"blur\"</code></li> <li><code>\"change\"</code></li> <li><code>\"changing\"</code></li> <li><code>\"enterKey\"</code></li> <li><code>\"focus\"</code></li> <li><code>\"move\"</code></li> <li><code>\"moving\"</code></li> <li><code>\"resize\"</code></li> <li><code>\"resizing\"</code></li> <li><code>\"show\"</code></li> </ul> <p>Additional type names apply specifically to keyboard and mouse events.</p>"},{"location":"user-interface-tools/event-handling/#type_7","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/event-handling/#view","title":"view","text":"<p><code>eventObj.view</code></p>"},{"location":"user-interface-tools/event-handling/#description_7","title":"Description","text":"<p>The container or control object that dispatched the event.</p>"},{"location":"user-interface-tools/event-handling/#type_8","title":"Type","text":"<p>Container or Control object</p>"},{"location":"user-interface-tools/event-handling/#uievent-object-methods","title":"UIEvent Object Methods","text":""},{"location":"user-interface-tools/event-handling/#inituievent","title":"initUIEvent()","text":"<p><code>eventObj.initUIEvent(eventName, bubble, isCancelable, view, detail)</code></p>"},{"location":"user-interface-tools/event-handling/#description_8","title":"Description","text":"<p>Modifies an event before it is dispatched to its targets. Takes effect only if UIEvent.eventPhase is <code>Event.NOT_DISPATCHING</code>.</p> <p>Ignored at all other phases.</p>"},{"location":"user-interface-tools/event-handling/#parameters","title":"Parameters","text":"Parameter Type Description <code>eventName</code> String The event name string. <code>bubble</code> Boolean When <code>true</code>, the event should be triggered in ancestors of the target object during the bubbling phase. <code>isCancelable</code> Boolean When <code>true</code>, the event can be cancelled. <code>view</code> Container or Control object The container or control object that dispatched the event. <code>detail</code> Any Details of the event, which vary according to the event type. The value is <code>1</code> or <code>2</code> for the click event, indicating a single or double click."},{"location":"user-interface-tools/event-handling/#returns","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/event-handling/#preventdefault","title":"preventDefault()","text":"<p><code>eventObj.preventDefault()</code></p>"},{"location":"user-interface-tools/event-handling/#description_9","title":"Description","text":"<p>Cancels the default action of this event, if this event is cancelable (that is, cancelable is true).</p> <p>For example, the default click action of an OK button is to close the containing dialog; this call prevents that behavior.</p>"},{"location":"user-interface-tools/event-handling/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/event-handling/#stoppropagation","title":"stopPropagation()","text":"<p><code>eventObj.stopPropagation()</code></p>"},{"location":"user-interface-tools/event-handling/#description_10","title":"Description","text":"<p>Stops event propagation (bubbling and capturing) after executing the handler or handlers at the current target.</p>"},{"location":"user-interface-tools/event-handling/#returns_2","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/event-handling/#keyboardevent-object","title":"KeyboardEvent Object","text":"<p>This type of object is passed to your registered event handler when a keyboard-input event occurs. The properties reflect the keypress and key modifier state at the time the keyboard event was generated.</p> <p>Info</p> <p>All properties are read only.</p>"},{"location":"user-interface-tools/event-handling/#keyboardevent-object-methods","title":"KeyboardEvent Object Methods","text":"<p>In addition to the properties defined for UIEvent base class, a keyboard event has these properties.</p>"},{"location":"user-interface-tools/event-handling/#altkey","title":"altKey","text":"<p><code>eventObj.altKey</code></p>"},{"location":"user-interface-tools/event-handling/#description_11","title":"Description","text":"<p>When <code>true</code>, the <code>ALT</code> key was active.</p> <p>Value is <code>undefined</code> if the <code>keyIdentifier</code> is for a modifier key.</p>"},{"location":"user-interface-tools/event-handling/#type_9","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#ctrlkey","title":"ctrlKey","text":"<p><code>eventObj.ctrlKey</code></p>"},{"location":"user-interface-tools/event-handling/#description_12","title":"Description","text":"<p>When <code>true</code>, the <code>CTRL</code> key was active.</p> <p>Value is <code>undefined</code> if the <code>keyIdentifier</code> is for a modifier key.</p>"},{"location":"user-interface-tools/event-handling/#type_10","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#metakey","title":"metaKey","text":"<p><code>eventObj.metaKey</code></p>"},{"location":"user-interface-tools/event-handling/#description_13","title":"Description","text":"<p>When <code>true</code>, the <code>META</code> or <code>COMMAND</code> key was active.</p> <p>Value is <code>undefined</code> if the <code>keyIdentifier</code> is for a modifier key.</p>"},{"location":"user-interface-tools/event-handling/#type_11","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#shiftkey","title":"shiftKey","text":"<p><code>eventObj.shiftKey</code></p>"},{"location":"user-interface-tools/event-handling/#description_14","title":"Description","text":"<p>When <code>true</code>, the <code>SHIFT</code> key was active.</p> <p>Value is <code>undefined</code> if the <code>keyIdentifier</code> is for a modifier key.</p>"},{"location":"user-interface-tools/event-handling/#type_12","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#keyidentifier","title":"keyIdentifier","text":"<p><code>eventObj.keyIdentifier</code></p>"},{"location":"user-interface-tools/event-handling/#description_15","title":"Description","text":"<p>The key whose keypress generated the event, as a W3C identifier contained in a string; for example, <code>\"U+0044\"</code>. See W3 Keyset Article.</p>"},{"location":"user-interface-tools/event-handling/#type_13","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/event-handling/#keylocation","title":"keyLocation","text":"<p><code>eventObj.keyLocation</code></p>"},{"location":"user-interface-tools/event-handling/#description_16","title":"Description","text":"<p>A constant that identifies where on the keyboard the keypress occurred.</p> <p>One of:</p> <ul> <li><code>DOM_KEY_LOCATION_STANDARD</code></li> <li><code>DOM_KEY_LOCATION_LEFT</code></li> <li><code>DOM_KEY_LOCATION_RIGHT</code></li> <li><code>DOM_KEY_LOCATION_NUMPAD</code></li> </ul>"},{"location":"user-interface-tools/event-handling/#type_14","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/event-handling/#keyname","title":"keyName","text":"<p><code>eventObj.keyName</code></p>"},{"location":"user-interface-tools/event-handling/#description_17","title":"Description","text":"<p>The key whose keypress generated the event, as a simple key name; for example <code>\"A\"</code>.</p>"},{"location":"user-interface-tools/event-handling/#type_15","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/event-handling/#type_16","title":"type","text":"<p><code>eventObj.type</code></p>"},{"location":"user-interface-tools/event-handling/#description_18","title":"Description","text":"<p>The name of the event that occurred. Key events types are:</p> <ul> <li><code>keyup</code></li> <li><code>keydown</code></li> </ul>"},{"location":"user-interface-tools/event-handling/#type_17","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/event-handling/#keyboardevent-object-methods_1","title":"KeyboardEvent Object Methods","text":"<p>In addition to the functions defined for UIEvent base class, a keyboard event has these functions.</p>"},{"location":"user-interface-tools/event-handling/#getmodifierstate","title":"getModifierState()","text":"<p><code>eventObj.getModifierState(keyIdentifier)</code></p>"},{"location":"user-interface-tools/event-handling/#description_19","title":"Description","text":"<p>Get the current modifier keys being used in this event.</p> <p>Note</p> <p>If you're trying to check whether keyboard modifier keys (alt/ctrl/meta/shift) are held down at any time in your script, not just in an event, see Keyboard state object.</p>"},{"location":"user-interface-tools/event-handling/#parameters_1","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>keyIdentifier</code></p> <p>String</p> <p>A string containing a modifier key identifier, one of: - <code>Alt</code> - <code>CapsLock</code> - <code>Control</code> - <code>Meta</code> - <code>NumLock</code> - <code>Scroll</code> - <code>Shift</code></p>"},{"location":"user-interface-tools/event-handling/#returns_3","title":"Returns","text":"<p>Boolean. <code>true</code> if the given modifier was active when the event occurred, <code>false</code> otherwise.</p>"},{"location":"user-interface-tools/event-handling/#initkeyboardevent","title":"initKeyboardEvent()","text":"<p><code>eventObj.initKeyboardEvent(eventName, bubble, isCancelable, view, keyID, keyLocation, modifiersList)</code></p>"},{"location":"user-interface-tools/event-handling/#description_20","title":"Description","text":"<p>Reinitializes the object, allowing you to change the event properties after construction. Arguments set the corresponding properties.</p>"},{"location":"user-interface-tools/event-handling/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>eventName</code> String The event name string. <code>bubble</code> Boolean When <code>true</code>, the event should be triggered in ancestors of the target object during the bubbling phase. <code>isCancelable</code> Boolean When <code>true</code>, the event can be cancelled. <code>view</code> Container or Control object The container or control object that dispatched the event. <code>keyID</code> String Sets the <code>keyIdentifier</code> value. <code>keyLocation</code> String Sets the <code>keyLocation</code>. value. <code>modifiersList</code> String A whitespace-separated string of modifier key names, such as \"Control Alt\"."},{"location":"user-interface-tools/event-handling/#returns_4","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/event-handling/#mouseevent-object","title":"MouseEvent Object","text":"<p>This type of object is passed to your registered event handler when a mouse-input event occurs. The properties reflect the button and modifier-key state and pointer position at the time the event was generated.</p> <p>In the case of nested elements, mouse event types are always targeted at the most deeply nested element. Ancestors of the targeted element can use bubbling to obtain notification of mouse events which occur within its descendent elements.</p>"},{"location":"user-interface-tools/event-handling/#mouseevent-object-attributes","title":"MouseEvent Object Attributes","text":"<p>In addition to the properties defined for UIEvent base class, a mouse event has these properties.</p> <p>Info</p> <p>All properties are read only.</p>"},{"location":"user-interface-tools/event-handling/#altkey_1","title":"altKey","text":"<p><code>eventObj.altKey</code></p>"},{"location":"user-interface-tools/event-handling/#description_21","title":"Description","text":"<p>When <code>true</code>, the <code>ALT</code> key was active.</p> <p>Value is <code>undefined</code> if the <code>keyIdentifier</code> is for a modifier key.</p>"},{"location":"user-interface-tools/event-handling/#type_18","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#button","title":"button","text":"<p><code>eventObj.button</code></p>"},{"location":"user-interface-tools/event-handling/#description_22","title":"Description","text":"<p>Which mouse button changed state.</p> <p>One of:</p> <ul> <li><code>0</code>: The left button of a two- or three-button mouse or the one button on a one-button mouse, used to activate a UI button or select text.</li> <li><code>1</code>: The middle button of a three-button mouse, or the mouse wheel.</li> <li><code>2</code>: The right button, used to display a context menu, if present.</li> </ul> <p>Some mice may provide or simulate more buttons, and values higher than <code>2</code> represent such buttons.</p>"},{"location":"user-interface-tools/event-handling/#type_19","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/event-handling/#clientx-and-clienty","title":"clientX and clientY","text":"<p><code>eventObj.clientX</code></p> <p><code>eventObj.clientY</code></p>"},{"location":"user-interface-tools/event-handling/#description_23","title":"Description","text":"<p>The horizontal and vertical coordinates at which the event occurred relative to the target object. The origin is the top left of the control or window, inside any border decorations.</p>"},{"location":"user-interface-tools/event-handling/#type_20","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/event-handling/#ctrlkey_1","title":"ctrlKey","text":"<p><code>eventObj.ctrlKey</code></p>"},{"location":"user-interface-tools/event-handling/#description_24","title":"Description","text":"<p>When <code>true</code>, the <code>CTRL</code> key was active.</p> <p>Value is <code>undefined</code> if the <code>keyIdentifier</code> is for a modifier key.</p>"},{"location":"user-interface-tools/event-handling/#type_21","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#detail","title":"detail","text":"<p><code>eventObj.detail</code></p>"},{"location":"user-interface-tools/event-handling/#description_25","title":"Description","text":"<p>Details of the event, which vary according to the event type.</p> <p>For the <code>click</code>, <code>mousedown</code>, and <code>mouseup</code> events, the value is <code>1</code> for a single click, or <code>2</code> for a double click.</p>"},{"location":"user-interface-tools/event-handling/#type_22","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/event-handling/#metakey_1","title":"metaKey","text":"<p><code>eventObj.metaKey</code></p>"},{"location":"user-interface-tools/event-handling/#description_26","title":"Description","text":"<p>When <code>true</code>, the <code>META</code> or <code>COMMAND</code> key was active.</p> <p>Value is <code>undefined</code> if the <code>keyIdentifier</code> is for a modifier key.</p>"},{"location":"user-interface-tools/event-handling/#type_23","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#relatedtarget","title":"relatedTarget","text":"<p><code>eventObj.relatedTarget</code></p>"},{"location":"user-interface-tools/event-handling/#description_27","title":"Description","text":"<ul> <li>For a <code>mouseover</code> event, the UI element the pointer is leaving, if any.</li> <li>For a <code>mouseout</code> event, the UI element the pointer is entering, if any.</li> </ul> <p>Otherwise <code>undefined</code>.</p>"},{"location":"user-interface-tools/event-handling/#type_24","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/event-handling/#screenx-and-screeny","title":"screenX and screenY","text":"<p><code>eventObj.screenX</code></p> <p><code>eventObj.screenY</code></p>"},{"location":"user-interface-tools/event-handling/#description_28","title":"Description","text":"<p>The horizontal and vertical coordinates at which the event occurred relative to the screen.</p>"},{"location":"user-interface-tools/event-handling/#type_25","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/event-handling/#shiftkey_1","title":"shiftKey","text":"<p><code>eventObj.shiftKey</code></p>"},{"location":"user-interface-tools/event-handling/#description_29","title":"Description","text":"<p>When <code>true</code>, the <code>SHIFT</code> key was active.</p> <p>Value is <code>undefined</code> if the <code>keyIdentifier</code> is for a modifier key.</p>"},{"location":"user-interface-tools/event-handling/#type_26","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/event-handling/#type_27","title":"type","text":"<p><code>eventObj.type</code></p>"},{"location":"user-interface-tools/event-handling/#description_30","title":"Description","text":"<p>The name of the event that occurred. Mouse events types are:</p> <ul> <li><code>\"mousedown\"</code></li> <li><code>\"mouseup\"</code></li> <li><code>\"mousemove\"</code></li> <li><code>\"mouseover\"</code></li> <li><code>\"mouseout\"</code></li> <li><code>\"click\"</code> (detail = 1 for single, 2 for double)</li> </ul> <p>The sequence of click events is: <code>mousedown</code>, <code>mouseup</code>, <code>click</code>.</p>"},{"location":"user-interface-tools/event-handling/#type_28","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/event-handling/#mouseevent-object-methods","title":"MouseEvent Object Methods","text":"<p>In addition to the functions defined for UIEvent base class, a mouse event has these functions.</p>"},{"location":"user-interface-tools/event-handling/#getmodifierstate_1","title":"getModifierState()","text":"<p><code>eventObj.getModifierState(keyIdentifier)</code></p>"},{"location":"user-interface-tools/event-handling/#description_31","title":"Description","text":"<p>Get the current modifier keys being used in this event.</p>"},{"location":"user-interface-tools/event-handling/#parameters_3","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>keyIdentifier</code></p> <p>String</p> <p>A string containing a modifier key identifier, one of:</p> <ul> <li><code>\"Alt\"</code></li> <li><code>\"CapsLock\"</code></li> <li><code>\"Control\"</code></li> <li><code>\"Meta\"</code></li> <li><code>\"NumLock\"</code></li> <li><code>\"Scroll\"</code></li> <li><code>\"Shift\"</code></li> </ul>"},{"location":"user-interface-tools/event-handling/#returns_5","title":"Returns","text":"<p>Boolean. <code>true</code> if the given modifier was active when the event occurred, <code>false</code> otherwise.</p>"},{"location":"user-interface-tools/event-handling/#initmouseevent","title":"initMouseEvent()","text":"<pre><code>eventObj.initMouseEvent(\n    eventName,\n    bubble,\n    isCancelable,\n    view,\n    detail,\n    screenX,\n    screenY,\n    clientX,\n    clientY,\n    ctrlKey,\n    altKey,\n    shiftKey,\n    metaKey,\n    button,\n    relatedTarge\n)\n</code></pre>"},{"location":"user-interface-tools/event-handling/#description_32","title":"Description","text":"<p>Reinitializes the object, allowing you to change the event properties after construction. Arguments set the corresponding properties.</p>"},{"location":"user-interface-tools/event-handling/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>eventName</code> String The event name string. <code>bubble</code> Boolean When <code>true</code>, the event should be triggered in ancestors of the target object during the bubbling phase. <code>isCancelable</code> Boolean When <code>true</code>, the event can be cancelled. <code>view</code> Container or Control object The container or control object that dispatched the event. <code>detail</code> Number Sets the single-double click value for the <code>click</code> event. <code>screenX, screenY</code> Number Sets the event coordinates relative to the screen. <code>clientX, clientY</code> Number Sets the event coordinates relative to the target object. The origin is the top left of the control or window, inside any border decorations. <code>ctrlKey, altKey, metaKey</code> Boolean Sets the modifier key states. <code>button</code> Number Sets the mouse button. <code>relatedTarget</code> Object Optional. Sets the related target, if any, for a <code>mouseover</code> or <code>mouseout</code> event."},{"location":"user-interface-tools/event-handling/#returns_6","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/graphic-customization-objects/","title":"Graphic customization objects","text":"<p>These objects provide the ability to customize the appearance of user-interface controls before they are drawn:</p> <ul> <li>ScriptUIGraphics object</li> <li>ScriptUIBrush object</li> <li>ScriptUIFont object</li> <li>ScriptUIImage object</li> <li>ScriptUIPath object</li> <li>ScriptUIPen object</li> </ul> <p>In addition, the Custom element class (if supported by the Adobe application you are using) allows you to define completely customized UI elements that are rendered by the application in a manner you define.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuigraphics-object","title":"ScriptUIGraphics Object","text":"<p>Most types of user-interface elements have a graphics property which contains an object of this type, which allows you to customize aspects of the element's appearance, such as the color and font. Use an onDraw callback function to set these properties or call the functions.</p> <p>All measurements are in pixels.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuigraphics-class-attributes","title":"ScriptUIGraphics Class Attributes","text":"<p>These static properties provide color type constants with which to create Pen and Brush objects.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#brushtype","title":"BrushType","text":""},{"location":"user-interface-tools/graphic-customization-objects/#description","title":"Description","text":"<p>Contains the enumerated constants for the type argument of <code>newBrush()</code>. Types are:</p> <ul> <li><code>SOLID_COLOR</code></li> <li><code>THEME_COLOR</code></li> </ul>"},{"location":"user-interface-tools/graphic-customization-objects/#type","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#pentype","title":"PenType","text":""},{"location":"user-interface-tools/graphic-customization-objects/#description_1","title":"Description","text":"<p>Contains the enumerated constants for the type argument of <code>newPen()</code>. Types are:</p> <ul> <li><code>SOLID_COLOR</code></li> <li><code>THEME_COLOR</code></li> </ul>"},{"location":"user-interface-tools/graphic-customization-objects/#type_1","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuigraphics-object-attributes","title":"ScriptUIGraphics Object Attributes","text":"<p>The object contains the following properties:</p>"},{"location":"user-interface-tools/graphic-customization-objects/#backgroundcolor","title":"backgroundColor","text":"<p><code>controlObj.graphics.backgroundColor</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_2","title":"Description","text":"<p>The background color of a container, or the parent background color for a control element.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#type_2","title":"Type","text":"<p>ScriptUIBrush object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#currentpath","title":"currentPath","text":"<p><code>controlObj.graphics.currentPath</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_3","title":"Description","text":"<p>The current drawing path for this object.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#type_3","title":"Type","text":"<p>ScriptUIPath object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#currentpoint","title":"currentPoint","text":"<p><code>controlObj.graphics.currentPoint</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_4","title":"Description","text":"<p>The current position in the drawing path for this object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#type_4","title":"Type","text":"<p>Point object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#disabledbackgroundcolor","title":"disabledBackgroundColor","text":"<p><code>controlObj.graphics.disabledBackgroundColor</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_5","title":"Description","text":"<p>The background color for the disabled state of a container, or the parent background color for the disabled state of a control element.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#type_5","title":"Type","text":"<p>ScriptUIBrush object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#disabledforegroundcolor","title":"disabledForegroundColor","text":"<p><code>controlObj.graphics.disabledForegroundColor</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_6","title":"Description","text":"<p>The foreground color for the disabled state of a container, or the parent foreground color for the disabled state of a control element.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#type_6","title":"Type","text":"<p>ScriptUIPen object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#font","title":"font","text":"<p><code>controlObj.graphics.font</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_7","title":"Description","text":"<p>The default font to use in writing text.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#type_7","title":"Type","text":"<p>ScriptUIFont object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#foregroundcolor","title":"foregroundColor","text":"<p><code>controlObj.graphics.foregroundColor</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_8","title":"Description","text":"<p>The foreground color for a container, or the parent foreground color of a control element.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#type_8","title":"Type","text":"<p>ScriptUIPen object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuigraphics-object-methods","title":"ScriptUIGraphics Object Methods","text":"<p>These functions directly customize the appearance of the associated element by drawing on the screen, or create the Pen and Brush objects used to populate the graphics object or pass to the drawing methods:</p>"},{"location":"user-interface-tools/graphic-customization-objects/#closepath","title":"closePath()","text":"<p><code>controlObj.graphics.closePath()</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_9","title":"Description","text":"<p>Defines a line from the current position to the start point of the current path (the value of <code>currentPath</code>), which closes the path.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#returns","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/graphic-customization-objects/#drawfocusring","title":"drawFocusRing()","text":"<p><code>controlObj.graphics.drawFocusRing(left, top[, width, height])</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_10","title":"Description","text":"<p>Draws a focus ring within the given rectangular region. This is a visual indicator showing that a given control has the keyboard focus (accepts keyboard input).</p> <p>In Mac OS, this is typically a light blue ring around the control.</p> <p>In Windows, it is typically a dashed-line rectangle around some part of the control.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters","title":"Parameters","text":"Parameter Type Description <code>left</code>, <code>top</code> Number Defines the top left corner of the region, in the coordinate system of the control that contains this graphics object. <code>width</code>, <code>height</code> Number Optional. The width and height of the region in pixels."},{"location":"user-interface-tools/graphic-customization-objects/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/graphic-customization-objects/#drawimage","title":"drawImage()","text":"<p><code>controlObj.graphics.drawImage(image, left, top[, width, height])</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_11","title":"Description","text":"<p>Draws an image within the given rectangular region, using the image file from the given image object that is appropriate to the control's current state.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>image</code> ScriptUIImage object The ScriptUIImage object containing the images to be drawn. <code>left</code>, <code>top</code> Number Defines the top left corner of the drawing region, in the coordinate system of the control that contains this graphics object. <code>width</code>, <code>height</code> Number Optional. The width and height of the drawing region in pixels. If specified, the image is stretched or shrunk to fit into the given rectangular area. If omitted, the image's original width or height is used."},{"location":"user-interface-tools/graphic-customization-objects/#returns_2","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/graphic-customization-objects/#drawoscontrol","title":"drawOSControl()","text":"<p><code>controlObj.graphics.drawOSControl()</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_12","title":"Description","text":"<p>Draws the platform-specific control associated with this element.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#returns_3","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/graphic-customization-objects/#drawstring","title":"drawString()","text":"<p><code>controlObj.graphics.drawString(text, pen, x, y, font)</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_13","title":"Description","text":"<p>Draws a string of text starting at a given point, using the given pen and font.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>text</code> String The text string. <code>pen</code> ScriptUIPen object The ScriptUIPen object for the drawing pen to use. <code>x</code>, <code>y</code> Number The origin point of the drawn text, in the coordinate system of the control that contains this graphics object. <code>font</code> ScriptUIFont object Optional. The ScriptUIFont object for the font to use. Default is the font value in this object."},{"location":"user-interface-tools/graphic-customization-objects/#returns_4","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/graphic-customization-objects/#ellipsepath","title":"ellipsePath()","text":"<p><code>controlObj.graphics.ellipsePath(left, top[, width, height])</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_14","title":"Description","text":"<p>Defines an elliptical path within a given rectangular area in the currentPath object, which can be filled using <code>fillPath()</code> or stroked using <code>strokePath()</code>.</p> <p>Returns a Point object for the upper left corner of the area, which is the new <code>currentPoint</code>.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>left</code>, <code>top</code> Number Defines the top left corner of the region, in the coordinate system of the control that contains this graphics object. <code>width</code>, <code>height</code> Number The width and height of the region in pixels."},{"location":"user-interface-tools/graphic-customization-objects/#returns_5","title":"Returns","text":"<p>Point object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#fillpath","title":"fillPath()","text":"<p><code>controlObj.graphics.fillPath(brush[, path])</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_15","title":"Description","text":"<p>Fills a path using a given painting brush.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>brush</code> ScriptUIBrush object The ScriptUIBrush object that defines the fill color. <code>path</code> ScriptUIPath object Optional, the ScriptUIPath object for the path. If not supplied, operates on the currentPath."},{"location":"user-interface-tools/graphic-customization-objects/#returns_6","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/graphic-customization-objects/#lineto","title":"lineto()","text":"<p><code>controlObj.graphics.lineto(x, y)</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_16","title":"Description","text":"<p>Adds a path segment to the <code>currentPath</code>, from the <code>currentPoint</code> to the specified point.</p> <p>Returns a Point object for the upper left corner of the area, which is the new <code>currentPoint</code>.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>x</code>, <code>y</code> Number The destination point of the line, in the coordinate system of the control that contains this graphics object."},{"location":"user-interface-tools/graphic-customization-objects/#returns_7","title":"Returns","text":"<p>Point object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#measurestring","title":"measureString()","text":"<p><code>controlObj.graphics.measureString(text, font[, boundingWidth])</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_17","title":"Description","text":"<p>Calculates the size needed to draw a text string in a given font.</p> <p>Returns a Dimension object object containing the height and width of the string in pixels.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_6","title":"Parameters","text":"Parameter Type Description <code>text</code> Text The text string to measure. <code>font</code> ScriptUIFont object Optional. The ScriptUIFont object for the font to use. Default is the font value in this object. <code>boundingWidth</code> Number Optional. A number that specifies the maximum width in pixels of the area in which the text might be placed. Use when wrapping a long string of text across multiple lines."},{"location":"user-interface-tools/graphic-customization-objects/#returns_8","title":"Returns","text":"<p>Dimension object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#moveto","title":"moveto()","text":"<p><code>controlObj.graphics.moveto(x, y)</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_18","title":"Description","text":"<p>Adds a given point to the <code>currentPath</code>, and makes it the <code>currentPoint</code>.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>x</code>, <code>y</code> Number The new coordinates, in the coordinate system of the control that contains this graphics object."},{"location":"user-interface-tools/graphic-customization-objects/#returns_9","title":"Returns","text":"<p>Point object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#newbrush","title":"newBrush()","text":"<p><code>controlObj.graphics.newBrush(type, color);</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_19","title":"Description","text":"<p>Creates a new painting brush.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_8","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p>type</p> <p>BrushType</p> <p>The brush type, one of these constants:</p> <ul> <li><code>ScriptUIGraphics.BrushType.SOLID_COLOR</code></li> <li><code>ScriptUIGraphics.BrushType.THEME_COLOR</code></li> </ul> <p>color</p> <p>Array of Numbers</p> <p>The brush color. If type is <code>SOLID_COLOR</code>, the color expressed as an array of three or four values, in the form <code>[R, B, G, A]</code> specifying the red, green, and blue values of the color and, optionally, the opacity (alpha channel).</p> <p>All values are numbers in the range <code>[0.0...1.0]</code>. An opacity of 0 is fully transparent, and an opacity of 1 is fully opaque. If the type is <code>THEME_COLOR</code>, the name string of the theme. Theme colors are defined by the host application.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#returns_10","title":"Returns","text":"<p>ScriptUIBrush object.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#newpath","title":"newPath()","text":"<p><code>controlObj.graphics.newPath();</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_20","title":"Description","text":"<p>Creates a new, empty drawing path in <code>currentPath</code>, replacing any existing path.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#returns_11","title":"Returns","text":"<p>ScriptUIPath object.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#newpen","title":"newPen()","text":"<p><code>controlObj.graphics.newPen(type, color, lineWidth);</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_21","title":"Description","text":"<p>Creates a new drawing pen.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_9","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p>type</p> <p>PenType</p> <p>The pen type, one of these constants:</p> <ul> <li><code>ScriptUIGraphics.PenType.SOLID_COLOR</code></li> <li><code>ScriptUIGraphics.PenType.THEME_COLOR</code></li> </ul> <p><code>color</code></p> <p>Array of Numbers</p> <p>The pen color. If type is SOLID_COLOR, the color expressed as an array of three or four values, in the form <code>[R, B, G, A]</code> specifying the red, green, and blue values of the color and, optionally, the opacity (alpha channel).</p> <p>All values are numbers in the range <code>[0.0...1.0]</code>. An opacity of 0 is fully transparent, and an opacity of 1 is fully opaque. If the type is <code>THEME_COLOR</code>, the name string of the theme. Theme colors are defined by the host application.</p> <p><code>lineWidth</code></p> <p>Pixels</p> <p>The width in pixels of the line this pen will draw. The line is centered around the current point. For example, if lineWidth is 2, drawing a line from (0, 10) to (5, 10) paints the two rows of pixels directly above and below y-position 10.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#returns_12","title":"Returns","text":"<p>ScriptUIPen object.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#rectpath","title":"rectPath()","text":"<p><code>controlObj.graphics.rectPath(left, top[, width, height])</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_22","title":"Description","text":"<p>Defines a rectangular path in the currentPath object, which can be filled using <code>fillPath()</code> or stroked using <code>strokePath()</code>.</p> <p>Returns a Point object for the upper left corner of the rectangle, which is the new currentPoint.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_10","title":"Parameters","text":"Parameter Type Description <code>left</code>, <code>top</code> Number Defines the top left corner of the region, in the coordinate system of the control that contains this graphics object. <code>width</code>, <code>height</code> Number The width and height of the region in pixels."},{"location":"user-interface-tools/graphic-customization-objects/#returns_13","title":"Returns","text":"<p>Point object</p>"},{"location":"user-interface-tools/graphic-customization-objects/#strokepath","title":"strokePath()","text":"<p><code>controlObj.graphics.fillPath(pen[, path])</code></p>"},{"location":"user-interface-tools/graphic-customization-objects/#description_23","title":"Description","text":"<p>Strokes the path segments of a path with a given drawing pen.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#parameters_11","title":"Parameters","text":"Parameter Type Description <code>pen</code> ScriptUIPen object The ScriptUIPen object that defines the color and line width. <code>path</code> ScriptUIPath object Optional, the ScriptUIPath object for the path. If not supplied, operates on the currentPath."},{"location":"user-interface-tools/graphic-customization-objects/#returns_14","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuibrush-object","title":"ScriptUIBrush Object","text":"<p>A helper object that encapsulates the qualities of a brush used to paint fill into a path in a control. Create with the <code>newBrush()</code> method of the <code>ScriptUIGraphics</code> object.</p> <p>Used as a value of <code>backgroundColor</code> and <code>disabledBackgroundColor</code>.</p> <p>Passed as an argument to <code>fillPath()</code>.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuibrush-object-attributes","title":"ScriptUIBrush Object Attributes","text":"<p>The object contains the following properties:</p> <p>Property</p> <p>Type</p> <p>Description</p> <p><code>color</code> </p> <p>Array of Number </p> <p>The paint color to use when the type is <code>SOLID_COLOR</code>. An array in the form [R, B, G, A] specifying the red, green, blue values of the color and the opacity (alpha channel) value as numbers in the range [0.0...1.0]. An opacity of 0 is fully transparent, and an opacity of 1 is fully opaque.</p> <p><code>theme</code></p> <p>String</p> <p>The name of a color theme to use as a painting texture when the type is <code>THEME_COLOR</code>. Theme colors are defined by the host application.</p> <p><code>type</code></p> <p>Number</p> <p>The brush type, one of these constants:</p> <ul> <li><code>ScriptUIGraphics.BrushType.SOLID_COLOR</code></li> <li><code>ScriptUIGraphics.BrushType.THEME_COLOR</code></li> </ul>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuifont-object","title":"ScriptUIFont Object","text":"<p>A helper object that encapsulates the qualities of a font used to draw text into a control. Create with the <code>newFont()</code> method of the <code>ScriptUI</code> class.</p> <p>Used as a value of font.</p> <p>Passed as an argument to <code>drawString()</code> and <code>measureString()</code>.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuifont-object-attributes","title":"ScriptUIFont Object Attributes","text":"<p>The object contains the following properties:</p> <p>Property</p> <p>Type</p> <p>Description</p> <p><code>family</code></p> <p>String</p> <p>The font family name.</p> <p><code>name</code></p> <p>String</p> <p>The complete font name, consisting of the family and style, if specified.</p> <p><code>size</code></p> <p>Number</p> <p>The font point size.</p> <p><code>style</code></p> <p>Object</p> <p>The font style. One of these constants:</p> <ul> <li><code>ScriptUI.FontStyle.REGULAR</code></li> <li><code>ScriptUI.FontStyle.BOLD</code></li> <li><code>ScriptUI.FontStyle.ITALIC</code></li> <li><code>ScriptUI.FontStyle.BOLDITALIC</code></li> </ul> <p><code>substitute</code></p> <p>String</p> <p>The name of a substitution font, a fallback font to substitute for this font if the requested font family or style is not available.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuiimage-object","title":"ScriptUIImage Object","text":"<p>A helper object that encapsulates a set of images that can be drawn into a control. Alternate versions of an image can reflect the state, such as a dimmed version for a disabled control.</p> <p>An object of this type is created automatically when a script uses a pathname or File object to set the image property of an Image, IconButton, or ListItem object; the new object becomes the value of that property.</p> <p>You can create this object explicitly using the <code>newImage()</code> method of the <code>ScriptUI</code> class. When you do this, you can specify alternate versions of the image to be used for different control states, such as enabled, disabled, and rollover.</p> <p>This object is passed as an argument to <code>drawImage()</code>.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuiimage-object-attributes","title":"ScriptUIImage Object Attributes","text":"<p>The object contains the following read-only properties:</p> Property Type Description <code>format</code> String The image format. Scripts can define images in <code>JPEG</code> and <code>PNG</code> format. Applications can define images in the <code>resource</code> format. <code>name</code> String The image name, either a file name or resource name. <code>pathname</code> String The full path to the file that contains the image. <code>size</code> Dimension A Dimension object that defines the size of the image in pixels."},{"location":"user-interface-tools/graphic-customization-objects/#scriptuipath-object","title":"ScriptUIPath Object","text":"<p>A helper object that encapsulates a drawing path for a figure to be drawn into a control. Create the object the <code>newPath()</code> method and define path segments with the <code>moveto()</code>, <code>lineto()</code>, <code>rectPath()</code>, and <code>ellipsePath()</code> methods of the <code>ScriptUIGraphics</code> object.</p> <p>Used as a value of currentPath, where it is acted upon by <code>closePath()</code> and other methods.</p> <p>Can be passed as an optional argument to <code>fillPath()</code> and <code>strokePath()</code> (which otherwise act upon the <code>currentPath</code>).</p> <p>The class defines no properties or methods.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuipen-object","title":"ScriptUIPen Object","text":"<p>A helper object that encapsulates the qualities of a pen used to stroke path segments in a control. Create with the <code>newPen()</code> method of the <code>ScriptUIGraphics</code> object.</p> <p>Used as a value of <code>foregroundColor</code> and <code>disabledForegroundColor</code>.</p> <p>Passed as an argument to <code>drawString()</code> and <code>strokePath()</code>.</p>"},{"location":"user-interface-tools/graphic-customization-objects/#scriptuipen-object-attributes","title":"ScriptUIPen Object Attributes","text":"<p>The object contains the following properties:</p> <p>Property</p> <p>Type</p> <p>Description</p> <p><code>color</code> </p> <p>Array of Number </p> <p>The paint color to use when the type is SOLID_COLOR. An array in the form [R, B, G, A] specifying the red, green, blue values of the color and the opacity (alpha channel) value as numbers in the range [0.0...1.0]. An opacity of 0 is fully transparent, and an opacity of 1 is fully opaque.</p> <p><code>lineWidth</code></p> <p>Number</p> <p>The pixel width of the drawing line.</p> <p><code>theme</code></p> <p>String</p> <p>The name of a color theme to use for drawing when the type is <code>THEME_COLOR</code>. Theme colors are defined by the host application.</p> <p><code>type</code></p> <p>Number</p> <p>The pen type, one of these constants:</p> <ul> <li><code>ScriptUIGraphics.PenType.SOLID_COLOR</code></li> <li><code>ScriptUIGraphics.PenType.THEME_COLOR</code></li> </ul>"},{"location":"user-interface-tools/graphic-customization-objects/#custom-element-class","title":"Custom element class","text":"<p>Elements of the Custom class differ from typical UI elements in that they have no default appearance; the script which creates a custom element is responsible for drawing it by defining the element's onDraw event handler function. This allows scripts to create any appearance for custom elements that can be rendered via the drawing functions defined for a UI element's graphics object.</p> <p>Custom elements have the same common properties that other types of control elements have (see Common properties). The different types of custom elements have additional properties.</p> <p>The Custom element class has the following types of elements:</p> <p>Element</p> <p>Description</p> <p><code>customBoundedValue</code></p> <p>Can be used to implement controls whose 'value' can vary within minimum and maximum bounds, like the Progressbar, Slider, and Scrollbar. Has the same additional properties as those controls:</p> <ul> <li><code>value</code></li> <li><code>minvalue</code></li> <li><code>maxvalue</code></li> <li><code>shortcutKey</code></li> </ul> <p>If the value property is changed, the control receives an onChange event notification, followed by an onDraw event notification, so the element can redraw itself with the changed state.</p> <p><code>customButton</code></p> <p>Can be used to implement various types of button controls, like the <code>Button</code>, <code>IconButton</code> with text, <code>Checkbox</code>, and so on. Additional properties are:</p> <ul> <li><code>image</code></li> <li><code>shortcutKey</code></li> <li><code>text</code></li> <li><code>value</code></li> </ul> <p><code>customView</code></p> <p>Has an <code>image</code> property that allows a script to define an image to display.</p> <p>If no <code>onDraw</code> function is defined and the image property is set, the default appearance is simply the specified image, rendered centered in the bounds of the element.</p> <p>A custom element's onDraw event handler function is not called when the mouse enters or leaves the screen region occupied by the element.</p> <p>If you need to force a drawing update in such cases, you must call <code>notify(\"onDraw\")</code> for the element, in response to a mouseOver or mouseout event for the element.</p> <p>In the following example, the script forces a visual update for a customButton element when the mouse enters or leaves the button, by handling mouseover or mouseout events for the custom button:</p> <pre><code>var res =\n\"\"\"palette {\n    text:'Custom elements demo',\n    properties:{ closeOnKey:'OSCmnd+W', resizeable:true },\n    customBtn: Custom {\n        type:'customButton',\n        text:'Redraw original image'\n    },\n    customImageViewer: Custom {\n        type:'customView',\n        alignment:['fill','fill']\n    }\n}\"\"\";\n\nvar w = new Window (res);\nw.customBtn.onDraw = drawButton;\nw.customBtn.addEventListener (\"mouseover\", btnMouseEventHandler, false);\nw.customBtn.addEventListener (\"mouseout\", btnMouseEventHandler, false);\n\n// ...\n\nfunction btnMouseEventHandler (event) {\n    try {\n        //\n        Redraw the button on mouseover and mouseout\n        event.target.notify(\"onDraw\");\n    } catch (e) {\n        ...\n    }\n}\n\nfunction drawButton (drawingState) {\n    ...\n}\n</code></pre>"},{"location":"user-interface-tools/layoutmanager-object/","title":"LayoutManager object","text":"<p>Controls the automatic layout behavior for a window or container. The subclass AutoLayoutManager implements the default automatic layout behavior.</p>"},{"location":"user-interface-tools/layoutmanager-object/#autolayoutmanager-object-constructor","title":"AutoLayoutManager object constructor","text":"<p>Create an instance of the <code>AutoLayoutManager</code> class with the new operator:</p> <pre><code>myWin.layout = new AutoLayoutManager( myWin );\n</code></pre> <p>An instance is automatically created when you create a <code>Window</code> or container (<code>group</code> or <code>panel</code>) object, and referenced by the container's layout property. This instance implements the default layout behavior unless you override it.</p>"},{"location":"user-interface-tools/layoutmanager-object/#autolayoutmanager-object-properties","title":"AutoLayoutManager object properties","text":"<p>The default object has no predefined properties, but a script can assign arbitrary properties to an object it creates, to store data needed by the script-defined layout algorithm.</p>"},{"location":"user-interface-tools/layoutmanager-object/#autolayoutmanager-object-functions","title":"AutoLayoutManager object functions","text":""},{"location":"user-interface-tools/layoutmanager-object/#layout","title":"layout()","text":"<p><code>windowObj.layout.layout( recalculate )</code></p>"},{"location":"user-interface-tools/layoutmanager-object/#description","title":"Description","text":"<p>Invokes the automatic layout behavior for the managed container. Adjusts sizes and positions of the child elements of this window or container according to the placement and alignment property values in the parent and children.</p> <p>Invoked automatically the first time the window is displayed. Thereafter, the script must invoke it explicitly to change the layout in case of changes in the size or position of the parent or children.</p>"},{"location":"user-interface-tools/layoutmanager-object/#parameters","title":"Parameters","text":"Parameter Type Description <code>recalculate</code> Boolean Optional. When <code>true</code>, forces the layout manager to recalculate the container size for this and any child containers. Default is <code>false</code>."},{"location":"user-interface-tools/layoutmanager-object/#returns","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/layoutmanager-object/#resize","title":"resize()","text":"<p><code>windowObj.layout.resize()</code></p>"},{"location":"user-interface-tools/layoutmanager-object/#description_1","title":"Description","text":"<p>Resizes and moves the child elements of the managed container, according to the alignment values for each child of the container, after the container has been resized by the user or by a script.</p> <p>See Automatic layout for details of how alignment affects an element's size and location.</p>"},{"location":"user-interface-tools/layoutmanager-object/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/localization-in-scriptui-objects/","title":"Localization in ScriptUI objects","text":"<p>For portions of your user interface that are displayed on the screen, you may want to localize the displayed text. You can localize the display strings in any ScriptUI object simply and efficiently, using the global <code>localize</code> function. This function takes as its argument a localization object containing the localized versions of a string.</p> <p>For complete details of this ExtendScript feature, see Localizing ExtendScript strings.</p> <p>A localization object is a JavaScript object literal whose property names are locale names, and whose property values are the localized text strings. The locale name is an identifier as specified in the ISO 31 standard. In this example, a <code>btnText</code> object contains localized text strings for several locales. This object supplies the text for a Button to be added to a window <code>win</code>:</p> <pre><code>btnText = { en: \"Yes\", de: \"Ja\", fr: \"Oui\" };\nb1 = win.add ( \"button\", undefined, localize( btnText ) );\n</code></pre> <p>The <code>localize</code> function extracts the proper string for the current locale. It matches the current locale and platform to one of the object's properties and returns the associated string. On a German system, for example, the property <code>de</code> provides the string <code>\"Ja\"</code>.</p> <p>When your script uses localization to provide language-appropriate strings for user-interface elements, it should also take advantage of the Automatic layout feature. The layout manager can determine the best size for each user-interface element based on its localized <code>text</code> value, automatically adjusting the layout of your script-defined dialogs to allow for the varying widths of strings for different languages.</p>"},{"location":"user-interface-tools/localization-in-scriptui-objects/#variable-values-in-localized-strings","title":"Variable values in localized strings","text":"<p>The localize function allows you to include variables in the string values. Each variable is replaced with the result of evaluating an additional argument.</p> <p>For example:</p> <pre><code>var today = {\n    en: \"Today is %1/%2.\",\n    de: \"Heute ist der %2.%1.\"\n};\nvar date = new Date();\nWindow.alert( localize( today, date.getMonth() + 1, date.getDate() ) );\n</code></pre>"},{"location":"user-interface-tools/localization-in-scriptui-objects/#enabling-automatic-localization","title":"Enabling automatic localization","text":"<p>If you do not need variable replacement, you can use automatic localization. To turn on automatic localization, set the global value:</p> <pre><code>$.localization = true\n</code></pre> <p>When it is enabled, you can specify a localization object directly as the value of any property that takes a localizable string, without using the <code>localize</code> function. For example:</p> <pre><code>var btnText = { en: \"Yes\", de: \"Ja\", fr: \"Oui\" };\nb1 = win.add( \"button\", undefined, btnText );\n</code></pre> <p>The <code>localize</code> function always performs its translation, regardless of the setting of the <code>$.localize</code> variable.</p> <p>For example:</p> <pre><code>// Only works if the $.localize = true\nvar b1 = win.add ( \"button\", undefined, btnText );\n// Always works, regardless of $.localize value\nvar b1 = win.add ( \"button\", undefined, localize( btnText ) );\n</code></pre> <p>If you need to include variables in the localized strings, use the <code>localize</code> function.</p>"},{"location":"user-interface-tools/managing-control-titles/","title":"Managing control titles","text":"<p>User interface elements often need a title or label to identify their purpose, with the title placed near the element it identifies. As shown by examples in Automatic layout, you can use a <code>statictext</code> element as a title or label, and use the automatic layout mechanism to control the placement of such a title relative to the element it identifies.</p> <p>The title-layout mechanism provides a simpler way to accomplish this task for many common cases. It allows you to define an element's title and its spacial relationship with the graphic representation of the object it identifies, without the need for additional <code>statictext</code> and container elements. Title layout operates on an element's optional title and titleLayout properties.</p> <p>It treats this title and the element's graphic representation as two separate objects whose relative positions are controlled according to layout rules within a virtual container that encloses both objects. This is similar to the operation of the automatic layout mechanism, but within a more limited scope.</p> <p>Title layout is available for these types of UI elements:</p> <ul> <li>DropDownList</li> <li>FlashPlayer</li> <li>IconButton</li> <li>Image</li> <li>TabbedPanel</li> </ul> <p>For most of these element types, the title typically appears outside the element itself, and the virtual container is an imaginary line surrounding the title and the separate element. For the IconButton, the title appears inside the bounds of the button, and the virtual container is defined by the outer bounds of the element. The same principles apply in both cases.</p> <ul> <li>The title property is a String that defines a text label for a UI element. The title can appear to the left or right of the graphic element, above or below it, or superimposed over the center of the graphic element; the placement is controlled by the titleLayout property.</li> <li>The titleLayout property is an Object containing properties that specify:<ul> <li>The title's character width;</li> <li>The title's justification within the character width;</li> <li>How the title should be truncated if necessary;</li> <li>The orientation, alignment, and spacing of the title with respect to the object it identifies;</li> <li>The margins within the virtual container that surrounds the title and its related object.</li> </ul> </li> </ul> <p>All <code>titleLayout</code> properties are optional; the element types that use this mechanism have default values for each property. Complete details are provided in the reference section; see titleLayout.</p> <p>The following sections provide examples that show how to use title layout to achieve many different layouts.</p>"},{"location":"user-interface-tools/managing-control-titles/#title-alignment-and-orientation","title":"Title alignment and orientation","text":"<p>Unlike automatic layout, title layout uses the alignment property to specify the orientation of the title and graphic element, and how the title aligns to the graphic element. This property contains a 2-element array, where the first element specifies horizontal alignment and the second specifies vertical alignment. The allowed values for these are the same as those used by automatic layout (see Aligning children), except that the <code>fill</code> value is not allowed.</p> <ul> <li> <p>To achieve a row orientation where the title appears to the left or right of the graphic element, define horizontal alignment as left or right and vertical alignment as <code>center</code>, <code>top</code>, or <code>bottom</code>:     <pre><code>button.titleLayout = { alignment: [\"right\", \"center\"] };\n</code></pre></p> <p> - To achieve a column orientation where the title appears above or below the graphic element, define vertical alignment as <code>top</code> or <code>bottom</code>, and horizontal alignment as <code>center</code>: <pre><code>image.titleLayout = { alignment: [\"center\", \"bottom\"] };\n</code></pre></p> <p> - To achieve a stack orientation where the title appears superimposed upon the graphic element, define both vertical and horizontal alignment as <code>center</code>. This orientation is mainly useful with the <code>iconbutton</code> or <code>image</code> element types; it does not make sense to superimpose a title over a dropdownlist, for instance. In this example, the button\"s title is centered over its iconic image: <pre><code>button.title = \"Get information\";\nbutton.titleLayout = { alignment: [\"center\", \"center\"] };\n</code></pre></p> <p> - With row orientation, you can control whether the title aligns to the top, center, or bottom of the graphic element. In this example, the title is placed to the left of the image, aligned at the top edge: <pre><code>image.titleLayout = { alignment: [\"left\", \"top\"] };\n</code></pre></p> <p> - Use <code>spacing</code> to override the default number of pixels separating the title from the graphic element. In this example, titleLayout is configured to place the title 15 pixels above the panel: <pre><code>panel.title = \"Image format\";\npanel.titleLayout = { alignment: [\"center\", \"top\"], spacing: 15 };\n</code></pre></p> <p></p> </li> </ul>"},{"location":"user-interface-tools/managing-control-titles/#title-character-width-and-justification","title":"Title character width and justification","text":"<ul> <li> <p>To override the automatically calculated title width, define a positive non-zero value for the <code>characters</code> property. This reserves enough space in the title area to hold the specified number of \"X\" characters. This is useful when an element's title can change (for localized values, for instance) and you want to reserve enough space to fit all the expected values without truncation or affecting the overall layout.     <pre><code>droplist.titleLayout = { alignment: [\"left\", \"center\"], characters: 20 };\n</code></pre></p> <p> - When a <code>characters</code> value specifies a width greater than the default title width, you can set the <code>justify</code> property to control how the text of the title is justified within the space reserved for it. The value <code>left</code> places the text at the left end of the space, leaving blank space on the right; <code>right</code> places the text at the right end of the space, leaving blank space on the left; and <code>center</code> places the text in the middle of the space, dividing any blank space evenly on both sides of the text. <pre><code>droplist.titleLayout = { alignment: [\"left\", \"center\"],\n                         characters: 20,\n                         justify: \"right\" };\n</code></pre></p> <p> - This example demonstrates using <code>characters</code> and <code>justify</code> to vertically align the colons at the ends of all the dropdownlist control titles in a group. The same <code>characters</code> value is used for each element\"s <code>title</code>, and all are right-justified: <pre><code>w.ddl1 = w.add(\"dropdownlist { title: \"Image format:\" }\");\nw.ddl2 = w.add(\"dropdownlist { title: \"Background color:\" }\");\nw.ddl3 = w.add(\"dropdownlist { title: \"Text color:\" }\");\nw.ddl1.titleLayout = { alignment: [\"left\", \"center\"], spacing: 3,\n                       characters: 16, justify: \"right\" };\nw.ddl2.titleLayout = { alignment: [\"left\", \"center\"], spacing: 3,\n                       characters: 16, justify: \"right\" };\nw.ddl3.titleLayout = { alignment: [\"left\", \"center\"], spacing: 3,\n                       characters: 16, justify: \"right\" };\n</code></pre></p> <p></p> </li> </ul>"},{"location":"user-interface-tools/managing-control-titles/#title-truncation","title":"Title truncation","text":"<p>If the space reserved for a title is not wide enough to display its entire text, set the <code>truncate</code> property to control the appearance of the truncated text. If <code>truncate</code> is <code>middle</code>, characters are removed from the middle of the text and replaced with an ellipsis (...). For the value <code>end</code>, characters are removed from the end of the text and replaced with an ellipsis. If <code>truncate</code> is <code>none</code> or is not defined, characters are removed from the end, without any replacement ellipsis character.</p> <p>This example demonstrates the effect of all three options on the same title string:</p> <pre><code>w.btn1 = w.add(\"iconbutton { title: 'Start 123456 End', image: 'SystemWarningIcon' }\");\nw.btn2 = w.add(\"iconbutton { title: 'Start 123456 End', image: 'SystemWarningIcon' }\");\nw.btn3 = w.add(\"iconbutton { title: 'Start 123456 End', image: 'SystemWarningIcon' }\");\nw.btn1.titleLayout = { characters: 8, truncate: 'middle' };\nw.btn2.titleLayout = { characters: 8, truncate: 'end' };\nw.btn3.titleLayout = { characters: 8, truncate: 'none' };\n</code></pre> <p></p>"},{"location":"user-interface-tools/managing-control-titles/#margins-around-the-title-and-graphic-object","title":"Margins around the title and graphic object","text":"<p>The <code>margins</code> property specifies the number of pixels separating each edge of an element from the visible content within that element. This value overrides the default margin settings (no margins for most element types, 6 pixels at each edge for <code>iconbutton</code>).</p> <ul> <li>For <code>iconbutton</code>, the margins value controls the padding between the button's frame and its title and icon image.</li> <li>For other element types, <code>margins</code> controls the padding between the imaginary border surrounding the union of the bounding boxes of the title and graphic object, which makes the space occupied by an element larger than its default measurements.</li> </ul> <p>This example demonstrates overriding the default margins for <code>iconbutton</code> and <code>dropdownlist</code> elements.</p> <p>The lists are enclosed in panels to create artificial borders around them:</p> <pre><code>w.btn1 = w.add(\"iconbutton { title: 'Default margins', image: 'SystemWarningIcon' }\");\n\nw.btn2 = w.add(\"iconbutton { title: 'Extra T/B margins', image: 'SystemWarningIcon' }\");\nvar defaultBtnMargins = w.btn2.titleLayout.margins;\nw.btn2.titleLayout = { margins: [defaultBtnMargins[0], 15, defaultBtnMargins[2], 15] };\n\nw.panel1 = w.add(\"panel { margins: 0, ddl1: DropDownList { title: 'Default margins' } }\");\nw.panel2 = w.add(\"panel { margins: 0, ddl2: DropDownList { title: 'Extra L/R margins' } }\");\nw.panel2.ddl2.titleLayout = { margins: [15, 0, 15, 0] };\n</code></pre> <p></p>"},{"location":"user-interface-tools/resource-specifications/","title":"Resource specifications","text":"<p>You can create one or more user-interface elements at a time using a resource specification. This specially formatted string provides a simple and compact means of creating an element, including any container element and its component elements. The resource-specification string is passed as the <code>type</code> parameter to the <code>Window()</code> or <code>add()</code> constructor function.</p> <p>The general structure of a resource specification is an element type specification (such as <code>dialog</code>), followed by a set of braces enclosing one or more property definitions.</p> <pre><code>var myResource = \"dialog{ control_specs }\";\nvar myDialog = new Window ( myResource );\n</code></pre> <p>Controls are defined as properties within windows and other containers. For each control, give the class name of the control, followed by the properties of the control enclosed in braces. For example, the following specifies a button:</p> <pre><code>testBtn: Button { text: \"Test\" }\n</code></pre> <p>The following resource string specifies a panel that contains grouped <code>StaticText</code> and <code>EditText</code> controls:</p> <pre><code>\"msgPnl: Panel { orientation:'column', alignChildren:['right', 'top'],\\\n    text: 'Messages', \\\n    title: Group { \\\n        st: StaticText { text:'Alert box title:' }, \\\n        et: EditText { text:'Sample Alert', characters:35 } \\\n    }\n    msg: Group { \\\n        st: StaticText { text:'Alert message:' }, \\\n        et: EditText { properties:{multiline:true}, \\\n        text:'&lt;your message here&gt;' \\\n    } \\\n}\"\n</code></pre> <p>The property with name properties specifies creation <code>properties</code>; see Creation properties.</p> <p>A property value can be specified as <code>null</code>, <code>true</code>, <code>false</code>, a String, a Number, an inline Array, or an Object.</p> <ul> <li>An inline array contains one or more values in the form:     <pre><code>[ value, value, ... ]\n</code></pre></li> <li> <p>An object can be an inline object, or a named object, in the form:     <pre><code>{ classname inlineObject }\n</code></pre></p> <p>In this case, the classname must be one of the control class names list in Types of controls. - An inline object contains one or more properties, in the form: <pre><code>{ propertyName: propertyValue, propertyName: propertyValue, ... }\n</code></pre></p> </li> </ul>"},{"location":"user-interface-tools/resource-specifications/#using-resource-strings","title":"Using resource strings","text":"<p>These examples in the Adobe ExtendScript SDK demonstrate how to use resource specification strings:</p> AlertBoxBuilder1.jsx Demonstrates one way to use resource strings, creating a dialog that allows the user to enter some values, and then using those values to construct the resource string for a customizable alert dialog. AlertBoxBuilder2.jsx Constructs the same dialog, using a resource string (rather than the <code>add()</code> method) to specify all of the dialog contents for the user-input dialog. <p>The two Alert Box Builder examples create the same dialog to collect values from the user.</p> <p></p> <p>The Build button event handler builds a resource string from the collected values, and returns it from the dialog invocation function; the script then saves the resource string to a file. That resource string can later be used to create and display the user-configured alert box.</p> <p>The resource specification format can also be used to create a single element or container and its child elements. For instance, if the <code>alertBuilderResource</code> in the example did not contain the panel <code>btnPnlResource</code>, you could define that resource separately, then add it to the dialog as follows:</p> <pre><code>var btnPnlResource = \"btnPnl: Panel { orientation:'row', \\\n    text: 'Build it', \\\n    testBtn: Button { text:'Test' }, \\\n    buildBtn: Button { text:'Build', properties:{name:'ok'} }, \\\n    cancelBtn: Button { text:'Cancel', properties:{name:'cancel'} } \\\n}\";\n\ndlg = new Window( alertBuilderResource );\ndlg.btnPnl = dlg.add( btnPnlResource );\ndlg.show();\n</code></pre>"},{"location":"user-interface-tools/scriptui-class/","title":"ScriptUI class","text":"<p>The globally available ScriptUI class provides central information about the ScriptUI module. This object is not instantiable.</p>"},{"location":"user-interface-tools/scriptui-class/#scriptui-classs-attributes","title":"ScriptUI Classs Attributes","text":""},{"location":"user-interface-tools/scriptui-class/#scriptuialignment","title":"ScriptUI.Alignment","text":"<p><code>ScriptUI.Alignment</code></p> <p>Collects the enumerated values that can be used in the alignment and alignChildren properties of controls and containers, and in the alignment property used to set a control's titleLayout property.</p> <p>Use these constants to set the alignment.</p> <p>When you query the alignment property, it returns index values that correspond to the constants as shown. Constant values are:</p> <ul> <li><code>ScriptUI.Alignment.TOP</code> (1)</li> <li><code>ScriptUI.Alignment.BOTTOM</code> (2)</li> <li><code>ScriptUI.Alignment.LEFT</code> (3)</li> <li><code>ScriptUI.Alignment.RIGHT</code> (4)</li> <li><code>ScriptUI.Alignment.FILL</code> (5)</li> <li><code>ScriptUI.Alignment.CENTER</code> (6)</li> </ul>"},{"location":"user-interface-tools/scriptui-class/#type","title":"Type","text":"<p>Object. Read only.</p>"},{"location":"user-interface-tools/scriptui-class/#example","title":"Example","text":"<pre><code>myGroup.alignment = [ScriptUI.Alignment.LEFT, ScriptUI.Alignment.TOP]\n</code></pre>"},{"location":"user-interface-tools/scriptui-class/#scriptuiapplicationfonts","title":"ScriptUI.applicationFonts","text":"<p><code>ScriptUI.applicationFonts</code></p>"},{"location":"user-interface-tools/scriptui-class/#description","title":"Description","text":"<p>Collects the enumerated values that specify the default application fonts.</p> <p>The available fonts vary according to the application and system configuration.</p>"},{"location":"user-interface-tools/scriptui-class/#type_1","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuicompatability","title":"ScriptUI.compatability","text":"<p><code>ScriptUI.compatability</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_1","title":"Description","text":"<p>An object whose properties are the names of compatibility modes supported by the host application. For example, the presence of <code>ScriptUI.compatability.su1PanelCoordinates</code> means that the application allows backward compatibility with the coordinate system of Panel elements in ScriptUI version 1.</p>"},{"location":"user-interface-tools/scriptui-class/#type_2","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuicoreversion","title":"ScriptUI.coreVersion","text":"<p><code>ScriptUI.coreVersion</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_2","title":"Description","text":"<p>The internal core version number of the ScriptUI components.</p>"},{"location":"user-interface-tools/scriptui-class/#type_3","title":"Type","text":"<p>String. Read only.</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuienvironment","title":"ScriptUI.environment","text":"<p><code>ScriptUI.environment</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_3","title":"Description","text":"<p>A JavaScript object that provides access to attributes of the ScriptUI environment; contains a Keyboard state object that reports the active state of the keyboard at any time, independent of the event-handling framework.</p>"},{"location":"user-interface-tools/scriptui-class/#type_4","title":"Type","text":"<p>Environment object</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuievents","title":"ScriptUI.events","text":"<p><code>ScriptUI.events</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_4","title":"Description","text":"<p>A JavaScript object that contains one function, ScriptUI.events.createEvent(), which allows you to create event objects in order to simulate user-interaction events.</p>"},{"location":"user-interface-tools/scriptui-class/#type_5","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuifontstyle","title":"ScriptUI.FontStyle","text":"<p><code>ScriptUI.FontStyle</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_5","title":"Description","text":"<p>Collects the enumerated values that can be used as the style argument to the ScriptUI.newFont() method. For example:</p> <pre><code>var font = ScriptUI.newFont( \"Helvetica\", ScriptUI.FontStyle.BOLD )\n</code></pre> <p>Values are:</p> <ul> <li><code>REGULAR</code></li> <li><code>BOLD</code></li> <li><code>ITALIC</code></li> <li><code>BOLDITALIC</code></li> </ul>"},{"location":"user-interface-tools/scriptui-class/#type_6","title":"Type","text":"<p>String. Read only.</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuiframeworkname","title":"ScriptUI.frameworkName","text":"<p><code>ScriptUI.frameworkName</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_6","title":"Description","text":"<p>The name of the user-interface framework with which this ScriptUI component is compatible.</p>"},{"location":"user-interface-tools/scriptui-class/#type_7","title":"Type","text":"<p>String. Read only.</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuiversion","title":"ScriptUI.version","text":"<p><code>ScriptUI.version</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_7","title":"Description","text":"<p>The main version number of the ScriptUI component framework.</p>"},{"location":"user-interface-tools/scriptui-class/#type_8","title":"Type","text":"<p>String. Read only.</p>"},{"location":"user-interface-tools/scriptui-class/#scriptui-class-methods","title":"ScriptUI Class Methods","text":""},{"location":"user-interface-tools/scriptui-class/#scriptuieventscreateevent","title":"ScriptUI.events.createEvent()","text":"<p><code>ScriptUI.events.createEvent(eventType)</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_8","title":"Description","text":"<p>This function is in the JavaScript object contained in the events property.</p> <p>This object is passed to a function that you register to respond to events of a certain type that occur in a window or control. Use windowObj.addEventListener() or controlObj.addEventListener() to register a handler function.</p> <p>See Registering event listeners for windows or controls.</p>"},{"location":"user-interface-tools/scriptui-class/#parameters","title":"Parameters","text":"<p>+-------------+--------+----------------------------+ |  Parameter  |  Type  |        Description         | +=============+========+============================+ | <code>eventType</code> | String | The type of event, one of: | |             |        | - <code>UIEvent</code>                | |             |        | - <code>KeyboardEvent</code>          | |             |        | - <code>MouseEvent</code>             | | ----------- | ------ | -------------------------- |</p>"},{"location":"user-interface-tools/scriptui-class/#returns","title":"Returns","text":"<p>It returns an event object of the appropriate type:</p> <ul> <li>A UIEvent base class encapsulates input event information for an event that propagates through a container and control hierarchy. This is a base class for the more specialized keyboard and mouse event types.</li> <li>A KeyboardEvent object encapsulates information about keyboard input events.</li> <li>A MouseEvent object encapsulates information about mouse events.</li> </ul>"},{"location":"user-interface-tools/scriptui-class/#scriptuigetresourcetext","title":"ScriptUI.getResourceText()","text":"<p><code>ScriptUI.getResourceText(text)</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_9","title":"Description","text":"<p>Finds and returns the resource for a given text string from the host application's resource data. If no string resource matches the given text, the text itself is returned.</p>"},{"location":"user-interface-tools/scriptui-class/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>text</code> String The text to match."},{"location":"user-interface-tools/scriptui-class/#returns_1","title":"Returns","text":"<p>String</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuinewfont","title":"ScriptUI.newFont()","text":"<p><code>ScriptUI.newFont(name, style, size);</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_10","title":"Description","text":"<p>Creates a new font object for use in text controls and titles.</p>"},{"location":"user-interface-tools/scriptui-class/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>name</code> String The font or font family name string. <code>style</code> String The font style string or an enumerated value from ScriptUI.FontStyle <code>size</code> Number The font size in points, a number."},{"location":"user-interface-tools/scriptui-class/#returns_2","title":"Returns","text":"<p>ScriptUIFont object</p>"},{"location":"user-interface-tools/scriptui-class/#scriptuinewimage","title":"ScriptUI.newImage()","text":"<p><code>ScriptUI.newImage( normal, disabled, pressed, rollover );</code></p>"},{"location":"user-interface-tools/scriptui-class/#description_11","title":"Description","text":"<p>Creates a new image object for use in controls that can display images, loading the associated images from the specified resources or image files.</p>"},{"location":"user-interface-tools/scriptui-class/#parameter","title":"Parameter","text":"Parameter Type Description <code>normal</code> String The resource name or path to the image to use for the normal or default state. <code>disabled</code> String The resource name or path to the image to use for the disabled state, shown when the control containing the image is disabled (enabled=false). <code>pressed</code> String The resource name or path to the image to use for the pressed state, shown when the user clicks on the image. <code>rollover</code> String The resource name or path to the image to use for the rollover state, which is shown when the cursor moves over the image."},{"location":"user-interface-tools/scriptui-class/#returns_3","title":"Returns","text":"<p>ScriptUIImage object</p>"},{"location":"user-interface-tools/scriptui-object-reference/","title":"ScriptUI object reference","text":"<p>ScriptUI is a component that works with the ExtendScript JavaScript interpreter to provide JavaScript programs with the ability to create and interact with user interface elements. It provides an object model for windows and user-interface control elements within an application.</p> <p>This section provides the details of the ScriptUI classes and objects with their properties, methods, and creation parameters.</p> <ul> <li>ScriptUI class</li> <li>Common properties</li> <li>Window class</li> <li>Window object</li> <li>Control objects</li> <li>UIEvent base class</li> <li>Graphic customization objects</li> <li>LayoutManager object</li> </ul>"},{"location":"user-interface-tools/scriptui-programming-model/","title":"ScriptUI programming model","text":"<p>ScriptUI defines <code>Window</code> objects that represent platform-specific windows, and various control elements such as <code>Button</code> and <code>StaticText</code>, that represent user-interface controls. These objects share a common set of properties and methods that allow you to query the type, move the element around, set the title, caption or content, and so on. Many element types also have properties unique to that class of elements.</p>"},{"location":"user-interface-tools/scriptui-programming-model/#creating-a-window","title":"Creating a window","text":"<p>ScriptUI defines the following types of windows:</p> <ul> <li>Modal dialog box: Holds focus when shown, does not allow activity in other application windows until dismissed.</li> <li>Floating palette: Also called modeless dialog, allows activity in other application windows. (Adobe Photoshop\u00ae does not support script creation of palette windows.)</li> <li>Main window: Suitable for use as an application's main window. (Main windows are not normally created by script developers for Adobe applications. Photoshop does not support script creation of main windows.)</li> </ul> <p>To create a new window, use the <code>Window</code> constructor function. The constructor takes the desired type of the window. The type is <code>\"dialog\"</code> for a modal dialog, or <code>\"palette\"</code> for a modeless dialog or floating palette. You can supply optional arguments to specify an initial window title and bounds; or you can set the location and size separately.</p> <p>The following example creates an empty dialog with the variable name dlg, which is used in subsequent examples:</p> <pre><code>// Create an empty dialog window near the upper left of the screen\nvar dlg = new Window( \"dialog\", \"Alert Box Builder\" );\ndlg.frameLocation = [ 100, 100 ];\n</code></pre> <p>Initially, new windows are hidden. The show method makes them visible and responsive to user interaction; for example:</p> <pre><code>dlg.show();\n</code></pre>"},{"location":"user-interface-tools/scriptui-programming-model/#container-elements","title":"Container elements","text":"<p>All Windows are containers-that is, they contain other elements within their bounds. Within a Window, you can create other types of container elements: Panels and Groups. These can contain control elements, and can also contain other Panel and Group containers. However, a Window cannot be added to any container.</p> <ul> <li>A <code>Group</code> is the simplest container used to visually organize related controls. You would typically define a group and populate it with related elements, for instance an edittext box and its descriptive statictext label.</li> <li>A <code>Panel</code> is a frame object, also typically used to visually organize related controls. It has a text property to specify a title, and can have a border to visually separate the collection of elements from other elements of a dialog.</li> <li>A <code>TabbedPanel</code> is a frame that contains only Tab elements. Each Tab is a frame with a localizable title in the selection tab, which contains a set of controls. When a tab is active, the Tab object is the value of the TabbedPanel.selection property.</li> </ul> <p>You might create a <code>Panel</code> and populate it with several <code>Groups</code>, each with their own elements. You can create nested containers, with different layout properties for different containers, in order to define a relatively complex layout without any explicit placement.</p> <p>You can add elements to any container using the add method (see Adding elements to containers). An element added to a container is considered a child of that container. Certain operations on a container apply to its children; for example, when you hide a container, its children are also hidden.</p>"},{"location":"user-interface-tools/scriptui-programming-model/#window-layout","title":"Window layout","text":"<p>When a script creates a <code>Window</code> and adds various user-interface elements to it, the locations and sizes of elements and spacing between elements is known as the layout of the window. Each user-interface element has properties which define its location and dimensions: <code>location</code>, <code>size</code>, and <code>bounds</code>. These properties are initially undefined, and a script that employs Automatic layout should leave them undefined for the main window as well as its contained elements, allowing the automatic layout mechanism to set their values.</p> <p>Your script can access these values, and (if not using auto-layout) set them as follows:</p> <ul> <li>The <code>location</code> of a window is defined by a Point object containing a pair of coordinates (<code>x</code> and <code>y</code>) for the top left corner (the origin), specified in the screen coordinate system. The location of an element within a window or other container is defined as the origin point specified in the container's coordinate system. That is, the x and y values are relative to the origin of the container.<ul> <li>The following examples show equivalent ways of placing the content region of an existing window at screen coordinates [10, 50]:     <pre><code>win.location = [ 10, 50 ];\nwin.location = { x: 10, y: 50 };\nwin.location = \"x:10, y:50\";\n</code></pre></li> </ul> </li> <li>The <code>size</code> of an element's region is defined by a Dimension object containing a <code>width</code> and <code>height</code> in pixels.<ul> <li>The following examples show equivalent ways of changing an existing window's width and height to 200 and 100:     <pre><code>win.size = [ 200, 100 ];\nwin.size = { width: 200, height: 100 };\nwin.size = \"width:200, height:100\";\n</code></pre></li> <li>This example shows how to change a window's height to 100, leaving its location and width unchanged:     <pre><code>win.size.height = 100;\n</code></pre></li> </ul> </li> <li>The <code>bounds</code> of an element are defined by a <code>Bounds</code> object containing both the origin point (<code>x</code>, <code>y</code>) and size (<code>width</code>, <code>height</code>) To define the size and location of windows and controls in one step, use the bounds property.<ul> <li>The value of the <code>bounds</code> property can be a string with appropriate contents, an inline JavaScript <code>Bounds</code> object, or a four-element array. The following examples show equivalent ways of placing a 380 by 390 pixel window near the upper left corner of the screen:     <pre><code>var dlg = new Window( \"dialog\", \"Alert Box Builder\", [ 100, 100, 480, 490] );\ndlg.bounds = [ 100, 100, 480, 490 ];\ndlg.bounds = { x: 100, y: 100, width: 380, height: 390 };\ndlg.bounds = { left: 100, top: 100, right: 480, bottom: 490 };\ndlg.bounds = \"left:100, top:100, right:480, bottom:490\";\n</code></pre></li> </ul> </li> </ul> <p>The <code>window</code> dimensions define the size of the content region of the window, or that portion of the window that a script can directly control. The actual window size is typically larger, because the host platform's window system typically adds title bars and borders. The <code>bounds</code> property for a <code>Window</code> refers only to its content region. To determine the bounds of the frame surrounding the content region of a window, use the <code>Window.frameBounds</code> property.</p>"},{"location":"user-interface-tools/scriptui-programming-model/#adding-elements-to-containers","title":"Adding elements to containers","text":"<p>To add elements to a <code>window</code>, <code>panel</code>, or <code>group</code>, use the container's <code>add</code> method. This method accepts the type of the element to be created and some optional parameters, depending on the element type. It creates and returns an object of the specified type.</p> <p>In additions to windows, ScriptUI defines the following user-interface elements and controls:</p> <ul> <li>Panels (frames) and groups, to collect and organize other control types</li> <li>Push buttons with text or icons, radio buttons, checkbox buttons</li> <li>Static text or images, edit text</li> <li>Progress bars, scrollbars, sliders</li> <li>Lists, which include list boxes, drop-down (also called popup) lists, and tree views. Each item in a list is a control of type <code>item</code>, and the parent list's <code>items</code> property contains an array of child items. Tree views can also have collapsible <code>node</code>-type items, which contain child items. You can add list items with the parent's <code>add</code> method.</li> </ul> <p>You can specify the initial size and position of any new element relative to the working area of the parent container, in an optional <code>bounds</code> parameter. Different types of elements have different additional parameters. For elements which display text, for example, you can specify the initial text. See the ScriptUI Classes dictionary in the ExtendScript Toolkit's Object Model Viewer for details.</p> <p>The order of optional parameters must be maintained. Use the value <code>undefined</code> for a parameter you do not wish to set. For example, if you want to use automatic layout to determine the bounds, but still set the title and text in a panel and button, the following creates <code>Panel</code> and <code>Button</code> elements with an initial <code>text</code> value, but no <code>bounds</code> value:</p> <pre><code>dlg.btnPnl = dlg.add(\"panel\", undefined, \"Build it\");\ndlg.btnPnl.testBtn = dlg.btnPnl.add(\"button\", undefined, \"Test\");\n</code></pre> <p>A new element is initially set to be visible, but is not shown unless its parent object is shown.</p>"},{"location":"user-interface-tools/scriptui-programming-model/#creation-properties","title":"Creation properties","text":"<p>Some element types have attributes that can only be specified when the element is created. These are not normal properties of the element, in that they cannot be changed during the element's lifetime, and they are only needed once. For these element types, you can supply an optional creation-properties argument to the add method. This argument is an object with one or more properties that control aspects of the element's appearance, or special functions such as whether an edit text element is editable or Read only. See Control object constructors for details.</p> <p>You can also specify the creation properties for new objects using the resource specification format; for details, see Resource specifications.</p> <p>All user-interface elements have an optional creation property called name, which assigns a name for identifying that element. For example, the following creates a new Button element with the name ok:</p> <pre><code>dlg.btnPnl.buildBtn = dlg.btnPnl.add(\"button\", undefined, \"Build\", {name: \"ok\"});\n</code></pre> <p>Note</p> <p>In Photoshop CS, panel coordinates were measured from outside the frame (including the title bar), but in Photoshop CS2, panel coordinates are measured from the inside the frame (the content area). This means that if you use the same values to set the vertical positions of child controls in a panel, the positions are slightly different in the two versions. When you add a panel to a window, you can choose to set a creation property (su1PanelCoordinates), which causes that panel to automatically adjust the positions of its children; see the add method for panel. When automatic adjustment is enabled, you provide position values that were correct for Photoshop CS, and the result is the same in Photoshop CS2, CS3, CS4, CS5, or CC. You can also set automatic adjustment for a window; in this case, it applies to all child panels of that window unless it is explicitly disabled in the child panel. See Window object constructor.</p>"},{"location":"user-interface-tools/scriptui-programming-model/#accessing-child-elements","title":"Accessing child elements","text":"<p>A reference to each element added to a container is appended to the container's <code>children</code> property. You can access the child elements through this array, using a 0-based index. For controls that are not containers, the <code>children</code> collection is empty.</p> <p>In this example, the <code>msgPnl</code> panel was the first element created in dlg, so the script can access the panel object at index 0 of the parent's <code>children</code> property to set the text for the title:</p> <pre><code>var dlg = new Window( \"dialog\", \"Alert Box Builder\" );\ndlg.msgPnl = dlg.add( \"panel\" );\ndlg.children[ 0 ].text = \"Messages\";\n</code></pre> <p>If you use a creation property to assign a name to a newly created element, you can access that child by its name, either in the <code>children</code> array of its parent, or directly as a property of its parent. For example, the <code>Button</code> in a previous example was named ok, so it can be referenced as follows:</p> <pre><code>dlg.btnPnl.children[ \"ok\" ].text = \"Build\";\ndlg.btnPnl.ok.text = \"Build\";\n</code></pre> <p>You can also access named elements through the parent window's <code>findElement()</code> method:</p> <pre><code>var myOkButton = dlg.findElement( \"ok\" );\n</code></pre> <p>For list controls (type <code>list</code> and <code>dropdown</code>), you can access the child list-item objects through the <code>items</code> array.</p>"},{"location":"user-interface-tools/scriptui-programming-model/#removing-elements","title":"Removing elements","text":"<p>To remove elements from a <code>Window</code>, <code>Panel</code>, or <code>Group</code>, use the container's <code>remove</code> method. This method accepts an object representing the element to be removed, or the name of the element, or the index of the element in the container's <code>children</code> collection (see Accessing child elements).</p> <p>The specified element is removed from view if it was currently visible, and it is no longer accessible from the container or window. The results of any further references by a script to the object representing the element are undefined.</p> <p>To remove list items from a list, use the parent list control's remove method in the same way. It removes the item from the parent's <code>items</code> list, hides it from view, and deletes the item object.</p>"},{"location":"user-interface-tools/size-and-location-objects/","title":"Size and location objects","text":"<p>ScriptUI defines objects to represent the complex values of properties that place and size windows and user-interface elements. These objects cannot be created directly, but are created when you set the corresponding property. That property then returns that object. For example, the <code>bounds</code> property returns a <code>Bounds</code> object.</p> <p>You can set these properties as objects, strings, or arrays.</p> <ul> <li><code>e.prop = Object</code> - The object must contain the set of properties defined for this type, as shown in the table below. The properties have integer values.</li> <li><code>e.prop = String</code> - The string must be an executable JavaScript inline object declaration, conforming to the same object description.</li> <li><code>e.prop = Array</code> - The array must have integer coordinate values in the order defined for this type, as shown in the table below. For example:</li> </ul> <p>The following examples show equivalent ways of placing a 380 by 390 pixel window near the upper left corner of the screen:</p> <pre><code>var dlg = new Window( \"dialog\", \"Alert Box Builder \");\ndlg.bounds = { x:100, y:100, width:380, height:390 }; // Object\ndlg.bounds = { left:100, top:100, right:480, bottom:490 }; // Object\ndlg.bounds = \"x:100, y:100, width:380, height:390\"; // String\ndlg.bounds = \"left:100, top:100, right:480, bottom:490\"; // String\ndlg.bounds = [100, 100, 480, 490]; // Array\n</code></pre> <p>You can access the resulting object as an array with values in the order defined for the type, or as an object with the properties supported for the type.</p>"},{"location":"user-interface-tools/size-and-location-objects/#size-and-location-object-types","title":"Size and location object types","text":"<p>The following objects are the property-value object types, the element properties that create and contain them, and their array and object-property formats.</p>"},{"location":"user-interface-tools/size-and-location-objects/#bounds","title":"Bounds","text":"<p>Defines the boundaries of a window within the screen's coordinate space, or of a user-interface element within the container's coordinate space. Contains an array, [left, top, right, bottom], that defines the coordinates of the upper left and lower right corners of the element.</p> <p>A <code>Bounds</code> object is created when you set an element's <code>bounds</code> property, and this property returns a <code>Bounds</code> object.</p> <ul> <li>An object must contain properties named <code>left</code>, <code>top</code>, <code>right</code>, <code>bottom</code>, or <code>x</code>, <code>y</code>, <code>width</code>, <code>height</code>.</li> <li>An array must have values in the order [left, top, right, bottom].</li> </ul>"},{"location":"user-interface-tools/size-and-location-objects/#dimension","title":"Dimension","text":"<p>Defines the size of a Window or user-interface element. Contains an array, <code>[ width, height ]</code>, that defines the element's size in pixels.</p> <p>A <code>Dimension</code> object is created when you set an element's size or <code>preferredSize</code> property. (A <code>preferredSize</code> of -1 causes the size to be calculated automatically.)</p> <ul> <li>An object must contain properties named <code>width</code> and <code>height</code>.</li> <li>An array must have values in the order <code>[ width, height ]</code>.</li> </ul>"},{"location":"user-interface-tools/size-and-location-objects/#margins","title":"Margins","text":"<p>Defines the number of pixels between the edges of a container and its outermost child elements. Contains an array <code>[ left, top, right, bottom ]</code> whose elements define the margins between the left edge of a container and its leftmost child element, and so on.</p> <p>A <code>Margins</code> object is created when you set an element's <code>margins</code> property.</p> <ul> <li>An object must contain properties named <code>left</code>, <code>top</code>, <code>right</code>, and <code>bottom</code>.</li> <li>An array must have values in the order [ <code>left</code>, <code>top</code>, <code>right</code>, <code>bottom</code> ].</li> </ul> <p>You can also set the margins property to a number; all of the array values are then set to this number.</p>"},{"location":"user-interface-tools/size-and-location-objects/#point","title":"Point","text":"<p>Defines the location of a <code>Window</code> or user-interface element. Contains an array, <code>[ x, y ]</code>, whose values represent the origin point of the element as horizontal and vertical pixel offsets from the origin of the element's coordinate space.</p> <p>A <code>Point</code> object is created when you set an element's location property.</p> <ul> <li>An object must contain properties named <code>x</code> and <code>y</code>.</li> <li>An array must have values in the order <code>[ x, y ]</code>.</li> </ul>"},{"location":"user-interface-tools/types-of-controls/","title":"Types of controls","text":"<p>The following sections introduce the types of controls you can add to a <code>Window</code> or other container element (<code>panel</code> or <code>group</code>). For details of the properties and functions, and of how to create each type of element, see Control object constructors.</p>"},{"location":"user-interface-tools/types-of-controls/#containers","title":"Containers","text":"<p>These are types of <code>Control</code> objects which are contained in windows, and which contain and group other controls.</p>"},{"location":"user-interface-tools/types-of-controls/#panel","title":"Panel","text":"<p>Typically used to visually organize related controls.</p> <ul> <li>Set the text property to define a title that appears at the top of the panel.</li> <li>An optional borderStyle creation property controls the appearance of the border drawn around the panel.</li> </ul> <p>You can use panels as separators: those with width of 0 appear as vertical lines and those with height of 0 appear as horizontal lines:</p> <pre><code>var dlg = new Window( \"dialog\", \"Alert Box Builder\" );\ndlg.msgPnl = dlg.add( \"panel\", [ 25, 15, 355, 130 ], \"Messages\" );\n</code></pre>"},{"location":"user-interface-tools/types-of-controls/#group","title":"Group","text":"<p>Used to visually organize related controls.</p> <p>Unlike <code>Panels</code>, <code>Groups</code> have no title or visible border.</p> <p>You can use them to create hierarchies of controls, and for fine control over layout attributes of certain groups of controls within a larger panel. For examples, see Creating more complex arrangements.</p>"},{"location":"user-interface-tools/types-of-controls/#tabbedpanel","title":"TabbedPanel","text":"<p>A panel that contains only Tab objects as its immediate children. It has a selection property that contains the currently active Tab child.</p> <p>When the value of the selection property changes, either by a user selecting a different tab, or by a script setting the property, the TabbedPanel receives an <code>onChange</code> notification.</p> <p>The title property provides an optional label; the titleLayout property places the label within the panel.</p>"},{"location":"user-interface-tools/types-of-controls/#tab","title":"Tab","text":"<p>A general container whose parent is a TabbedPanel, with a selectable tab showing a localizable text value.</p> <p>Its size and position are determined by the parent.</p>"},{"location":"user-interface-tools/types-of-controls/#user-interface-controls","title":"User-interface controls","text":"<p>These are types of <code>Control</code> objects that are contained in windows, panels, and groups, and that provide specific kinds of display and user interaction. Control instances are created by passing the corresponding <code>type</code> keyword to the <code>add()</code> method of a Window or container; see Control types and creation parameters.</p> <p>These examples do not set bounds explicitly on creation, because it is often more useful to set a preferred size, then allow the layout manager to set the bounds; see Automatic layout.</p>"},{"location":"user-interface-tools/types-of-controls/#button","title":"Button","text":"<p>Typically used to initiate some action from a window when a user clicks the button; for example, accepting a dialog's current settings, canceling a dialog, bringing up a new dialog, and so on.</p> <ul> <li>Set the <code>text</code> property to assign a label to identify a Button's function.</li> <li>The <code>onClick</code> callback method provides behavior.</li> </ul> <pre><code>var dlg = new Window( \"dialog\", \"Alert Box Builder\" );\ndlg.btnPnl = dlg.add( \"panel\", undefined, \"Build it\" );\ndlg.btnPnl.testBtn = dlg.btnPnl.add( \"button\", undefined, \"Test\" );\ndlg.btnPnl.buildBtn = dlg.btnPnl.add( \"button\", undefined, \"Build\", { name: \"ok\" } );\ndlg.btnPnl.cancelBtn = dlg.btnPnl.add( \"button\", undefined, \"Cancel\", { name: \"cancel\" } );\ndlg.show();\n</code></pre>"},{"location":"user-interface-tools/types-of-controls/#iconbutton","title":"IconButton","text":"<p>A button that displays an icon, with or without a text label. Like a text button, typically initiates an action in response to a click.</p> <ul> <li>The <code>image</code> property identifies the icon image; see Displaying images.</li> <li>The <code>title</code> or <code>text</code> property provides an optional label; the titleLayout property places the label with respect to the image.</li> <li>The <code>onClick</code> callback method provides behavior.</li> </ul>"},{"location":"user-interface-tools/types-of-controls/#image","title":"Image","text":"<p>Displays an iconic image.</p> <ul> <li>The <code>image</code> property identifies the icon image; see Displaying images.</li> <li>The <code>title</code> property provides an optional label; the titleLayout property places the label with respect to the image.</li> </ul>"},{"location":"user-interface-tools/types-of-controls/#statictext","title":"StaticText","text":"<p>Typically used to display text strings that are not intended for direct manipulation by a user, such as informative messages or labels.</p> <p>This example creates a Panel and adds several StaticText elements:</p> <pre><code>var dlg = new Window( \"dialog\", \"Alert Box Builder\" );\ndlg.msgPnl = dlg.add( \"panel\", undefined, \"Messages\" );\ndlg.msgPnl.titleSt = dlg.msgPnl.add( \"statictext\", undefined, \"Alert box title:\" );\ndlg.msgPnl.msgSt = dlg.msgPnl.add( \"statictext\", undefined, \"Alert message:\" );\ndlg.show();\n</code></pre>"},{"location":"user-interface-tools/types-of-controls/#edittext","title":"EditText","text":"<p>Allows users to enter text, which is returned to the script when the dialog is dismissed. Text in EditText elements can be selected, copied, and pasted.</p> <ul> <li>Set the <code>text</code> property to assign the initial displayed text in the element, and read it to obtain the current text value, as entered or modified by the user.</li> <li>Set the <code>textselection</code> property to replace the current selection with new text, or to insert text at the cursor (insertion point). Read this property to obtain the current selection, if any.</li> </ul> <p>This example adds some EditText elements, with initial values that a user can accept or replace:</p> <pre><code>var dlg = new Window( \"dialog\", \"Alert Box Builder\" );\ndlg.msgPnl = dlg.add( \"panel\", undefined, \"Messages\" );\ndlg.msgPnl.titleSt = dlg.msgPnl.add( \"statictext\", undefined, \"Alert box title:\" );\ndlg.msgPnl.titleEt = dlg.msgPnl.add( \"edittext\", undefined, \"Sample Alert\" );\ndlg.msgPnl.msgSt = dlg.msgPnl.add( \"statictext\", undefined, \"Alert message:\" );\ndlg.msgPnl.msgEt = dlg.msgPnl.add( \"edittext\", undefined, \"&lt;your message here&gt;\", { multiline: true } );\ndlg.show();\n</code></pre> <p>Note</p> <p>The creation property on the second EditText field, <code>multiline: true</code>, indicates a field in which a long text string can be entered. The text wraps to appear as multiple lines.</p>"},{"location":"user-interface-tools/types-of-controls/#editnumber","title":"EditNumber","text":"<p>Allows users to enter a decimal number, which is returned to the script when the dialog is dismissed. The value entered is validated for being a localized number format and checked against a lower and upper boundary when the control loses focus. Text in EditNumber elements can be selected, copied, and pasted.</p> <p>Note</p> <p>This functionality was added in Photoshop 20.0 (CC 2019), and may not exist in other hosts.</p> <ul> <li>Set the <code>text</code> property to assign the initial displayed number in the element, and read it to obtain the current number value, as entered or modified by the user.</li> <li>Set the <code>textselection</code> property to replace the current selection with new text, or to insert text at the cursor (insertion point). Read this property to obtain the current selection, if any.</li> </ul> <p>This example adds some EditNumber elements, with initial values that a user can accept or replace:</p> <pre><code>var dlg = new Window( \"dialog\", \"Date Box\" );\ndlg.msgPnl = dlg.add( \"panel\", undefined, \"Enter Date\" );\ndlg.msgPnl.titleSt = dlg.msgPnl.add( \"statictext\", undefined, \"Month:\" );\ndlg.msgPnl.titleEt = dlg.msgPnl.add( \"editnumber\", undefined, 1, 1, 12 );\ndlg.msgPnl.msgSt = dlg.msgPnl.add( \"statictext\", undefined, \"Year:\" );\ndlg.msgPnl.msgEt = dlg.msgPnl.add( \"editnumber\", undefined, 2025, 2000, 2100 );\ndlg.show();\n</code></pre> <p>Note</p> <p>Decimal numbers like <code>2.5</code> are accepted for minimum and maximum values.</p>"},{"location":"user-interface-tools/types-of-controls/#checkbox","title":"Checkbox","text":"<p>Allows the user to set a boolean state.</p> <ul> <li>Set the <code>text</code> property to assign an identifying text string that appears next to the clickable box.</li> <li>The user can click to select or deselect the box, which shows a checkmark when selected. The <code>value</code> is <code>true</code> when it is selected (checked) and <code>false</code> when it is not.</li> </ul> <p>When you create a Checkbox, you can set its value property to specify its initial state and appearance.</p> <pre><code>// Add a checkbox to control the buttons that dismiss an alert box\ndlg.hasBtnsCb = dlg.add( \"checkbox\", undefined, \"Should there be alert buttons?\" );\ndlg.hasBtnsCb.value = true;\n</code></pre>"},{"location":"user-interface-tools/types-of-controls/#radiobutton","title":"RadioButton","text":"<p>Allows the user to select one choice among several.</p> <ul> <li>Set the text property to assign an identifying text string that appears next to the clickable button.</li> <li>The <code>value</code> is <code>true</code> when the button is selected. The button shows the state in a platform-specific manner, with a filled or empty dot, for example.</li> </ul> <p>You group a related set of radio buttons by creating all the related elements one after another. When any button's value becomes <code>true</code>, the value of all other buttons in the group becomes <code>false</code>. When you create a group of radio buttons, you should set the state of one of them <code>true</code>:</p> <pre><code>var dlg = new Window( \"dialog\", \"Alert Box Builder\" );\ndlg.alertBtnsPnl = dlg.add( \"panel\", undefined, \"Button alignment\" );\ndlg.alertBtnsPnl.alignLeftRb = dlg.alertBtnsPnl.add( \"radiobutton\", undefined, \"Left\" );\ndlg.alertBtnsPnl.alignCenterRb = dlg.alertBtnsPnl.add( \"radiobutton\", undefined, \"Center\" );\ndlg.alertBtnsPnl.alignRightRb = dlg.alertBtnsPnl.add( \"radiobutton\", undefined, \"Right\" );\ndlg.alertBtnsPnl.alignCenterRb.value = true;\ndlg.show();\n</code></pre>"},{"location":"user-interface-tools/types-of-controls/#progressbar","title":"Progressbar","text":"<p>Typically used to display the progress of a time-consuming operation. A colored bar covers a percentage of the area of the control, representing the percentage completion of the operation.</p> <p>The <code>value</code> property reflects and controls how much of the visible area is colored, relative to the maximum value (<code>maxvalue</code>).</p> <p>By default the range is <code>[0..100]</code>, so the <code>value = 50</code> when the operation is half done.</p>"},{"location":"user-interface-tools/types-of-controls/#slider","title":"Slider","text":"<p>Typically used to select within a range of values. The slider is a horizontal bar with a draggable indicator, and you can click a point on the slider bar to jump the indicator to that location.</p> <p>The <code>value</code> property reflects and controls the position of the indicator, within the range determined by <code>minvalue</code> and <code>maxvalue</code>.</p> <p>By default the range is 0 to 100, so setting <code>value = 50</code> moves the indicator to the middle of the bar.</p>"},{"location":"user-interface-tools/types-of-controls/#scrollbar","title":"Scrollbar","text":"<p>Like a slider, the scrollbar is a bar with a draggable indicator. It also has \"stepper\" buttons at each end, that you can click to jump the indicator by the amount in the <code>stepdelta</code> property. If you click a point on the bar outside the indicator, the indicator jumps by the amount in the jumpdelta property.</p> <p>You can create scrollbars with horizontal or vertical orientation; if <code>width</code> is greater than <code>height</code>, it is horizontal, otherwise it is vertical. Arguments to the <code>add</code> method that creates the scrollbar define values for the <code>value</code>, <code>minvalue</code> and <code>maxvalue</code> properties.</p> <p>Scrollbars are often created with an associated <code>EditText</code> field to display the current value of the scrollbar, and to allow setting the scrollbar's position to a specific value.</p> <p>This example creates a scrollbar with associated <code>StaticText</code> and <code>EditText</code> elements within a panel:</p> <pre><code>dlg.sizePnl = dlg.add( \"panel\", undefined, \"Dimensions\" );\ndlg.sizePnl.widthSt = dlg.sizePnl.add( \"statictext\", undefined, \"Width:\" );\ndlg.sizePnl.widthScrl = dlg.sizePnl.add( \"scrollbar\", undefined, 300, 300, 800 );\ndlg.sizePnl.widthEt = dlg.sizePnl.add( \"edittext\" );\n</code></pre>"},{"location":"user-interface-tools/types-of-controls/#listbox-dropdownlist-and-treeview","title":"ListBox, DropDownList and TreeView","text":"<p>These controls display lists of items, which are represented by <code>ListItem</code> objects in the <code>items</code> property. You can access the items in this array using a 0-based index.</p> <ul> <li>A <code>ListBox</code> control displays a list of choices. When you create the object, you specify whether it allows the user to select only one or multiple items. If a list contains more items than can be displayed in the available area, a scrollbar may appear that allows the user to scroll through all the list items. A list box can display items in multiple columns; see Creating multi-column lists.</li> <li>A <code>DropDownList</code> control displays a single visible item. When you click the control, a list drops down and allows you to select one of the other items in the list. Drop-down lists can have nonselectable separator items for visually separating groups of related items, as in a menu.</li> <li>A <code>TreeView</code> control is similar to a ListBox, except that the items can have child items. Items with children can be expanded or collapsed to show or hide the child items. Child items can in turn contain children.</li> <li>The <code>title</code> property provides an optional label; the titleLayout property places the label with respect to the list.</li> </ul> <p>You can specify the choice items on creation of the list object, or afterward using the list object's <code>add()</code> method. You can remove items programmatically with the list object's <code>remove()</code> and <code>removeAll()</code> methods.</p>"},{"location":"user-interface-tools/types-of-controls/#listitem","title":"ListItem","text":"<p>Items added to or inserted into any type of list control are <code>ListItem</code> objects, with properties that can be manipulated from a script. ListItem elements can be of the following types:</p> Type Description <code>item</code> The typical item in any type of list. It displays text or an image, and can be selected. To display an image, set the item object's image property; Displaying images. <code>separator</code> A separator is a nonselectable visual element in a drop-down list. Although it has a text property, the value is ignored, and the item is displayed as a horizontal line. <code>node</code> A displayable and selectable item in a <code>TreeView</code> control which can contain other <code>ListItem</code> objects, including other items of type node."},{"location":"user-interface-tools/types-of-controls/#flashplayer","title":"FlashPlayer","text":"<p>Runs a Flash movie within a ScriptUI window. Its control's methods allow you to load a movie from an SWF file and control the playback. See FlashPlayer control functions.</p> <p>You can also use the control object to communicate with the Flash application, calling ActionScript methods, and making JavaScript methods defined in your Adobe application script available to the Flash ActionScript code. See Calling ActionScript functions from a ScriptUI script.</p> <p>The <code>title</code> property provides an optional label; the titleLayout property places the label with respect to the player.</p>"},{"location":"user-interface-tools/types-of-controls/#displaying-images","title":"Displaying images","text":"<p>You can display icon images in <code>Image</code> or <code>IconButton</code> controls, or display images in place of strings or in addition to strings as the selectable items in a <code>Listbox</code> or <code>DropdownList</code> control. In each case, the image is defined by setting the element's <code>image</code> property. You can set it to a ScriptUIImage object; a named icon resource; a File object; or the pathname of a file containing the iconic image, or of an alias or shortcut to that file (see Specifying paths).</p> <p>The image data for an icon can be in Portable Network Graphics (PNG) format, or in Joint Photographic Experts Group (JPEG) format. See http://www.libpng.org and http://www.jpeg.org/ for detailed information on these formats.</p> <p>You can set or reset the <code>image</code> property at any time to change the image displayed in the element.</p> <p>The scripting environment can define icon resources, which are available to scripts by name. To specify an icon resource, set a control's <code>image</code> property to the resource's JavaScript name, or refer to the resource by name when creating the control. For example, to create a button with an application-defined icon resource:</p> <pre><code>myWin.upBtn = myWin.add ( \"iconbutton\", undefined, \"SourceFolderIcon\" );\n</code></pre> <p>Photoshop CC, for example, defines these icon resources:</p> <ul> <li><code>Step1Icon</code></li> <li><code>Step2Icon</code></li> <li><code>Step3Icon</code></li> <li><code>Step4Icon</code></li> <li><code>SourceFolderIcon</code></li> <li><code>DestinationFolderIcon</code></li> </ul> <p>If a script does not explicitly set the <code>preferredSize</code> or <code>size</code> property of an element that displays a icon image, the value of <code>preferredSize</code> is determined by the dimensions of the iconic image. If the size values are explicitly set to dimensions smaller than those of the actual image graphic, the displayed image is clipped. If they are set to dimensions larger than those of the image graphic, the displayed image is centered in the larger space. An image is never scaled to fit the available space.</p>"},{"location":"user-interface-tools/types-of-controls/#creating-multi-column-lists","title":"Creating multi-column lists","text":"<p>In list controls (ListBox, DropDownList and TreeView), a set of ListItem objects represents the individual choices in the list. Each choice can be labeled with a localizable string, an image, or both, as specified by the text and image properties of the ListItem (see Displaying images).</p> <p>You can define a ListBox to have multiple columns, by specifying the <code>numberOfColumns</code> creation parameter. By default, the number of columns is 1. If you specify multiple columns, you can also use the creation parameters to specify whether headers are shown, and the header text for each column.</p> <p>If you specify more than one column, each ListItem object that you add to the box specifies one selectable row. The <code>text</code> and <code>image</code> of the ListItem object specifies the label in the first column, and the subitems property specifies labels that appear in that row for the remaining columns.</p> <p>The subitems value is an array, whose length is one less than the number of columns. That is, the first member, <code>ListItem.subitems[0]</code>, specifies the label in the second column. Each member specifies one label, as a JavaScript object with two properties:</p> <pre><code>{ text : displayString , image : imageFileReference }\n</code></pre> <p>For example, the following fragment defines a list box with two columns, and specifies the labels in each column for the two choices:</p> <pre><code>...\n// create list box with two titled columns\nvar list = dlg.add (\"ListBox\", [0, 0, 150, 75], \"asd\",\n{numberOfColumns: 2, showHeaders: true,\ncolumnTitles: [\"First Name\", \"Last Name\"]});\n// add an item for the first row, with the label value for the first column\nvar item1 = list.add (\"item\", \"John\");\n// add the label value for the second column in that row.\nitem1.subItems[0].text = \"Doe\";\n// add an item for the second row, with the text for the first column label\nvar item2 = list.add (\"item\", \"Jane\");\n// add the label text and image for the second column in the second row\nitem2.subItems[0].text = \"Doe\";\nitem2.subItems[0].image = File (\"~/Desktop/Step1.png\");\n...\n</code></pre> <p>This creates a control that looks like this:</p> <p></p> <p>Notice that the columns have headers, and the label in the second column of the second row has both text and an image.</p>"},{"location":"user-interface-tools/types-of-controls/#prompts-and-alerts","title":"Prompts and alerts","text":"<p>Static functions on the <code>Window</code> class are globally available to display short messages in standard dialogs.</p> <p>The host application controls the appearance of these simple dialogs, so they are consistent with other alert and message boxes displayed by the application. You can often use these standard dialogs for simple interactions with your users, rather than designing special-purpose dialogs of your own.</p> <p>Use the static functions <code>alert</code>, <code>confirm</code>, and <code>prompt</code> on the <code>Window</code> class to invoke these dialogs with your own messages. You do not need to create a Window object to call these functions.</p>"},{"location":"user-interface-tools/types-of-controls/#modal-dialogs","title":"Modal dialogs","text":"<p>A modal dialog is initially invisible. Your script invokes it using the <code>show</code> method, which does not return until the dialog has been dismissed. The user can dismiss it by using a platform-specific window gesture, or by using one of the dialog controls that you supply, typically an OK or Cancel button. The <code>onClick</code> method of such a button must call the <code>close</code> or <code>hide</code> method to close the dialog. The <code>close</code> method allows you to pass a value to be returned by the show method.</p> <p>For an example of how to define such buttons and their behavior, see Defining behavior with event callbacks and listeners.</p>"},{"location":"user-interface-tools/types-of-controls/#creating-and-using-modal-dialogs","title":"Creating and using modal dialogs","text":"<p>A dialog typically contains some controls that the user must interact with, to make selections or enter values that your script will use. In some cases, the result of the user action is stored in the object, and you can retrieve it after the dialog has been dismissed. For example, if the user changes the state of a <code>Checkbox</code> or <code>RadioButton</code>, the new state is found in the control's <code>value</code> property.</p> <p>However, if you need to respond to a user action while the dialog is still active, you must assign the control a callback function for the interaction event, either <code>onClick</code> or <code>onChange</code>. The callback function is the value of the <code>onClick</code> or <code>onChange</code> property of the control.</p> <p>For example, if you need to validate a value that the user enters in a edittext control, you can do so in an <code>onChange</code> callback handler function for that control. The callback can perform the validation, and perhaps display an alert to inform the user of errors.</p> <p>Sometimes, a modal dialog presents choices to the user that must be correct before your script allows the dialog to be dismissed. If your script needs to validate the state of a dialog after the user clicks OK, you can define an <code>onClose</code> event handler for the dialog. This callback function is invoked whenever a window is closed. If the function returns <code>true</code>, the window is closed, but if it returns <code>false</code>, the close operation is cancelled and the window remains open.</p> <p>Your <code>onClose</code> handler can examine the states of any controls in the dialog to determine their correctness, and can show alert messages or use other modal dialogs to alert the user to any errors that must be corrected. It can then return <code>true</code> to allow the dialog to be dismissed, or <code>false</code> to allow the user to correct any errors.</p>"},{"location":"user-interface-tools/types-of-controls/#dismissing-a-modal-dialog","title":"Dismissing a modal dialog","text":"<p>Every modal dialog should have at least one button that the user can click to dismiss the dialog. Typically modal dialogs have an OK and a Cancel button to close the dialog with or without accepting changes that were made in it.</p> <p>You can define <code>onClick</code> callbacks for the buttons that close the parent dialog by calling its close method. You have the option of sending a value to the close method, which is in turn passed on to and returned from the show method that invoked the dialog. This return value allows your script to distinguish different closing events; for example, clicking OK can return 1, clicking Cancel can return 2. However, for this typical behavior, you do not need to define these callbacks explicitly; see Default and cancel elements.</p> <p>For some dialogs, such as a simple alert with only an OK button, you do not need to return any value. For more complex dialogs with several possible user actions, you might need to distinguish more outcomes. If you need to distinguish more than two closing states, you must define your own closing callbacks rather than relying on the default behavior.</p> <p>If, by mistake, you create a modal dialog with no buttons to dismiss it, or if your dialog does have buttons, but their <code>onClick</code> handlers do not function properly, a user can still dismiss the dialog by typing ESC. In this case, the system will execute a call to the dialog's <code>close</code> method, passing a value of 2. This is not, of course, a recommended way to design your dialogs, but is provided as an escape hatch to prevent the application from hanging in case of an error in the operations of your dialog.</p>"},{"location":"user-interface-tools/types-of-controls/#default-and-cancel-elements","title":"Default and cancel elements","text":"<p>The user can typically dismiss a modal dialog by clicking an OK or Cancel button, or by typing certain keyboard shortcuts. By convention, typing ENTER is the same as clicking OK or the default button, and typing ESC is the same as clicking Cancel. The keyboard shortcut has the same effect as calling notify for the associated <code>button</code> control.</p> <p>To determine which control is notified by which keyboard shortcut, set the <code>Dialog</code> object's <code>defaultElement</code> and <code>cancelElement</code> properties. The value is the control object that should be notified when the user types the associated keyboard shortcut.</p> <ul> <li>For buttons assigned as the <code>defaultElement</code>, if there is no <code>onClick</code> handler associated with the button, clicking the button or typing ENTER calls the parent dialog's <code>close</code> method, passing a value of 1 to be returned by the show call that opened the dialog.</li> <li>For buttons assigned as the <code>cancelElement</code>, if there is no <code>onClick</code> handler associated with the button, clicking the button or typing ESC calls the parent dialog's <code>close</code> method, passing a value of 2 to be returned by the show call that opened the dialog.</li> </ul> <p>If you do not set the <code>defaultElement</code> and <code>cancelElement</code> properties explicitly, ScriptUI tries to choose reasonable defaults when the dialog is about to be shown for the first time. For the default element, it looks for a button whose <code>name</code> or <code>text</code> value is <code>\"ok\"</code> (disregarding case). For the cancel element, it looks for a button whose <code>name</code> or <code>text</code> value is <code>\"cancel\"</code> (disregarding case). Because it looks at the name value first, this works even if the text value is localized. If there is no suitable button in the dialog, the property value remains <code>null</code>, which means that the keyboard shortcut has no effect in that dialog.</p> <p>To make this feature most useful, it is recommended that you always provide the <code>name</code> creation property for buttons meant to be used in this way.</p>"},{"location":"user-interface-tools/window-class/","title":"Window class","text":"<p>The Window class defines these static properties and functions. Window instances created with new <code>Window()</code> do not have these properties and functions defined.</p>"},{"location":"user-interface-tools/window-class/#window-class-attributes","title":"Window Class Attributes","text":""},{"location":"user-interface-tools/window-class/#windowframeworkname","title":"Window.frameworkName","text":"<p><code>Window.frameworkName</code></p>"},{"location":"user-interface-tools/window-class/#description","title":"Description","text":"<p>Danger</p> <p>Deprecated. Use ScriptUI.frameworkName instead.</p>"},{"location":"user-interface-tools/window-class/#type","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/window-class/#windowversion","title":"Window.version","text":"<p><code>Window.version</code></p>"},{"location":"user-interface-tools/window-class/#description_1","title":"Description","text":"<p>Danger</p> <p>Deprecated. Use ScriptUI.version instead.</p>"},{"location":"user-interface-tools/window-class/#type_1","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/window-class/#window-class-methods","title":"Window Class Methods","text":"<p>Access these function through the class. For example:</p> <pre><code>Window.alert(\"Notification to user\");\n</code></pre>"},{"location":"user-interface-tools/window-class/#alert","title":"alert()","text":"<p><code>Window.alert(message[, title=\"Script Alert\", errorIcon=false]);</code></p>"},{"location":"user-interface-tools/window-class/#description_2","title":"Description","text":"<p>Displays a platform-standard dialog containing a short message and an OK button.</p>"},{"location":"user-interface-tools/window-class/#parameters","title":"Parameters","text":"Parameter Type Description <code>message</code> String The string for the displayed message. <code>title</code> String Optional. A string to appear as the title of the dialog, if the platform supports a title. Mac OS does not support titles for alert dialogs. The default title string is <code>\"Script Alert\"</code> <code>errorIcon</code> Boolean Optional. When <code>true</code>, the platform-standard alert icon is replaced by the platform-standard error icon in the dialog. Default is <code>false</code>."},{"location":"user-interface-tools/window-class/#returns","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-class/#confirm","title":"confirm()","text":"<p><code>Window.confirm(message[, noAsDflt=false, title=\"Script Alert\"]);</code></p>"},{"location":"user-interface-tools/window-class/#description_3","title":"Description","text":"<p>Displays a platform-standard dialog containing a short message and two buttons labeled \"Yes\" and \"No\".</p>"},{"location":"user-interface-tools/window-class/#parameters_1","title":"Parameters","text":"Parameter Type Description <code>message</code> String The string for the displayed message. <code>noAsDflt</code> Boolean Optional. When <code>true</code>, the No button is the default choice, selected when the user types ENTER. Default is <code>false</code>, meaning that Yes is the default choice. <code>title</code> String Optional. A string to appear as the title of the dialog, if the platform supports a title. Mac OS does not support titles for confirmation dialogs. The default title string is <code>\"Script Alert\"</code>"},{"location":"user-interface-tools/window-class/#returns_1","title":"Returns","text":"<p>Boolean. <code>true</code> if the user clicked \"Yes\", <code>false</code> if the user clicked \"No\".</p>"},{"location":"user-interface-tools/window-class/#find","title":"find()","text":"<p><code>Window.find(resourceName)</code></p> <p><code>Window.find(type, title)</code></p>"},{"location":"user-interface-tools/window-class/#description_4","title":"Description","text":"<p>Use this method to find an existing window. This includes windows already created by a script, and windows created by the application (if the application supports this case).</p> <p>Warning</p> <p>Not supported in all ScriptUI implementations.</p>"},{"location":"user-interface-tools/window-class/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>resourceName</code> String The name of a predefined resource available to JavaScript in the current application. <code>type</code> String Optional. The window type (see Window object constructor) used if there is more than one window with the same title. Can be <code>null</code> or the empty string. <code>title</code> Strign The window title."},{"location":"user-interface-tools/window-class/#returns_2","title":"Returns","text":"<p>Window object found or generated from the resource, or <code>null</code> if no such window or resource exists.</p>"},{"location":"user-interface-tools/window-class/#prompt","title":"prompt()","text":"<p><code>Window.prompt(message, preset[, title=\"Script Prompt\"]);</code></p>"},{"location":"user-interface-tools/window-class/#description_5","title":"Description","text":"<p>Displays a modal dialog that returns the user's text input.</p>"},{"location":"user-interface-tools/window-class/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>message</code> String The string for the displayed message. <code>preset</code> String The initial value to be displayed in the text edit field. <code>title</code> String Optional. A string to appear as the title of the dialog. In Windows, this appears in the window's frame; in Mac OS it appears above the message. The default title string is <code>\"Script Prompt\"</code>."},{"location":"user-interface-tools/window-class/#returns_3","title":"Returns","text":"<p>Returns the value of the text edit field if the user clicked OK, <code>null</code> if the user clicked Cancel.</p>"},{"location":"user-interface-tools/window-object/","title":"Window object","text":""},{"location":"user-interface-tools/window-object/#window-object-constructor","title":"Window Object constructor","text":"<p>The constructor creates and returns a new Window object, or null if window creation failed.</p> <pre><code>new Window (type [, title, bounds, {creation_properties}]);\n</code></pre> <p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>type</code></p> <p>String</p> <p>The window type. One of:</p> <ul> <li><code>\"dialog\"</code> - Creates a modal dialog.</li> <li><code>\"palette\"</code> - Creates a modeless dialog, also called a floating palette. (Not supported by Photoshop CC.)</li> <li><code>\"window\"</code> - Creates a simple window that can be used as a main window for an application. (Not supported by Photoshop CC.)</li> </ul> <p>This argument can be a ScriptUI resource specification; in this case, all other arguments are ignored. See Resource specifications.</p> <p><code>title</code></p> <p>String</p> <p>Optional. The window title. A localizable string.</p> <p><code>bounds</code></p> <p>Bounds object.</p> <p>Optional. The window's position and size.</p> <p><code>creation_properties</code></p> <p>Object</p> <p>Optional. An object that contains any of the properties below.</p>"},{"location":"user-interface-tools/window-object/#creation-properties","title":"Creation Properties","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>resizeable</code></p> <p>Boolean</p> <p>When <code>true</code>, the window can be resized by the user.</p> <p>Default is <code>false</code>.</p> <p><code>su1PanelCoordinates</code></p> <p>Boolean</p> <p>(Photoshop only) When <code>true</code>, the child panels of this window automatically adjust the positions of their children for compatability with Photoshop CS (in which the vertical coordinate was measured from outside the frame). Individual panels can override the parent window's setting.</p> <p>Default is <code>false</code>.</p> <p><code>closeButton</code></p> <p>Boolean</p> <p>When <code>true</code>, the title bar includes a button to close the window, if the platform and window type allow it. When <code>false</code>, it does not. Not used for dialogs.</p> <p>Default is <code>true</code>.</p> <p><code>maximizeButton</code></p> <p>Boolean</p> <p>When <code>true</code>, the title bar includes a button to expand the window to its maximum size (typically, the entire screen), if the platform and window type allow it. When <code>false</code>, it does not. Not used for dialogs.</p> <p>Default is <code>false</code> for type palette, <code>true</code> for type window.</p> <p><code>minimizeButton</code></p> <p>Boolean</p> <p>When <code>true</code>, the title bar includes a button to minimize or iconify the window, if the platform and window type allow it. When <code>false</code>, it does not. Main windows cannot have a minimize button in Mac OS. Not used for dialogs.</p> <p>Default is <code>false</code> for type palette, <code>true</code> for type window.</p> <p><code>independent</code></p> <p>Boolean</p> <p>When <code>true</code>, a window of type window is independent of other application windows, and can be hidden behind them in Windows. In Mac OS, has no effect.</p> <p>Default is <code>false</code>.</p> <p><code>borderless</code></p> <p>Boolean</p> <p>When <code>true</code>, the window has no title bar or borders. Properties that control those features are ignored.</p>"},{"location":"user-interface-tools/window-object/#window-object-attributes","title":"Window Object Attributes","text":"<p>The following element properties apply specifically to Window elements:</p>"},{"location":"user-interface-tools/window-object/#active","title":"active","text":"<p><code>windowOrContainerObj.active</code></p>"},{"location":"user-interface-tools/window-object/#description","title":"Description","text":"<p>When <code>true</code>, the object is active, <code>false</code> otherwise. Set to <code>true</code> to make a given control or dialog active.</p> <ul> <li>A modal dialog that is visible is by definition the active dialog.</li> <li>An active palette is the front-most window.</li> <li>An active control is the one with focus-that is, the one that accepts keystrokes, or in the case of a Button, be selected when the user types RETURN or ENTER.</li> </ul>"},{"location":"user-interface-tools/window-object/#type","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/window-object/#cancelelement","title":"cancelElement","text":"<p><code>windowOrContainerObj.cancelElement</code></p>"},{"location":"user-interface-tools/window-object/#description_1","title":"Description","text":"<p>For a window of type dialog, the control to notify when a user types the ESC key.</p> <p>By default, looks for a button whose name or text is <code>\"cancel\"</code> (case disregarded).</p>"},{"location":"user-interface-tools/window-object/#type_1","title":"Type","text":"<p>Control object</p>"},{"location":"user-interface-tools/window-object/#defaultelement","title":"defaultElement","text":"<p><code>windowOrContainerObj.defaultElement</code></p>"},{"location":"user-interface-tools/window-object/#description_2","title":"Description","text":"<p>For a window of type dialog, the control to notify when a user types the ENTER key.</p> <p>By default, looks for a button whose name or text is <code>\"ok\"</code> (case disregarded).</p>"},{"location":"user-interface-tools/window-object/#type_2","title":"Type","text":"<p>Control object</p>"},{"location":"user-interface-tools/window-object/#framebounds","title":"frameBounds","text":"<p><code>windowOrContainerObj.frameBounds</code></p>"},{"location":"user-interface-tools/window-object/#description_3","title":"Description","text":"<p>A Bounds object for the boundaries of the Window's frame in screen coordinates.</p> <p>The frame consists of the title bar and borders that enclose the content region of a window, depending on the windowing system.</p>"},{"location":"user-interface-tools/window-object/#type_3","title":"Type","text":"<p>Bounds. Read only.</p>"},{"location":"user-interface-tools/window-object/#framelocation","title":"frameLocation","text":"<p><code>windowOrContainerObj.frameLocation</code></p>"},{"location":"user-interface-tools/window-object/#description_4","title":"Description","text":"<p>A Point object for the location of the top left corner of the Window's frame. The same as <code>[frameBounds.x, frameBounds.y]</code>.</p> <p>Set this value to move the window frame to the specified location on the screen. The <code>frameBounds</code> value changes accordingly.</p>"},{"location":"user-interface-tools/window-object/#type_4","title":"Type","text":"<p>Point</p>"},{"location":"user-interface-tools/window-object/#framesize","title":"frameSize","text":"<p><code>windowOrContainerObj.frameSize</code></p>"},{"location":"user-interface-tools/window-object/#description_5","title":"Description","text":"<p>A Dimension object for the size and location of the Window's frame in screen coordinates.</p>"},{"location":"user-interface-tools/window-object/#type_5","title":"Type","text":"<p>Dimension. Read only.</p>"},{"location":"user-interface-tools/window-object/#maximized","title":"maximized","text":"<p><code>windowOrContainerObj.maximized</code></p>"},{"location":"user-interface-tools/window-object/#description_6","title":"Description","text":"<p>When <code>true</code>, the window is expanded.</p>"},{"location":"user-interface-tools/window-object/#type_6","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/window-object/#minimized","title":"minimized","text":"<p><code>windowOrContainerObj.minimized</code></p>"},{"location":"user-interface-tools/window-object/#description_7","title":"Description","text":"<p>When <code>true</code>, the window is minimized or iconified.</p>"},{"location":"user-interface-tools/window-object/#type_7","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/window-object/#opacity","title":"opacity","text":"<p><code>windowOrContainerObj.opacity</code></p>"},{"location":"user-interface-tools/window-object/#description_8","title":"Description","text":"<p>The opacity of the window, in the range <code>[0..1]</code>.</p> <p>A value of <code>1.0</code> (the default) makes the window completely opaque, a value of 0 makes it completely transparent.</p> <p>Intermediate values make it partially transparent to any degree.</p>"},{"location":"user-interface-tools/window-object/#type_8","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/window-object/#shortcutkey","title":"shortcutKey","text":"<p><code>windowOrContainerObj.shortcutKey</code></p>"},{"location":"user-interface-tools/window-object/#description_9","title":"Description","text":"<p>Note</p> <p>In Windows only.</p> <p>The key sequence that invokes this window's ControlEvent.onShortcutKey callback.</p>"},{"location":"user-interface-tools/window-object/#type_9","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/window-object/#container-attributes","title":"Container Attributes","text":"<p>The following table shows properties that apply to Window objects and container objects (controls of type <code>panel</code>, <code>tabbedpanel</code>, <code>tab</code>, and <code>group</code>).</p>"},{"location":"user-interface-tools/window-object/#alignchildren","title":"alignChildren","text":"<p><code>windowOrContainerObj.alignChildren</code></p>"},{"location":"user-interface-tools/window-object/#description_10","title":"Description","text":"<p>Tells the layout manager how unlike-sized children of a container should be aligned within a column or row. Order of creation determines which children are at the top of a column or the left of a row; the earlier a child is created, the closer it is to the top or left of its column or row.</p> <p>If defined, alignment for a child element overrides the alignChildren setting for the parent container.</p> <p>For a single string value, allowed values depend on the orientation value.</p> <p>For <code>orientation=row</code>:</p> <ul> <li><code>top</code></li> <li><code>bottom</code></li> <li><code>center</code> (default)</li> <li><code>fill</code></li> </ul> <p>For <code>orientation=column</code>:</p> <ul> <li><code>left</code></li> <li><code>right</code></li> <li><code>center</code> (default)</li> <li><code>fill</code></li> </ul> <p>For <code>orientation=stack</code>:</p> <ul> <li><code>top</code></li> <li><code>bottom</code></li> <li><code>left</code></li> <li><code>right</code></li> <li><code>center</code> (default)</li> <li><code>fill</code></li> </ul> <p>For an array value, the first string element defines the horizontal alignment and the second element defines the vertical alignment. The horizontal alignment value must be one of left, right, center or fill. The vertical alignment value must be one of top, bottom, center, or fill.</p> <p>Values are not case sensitive.</p>"},{"location":"user-interface-tools/window-object/#type_10","title":"Type","text":"<p>String, or Array of 2 Strings</p>"},{"location":"user-interface-tools/window-object/#alignment","title":"alignment","text":"<p><code>windowOrContainerObj.alignment</code></p>"},{"location":"user-interface-tools/window-object/#description_11","title":"Description","text":"<p>Applies to child elements of a container. If defined, this value overrides the alignChildren setting for the parent container.</p> <p>For a single string value, allowed values depend on the <code>orientation</code> value.</p> <p>For <code>orientation = row</code>:</p> <ul> <li><code>top</code></li> <li><code>bottom</code></li> <li><code>center</code> (default)</li> <li><code>fill</code></li> </ul> <p>For <code>orientation=column</code>:</p> <ul> <li><code>left</code></li> <li><code>right</code></li> <li><code>center</code> (default)</li> <li><code>fill</code></li> </ul> <p>For <code>orientation = stack</code>:</p> <ul> <li><code>top</code></li> <li><code>bottom</code></li> <li><code>left</code></li> <li><code>right</code></li> <li><code>center</code> (default)</li> <li><code>fill</code></li> </ul> <p>For an array value, the first string element defines the horizontal alignment and the second element defines the vertical alignment.</p> <p>The horizontal alignment value must be one of <code>left</code>, <code>right</code>, <code>center</code> or <code>fill</code>. The vertical alignment value must be one of <code>top</code>, <code>bottom</code>, <code>center</code>, or <code>fill</code>.</p> <p>Values are not case sensitive.</p>"},{"location":"user-interface-tools/window-object/#type_11","title":"Type","text":"<p>String, or Array of 2 Strings</p>"},{"location":"user-interface-tools/window-object/#bounds","title":"bounds","text":"<p><code>windowOrContainerObj.bounds</code></p>"},{"location":"user-interface-tools/window-object/#description_12","title":"Description","text":"<p>A Bounds object for the boundaries of the window's drawable area in screen coordinates. Compare frameBounds.</p> <p>Does not apply to containers of type tab, whose bounds are determined by the parent tabbedpanel container.</p>"},{"location":"user-interface-tools/window-object/#type_12","title":"Type","text":"<p>Bounds. Read only.</p>"},{"location":"user-interface-tools/window-object/#children","title":"children","text":"<p><code>windowOrContainerObj.children</code></p>"},{"location":"user-interface-tools/window-object/#description_13","title":"Description","text":"<p>The collection of user-interface elements that have been added to this window or container.</p> <p>An array indexed by number or by a string containing an element's <code>name</code>. The <code>length</code> property of this array is the number of child elements for container elements, and is zero for controls.</p>"},{"location":"user-interface-tools/window-object/#type_13","title":"Type","text":"<p>Array of Objects. Read only.</p>"},{"location":"user-interface-tools/window-object/#graphics","title":"graphics","text":"<p><code>windowOrContainerObj.graphics</code></p>"},{"location":"user-interface-tools/window-object/#description_14","title":"Description","text":"<p>A ScriptUIGraphics object that can be used to customize the window's appearance, in response to the onDraw event.</p>"},{"location":"user-interface-tools/window-object/#type_14","title":"Type","text":"<p>ScriptUIGraphics object</p>"},{"location":"user-interface-tools/window-object/#layout","title":"layout","text":"<p><code>windowOrContainerObj.layout</code></p>"},{"location":"user-interface-tools/window-object/#description_15","title":"Description","text":"<p>A LayoutManager object for a window or container. The first time a container object is made visible, ScriptUI invokes this layout manager by calling its layout function.</p> <p>Default is an instance of the LayoutManager class that is automatically created when the container element is created.</p>"},{"location":"user-interface-tools/window-object/#type_15","title":"Type","text":"<p>LayoutManager object</p>"},{"location":"user-interface-tools/window-object/#location","title":"location","text":"<p><code>windowOrContainerObj.location</code></p>"},{"location":"user-interface-tools/window-object/#description_16","title":"Description","text":"<p>A Point object for the location of the top left corner of the Window's drawable area, or the top left corner of the frame for a panel.</p> <p>The same as <code>[bounds.x, bounds.y]</code>.</p>"},{"location":"user-interface-tools/window-object/#type_16","title":"Type","text":"<p>Point</p>"},{"location":"user-interface-tools/window-object/#margins","title":"margins","text":"<p><code>windowOrContainerObj.margins</code></p>"},{"location":"user-interface-tools/window-object/#description_17","title":"Description","text":"<p>A Margins object describing the number of pixels between the edges of this container and the outermost child elements. You can specify different margins for each edge of the container.</p> <p>The default value is based on the type of container, and is chosen to match the standard Adobe user-interface guidelines.</p>"},{"location":"user-interface-tools/window-object/#type_17","title":"Type","text":"<p>Margins</p>"},{"location":"user-interface-tools/window-object/#maximumsize","title":"maximumSize","text":"<p><code>windowOrContainerObj.maximumSize</code></p>"},{"location":"user-interface-tools/window-object/#description_18","title":"Description","text":"<p>Dimension</p> <p>A Dimension object for the largest rectangle to which the window can be resized, used in automatic layout and resizing.</p>"},{"location":"user-interface-tools/window-object/#type_18","title":"Type","text":""},{"location":"user-interface-tools/window-object/#minimumsize","title":"minimumSize","text":"<p><code>windowOrContainerObj.minimumSize</code></p>"},{"location":"user-interface-tools/window-object/#description_19","title":"Description","text":"<p>Dimension</p> <p>A Dimension object for the smallest rectangle to which the window can be resized, used in automatic layout and resizing.</p>"},{"location":"user-interface-tools/window-object/#type_19","title":"Type","text":""},{"location":"user-interface-tools/window-object/#orientation","title":"orientation","text":"<p><code>windowOrContainerObj.orientation</code></p>"},{"location":"user-interface-tools/window-object/#description_20","title":"Description","text":"<p>How elements are organized within this container.</p> <p>Interpreted by the layout manager for the container.</p> <p>The default LayoutManager object accepts the (case-insensitive) values:</p> <ul> <li><code>row</code></li> <li><code>column</code></li> <li><code>stack</code></li> </ul> <p>The default orientation depends on the type of container. For <code>Window</code> and <code>Panel</code>, the default is <code>column</code>, and for <code>Group</code> the default is <code>row</code>.</p> <p>The allowed values for the container's alignChildren and its children's alignment properties depend on the orientation.</p>"},{"location":"user-interface-tools/window-object/#type_20","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/window-object/#parent","title":"parent","text":"<p><code>windowOrContainerObj.parent</code></p>"},{"location":"user-interface-tools/window-object/#description_21","title":"Description","text":"<p>The immediate parent object of this element, a window or container element. The value is <code>null</code> for Window objects.</p>"},{"location":"user-interface-tools/window-object/#type_21","title":"Type","text":"<p>Object. Read only.</p>"},{"location":"user-interface-tools/window-object/#preferredsize","title":"preferredSize","text":"<p><code>windowOrContainerObj.preferredSize</code></p>"},{"location":"user-interface-tools/window-object/#description_22","title":"Description","text":"<p>A Dimension object for the preferred size of the window, used in automatic layout and resizing. To set a specific value for only one dimension, specify other dimension as <code>-1</code>.</p>"},{"location":"user-interface-tools/window-object/#type_22","title":"Type","text":"<p>Dimension</p>"},{"location":"user-interface-tools/window-object/#properties","title":"properties","text":"<p><code>windowOrContainerObj.properties</code></p>"},{"location":"user-interface-tools/window-object/#description_23","title":"Description","text":"<p>An object that contains one or more creation properties of the container (properties used only when the element is created).</p>"},{"location":"user-interface-tools/window-object/#type_23","title":"Type","text":"<p>Object</p>"},{"location":"user-interface-tools/window-object/#selection","title":"selection","text":"<p><code>windowOrContainerObj.selection</code></p>"},{"location":"user-interface-tools/window-object/#description_24","title":"Description","text":"<p>Info</p> <p>For TabbedPanel objects only.</p> <p>The currently active Tab child. Setting this property changes the active tab. The value can only be <code>null</code> when the panel has no children; setting it to <code>null</code> is an error.</p> <p>When the value changes, either by a user selecting a different tab, or by a script setting the property, the onChange callback for the panel is called.</p>"},{"location":"user-interface-tools/window-object/#type_24","title":"Type","text":"<p>tab</p>"},{"location":"user-interface-tools/window-object/#size","title":"size","text":"<p><code>windowOrContainerObj.size</code></p>"},{"location":"user-interface-tools/window-object/#description_25","title":"Description","text":"<p>A Dimension object for the current size and location of a group or panel element, or of the content area of a window.</p>"},{"location":"user-interface-tools/window-object/#type_25","title":"Type","text":"<p>Dimension</p>"},{"location":"user-interface-tools/window-object/#spacing","title":"spacing","text":"<p><code>windowOrContainerObj.spacing</code></p>"},{"location":"user-interface-tools/window-object/#description_26","title":"Description","text":"<p>The number of pixels separating one child element from its adjacent sibling element. Because each container holds only a single row or column of children, only a single spacing value is needed for a container.</p> <p>The default value is based on the type of container, and is chosen to match standard Adobe user-interface guidelines.</p>"},{"location":"user-interface-tools/window-object/#type_26","title":"Type","text":"<p>Number</p>"},{"location":"user-interface-tools/window-object/#text","title":"text","text":"<p><code>windowOrContainerObj.text</code></p>"},{"location":"user-interface-tools/window-object/#description_27","title":"Description","text":"<p>The title, label, or displayed text. Does not apply to containers of type <code>group</code> or <code>tabbedpanel</code>.</p> <p>This is a localizable string: see Localization in ScriptUI objects.</p>"},{"location":"user-interface-tools/window-object/#type_27","title":"Type","text":"<p>String</p>"},{"location":"user-interface-tools/window-object/#visible","title":"visible","text":"<p><code>windowOrContainerObj.visible</code></p>"},{"location":"user-interface-tools/window-object/#description_28","title":"Description","text":"<p>When <code>true</code>, the element is shown, when <code>false</code> it is hidden.</p> <p>When a container is hidden, its children are also hidden, but they retain their own visibility values, and are shown or hidden accordingly when the parent is next shown.</p>"},{"location":"user-interface-tools/window-object/#type_28","title":"Type","text":"<p>Boolean</p>"},{"location":"user-interface-tools/window-object/#window","title":"window","text":"<p><code>windowOrContainerObj.window</code></p>"},{"location":"user-interface-tools/window-object/#description_29","title":"Description","text":"<p>The top-level parent window of this container, a Window object.</p>"},{"location":"user-interface-tools/window-object/#type_29","title":"Type","text":"<p>Window</p>"},{"location":"user-interface-tools/window-object/#windowbounds","title":"windowBounds","text":"<p><code>windowOrContainerObj.windowBounds</code></p>"},{"location":"user-interface-tools/window-object/#description_30","title":"Description","text":"<p>A Bounds object for the size and location of this container relative to its top-level parent window.</p>"},{"location":"user-interface-tools/window-object/#type_30","title":"Type","text":"<p>Bounds</p>"},{"location":"user-interface-tools/window-object/#window-object-methods","title":"Window Object Methods","text":"<p>These functions are defined for Window instances, and as indicated for container objects of type <code>Panel</code> and <code>Group</code>.</p>"},{"location":"user-interface-tools/window-object/#add","title":"add()","text":"<p><code>windowOrContainerObj.add(type[, bounds, text, { creation_props } ]);</code></p>"},{"location":"user-interface-tools/window-object/#description_31","title":"Description","text":"<p>Creates and returns a new control or container object and adds it to the children of this window or container.</p>"},{"location":"user-interface-tools/window-object/#parameters","title":"Parameters","text":"Parameter Type Description <code>type</code> String The control type. See Control types and creation parameters. <code>bounds</code> Bounds object Optional. A bounds specification that describes the size and position of the new control or container, relative to its parent. See Bounds object for specification formats. If supplied, this value creates a new Bounds object which is assigned to the new object's bounds property. <code>text</code> String Optional. Initial text to be displayed in the control as the title, label, or contents, depending on the control type. If supplied, this value is assigned to the new object's text property. <code>creation_props</code> Object. Optional. The properties of this object specify creation parameters, which are specific to each object type. See Control types and creation parameters."},{"location":"user-interface-tools/window-object/#returns","title":"Returns","text":"<p>The new object, or <code>null</code> if unable to create the object.</p>"},{"location":"user-interface-tools/window-object/#addeventlistener","title":"addEventListener()","text":"<p><code>windowObj.addEventListener(eventName, handler[, capturePhase=false]);</code></p>"},{"location":"user-interface-tools/window-object/#description_32","title":"Description","text":"<p>Registers an event handler for a particular type of event occurring in this window.</p>"},{"location":"user-interface-tools/window-object/#parameters_1","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>eventName</code></p> <p>String</p> <p>The event name string. Predefined event names include:</p> <ul> <li><code>\"change\"</code></li> <li><code>\"changing\"</code></li> <li><code>\"move\"</code></li> <li><code>\"moving\"</code></li> <li><code>\"resize\"</code></li> <li><code>\"resizing\"</code></li> <li><code>\"show\"</code></li> <li><code>\"enterKey\"</code></li> <li><code>\"focus\"</code></li> <li><code>\"blur\"</code></li> <li><code>\"mousedown\"</code></li> <li><code>\"mouseup\"</code></li> <li><code>\"mousemove\"</code></li> <li><code>\"mouseover\"</code></li> <li><code>\"mouseout\"</code></li> <li><code>\"click\"</code> (detail = 1 for single, 2 for double)</li> </ul> <p><code>handler</code></p> <p>Function</p> <p>The function to register for the specified event in this target. This can be the name of a function defined in the extension, or a locally defined handler function to be executed when the event occurs. A handler function takes one argument, the UIEvent base class. See Registering event listeners for windows or controls.</p> <p><code>capturePhase</code></p> <p>Boolean</p> <p>Optional. When <code>true</code>, the handler is called only in the capturing phase of the event propagation. Default is <code>false</code>, meaning that the handler is called in the bubbling phase if this object is an ancestor of the target, or in the at-target phase if this object is itself the target.</p>"},{"location":"user-interface-tools/window-object/#returns_1","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#center","title":"center()","text":"<p><code>windowObj.center([window])</code></p>"},{"location":"user-interface-tools/window-object/#description_33","title":"Description","text":"<p>Centers this window on the screen, or with respect to another specified window.</p>"},{"location":"user-interface-tools/window-object/#parameters_2","title":"Parameters","text":"Parameter Type Description <code>window</code> Window object Optional. A Window object."},{"location":"user-interface-tools/window-object/#returns_2","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#close","title":"close()","text":"<p><code>windowObj.close([result])</code></p>"},{"location":"user-interface-tools/window-object/#description_34","title":"Description","text":"<p>Closes this window. If an <code>onClose</code> callback is defined for the window, calls that function before closing the window.</p>"},{"location":"user-interface-tools/window-object/#parameters_3","title":"Parameters","text":"Parameter Type Description <code>result</code> Number Optional. A number to be returned from the show method that invoked this window as a modal dialog."},{"location":"user-interface-tools/window-object/#returns_3","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#dispatchevent","title":"dispatchEvent()","text":"<p><code>windowObj.dispatchEvent(eventObj)</code></p>"},{"location":"user-interface-tools/window-object/#description_35","title":"Description","text":"<p>Simulates the occurrence of an event in this target. A script can create a UIEvent base class for a specific event and pass it to this method to start the event propagation for the event.</p>"},{"location":"user-interface-tools/window-object/#parameters_4","title":"Parameters","text":"Parameter Type Description <code>eventObj</code> UIEvent base class A UIEvent base class."},{"location":"user-interface-tools/window-object/#returns_4","title":"Returns","text":"<p>Boolean. <code>false</code> if any of the registered listeners that handled the event called the event object's preventDefault() method, <code>true</code> otherwise.</p>"},{"location":"user-interface-tools/window-object/#findelement","title":"findElement()","text":"<p><code>windowOrContainerObj.findElement(name)</code></p>"},{"location":"user-interface-tools/window-object/#description_36","title":"Description","text":"<p>Searches for the named element among the children of this window or container, and returns the object if found.</p>"},{"location":"user-interface-tools/window-object/#parameters_5","title":"Parameters","text":"Parameter Type Description <code>name</code> String The name of the element, as specified in the name creation property."},{"location":"user-interface-tools/window-object/#returns_5","title":"Returns","text":"<p>The control object or <code>null</code>.</p>"},{"location":"user-interface-tools/window-object/#hide","title":"hide()","text":"<p><code>windowObj.hide()</code></p> <p>Hides this window. When a window is hidden, its children are also hidden, but when it is shown again, the children retain their own visibility states.</p> <p>For a modal dialog, closes the dialog and sets its result to <code>0</code>.</p>"},{"location":"user-interface-tools/window-object/#returns_6","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#notify","title":"notify()","text":"<p><code>windowObj.notify([event])</code></p>"},{"location":"user-interface-tools/window-object/#description_37","title":"Description","text":"<p>Sends a notification message, simulating the specified user interaction event.</p>"},{"location":"user-interface-tools/window-object/#parameters_6","title":"Parameters","text":"<p>Parameter</p> <p>Type</p> <p>Description</p> <p><code>event</code></p> <p>String</p> <p>Optional. The name of the window event handler to call. One of:</p> <ul> <li><code>onClose</code></li> <li><code>onMove</code></li> <li><code>onMoving</code></li> <li><code>onResize</code></li> <li><code>onResizing</code></li> <li><code>onShow</code></li> </ul>"},{"location":"user-interface-tools/window-object/#returns_7","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#example","title":"Example","text":"<p>To simulate a dialog being moved by a user:</p> <pre><code>myDlg.notify(\"onMove\")\n</code></pre>"},{"location":"user-interface-tools/window-object/#remove","title":"remove()","text":"<p><code>windowOrContainerObj.remove(index)</code></p> <p><code>windowOrContainerObj.remove(text)</code></p> <p><code>windowOrContainerObj.remove(child)</code></p>"},{"location":"user-interface-tools/window-object/#description_38","title":"Description","text":"<p>Removes the specified child control from this window's or container's children array. No error results if the child does not exist.</p>"},{"location":"user-interface-tools/window-object/#parameters_7","title":"Parameters","text":"Parameter Type Description <code>index</code>/<code>text</code>/<code>child</code> Number, String, or Control object The child control to remove, specified by 0-based index, the contained text value, or as a control object."},{"location":"user-interface-tools/window-object/#returns_8","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#removeeventlistener","title":"removeEventListener()","text":"<p><code>windowOrContainerObj.removeEventListener(eventName, handler[, capturePhase])</code></p>"},{"location":"user-interface-tools/window-object/#description_39","title":"Description","text":"<p>Unregisters an event handler for a particular type of event occurring in this window. All arguments must be identical to those that were used to register the event handler.</p>"},{"location":"user-interface-tools/window-object/#parameters_8","title":"Parameters","text":"Parameter Type Description <code>eventName</code> String The event name string. <code>handler</code> Function The function that was registered to handle the event. <code>capturePhase</code> Boolean Optional. Whether the handler was to respond only in the capture phase."},{"location":"user-interface-tools/window-object/#returns_9","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#show","title":"show()","text":"<p><code>windowOrContainerObj.show()</code></p> <p>Shows this window, container, or control. If an onShow callback is defined for a window, calls that function before showing the window.</p> <p>When a window or container is hidden, its children are also hidden, but when it is shown again, the children retain their own visibility states.</p> <p>For a modal dialog, opens the dialog and does not return until the dialog is dismissed. If it is dismissed via the close() method, this method returns any result value passed to that method. Otherwise, returns 0.</p>"},{"location":"user-interface-tools/window-object/#returns_10","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#update","title":"update()","text":"<p><code>windowOrContainerObj.update()</code></p> <p>Allows a script to run a long operation (such as copying a large file) and update UI elements to show the status of the operation.</p> <p>Normally, drawing updates to UI elements occur during idle periods, when the application is not doing anything and the OS event queue is being processed, but during a long scripted operation, the normal event loop is not running. Use this method to perform the necessary synchronous drawing updates, and also process certain mouse and keyboard events in order to allow a user to cancel the current operation (by clicking a Cancel button, for instance).</p> <p>During the update() operation, the application is put into a modal state, so that it does not handle any events that would activate a different window, or give focus to a control outside the window being updated. The modal state allows drawing events for controls in other windows to occur (as is the case during a modal show() operation), so that the script does not prevent the update of other parts of the application's UI while in the operation loop.</p> <p>It is an error to call the update() method for a window that is not currently visible.</p>"},{"location":"user-interface-tools/window-object/#returns_11","title":"Returns","text":"<p>Nothing</p>"},{"location":"user-interface-tools/window-object/#window-event-handling-callbacks","title":"Window event-handling callbacks","text":"<p>The following callback functions can be defined to respond to events in windows. To respond to an event, define a function with the corresponding name in the <code>Window</code> instance. These callbacks are not available for other container types (controls of type <code>panel</code> or <code>group</code>).</p>"},{"location":"user-interface-tools/window-object/#onactivate","title":"onActivate","text":"<p>Called when the user make the window active by clicking it or otherwise making it the keyboard focus.</p>"},{"location":"user-interface-tools/window-object/#onclose","title":"onClose","text":"<p>Called when a request is made to close the window, either by an explicit call to the close() function or by a user action (clicking the OS-specific close icon in the title bar). The function is called before the window actually closes; it can return <code>false</code> to cancel the close operation.</p>"},{"location":"user-interface-tools/window-object/#ondeactivate","title":"onDeactivate","text":"<p>Called when the user makes a previously active window inactive; for instance by closing it, or by clicking another window to change the keyboard focus.</p>"},{"location":"user-interface-tools/window-object/#ondraw","title":"onDraw","text":"<p>Called when a container or control is about to be drawn. Allows the script to modify or control the appearance, using the control's associated ScriptUIGraphics object object. Handler takes one argument, a DrawState object object.</p>"},{"location":"user-interface-tools/window-object/#onmove","title":"onMove","text":"<p>Called when the window has been moved.</p>"},{"location":"user-interface-tools/window-object/#onmoving","title":"onMoving","text":"<p>Called while a window in being moved, each time the position changes. A handler can monitor the move operation.</p>"},{"location":"user-interface-tools/window-object/#onresize","title":"onResize","text":"<p>Called when the window has been resized.</p>"},{"location":"user-interface-tools/window-object/#onresizing","title":"onResizing","text":"<p>Called while a window is being resized, each time the height or width changes. A handler can monitor the resize operation.</p>"},{"location":"user-interface-tools/window-object/#onshortcutkey","title":"onShortcutKey","text":"<p>(In Windows only)</p> <p>Called when a shortcut-key sequence is typed that matches the shortcutKey value for this window.</p>"},{"location":"user-interface-tools/window-object/#onshow","title":"onShow","text":"<p>Called when a request is made to open the window using the show() method, before the window is made visible, but after automatic layout is complete. A handler can modify the results of the automatic layout.</p>"},{"location":"vscode-debugger/","title":"The VS Code Debugger","text":"<p>Since The ExtendScript Toolkit has been deprecated by Adobe (in part due to MacOS dropping support for 32-bit apps), the official method of debugging Extendscript is by using VS Code with the Adobe Extendscript extension.</p> <p>It's semi-buggy, generally unreliable, and seems to be meant for self-contained instant-run scripts (as opposed to ScriptUI panels), but it can be helpful in some cases.</p> <p>The docs here are currently in progress and are ever-evolving; contributions are encouraged and welcome!</p> <ul> <li>Getting Started with the VS Code Debugger</li> <li>VS Code Extension Features</li> </ul>"},{"location":"vscode-debugger/#external-links","title":"External Links","text":"<p>For information on the history of and official announcements about the VS Code debugger, see the following:</p> <ul> <li>ExtendScript Debugger for Visual Studio Code Public Release</li> <li>The Future of ExtendScript Development: A VSCode Plugin</li> </ul>"},{"location":"vscode-debugger/getting-started-with-vscode-debugger/","title":"Getting Started with the VS Code Debugger","text":"<p>Unlike the ExtendScript Toolkit, the VS Code debugger takes some work to get up and running. This document is intended to make that process as straightforward as possible.</p> <p>Note</p> <p>This guide is meant to walk you through how to install and run the Extendscript for VS Code debugger.</p> <p>If you're looking on how to use specific features of the extension, see VS Code Extension Features.</p> <p>Generally, you'll need to follow these steps:</p> <ul> <li>Installing the extension</li> <li>Opening a project directory</li> <li>Creating a debug launch task</li> <li>Attaching the debugger</li> <li>Running the debugger</li> <li>Futher reading</li> </ul>"},{"location":"vscode-debugger/getting-started-with-vscode-debugger/#installing-the-extension","title":"Installing the extension","text":"<p>Either head to the extension marketplace link and install from there, or search \"ExtendScript Debugger\" within VS Code's extension browser and install.</p> <p>If you're going the latter route, make sure you're installing the one from Adobe!</p>"},{"location":"vscode-debugger/getting-started-with-vscode-debugger/#opening-a-project-directory","title":"Opening a project directory","text":"<ul> <li>File &gt; Open Folder</li> <li>Choose your project directory</li> </ul>"},{"location":"vscode-debugger/getting-started-with-vscode-debugger/#creating-a-debug-launch-task","title":"Creating a debug launch task","text":"<p>To use the extension, you need to create a debug task for VS Code to run when you want to debug extendscript.</p> <p>In your project directory:</p> <ul> <li>create a folder called .vscode (with the period)</li> <li>in that folder, create a file launch.json</li> <li>paste in the following code:</li> </ul> <pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"type\": \"extendscript-debug\",\n            \"request\": \"attach\",\n            \"name\": \"extendScript-Debug attach\",\n        }\n    ]\n}\n</code></pre> <p>This creates a config for VSCode's debugger that attaches to the host app of your choice.</p>"},{"location":"vscode-debugger/getting-started-with-vscode-debugger/#attaching-the-debugger","title":"Attaching the debugger","text":"<p>Once the extension is installed:</p> <ul> <li>Open a JS workspace</li> <li>Launch your Adobe app of choice</li> <li>Select the run and Debug tab from the sidebar or hit Ctrl+Shift+D, then in the drop-down menu choose \"extendScript-Debug attach\"</li> <li>Choose the host app from the drop-down that appears</li> </ul> <p>The bottom Status bar will turn orange indicating that the debugger is now attached to the host app. You can use the debug console to evaluate commands and query variables, even if a script is not running.</p>"},{"location":"vscode-debugger/getting-started-with-vscode-debugger/#running-the-debugger","title":"Running the debugger","text":"<p>Once you've set up your environment and built your script:</p> <ul> <li>Click on the status bar button labelled \"\u25b7 Eval in host app name\" to launch the current script, or use the command pallette and choose ExtendScript - Evaluate Script In Attached Host.</li> <li>If the script throws any errors, you'll be able to view variables &amp; a call stack</li> </ul> <p>Note</p> <p>If you're compiling the end jsx file from a number of source files, the debugger will catch errors in the compiled script, not the source files - you'll need to backtrack yourself to figure out what source file the error came from, unless you're building source maps in some way.</p> <p>This may not apply to compiled files using #include</p>"},{"location":"vscode-debugger/getting-started-with-vscode-debugger/#futher-reading","title":"Futher reading","text":"<ul> <li>Debugging in VS Code</li> </ul>"},{"location":"vscode-debugger/vscode-extension-features/","title":"VS Code Extension Features","text":"<p>Once you have the Extendscript VS Code Extension up and running, there are a few other things you can do; export to jsxbin, use breakpoints in your code, and more.</p> <p>Note</p> <p>This guide is meant to give insight on how to use specific Extendscript for VS Code features.</p> <p>If you're looking on how to get up and running with the extension, see Getting Started with the VS Code Debugger.</p>"},{"location":"vscode-debugger/vscode-extension-features/#using-breakpoints","title":"Using Breakpoints","text":"<p>Breakpoints allow you to stop your code running at a specific line, letting you explore the call stack, variable status, and function arguments at that exact point.</p> <p>You can create breakpoints one of two ways; either using VS Code's native Breakpoints system, or using Extendscript's inline breakpoint method.</p>"},{"location":"vscode-debugger/vscode-extension-features/#vs-code-breakpoints","title":"VS Code Breakpoints","text":"<p>One advantage of using VS Code is that we can set VS Code breakpoints and have the debugger respect them! See the official Visual Studio article on breakpoints.</p>"},{"location":"vscode-debugger/vscode-extension-features/#extendscript-breakpoints","title":"Extendscript Breakpoints","text":"<p>You can add in <code>$.bp()</code> anywhere in your source file, and the debugger will catch on it at the correct place, allowing you to view the call stack / data browser at that point.</p> <p>This works identically to the <code>debugger;</code> method in browser-based Javascript.</p> <p>See bp() for more info.</p>"},{"location":"vscode-debugger/vscode-extension-features/#exporting-as-binary","title":"Exporting as Binary","text":"<p>In the old Extendscript ToolKit, you could very easily save your projects as an obfuscated binary file. This functionality still exists in the VS Code debugger!</p> <p>You can export either from the vscode interface, or via the command line.</p>"},{"location":"vscode-debugger/vscode-extension-features/#jsxbin-from-vs-code","title":"JSXBIN from VS Code","text":"<p>To export your script as binary, you have a few options:</p> <ul> <li>With the file open, right-click the document and press 'Export as Binary'</li> <li>Open the command palette (Ctrl + Shift + P) and type 'Export as Binary'</li> <li>Use the keyboard shortcut for the same command (Ctrl + Shift + J)</li> </ul>"},{"location":"vscode-debugger/vscode-extension-features/#jsxbin-from-the-command-line","title":"JSXBIN from the Command Line","text":"<p>The VS Code extension allows you to export either single files or entire directories via the command line, but it takes a bit of work on your end.</p> <p>Warning</p> <p>While there is a built-in way to do it, it can be a fairly unfriendly process. As an alternative, consider the gulp-accessible npm package jsxbin. It does the same as below, but with much less user involvement.</p> <p>There are reports that this package has issues on Windows. As an alternative gulp task, you can try this script from Justin Taylor.</p> <p>Both methods above require the VS Code extension be installed.</p> <p>All of the files are saved in the same directory with the same filename (though the suffix will be .jsxbin). Any passed directories will be recursively traversed.</p> <ol> <li>Within the Extension install directory, there's a <code>exportToJSX.js</code> script file that accepts a file path or directory to convert. We need to get this path.<ul> <li>Note that you'll need to swap X.X.X with the current version #</li> <li>MacOS: <code>$HOME/.vscode/extensions/adobe.extendscript-debug-X.X.X/public-scripts/exportToJSX.js</code></li> <li>Windows: <code>%USERPROFILE%\\.vscode\\extensions\\adobe.extendscript-debug-X.X.X\\public-scripts\\exportToJSX.js</code></li> </ul> </li> <li>This script accepts a few arguments;<ul> <li><code>-f</code>, <code>--force</code>: Overwrite the '.jsxbin' file/files if already exists</li> <li><code>-n</code>, <code>--name</code>: The '.js/.jsx' script path or path to some directory having these files.</li> <li><code>h</code>, <code>--help</code>: Show this help and exit</li> </ul> </li> <li>Running the script<ul> <li>From your command line, run <code>node path/to/exportToJSX.js [options] [file/directory]</code></li> </ul> </li> </ol>"},{"location":"vscode-debugger/vscode-extension-features/#examples","title":"Examples","text":"<p>Exporting a single script</p> <pre><code>sh node \"C:/Users/Dev/.vscode/extensions/adobe.extendscript-debug-1.1.2/public-scripts/exportToJSX.js\" \"d:/projects/scripting/coolTool.jsx\"\n</code></pre> <p>Exporting a folder, overwriting</p> <pre><code>sh node \"C:/Users/Dev/.vscode/extensions/adobe.extendscript-debug-1.1.2/public-scripts/exportToJSX.js\" --force \"d:/projects/scripting/\"\n</code></pre>"}]}